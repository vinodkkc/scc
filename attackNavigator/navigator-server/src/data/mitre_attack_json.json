{
    "name": "layer",
    "versions": {
        "attack": "8",
        "navigator": "4.1",
        "layer": "4.1"
    },
    "domain": "enterprise-attack",
    "description": "",
    "filters": {
        "platforms": [
            "Linux",
            "macOS",
            "Windows",
            "Office 365",
            "Azure AD",
            "AWS",
            "GCP",
            "Azure",
            "SaaS",
            "PRE",
            "Network"
        ]
    },
    "sorting": 0,
    "layout": {
        "layout": "side",
        "showID": false,
        "showName": true
    },
    "hideDisabled": false,
    "techniques": [
        {
            "techniqueID": "T1134",
            "tactic": "defense-evasion",
            "color": "#8ddd25",
            "comment": "[\"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%runas%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1134",
            "tactic": "privilege-escalation",
            "color": "#8ddd25",
            "comment": "[\"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%runas%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1087",
            "tactic": "discovery",
            "color": "#8ddd25",
            "comment": "['select usr.username, sht.command, sht.history_file from shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid from users);', \"select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';\", \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%net.exe%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1071",
            "tactic": "command-and-control",
            "color": "#8ddd25",
            "comment": "[\"select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';\", \"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1071.001",
            "tactic": "command-and-control",
            "color": "#8ddd25",
            "comment": "[\"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1071.002",
            "tactic": "command-and-control",
            "color": "#8ddd25",
            "comment": "[\"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1071.004",
            "tactic": "command-and-control",
            "color": "#8ddd25",
            "comment": "[\"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1560.001",
            "tactic": "collection",
            "color": "#8ddd25",
            "comment": "[\"select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';\", \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%MAKECAB%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1020",
            "tactic": "exfiltration",
            "color": "#8ddd25",
            "comment": "[\"select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';\", \"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1197",
            "tactic": "defense-evasion",
            "color": "#8ddd25",
            "comment": "[\"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\", \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%bitsadmin%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1197",
            "tactic": "persistence",
            "color": "#8ddd25",
            "comment": "[\"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\", \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%bitsadmin%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1547.001",
            "tactic": "persistence",
            "color": "#8ddd25",
            "comment": "[\"select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunOnceEx\\\\\\\\0001';\", \"select name,type,data from registry where key='HKEY_CURRENT_USER\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunServices';\", \"select name,type,data from registry where key LIKE 'HKEY_USERS\\\\\\\\%\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run' and name='SystemTextEncoding';\", \"select name,type,data from registry where key='HKEY_CURRENT_USER\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunOnce';\", \"select name,type,data from registry where key='HKEY_CURRENT_USER\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1547.001",
            "tactic": "privilege-escalation",
            "color": "#8ddd25",
            "comment": "[\"select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunOnceEx\\\\\\\\0001';\", \"select name,type,data from registry where key='HKEY_CURRENT_USER\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunServices';\", \"select name,type,data from registry where key LIKE 'HKEY_USERS\\\\\\\\%\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run' and name='SystemTextEncoding';\", \"select name,type,data from registry where key='HKEY_CURRENT_USER\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunOnce';\", \"select name,type,data from registry where key='HKEY_CURRENT_USER\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1037",
            "tactic": "persistence",
            "color": "#8ddd25",
            "comment": "[\"select * from registry where key='HKEY_CURRENT_USER\\\\\\\\Environment';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1037",
            "tactic": "privilege-escalation",
            "color": "#8ddd25",
            "comment": "[\"select * from registry where key='HKEY_CURRENT_USER\\\\\\\\Environment';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1217",
            "tactic": "discovery",
            "color": "#8ddd25",
            "comment": "['select usr.username, sht.command, sht.history_file from shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid from users);', \"select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1176",
            "tactic": "persistence",
            "color": "#8ddd25",
            "comment": "['SELECT u.username, ce.* FROM users u CROSS JOIN chrome_extensions ce USING (uid);', 'SELECT u.username, ce.* FROM users u CROSS JOIN firefox_addons ce USING (uid);', 'SELECT u.username, ce.* FROM users u CROSS JOIN opera_extensions ce USING (uid);', 'select * from ie_extensions;', 'select u.username, ce.name,ce.identifier,ce.version,ce.description,ce.locale,ce.update_url,ce.author,ce.persistent,ce.path from chrome_extensions ce LEFT JOIN users u ON ce.uid = u.uid;']",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1110.002",
            "tactic": "credential-access",
            "color": "#8ddd25",
            "comment": "[\"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%mimikatz%';\", \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%procdump%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1059",
            "tactic": "execution",
            "color": "#8ddd25",
            "comment": "[\"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%CMD%';\", 'select usr.username, sht.command, sht.history_file from shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid from users);', 'all queries', \"select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1059.001",
            "tactic": "execution",
            "color": "#8ddd25",
            "comment": "[\"1. select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%POWERSHELL%';\\n2. select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.name LIKE '%powershell%' AND pr.cmdline != '';\", 'select * from powershell_events;']",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1059.003",
            "tactic": "execution",
            "color": "#8ddd25",
            "comment": "[\"select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1059.004",
            "tactic": "execution",
            "color": "#8ddd25",
            "comment": "['select usr.username, sht.command, sht.history_file from shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid from users);']",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1136",
            "tactic": "persistence",
            "color": "#8ddd25",
            "comment": "[\"select datetime(time,'unixepoch','UTC') as time_utc,host,username,tty,pid,type from last;\", 'select * from users;', 'SELECT * FROM users;', \"select datetime(time,'unixepoch','UTC') as time_utc,host,user,tty,pid,type from logged_in_users;\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1136.001",
            "tactic": "persistence",
            "color": "#8ddd25",
            "comment": "[\"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%net.exe%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1543.003",
            "tactic": "persistence",
            "color": "#8ddd25",
            "comment": "[\"select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';\", \"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\", \"select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunServices';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1543.003",
            "tactic": "privilege-escalation",
            "color": "#8ddd25",
            "comment": "[\"select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';\", \"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\", \"select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunServices';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1555",
            "tactic": "credential-access",
            "color": "#8ddd25",
            "comment": "[\"select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.name LIKE 'lazagne';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1555.003",
            "tactic": "credential-access",
            "color": "#8ddd25",
            "comment": "[\"select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.name LIKE 'lazagne';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1132",
            "tactic": "command-and-control",
            "color": "#8ddd25",
            "comment": "[\"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1486",
            "tactic": "impact",
            "color": "#8ddd25",
            "comment": "[\"select path, size from file where path like 'C:\\\\Users\\\\%%' and mtime > (select local_time from time) - 100 and filename\\xa0!= '.';\", \"select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';\", \"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1001",
            "tactic": "command-and-control",
            "color": "#8ddd25",
            "comment": "[\"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1074",
            "tactic": "collection",
            "color": "#8ddd25",
            "comment": "[\"select f.path,f.directory,u.username,f.hard_links,f.symlink,datetime(f.btime, 'unixepoch', 'UTC') as btime, datetime(f.atime, 'unixepoch', 'UTC') as atime, datetime(f.ctime, 'unixepoch', 'UTC') as ctime, datetime(f.mtime, 'unixepoch', 'UTC') as mtime from file f LEFT JOIN users u on f.uid=u.uid where f.path like 'C:\\\\\\\\users\\\\\\\\%\\\\\\\\AppData\\\\\\\\Local\\\\\\\\%' AND f.type='directory';\", \"select f.path,f.directory,u.username,f.hard_links,f.symlink,datetime(f.btime, 'unixepoch', 'UTC') as btime, datetime(f.atime, 'unixepoch', 'UTC') as atime, datetime(f.ctime, 'unixepoch', 'UTC') as ctime, datetime(f.mtime, 'unixepoch', 'UTC') as mtime from file f LEFT JOIN users u on f.uid=u.uid where f.path like 'C:\\\\\\\\users\\\\\\\\%\\\\\\\\AppData\\\\\\\\Roaming\\\\\\\\%' AND f.type='directory';\", \"SELECT hash.md5, path, file.filename, datetime(file.btime, 'unixepoch', 'UTC') as btime, datetime(file.atime, 'unixepoch', 'UTC') as atime, datetime(file.ctime, 'unixepoch', 'UTC') as ctime, datetime(file.mtime, 'unixepoch', 'UTC') as mtime FROM hash JOIN file USING (path) where path like 'C:\\\\\\\\Windows\\\\\\\\temp\\\\\\\\%' and type='regular';\", \"select f.path,f.directory,u.username,f.hard_links,f.symlink,datetime(f.btime, 'unixepoch', 'UTC') as btime, datetime(f.atime, 'unixepoch', 'UTC') as atime, datetime(f.ctime, 'unixepoch', 'UTC') as ctime, datetime(f.mtime, 'unixepoch', 'UTC') as mtime from file f LEFT JOIN users u on f.uid=u.uid where f.path like 'C:\\\\\\\\Windows\\\\\\\\temp\\\\\\\\%' AND f.type='directory';\", \"select f.path,f.directory,u.username,f.hard_links,f.symlink,datetime(f.btime, 'unixepoch', 'UTC') as btime, datetime(f.atime, 'unixepoch', 'UTC') as atime, datetime(f.ctime, 'unixepoch', 'UTC') as ctime, datetime(f.mtime, 'unixepoch', 'UTC') as mtime from file f LEFT JOIN users u on f.uid=u.uid where f.path like 'C:\\\\\\\\users\\\\\\\\%\\\\\\\\AppData\\\\\\\\local\\\\\\\\temp\\\\\\\\%' AND f.type='directory';\", \"select f.path,f.directory,u.username,f.hard_links,f.symlink,datetime(f.btime, 'unixepoch', 'UTC') as btime, datetime(f.atime, 'unixepoch', 'UTC') as atime, datetime(f.ctime, 'unixepoch', 'UTC') as ctime, datetime(f.mtime, 'unixepoch', 'UTC') as mtime from file f LEFT JOIN users u on f.uid=u.uid where f.path like 'C:\\\\\\\\Windows\\\\\\\\%' AND f.type='directory';\", \"SELECT hash.md5, path, file.filename, datetime(file.btime, 'unixepoch', 'UTC') as btime, datetime(file.atime, 'unixepoch', 'UTC') as atime, datetime(file.ctime, 'unixepoch', 'UTC') as ctime, datetime(file.mtime, 'unixepoch', 'UTC') as mtime FROM hash JOIN file USING (path) where path like 'C:\\\\\\\\users\\\\\\\\%\\\\\\\\AppData\\\\\\\\Local\\\\\\\\temp\\\\\\\\%' and type='regular';\", \"SELECT hash.md5, path, file.filename, datetime(file.btime, 'unixepoch', 'UTC') as btime, datetime(file.atime, 'unixepoch', 'UTC') as atime, datetime(file.ctime, 'unixepoch', 'UTC') as ctime, datetime(file.mtime, 'unixepoch', 'UTC') as mtime FROM hash JOIN file USING (path) where path like 'C:\\\\\\\\users\\\\\\\\%\\\\\\\\AppData\\\\\\\\Roaming\\\\\\\\%' and type='regular';\", \"SELECT hash.md5, path, file.filename, datetime(file.btime, 'unixepoch', 'UTC') as btime, datetime(file.atime, 'unixepoch', 'UTC') as atime, datetime(file.ctime, 'unixepoch', 'UTC') as ctime, datetime(file.mtime, 'unixepoch', 'UTC') as mtime FROM hash JOIN file USING (path) where path like 'C:\\\\\\\\users\\\\\\\\%\\\\\\\\AppData\\\\\\\\Local\\\\\\\\%' and type='regular';\", \"SELECT hash.md5, path, file.filename, datetime(file.btime, 'unixepoch', 'UTC') as btime, datetime(file.atime, 'unixepoch', 'UTC') as atime, datetime(file.ctime, 'unixepoch', 'UTC') as ctime, datetime(file.mtime, 'unixepoch', 'UTC') as mtime FROM hash JOIN file USING (path) where path like 'C:\\\\\\\\Windows\\\\\\\\%' and type='regular';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1039",
            "tactic": "collection",
            "color": "#8ddd25",
            "comment": "[\"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1025",
            "tactic": "collection",
            "color": "#8ddd25",
            "comment": "['SELECT device, device_alias, flags, path,type from mounts;']",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1140",
            "tactic": "defense-evasion",
            "color": "#8ddd25",
            "comment": "[\"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%certutil%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1546.008",
            "tactic": "persistence",
            "color": "#8ddd25",
            "comment": "[\"select name,type,data from registry where key like 'HKEY_LOCAL_MACHINE\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows NT\\\\\\\\CurrentVersion\\\\\\\\Image File Execution Options\\\\\\\\%\\\\\\\\';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1546.008",
            "tactic": "privilege-escalation",
            "color": "#8ddd25",
            "comment": "[\"select name,type,data from registry where key like 'HKEY_LOCAL_MACHINE\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows NT\\\\\\\\CurrentVersion\\\\\\\\Image File Execution Options\\\\\\\\%\\\\\\\\';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1048",
            "tactic": "exfiltration",
            "color": "#8ddd25",
            "comment": "[\"select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';\", \"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1041",
            "tactic": "exfiltration",
            "color": "#8ddd25",
            "comment": "[\"select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';\", \"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\", \"select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.name LIKE 'lazagne';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1011",
            "tactic": "exfiltration",
            "color": "#8ddd25",
            "comment": "[\"select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';\", \"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1052",
            "tactic": "exfiltration",
            "color": "#8ddd25",
            "comment": "['SELECT * FROM usb_devices;', 'SELECT device, device_alias, flags, path,type from mounts;']",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1008",
            "tactic": "command-and-control",
            "color": "#8ddd25",
            "comment": "[\"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1083",
            "tactic": "discovery",
            "color": "#8ddd25",
            "comment": "['select usr.username, sht.command, sht.history_file from shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid from users);', \"select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1222",
            "tactic": "defense-evasion",
            "color": "#8ddd25",
            "comment": "['select usr.username, sht.command, sht.history_file from shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid from users);']",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1574.002",
            "tactic": "defense-evasion",
            "color": "#8ddd25",
            "comment": "[\"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\", 'select DISTINCT(pm.path), p.pid, p.name from processes p JOIN process_memory_map pm ON p.pid=pm.pid;']",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1574.002",
            "tactic": "persistence",
            "color": "#8ddd25",
            "comment": "[\"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\", 'select DISTINCT(pm.path), p.pid, p.name from processes p JOIN process_memory_map pm ON p.pid=pm.pid;']",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1574.002",
            "tactic": "privilege-escalation",
            "color": "#8ddd25",
            "comment": "[\"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\", 'select DISTINCT(pm.path), p.pid, p.name from processes p JOIN process_memory_map pm ON p.pid=pm.pid;']",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1070.001",
            "tactic": "defense-evasion",
            "color": "#8ddd25",
            "comment": "['select * from windows_events;', 'select * from windows_events where eventid=1102;', 'select * from powershell_events;']",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1070.004",
            "tactic": "defense-evasion",
            "color": "#8ddd25",
            "comment": "[\"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%CMD%';\", 'select * from file_events;']",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1105",
            "tactic": "command-and-control",
            "color": "#8ddd25",
            "comment": "[\"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\", \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%certutil%';\", 'select * from file_events;']",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1056.001",
            "tactic": "collection",
            "color": "#8ddd25",
            "comment": "['select * from file_events;']",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1056.001",
            "tactic": "credential-access",
            "color": "#8ddd25",
            "comment": "['select * from file_events;']",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1036.005",
            "tactic": "defense-evasion",
            "color": "#8ddd25",
            "comment": "[\"select name,type,data from registry where key LIKE 'HKEY_USERS\\\\\\\\%\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run' and name='WindowsDefenderUpdater';\", 'select * from file_events;']",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1112",
            "tactic": "defense-evasion",
            "color": "#8ddd25",
            "comment": "['all queries']",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1104",
            "tactic": "command-and-control",
            "color": "#8ddd25",
            "comment": "[\"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1046",
            "tactic": "discovery",
            "color": "#8ddd25",
            "comment": "[\"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1135",
            "tactic": "discovery",
            "color": "#8ddd25",
            "comment": "[\"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%net.exe%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1003",
            "tactic": "credential-access",
            "color": "#8ddd25",
            "comment": "['select usr.username, sht.command, sht.history_file from shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid from users);', \"select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1003.001",
            "tactic": "credential-access",
            "color": "#8ddd25",
            "comment": "[\"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%mimikatz%';\", 'select * from powershell_events;']",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1003.005",
            "tactic": "credential-access",
            "color": "#8ddd25",
            "comment": "[\"select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.name LIKE 'lazagne';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1201",
            "tactic": "discovery",
            "color": "#8ddd25",
            "comment": "['select usr.username, sht.command, sht.history_file from shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid from users);', \"select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';\", \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%net.exe%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1069",
            "tactic": "discovery",
            "color": "#8ddd25",
            "comment": "['select usr.username, sht.command, sht.history_file from shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid from users);', \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%net.exe%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1057",
            "tactic": "discovery",
            "color": "#8ddd25",
            "comment": "[\"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%tasklist%';\", \"select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1055",
            "tactic": "defense-evasion",
            "color": "#8ddd25",
            "comment": "['select usr.username, sht.command, sht.history_file from shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid from users);']",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1055",
            "tactic": "privilege-escalation",
            "color": "#8ddd25",
            "comment": "['select usr.username, sht.command, sht.history_file from shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid from users);']",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1090",
            "tactic": "command-and-control",
            "color": "#8ddd25",
            "comment": "[\"select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';\", \"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1012",
            "tactic": "discovery",
            "color": "#8ddd25",
            "comment": "[\"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%reg%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1219",
            "tactic": "command-and-control",
            "color": "#8ddd25",
            "comment": "[\"select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';\", \"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1021",
            "tactic": "lateral-movement",
            "color": "#8ddd25",
            "comment": "['select * from users;', \"select datetime(time,'unixepoch','UTC') as time_utc,host,user,tty,pid,type from logged_in_users;\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1018",
            "tactic": "discovery",
            "color": "#8ddd25",
            "comment": "[\"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%net.exe%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1496",
            "tactic": "impact",
            "color": "#8ddd25",
            "comment": "[\"SELECT pid, name, ROUND((total_size * '10e-7'), 2) AS used FROM processes ORDER BY total_size DESC LIMIT 5;\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1053",
            "tactic": "execution",
            "color": "#8ddd25",
            "comment": "[\"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%at.exe%';\", \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%taskeng%';\", \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%schtasks%';\", \"select name,action,path,enabled,datetime(next_run_time,'unixepoch','UTC') from scheduled_tasks;\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1053",
            "tactic": "persistence",
            "color": "#8ddd25",
            "comment": "[\"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%at.exe%';\", \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%taskeng%';\", \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%schtasks%';\", \"select name,action,path,enabled,datetime(next_run_time,'unixepoch','UTC') from scheduled_tasks;\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1053",
            "tactic": "privilege-escalation",
            "color": "#8ddd25",
            "comment": "[\"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%at.exe%';\", \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%taskeng%';\", \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%schtasks%';\", \"select name,action,path,enabled,datetime(next_run_time,'unixepoch','UTC') from scheduled_tasks;\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1053.005",
            "tactic": "execution",
            "color": "#8ddd25",
            "comment": "[\"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%at.exe%';\", 'select * from windows_events where eventid=4698;', 'select * from windows_events where eventid=4701;', \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%taskeng%';\", 'select * from windows_events where eventid=4700;', \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%schtasks%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1053.005",
            "tactic": "persistence",
            "color": "#8ddd25",
            "comment": "[\"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%at.exe%';\", 'select * from windows_events where eventid=4698;', 'select * from windows_events where eventid=4701;', \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%taskeng%';\", 'select * from windows_events where eventid=4700;', \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%schtasks%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1053.005",
            "tactic": "privilege-escalation",
            "color": "#8ddd25",
            "comment": "[\"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%at.exe%';\", 'select * from windows_events where eventid=4698;', 'select * from windows_events where eventid=4701;', \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%taskeng%';\", 'select * from windows_events where eventid=4700;', \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%schtasks%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1029",
            "tactic": "exfiltration",
            "color": "#8ddd25",
            "comment": "[\"select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';\", \"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1218.001",
            "tactic": "defense-evasion",
            "color": "#8ddd25",
            "comment": "[\"select * from processes where name='hh.exe';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1216",
            "tactic": "defense-evasion",
            "color": "#8ddd25",
            "comment": "[\"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%cscript%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1072",
            "tactic": "execution",
            "color": "#8ddd25",
            "comment": "[\"select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1072",
            "tactic": "lateral-movement",
            "color": "#8ddd25",
            "comment": "[\"select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1518.001",
            "tactic": "discovery",
            "color": "#8ddd25",
            "comment": "[\"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%tasklist%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1082",
            "tactic": "discovery",
            "color": "#8ddd25",
            "comment": "['select usr.username, sht.command, sht.history_file from shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid from users);', \"select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';\", \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%systeminfo%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1016",
            "tactic": "discovery",
            "color": "#8ddd25",
            "comment": "['select usr.username, sht.command, sht.history_file from shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid from users);', \"select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1049",
            "tactic": "discovery",
            "color": "#8ddd25",
            "comment": "[\"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%netstat%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1033",
            "tactic": "discovery",
            "color": "#8ddd25",
            "comment": "['select usr.username, sht.command, sht.history_file from shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid from users);', \"select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';\", \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%whoami%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1007",
            "tactic": "discovery",
            "color": "#8ddd25",
            "comment": "[\"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%tasklist%';\", \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%sc%';\", \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%net.exe%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1569.002",
            "tactic": "execution",
            "color": "#8ddd25",
            "comment": "[\"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%sc%';\", \"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%net%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1124",
            "tactic": "discovery",
            "color": "#8ddd25",
            "comment": "[\"select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%net.exe%';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1205",
            "tactic": "command-and-control",
            "color": "#8ddd25",
            "comment": "[\"select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1205",
            "tactic": "defense-evasion",
            "color": "#8ddd25",
            "comment": "[\"select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1205",
            "tactic": "persistence",
            "color": "#8ddd25",
            "comment": "[\"select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1204",
            "tactic": "execution",
            "color": "#8ddd25",
            "comment": "[\"SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='notepad++.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='notepad++.exe');\", \"SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='firefox.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='firefox.exe');\", \"SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent != (SELECT pid from processes where name='explorer.exe') AND LOWER(name)='chrome.exe') OR pid=(SELECT pid FROM processes WHERE parent != (SELECT pid from processes where name='explorer.exe') AND LOWER(name)='chrome.exe');\", \"SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='iexplore.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='iexplore.exe');\", \"SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='wininit.exe') AND LOWER(name)='services.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='wininit.exe') AND LOWER(name)='services.exe');\", \"SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='wininit.exe') AND LOWER(name)='lsass.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='wininit.exe') AND LOWER(name)='lsass.exe');\", \"SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='cmd.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='cmd.exe');\", \"SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='notepad.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='notepad.exe');\", \"SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent != (SELECT pid from processes where name='csrss.exe') AND LOWER(name)='conhost.exe') OR pid=(SELECT pid FROM processes WHERE parent != (SELECT pid from processes where name='csrss.exe') AND LOWER(name)='conhost.exe');\", \"SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='powershell.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='powershell.exe');\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1078",
            "tactic": "defense-evasion",
            "color": "#8ddd25",
            "comment": "[\"select datetime(time,'unixepoch','UTC') as time_utc,host,username,tty,pid,type from last;\", 'select * from users;', 'SELECT * FROM users;', \"select datetime(time,'unixepoch','UTC') as time_utc,host,user,tty,pid,type from logged_in_users;\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1078",
            "tactic": "initial-access",
            "color": "#8ddd25",
            "comment": "[\"select datetime(time,'unixepoch','UTC') as time_utc,host,username,tty,pid,type from last;\", 'select * from users;', 'SELECT * FROM users;', \"select datetime(time,'unixepoch','UTC') as time_utc,host,user,tty,pid,type from logged_in_users;\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1078",
            "tactic": "persistence",
            "color": "#8ddd25",
            "comment": "[\"select datetime(time,'unixepoch','UTC') as time_utc,host,username,tty,pid,type from last;\", 'select * from users;', 'SELECT * FROM users;', \"select datetime(time,'unixepoch','UTC') as time_utc,host,user,tty,pid,type from logged_in_users;\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1078",
            "tactic": "privilege-escalation",
            "color": "#8ddd25",
            "comment": "[\"select datetime(time,'unixepoch','UTC') as time_utc,host,username,tty,pid,type from last;\", 'select * from users;', 'SELECT * FROM users;', \"select datetime(time,'unixepoch','UTC') as time_utc,host,user,tty,pid,type from logged_in_users;\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1102",
            "tactic": "command-and-control",
            "color": "#8ddd25",
            "comment": "[\"select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';\", \"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        },
        {
            "techniqueID": "T1102.001",
            "tactic": "command-and-control",
            "color": "#8ddd25",
            "comment": "[\"select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';\", \"select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';\"]",
            "enabled": true,
            "metadata": [],
            "showSubtechniques": false
        }
    ],
    "gradient": {
        "colors": [
            "#ff6666",
            "#ffe766",
            "#8ec843"
        ],
        "minValue": 0,
        "maxValue": 100
    },
    "legendItems": [],
    "metadata": [],
    "showTacticRowBackground": false,
    "tacticRowBackground": "#dddddd",
    "selectTechniquesAcrossTactics": true,
    "selectSubtechniquesWithParent": false
}